(function() {
  window.classes = {view: {},page: {},model: {},collection: {},controller: {}};
  window.models = {};
  window.views = {};
  window.resources = {};
  window.helpers = {};
  window.tracksflow = {};
  window.tracksflow.h = {};
  window.APP_NAME = "Tracks Flow";
  window.API_PREFIX = "/api/common";
  window.NODE_API_PREFIX = "/api";
  window.api_url = "/api";
  window.api_url_2 = "/2.0/api";
  window.helpers.gridHeight = 8;
  window.tracksflow.h.gSize = 8
}).call(this);
/*
 * JavaScript Linkify - v0.3 - 6/27/2009
 * http://benalman.com/projects/javascript-linkify/
 * 
 * Copyright (c) 2009 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 * 
 * Some regexps adapted from http://userscripts.org/scripts/review/7122
 */
window.linkify = (function() {
  var f = "[a-z\\d.-]+://", h = "(?:(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])\\.){3}(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])", g = "(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+", p = "(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)", c = "(?:" + g + p + "|" + h + ")", q = "(?:[;/][^#?<>\\s]*)?", d = "(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?", e = "\\b" + f + "[^<>\\s]+", b = "\\b" + c + q + d + "(?!\\w)", o = "mailto:", k = "(?:" + o + ")?[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@" + c + d + "(?!\\w)", a = new RegExp("(?:" + e + "|" + b + "|" + k + ")", "ig"), m = new RegExp("^" + f, "i"), n = {"'": "`",">": "<",")": "(","]": "[","}": "{","»": "«","›": "‹"}, l = {callback: function(s, r) {
    return r ? '<a class="urlLink" href="' + r + '" title="' + r + '" target="_blank">' + s + "</a>" : s
  },punct_regexp: /(?:[!?.,:;'"]|(?:&|&amp;)(?:lt|gt|quot|apos|raquo|laquo|rsaquo|lsaquo);)$/};
  return function(x, G) {
    G = G || {};
    var z, w, B, s, y = "", v = [], u, F, E, r, t, D, C, A;
    for (w in l) {
      if (G[w] === undefined) {
        G[w] = l[w]
      }
    }
    while (z = a.exec(x)) {
      B = z[0];
      F = a.lastIndex;
      E = F - B.length;
      if (/[\/:]/.test(x.charAt(E - 1))) {
        continue
      }
      do {
        r = B;
        A = B.substr(-1);
        C = n[A];
        if (C) {
          t = B.match(new RegExp("\\" + C + "(?!$)", "g"));
          D = B.match(new RegExp("\\" + A, "g"));
          if ((t ? t.length : 0) < (D ? D.length : 0)) {
            B = B.substr(0, B.length - 1);
            F--
          }
        }
        if (G.punct_regexp) {
          B = B.replace(G.punct_regexp, function(H) {
            F -= H.length;
            return ""
          })
        }
      } while (B.length && B !== r);
      s = B;
      if (!m.test(s)) {
        s = (s.indexOf("@") !== -1 ? (!s.indexOf(o) ? "" : o) : !s.indexOf("irc.") ? "irc://" : !s.indexOf("ftp.") ? "ftp://" : "http://") + s
      }
      if (u != E) {
        v.push([x.slice(u, E)]);
        u = F
      }
      v.push([B, s])
    }
    v.push([x.substr(u)]);
    for (w = 0; w < v.length; w++) {
      y += G.callback.apply(window, v[w])
    }
    return y || x
  }
})();
/* jQuery v1.8.2 jquery.com | jquery.org/license */
(function(a, b) {
  function G(a) {
    var b = F[a] = {};
    return p.each(a.split(s), function(a, c) {
      b[c] = !0
    }), b
  }
  function J(a, c, d) {
    if (d === b && a.nodeType === 1) {
      var e = "data-" + c.replace(I, "-$1").toLowerCase();
      d = a.getAttribute(e);
      if (typeof d == "string") {
        try {
          d = d === "true" ? !0 : d === "false" ? !1 : d === "null" ? null : +d + "" === d ? +d : H.test(d) ? p.parseJSON(d) : d
        } catch (f) {
        }
        p.data(a, c, d)
      } else {
        d = b
      }
    }
    return d
  }
  function K(a) {
    var b;
    for (b in a) {
      if (b === "data" && p.isEmptyObject(a[b])) {
        continue
      }
      if (b !== "toJSON") {
        return !1
      }
    }
    return !0
  }
  function ba() {
    return !1
  }
  function bb() {
    return !0
  }
  function bh(a) {
    return !a || !a.parentNode || a.parentNode.nodeType === 11
  }
  function bi(a, b) {
    do {
      a = a[b]
    } while (a && a.nodeType !== 1);
    return a
  }
  function bj(a, b, c) {
    b = b || 0;
    if (p.isFunction(b)) {
      return p.grep(a, function(a, d) {
        var e = !!b.call(a, d, a);
        return e === c
      })
    }
    if (b.nodeType) {
      return p.grep(a, function(a, d) {
        return a === b === c
      })
    }
    if (typeof b == "string") {
      var d = p.grep(a, function(a) {
        return a.nodeType === 1
      });
      if (be.test(b)) {
        return p.filter(b, d, !c)
      }
      b = p.filter(b, d)
    }
    return p.grep(a, function(a, d) {
      return p.inArray(a, b) >= 0 === c
    })
  }
  function bk(a) {
    var b = bl.split("|"), c = a.createDocumentFragment();
    if (c.createElement) {
      while (b.length) {
        c.createElement(b.pop())
      }
    }
    return c
  }
  function bC(a, b) {
    return a.getElementsByTagName(b)[0] || a.appendChild(a.ownerDocument.createElement(b))
  }
  function bD(a, b) {
    if (b.nodeType !== 1 || !p.hasData(a)) {
      return
    }
    var c, d, e, f = p._data(a), g = p._data(b, f), h = f.events;
    if (h) {
      delete g.handle, g.events = {};
      for (c in h) {
        for (d = 0, e = h[c].length; d < e; d++) {
          p.event.add(b, c, h[c][d])
        }
      }
    }
    g.data && (g.data = p.extend({}, g.data))
  }
  function bE(a, b) {
    var c;
    if (b.nodeType !== 1) {
      return
    }
    b.clearAttributes && b.clearAttributes(), b.mergeAttributes && b.mergeAttributes(a), c = b.nodeName.toLowerCase(), c === "object" ? (b.parentNode && (b.outerHTML = a.outerHTML), p.support.html5Clone && a.innerHTML && !p.trim(b.innerHTML) && (b.innerHTML = a.innerHTML)) : c === "input" && bv.test(a.type) ? (b.defaultChecked = b.checked = a.checked, b.value !== a.value && (b.value = a.value)) : c === "option" ? b.selected = a.defaultSelected : c === "input" || c === "textarea" ? b.defaultValue = a.defaultValue : c === "script" && b.text !== a.text && (b.text = a.text), b.removeAttribute(p.expando)
  }
  function bF(a) {
    return typeof a.getElementsByTagName != "undefined" ? a.getElementsByTagName("*") : typeof a.querySelectorAll != "undefined" ? a.querySelectorAll("*") : []
  }
  function bG(a) {
    bv.test(a.type) && (a.defaultChecked = a.checked)
  }
  function bY(a, b) {
    if (b in a) {
      return b
    }
    var c = b.charAt(0).toUpperCase() + b.slice(1), d = b, e = bW.length;
    while (e--) {
      b = bW[e] + c;
      if (b in a) {
        return b
      }
    }
    return d
  }
  function bZ(a, b) {
    return a = b || a, p.css(a, "display") === "none" || !p.contains(a.ownerDocument, a)
  }
  function b$(a, b) {
    var c, d, e = [], f = 0, g = a.length;
    for (; f < g; f++) {
      c = a[f];
      if (!c.style) {
        continue
      }
      e[f] = p._data(c, "olddisplay"), b ? (!e[f] && c.style.display === "none" && (c.style.display = ""), c.style.display === "" && bZ(c) && (e[f] = p._data(c, "olddisplay", cc(c.nodeName)))) : (d = bH(c, "display"), !e[f] && d !== "none" && p._data(c, "olddisplay", d))
    }
    for (f = 0; f < g; f++) {
      c = a[f];
      if (!c.style) {
        continue
      }
      if (!b || c.style.display === "none" || c.style.display === "") {
        c.style.display = b ? e[f] || "" : "none"
      }
    }
    return a
  }
  function b_(a, b, c) {
    var d = bP.exec(b);
    return d ? Math.max(0, d[1] - (c || 0)) + (d[2] || "px") : b
  }
  function ca(a, b, c, d) {
    var e = c === (d ? "border" : "content") ? 4 : b === "width" ? 1 : 0, f = 0;
    for (; e < 4; e += 2) {
      c === "margin" && (f += p.css(a, c + bV[e], !0)), d ? (c === "content" && (f -= parseFloat(bH(a, "padding" + bV[e])) || 0), c !== "margin" && (f -= parseFloat(bH(a, "border" + bV[e] + "Width")) || 0)) : (f += parseFloat(bH(a, "padding" + bV[e])) || 0, c !== "padding" && (f += parseFloat(bH(a, "border" + bV[e] + "Width")) || 0))
    }
    return f
  }
  function cb(a, b, c) {
    var d = b === "width" ? a.offsetWidth : a.offsetHeight, e = !0, f = p.support.boxSizing && p.css(a, "boxSizing") === "border-box";
    if (d <= 0 || d == null) {
      d = bH(a, b);
      if (d < 0 || d == null) {
        d = a.style[b]
      }
      if (bQ.test(d)) {
        return d
      }
      e = f && (p.support.boxSizingReliable || d === a.style[b]), d = parseFloat(d) || 0
    }
    return d + ca(a, b, c || (f ? "border" : "content"), e) + "px"
  }
  function cc(a) {
    if (bS[a]) {
      return bS[a]
    }
    var b = p("<" + a + ">").appendTo(e.body), c = b.css("display");
    b.remove();
    if (c === "none" || c === "") {
      bI = e.body.appendChild(bI || p.extend(e.createElement("iframe"), {frameBorder: 0,width: 0,height: 0}));
      if (!bJ || !bI.createElement) {
        bJ = (bI.contentWindow || bI.contentDocument).document, bJ.write("<!doctype html><html><body>"), bJ.close()
      }
      b = bJ.body.appendChild(bJ.createElement(a)), c = bH(b, "display"), e.body.removeChild(bI)
    }
    return bS[a] = c, c
  }
  function ci(a, b, c, d) {
    var e;
    if (p.isArray(b)) {
      p.each(b, function(b, e) {
        c || ce.test(a) ? d(a, e) : ci(a + "[" + (typeof e == "object" ? b : "") + "]", e, c, d)
      })
    } else {
      if (!c && p.type(b) === "object") {
        for (e in b) {
          ci(a + "[" + e + "]", b[e], c, d)
        }
      } else {
        d(a, b)
      }
    }
  }
  function cz(a) {
    return function(b, c) {
      typeof b != "string" && (c = b, b = "*");
      var d, e, f, g = b.toLowerCase().split(s), h = 0, i = g.length;
      if (p.isFunction(c)) {
        for (; h < i; h++) {
          d = g[h], f = /^\+/.test(d), f && (d = d.substr(1) || "*"), e = a[d] = a[d] || [], e[f ? "unshift" : "push"](c)
        }
      }
    }
  }
  function cA(a, c, d, e, f, g) {
    f = f || c.dataTypes[0], g = g || {}, g[f] = !0;
    var h, i = a[f], j = 0, k = i ? i.length : 0, l = a === cv;
    for (; j < k && (l || !h); j++) {
      h = i[j](c, d, e), typeof h == "string" && (!l || g[h] ? h = b : (c.dataTypes.unshift(h), h = cA(a, c, d, e, h, g)))
    }
    return (l || !h) && !g["*"] && (h = cA(a, c, d, e, "*", g)), h
  }
  function cB(a, c) {
    var d, e, f = p.ajaxSettings.flatOptions || {};
    for (d in c) {
      c[d] !== b && ((f[d] ? a : e || (e = {}))[d] = c[d])
    }
    e && p.extend(!0, a, e)
  }
  function cC(a, c, d) {
    var e, f, g, h, i = a.contents, j = a.dataTypes, k = a.responseFields;
    for (f in k) {
      f in d && (c[k[f]] = d[f])
    }
    while (j[0] === "*") {
      j.shift(), e === b && (e = a.mimeType || c.getResponseHeader("content-type"))
    }
    if (e) {
      for (f in i) {
        if (i[f] && i[f].test(e)) {
          j.unshift(f);
          break
        }
      }
    }
    if (j[0] in d) {
      g = j[0]
    } else {
      for (f in d) {
        if (!j[0] || a.converters[f + " " + j[0]]) {
          g = f;
          break
        }
        h || (h = f)
      }
      g = g || h
    }
    if (g) {
      return g !== j[0] && j.unshift(g), d[g]
    }
  }
  function cD(a, b) {
    var c, d, e, f, g = a.dataTypes.slice(), h = g[0], i = {}, j = 0;
    a.dataFilter && (b = a.dataFilter(b, a.dataType));
    if (g[1]) {
      for (c in a.converters) {
        i[c.toLowerCase()] = a.converters[c]
      }
    }
    for (; e = g[++j]; ) {
      if (e !== "*") {
        if (h !== "*" && h !== e) {
          c = i[h + " " + e] || i["* " + e];
          if (!c) {
            for (d in i) {
              f = d.split(" ");
              if (f[1] === e) {
                c = i[h + " " + f[0]] || i["* " + f[0]];
                if (c) {
                  c === !0 ? c = i[d] : i[d] !== !0 && (e = f[0], g.splice(j--, 0, e));
                  break
                }
              }
            }
          }
          if (c !== !0) {
            if (c && a["throws"]) {
              b = c(b)
            } else {
              try {
                b = c(b)
              } catch (k) {
                return {state: "parsererror",error: c ? k : "No conversion from " + h + " to " + e}
              }
            }
          }
        }
        h = e
      }
    }
    return {state: "success",data: b}
  }
  function cL() {
    try {
      return new a.XMLHttpRequest
    } catch (b) {
    }
  }
  function cM() {
    try {
      return new a.ActiveXObject("Microsoft.XMLHTTP")
    } catch (b) {
    }
  }
  function cU() {
    return setTimeout(function() {
      cN = b
    }, 0), cN = p.now()
  }
  function cV(a, b) {
    p.each(b, function(b, c) {
      var d = (cT[b] || []).concat(cT["*"]), e = 0, f = d.length;
      for (; e < f; e++) {
        if (d[e].call(a, b, c)) {
          return
        }
      }
    })
  }
  function cW(a, b, c) {
    var d, e = 0, f = 0, g = cS.length, h = p.Deferred().always(function() {
      delete i.elem
    }), i = function() {
      var b = cN || cU(), c = Math.max(0, j.startTime + j.duration - b), d = 1 - (c / j.duration || 0), e = 0, f = j.tweens.length;
      for (; e < f; e++) {
        j.tweens[e].run(d)
      }
      return h.notifyWith(a, [j, d, c]), d < 1 && f ? c : (h.resolveWith(a, [j]), !1)
    }, j = h.promise({elem: a,props: p.extend({}, b),opts: p.extend(!0, {specialEasing: {}}, c),originalProperties: b,originalOptions: c,startTime: cN || cU(),duration: c.duration,tweens: [],createTween: function(b, c, d) {
      var e = p.Tween(a, j.opts, b, c, j.opts.specialEasing[b] || j.opts.easing);
      return j.tweens.push(e), e
    },stop: function(b) {
      var c = 0, d = b ? j.tweens.length : 0;
      for (; c < d; c++) {
        j.tweens[c].run(1)
      }
      return b ? h.resolveWith(a, [j, b]) : h.rejectWith(a, [j, b]), this
    }}), k = j.props;
    cX(k, j.opts.specialEasing);
    for (; e < g; e++) {
      d = cS[e].call(j, a, k, j.opts);
      if (d) {
        return d
      }
    }
    return cV(j, k), p.isFunction(j.opts.start) && j.opts.start.call(a, j), p.fx.timer(p.extend(i, {anim: j,queue: j.opts.queue,elem: a})), j.progress(j.opts.progress).done(j.opts.done, j.opts.complete).fail(j.opts.fail).always(j.opts.always)
  }
  function cX(a, b) {
    var c, d, e, f, g;
    for (c in a) {
      d = p.camelCase(c), e = b[d], f = a[c], p.isArray(f) && (e = f[1], f = a[c] = f[0]), c !== d && (a[d] = f, delete a[c]), g = p.cssHooks[d];
      if (g && "expand" in g) {
        f = g.expand(f), delete a[d];
        for (c in f) {
          c in a || (a[c] = f[c], b[c] = e)
        }
      } else {
        b[d] = e
      }
    }
  }
  function cY(a, b, c) {
    var d, e, f, g, h, i, j, k, l = this, m = a.style, n = {}, o = [], q = a.nodeType && bZ(a);
    c.queue || (j = p._queueHooks(a, "fx"), j.unqueued == null && (j.unqueued = 0, k = j.empty.fire, j.empty.fire = function() {
      j.unqueued || k()
    }), j.unqueued++, l.always(function() {
      l.always(function() {
        j.unqueued--, p.queue(a, "fx").length || j.empty.fire()
      })
    })), a.nodeType === 1 && ("height" in b || "width" in b) && (c.overflow = [m.overflow, m.overflowX, m.overflowY], p.css(a, "display") === "inline" && p.css(a, "float") === "none" && (!p.support.inlineBlockNeedsLayout || cc(a.nodeName) === "inline" ? m.display = "inline-block" : m.zoom = 1)), c.overflow && (m.overflow = "hidden", p.support.shrinkWrapBlocks || l.done(function() {
      m.overflow = c.overflow[0], m.overflowX = c.overflow[1], m.overflowY = c.overflow[2]
    }));
    for (d in b) {
      f = b[d];
      if (cP.exec(f)) {
        delete b[d];
        if (f === (q ? "hide" : "show")) {
          continue
        }
        o.push(d)
      }
    }
    g = o.length;
    if (g) {
      h = p._data(a, "fxshow") || p._data(a, "fxshow", {}), q ? p(a).show() : l.done(function() {
        p(a).hide()
      }), l.done(function() {
        var b;
        p.removeData(a, "fxshow", !0);
        for (b in n) {
          p.style(a, b, n[b])
        }
      });
      for (d = 0; d < g; d++) {
        e = o[d], i = l.createTween(e, q ? h[e] : 0), n[e] = h[e] || p.style(a, e), e in h || (h[e] = i.start, q && (i.end = i.start, i.start = e === "width" || e === "height" ? 1 : 0))
      }
    }
  }
  function cZ(a, b, c, d, e) {
    return new cZ.prototype.init(a, b, c, d, e)
  }
  function c$(a, b) {
    var c, d = {height: a}, e = 0;
    b = b ? 1 : 0;
    for (; e < 4; e += 2 - b) {
      c = bV[e], d["margin" + c] = d["padding" + c] = a
    }
    return b && (d.opacity = d.width = a), d
  }
  function da(a) {
    return p.isWindow(a) ? a : a.nodeType === 9 ? a.defaultView || a.parentWindow : !1
  }
  var c, d, e = a.document, f = a.location, g = a.navigator, h = a.jQuery, i = a.$, j = Array.prototype.push, k = Array.prototype.slice, l = Array.prototype.indexOf, m = Object.prototype.toString, n = Object.prototype.hasOwnProperty, o = String.prototype.trim, p = function(a, b) {
    return new p.fn.init(a, b, c)
  }, q = /[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source, r = /\S/, s = /\s+/, t = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, u = /^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/, v = /^<(\w+)\s*\/?>(?:<\/\1>|)$/, w = /^[\],:{}\s]*$/, x = /(?:^|:|,)(?:\s*\[)+/g, y = /\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g, z = /"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g, A = /^-ms-/, B = /-([\da-z])/gi, C = function(a, b) {
    return (b + "").toUpperCase()
  }, D = function() {
    e.addEventListener ? (e.removeEventListener("DOMContentLoaded", D, !1), p.ready()) : e.readyState === "complete" && (e.detachEvent("onreadystatechange", D), p.ready())
  }, E = {};
  p.fn = p.prototype = {constructor: p,init: function(a, c, d) {
    var f, g, h, i;
    if (!a) {
      return this
    }
    if (a.nodeType) {
      return this.context = this[0] = a, this.length = 1, this
    }
    if (typeof a == "string") {
      a.charAt(0) === "<" && a.charAt(a.length - 1) === ">" && a.length >= 3 ? f = [null, a, null] : f = u.exec(a);
      if (f && (f[1] || !c)) {
        if (f[1]) {
          return c = c instanceof p ? c[0] : c, i = c && c.nodeType ? c.ownerDocument || c : e, a = p.parseHTML(f[1], i, !0), v.test(f[1]) && p.isPlainObject(c) && this.attr.call(a, c, !0), p.merge(this, a)
        }
        g = e.getElementById(f[2]);
        if (g && g.parentNode) {
          if (g.id !== f[2]) {
            return d.find(a)
          }
          this.length = 1, this[0] = g
        }
        return this.context = e, this.selector = a, this
      }
      return !c || c.jquery ? (c || d).find(a) : this.constructor(c).find(a)
    }
    return p.isFunction(a) ? d.ready(a) : (a.selector !== b && (this.selector = a.selector, this.context = a.context), p.makeArray(a, this))
  },selector: "",jquery: "1.8.2",length: 0,size: function() {
    return this.length
  },toArray: function() {
    return k.call(this)
  },get: function(a) {
    return a == null ? this.toArray() : a < 0 ? this[this.length + a] : this[a]
  },pushStack: function(a, b, c) {
    var d = p.merge(this.constructor(), a);
    return d.prevObject = this, d.context = this.context, b === "find" ? d.selector = this.selector + (this.selector ? " " : "") + c : b && (d.selector = this.selector + "." + b + "(" + c + ")"), d
  },each: function(a, b) {
    return p.each(this, a, b)
  },ready: function(a) {
    return p.ready.promise().done(a), this
  },eq: function(a) {
    return a = +a, a === -1 ? this.slice(a) : this.slice(a, a + 1)
  },first: function() {
    return this.eq(0)
  },last: function() {
    return this.eq(-1)
  },slice: function() {
    return this.pushStack(k.apply(this, arguments), "slice", k.call(arguments).join(","))
  },map: function(a) {
    return this.pushStack(p.map(this, function(b, c) {
      return a.call(b, c, b)
    }))
  },end: function() {
    return this.prevObject || this.constructor(null)
  },push: j,sort: [].sort,splice: [].splice}, p.fn.init.prototype = p.fn, p.extend = p.fn.extend = function() {
    var a, c, d, e, f, g, h = arguments[0] || {}, i = 1, j = arguments.length, k = !1;
    typeof h == "boolean" && (k = h, h = arguments[1] || {}, i = 2), typeof h != "object" && !p.isFunction(h) && (h = {}), j === i && (h = this, --i);
    for (; i < j; i++) {
      if ((a = arguments[i]) != null) {
        for (c in a) {
          d = h[c], e = a[c];
          if (h === e) {
            continue
          }
          k && e && (p.isPlainObject(e) || (f = p.isArray(e))) ? (f ? (f = !1, g = d && p.isArray(d) ? d : []) : g = d && p.isPlainObject(d) ? d : {}, h[c] = p.extend(k, g, e)) : e !== b && (h[c] = e)
        }
      }
    }
    return h
  }, p.extend({noConflict: function(b) {
    return a.$ === p && (a.$ = i), b && a.jQuery === p && (a.jQuery = h), p
  },isReady: !1,readyWait: 1,holdReady: function(a) {
    a ? p.readyWait++ : p.ready(!0)
  },ready: function(a) {
    if (a === !0 ? --p.readyWait : p.isReady) {
      return
    }
    if (!e.body) {
      return setTimeout(p.ready, 1)
    }
    p.isReady = !0;
    if (a !== !0 && --p.readyWait > 0) {
      return
    }
    d.resolveWith(e, [p]), p.fn.trigger && p(e).trigger("ready").off("ready")
  },isFunction: function(a) {
    return p.type(a) === "function"
  },isArray: Array.isArray || function(a) {
    return p.type(a) === "array"
  },isWindow: function(a) {
    return a != null && a == a.window
  },isNumeric: function(a) {
    return !isNaN(parseFloat(a)) && isFinite(a)
  },type: function(a) {
    return a == null ? String(a) : E[m.call(a)] || "object"
  },isPlainObject: function(a) {
    if (!a || p.type(a) !== "object" || a.nodeType || p.isWindow(a)) {
      return !1
    }
    try {
      if (a.constructor && !n.call(a, "constructor") && !n.call(a.constructor.prototype, "isPrototypeOf")) {
        return !1
      }
    } catch (c) {
      return !1
    }
    var d;
    for (d in a) {
    }
    return d === b || n.call(a, d)
  },isEmptyObject: function(a) {
    var b;
    for (b in a) {
      return !1
    }
    return !0
  },error: function(a) {
    throw new Error(a)
  },parseHTML: function(a, b, c) {
    var d;
    return !a || typeof a != "string" ? null : (typeof b == "boolean" && (c = b, b = 0), b = b || e, (d = v.exec(a)) ? [b.createElement(d[1])] : (d = p.buildFragment([a], b, c ? null : []), p.merge([], (d.cacheable ? p.clone(d.fragment) : d.fragment).childNodes)))
  },parseJSON: function(b) {
    if (!b || typeof b != "string") {
      return null
    }
    b = p.trim(b);
    if (a.JSON && a.JSON.parse) {
      return a.JSON.parse(b)
    }
    if (w.test(b.replace(y, "@").replace(z, "]").replace(x, ""))) {
      return (new Function("return " + b))()
    }
    p.error("Invalid JSON: " + b)
  },parseXML: function(c) {
    var d, e;
    if (!c || typeof c != "string") {
      return null
    }
    try {
      a.DOMParser ? (e = new DOMParser, d = e.parseFromString(c, "text/xml")) : (d = new ActiveXObject("Microsoft.XMLDOM"), d.async = "false", d.loadXML(c))
    } catch (f) {
      d = b
    }
    return (!d || !d.documentElement || d.getElementsByTagName("parsererror").length) && p.error("Invalid XML: " + c), d
  },noop: function() {
  },globalEval: function(b) {
    b && r.test(b) && (a.execScript || function(b) {
      a.eval.call(a, b)
    })(b)
  },camelCase: function(a) {
    return a.replace(A, "ms-").replace(B, C)
  },nodeName: function(a, b) {
    return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase()
  },each: function(a, c, d) {
    var e, f = 0, g = a.length, h = g === b || p.isFunction(a);
    if (d) {
      if (h) {
        for (e in a) {
          if (c.apply(a[e], d) === !1) {
            break
          }
        }
      } else {
        for (; f < g; ) {
          if (c.apply(a[f++], d) === !1) {
            break
          }
        }
      }
    } else {
      if (h) {
        for (e in a) {
          if (c.call(a[e], e, a[e]) === !1) {
            break
          }
        }
      } else {
        for (; f < g; ) {
          if (c.call(a[f], f, a[f++]) === !1) {
            break
          }
        }
      }
    }
    return a
  },trim: o && !o.call(" ") ? function(a) {
    return a == null ? "" : o.call(a)
  } : function(a) {
    return a == null ? "" : (a + "").replace(t, "")
  },makeArray: function(a, b) {
    var c, d = b || [];
    return a != null && (c = p.type(a), a.length == null || c === "string" || c === "function" || c === "regexp" || p.isWindow(a) ? j.call(d, a) : p.merge(d, a)), d
  },inArray: function(a, b, c) {
    var d;
    if (b) {
      if (l) {
        return l.call(b, a, c)
      }
      d = b.length, c = c ? c < 0 ? Math.max(0, d + c) : c : 0;
      for (; c < d; c++) {
        if (c in b && b[c] === a) {
          return c
        }
      }
    }
    return -1
  },merge: function(a, c) {
    var d = c.length, e = a.length, f = 0;
    if (typeof d == "number") {
      for (; f < d; f++) {
        a[e++] = c[f]
      }
    } else {
      while (c[f] !== b) {
        a[e++] = c[f++]
      }
    }
    return a.length = e, a
  },grep: function(a, b, c) {
    var d, e = [], f = 0, g = a.length;
    c = !!c;
    for (; f < g; f++) {
      d = !!b(a[f], f), c !== d && e.push(a[f])
    }
    return e
  },map: function(a, c, d) {
    var e, f, g = [], h = 0, i = a.length, j = a instanceof p || i !== b && typeof i == "number" && (i > 0 && a[0] && a[i - 1] || i === 0 || p.isArray(a));
    if (j) {
      for (; h < i; h++) {
        e = c(a[h], h, d), e != null && (g[g.length] = e)
      }
    } else {
      for (f in a) {
        e = c(a[f], f, d), e != null && (g[g.length] = e)
      }
    }
    return g.concat.apply([], g)
  },guid: 1,proxy: function(a, c) {
    var d, e, f;
    return typeof c == "string" && (d = a[c], c = a, a = d), p.isFunction(a) ? (e = k.call(arguments, 2), f = function() {
      return a.apply(c, e.concat(k.call(arguments)))
    }, f.guid = a.guid = a.guid || p.guid++, f) : b
  },access: function(a, c, d, e, f, g, h) {
    var i, j = d == null, k = 0, l = a.length;
    if (d && typeof d == "object") {
      for (k in d) {
        p.access(a, c, k, d[k], 1, g, e)
      }
      f = 1
    } else {
      if (e !== b) {
        i = h === b && p.isFunction(e), j && (i ? (i = c, c = function(a, b, c) {
          return i.call(p(a), c)
        }) : (c.call(a, e), c = null));
        if (c) {
          for (; k < l; k++) {
            c(a[k], d, i ? e.call(a[k], k, c(a[k], d)) : e, h)
          }
        }
        f = 1
      }
    }
    return f ? a : j ? c.call(a) : l ? c(a[0], d) : g
  },now: function() {
    return (new Date).getTime()
  }}), p.ready.promise = function(b) {
    if (!d) {
      d = p.Deferred();
      if (e.readyState === "complete") {
        setTimeout(p.ready, 1)
      } else {
        if (e.addEventListener) {
          e.addEventListener("DOMContentLoaded", D, !1), a.addEventListener("load", p.ready, !1)
        } else {
          e.attachEvent("onreadystatechange", D), a.attachEvent("onload", p.ready);
          var c = !1;
          try {
            c = a.frameElement == null && e.documentElement
          } catch (f) {
          }
          c && c.doScroll && function g() {
            if (!p.isReady) {
              try {
                c.doScroll("left")
              } catch (a) {
                return setTimeout(g, 50)
              }
              p.ready()
            }
          }()
        }
      }
    }
    return d.promise(b)
  }, p.each("Boolean Number String Function Array Date RegExp Object".split(" "), function(a, b) {
    E["[object " + b + "]"] = b.toLowerCase()
  }), c = p(e);
  var F = {};
  p.Callbacks = function(a) {
    a = typeof a == "string" ? F[a] || G(a) : p.extend({}, a);
    var c, d, e, f, g, h, i = [], j = !a.once && [], k = function(b) {
      c = a.memory && b, d = !0, h = f || 0, f = 0, g = i.length, e = !0;
      for (; i && h < g; h++) {
        if (i[h].apply(b[0], b[1]) === !1 && a.stopOnFalse) {
          c = !1;
          break
        }
      }
      e = !1, i && (j ? j.length && k(j.shift()) : c ? i = [] : l.disable())
    }, l = {add: function() {
      if (i) {
        var b = i.length;
        (function d(b) {
          p.each(b, function(b, c) {
            var e = p.type(c);
            e === "function" && (!a.unique || !l.has(c)) ? i.push(c) : c && c.length && e !== "string" && d(c)
          })
        })(arguments), e ? g = i.length : c && (f = b, k(c))
      }
      return this
    },remove: function() {
      return i && p.each(arguments, function(a, b) {
        var c;
        while ((c = p.inArray(b, i, c)) > -1) {
          i.splice(c, 1), e && (c <= g && g--, c <= h && h--)
        }
      }), this
    },has: function(a) {
      return p.inArray(a, i) > -1
    },empty: function() {
      return i = [], this
    },disable: function() {
      return i = j = c = b, this
    },disabled: function() {
      return !i
    },lock: function() {
      return j = b, c || l.disable(), this
    },locked: function() {
      return !j
    },fireWith: function(a, b) {
      return b = b || [], b = [a, b.slice ? b.slice() : b], i && (!d || j) && (e ? j.push(b) : k(b)), this
    },fire: function() {
      return l.fireWith(this, arguments), this
    },fired: function() {
      return !!d
    }};
    return l
  }, p.extend({Deferred: function(a) {
    var b = [["resolve", "done", p.Callbacks("once memory"), "resolved"], ["reject", "fail", p.Callbacks("once memory"), "rejected"], ["notify", "progress", p.Callbacks("memory")]], c = "pending", d = {state: function() {
      return c
    },always: function() {
      return e.done(arguments).fail(arguments), this
    },then: function() {
      var a = arguments;
      return p.Deferred(function(c) {
        p.each(b, function(b, d) {
          var f = d[0], g = a[b];
          e[d[1]](p.isFunction(g) ? function() {
            var a = g.apply(this, arguments);
            a && p.isFunction(a.promise) ? a.promise().done(c.resolve).fail(c.reject).progress(c.notify) : c[f + "With"](this === e ? c : this, [a])
          } : c[f])
        }), a = null
      }).promise()
    },promise: function(a) {
      return a != null ? p.extend(a, d) : d
    }}, e = {};
    return d.pipe = d.then, p.each(b, function(a, f) {
      var g = f[2], h = f[3];
      d[f[1]] = g.add, h && g.add(function() {
        c = h
      }, b[a ^ 1][2].disable, b[2][2].lock), e[f[0]] = g.fire, e[f[0] + "With"] = g.fireWith
    }), d.promise(e), a && a.call(e, e), e
  },when: function(a) {
    var b = 0, c = k.call(arguments), d = c.length, e = d !== 1 || a && p.isFunction(a.promise) ? d : 0, f = e === 1 ? a : p.Deferred(), g = function(a, b, c) {
      return function(d) {
        b[a] = this, c[a] = arguments.length > 1 ? k.call(arguments) : d, c === h ? f.notifyWith(b, c) : --e || f.resolveWith(b, c)
      }
    }, h, i, j;
    if (d > 1) {
      h = new Array(d), i = new Array(d), j = new Array(d);
      for (; b < d; b++) {
        c[b] && p.isFunction(c[b].promise) ? c[b].promise().done(g(b, j, c)).fail(f.reject).progress(g(b, i, h)) : --e
      }
    }
    return e || f.resolveWith(j, c), f.promise()
  }}), p.support = function() {
    var b, c, d, f, g, h, i, j, k, l, m, n = e.createElement("div");
    n.setAttribute("className", "t"), n.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", c = n.getElementsByTagName("*"), d = n.getElementsByTagName("a")[0], d.style.cssText = "top:1px;float:left;opacity:.5";
    if (!c || !c.length) {
      return {}
    }
    f = e.createElement("select"), g = f.appendChild(e.createElement("option")), h = n.getElementsByTagName("input")[0], b = {leadingWhitespace: n.firstChild.nodeType === 3,tbody: !n.getElementsByTagName("tbody").length,htmlSerialize: !!n.getElementsByTagName("link").length,style: /top/.test(d.getAttribute("style")),hrefNormalized: d.getAttribute("href") === "/a",opacity: /^0.5/.test(d.style.opacity),cssFloat: !!d.style.cssFloat,checkOn: h.value === "on",optSelected: g.selected,getSetAttribute: n.className !== "t",enctype: !!e.createElement("form").enctype,html5Clone: e.createElement("nav").cloneNode(!0).outerHTML !== "<:nav></:nav>",boxModel: e.compatMode === "CSS1Compat",submitBubbles: !0,changeBubbles: !0,focusinBubbles: !1,deleteExpando: !0,noCloneEvent: !0,inlineBlockNeedsLayout: !1,shrinkWrapBlocks: !1,reliableMarginRight: !0,boxSizingReliable: !0,pixelPosition: !1}, h.checked = !0, b.noCloneChecked = h.cloneNode(!0).checked, f.disabled = !0, b.optDisabled = !g.disabled;
    try {
      delete n.test
    } catch (o) {
      b.deleteExpando = !1
    }
    !n.addEventListener && n.attachEvent && n.fireEvent && (n.attachEvent("onclick", m = function() {
      b.noCloneEvent = !1
    }), n.cloneNode(!0).fireEvent("onclick"), n.detachEvent("onclick", m)), h = e.createElement("input"), h.value = "t", h.setAttribute("type", "radio"), b.radioValue = h.value === "t", h.setAttribute("checked", "checked"), h.setAttribute("name", "t"), n.appendChild(h), i = e.createDocumentFragment(), i.appendChild(n.lastChild), b.checkClone = i.cloneNode(!0).cloneNode(!0).lastChild.checked, b.appendChecked = h.checked, i.removeChild(h), i.appendChild(n);
    if (n.attachEvent) {
      for (k in {submit: !0,change: !0,focusin: !0}) {
        j = "on" + k, l = j in n, l || (n.setAttribute(j, "return;"), l = typeof n[j] == "function"), b[k + "Bubbles"] = l
      }
    }
    return p(function() {
      var c, d, f, g, h = "padding:0;margin:0;border:0;display:block;overflow:hidden;", i = e.getElementsByTagName("body")[0];
      if (!i) {
        return
      }
      c = e.createElement("div"), c.style.cssText = "visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px", i.insertBefore(c, i.firstChild), d = e.createElement("div"), c.appendChild(d), d.innerHTML = "<table><tr><td></td><td>t</td></tr></table>", f = d.getElementsByTagName("td"), f[0].style.cssText = "padding:0;margin:0;border:0;display:none", l = f[0].offsetHeight === 0, f[0].style.display = "", f[1].style.display = "none", b.reliableHiddenOffsets = l && f[0].offsetHeight === 0, d.innerHTML = "", d.style.cssText = "box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;", b.boxSizing = d.offsetWidth === 4, b.doesNotIncludeMarginInBodyOffset = i.offsetTop !== 1, a.getComputedStyle && (b.pixelPosition = (a.getComputedStyle(d, null) || {}).top !== "1%", b.boxSizingReliable = (a.getComputedStyle(d, null) || {width: "4px"}).width === "4px", g = e.createElement("div"), g.style.cssText = d.style.cssText = h, g.style.marginRight = g.style.width = "0", d.style.width = "1px", d.appendChild(g), b.reliableMarginRight = !parseFloat((a.getComputedStyle(g, null) || {}).marginRight)), typeof d.style.zoom != "undefined" && (d.innerHTML = "", d.style.cssText = h + "width:1px;padding:1px;display:inline;zoom:1", b.inlineBlockNeedsLayout = d.offsetWidth === 3, d.style.display = "block", d.style.overflow = "visible", d.innerHTML = "<div></div>", d.firstChild.style.width = "5px", b.shrinkWrapBlocks = d.offsetWidth !== 3, c.style.zoom = 1), i.removeChild(c), c = d = f = g = null
    }), i.removeChild(n), c = d = f = g = h = i = n = null, b
  }();
  var H = /(?:\{[\s\S]*\}|\[[\s\S]*\])$/, I = /([A-Z])/g;
  p.extend({cache: {},deletedIds: [],uuid: 0,expando: "jQuery" + (p.fn.jquery + Math.random()).replace(/\D/g, ""),noData: {embed: !0,object: "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet: !0},hasData: function(a) {
    return a = a.nodeType ? p.cache[a[p.expando]] : a[p.expando], !!a && !K(a)
  },data: function(a, c, d, e) {
    if (!p.acceptData(a)) {
      return
    }
    var f, g, h = p.expando, i = typeof c == "string", j = a.nodeType, k = j ? p.cache : a, l = j ? a[h] : a[h] && h;
    if ((!l || !k[l] || !e && !k[l].data) && i && d === b) {
      return
    }
    l || (j ? a[h] = l = p.deletedIds.pop() || p.guid++ : l = h), k[l] || (k[l] = {}, j || (k[l].toJSON = p.noop));
    if (typeof c == "object" || typeof c == "function") {
      e ? k[l] = p.extend(k[l], c) : k[l].data = p.extend(k[l].data, c)
    }
    return f = k[l], e || (f.data || (f.data = {}), f = f.data), d !== b && (f[p.camelCase(c)] = d), i ? (g = f[c], g == null && (g = f[p.camelCase(c)])) : g = f, g
  },removeData: function(a, b, c) {
    if (!p.acceptData(a)) {
      return
    }
    var d, e, f, g = a.nodeType, h = g ? p.cache : a, i = g ? a[p.expando] : p.expando;
    if (!h[i]) {
      return
    }
    if (b) {
      d = c ? h[i] : h[i].data;
      if (d) {
        p.isArray(b) || (b in d ? b = [b] : (b = p.camelCase(b), b in d ? b = [b] : b = b.split(" ")));
        for (e = 0, f = b.length; e < f; e++) {
          delete d[b[e]]
        }
        if (!(c ? K : p.isEmptyObject)(d)) {
          return
        }
      }
    }
    if (!c) {
      delete h[i].data;
      if (!K(h[i])) {
        return
      }
    }
    g ? p.cleanData([a], !0) : p.support.deleteExpando || h != h.window ? delete h[i] : h[i] = null
  },_data: function(a, b, c) {
    return p.data(a, b, c, !0)
  },acceptData: function(a) {
    var b = a.nodeName && p.noData[a.nodeName.toLowerCase()];
    return !b || b !== !0 && a.getAttribute("classid") === b
  }}), p.fn.extend({data: function(a, c) {
    var d, e, f, g, h, i = this[0], j = 0, k = null;
    if (a === b) {
      if (this.length) {
        k = p.data(i);
        if (i.nodeType === 1 && !p._data(i, "parsedAttrs")) {
          f = i.attributes;
          for (h = f.length; j < h; j++) {
            g = f[j].name, g.indexOf("data-") || (g = p.camelCase(g.substring(5)), J(i, g, k[g]))
          }
          p._data(i, "parsedAttrs", !0)
        }
      }
      return k
    }
    return typeof a == "object" ? this.each(function() {
      p.data(this, a)
    }) : (d = a.split(".", 2), d[1] = d[1] ? "." + d[1] : "", e = d[1] + "!", p.access(this, function(c) {
      if (c === b) {
        return k = this.triggerHandler("getData" + e, [d[0]]), k === b && i && (k = p.data(i, a), k = J(i, a, k)), k === b && d[1] ? this.data(d[0]) : k
      }
      d[1] = c, this.each(function() {
        var b = p(this);
        b.triggerHandler("setData" + e, d), p.data(this, a, c), b.triggerHandler("changeData" + e, d)
      })
    }, null, c, arguments.length > 1, null, !1))
  },removeData: function(a) {
    return this.each(function() {
      p.removeData(this, a)
    })
  }}), p.extend({queue: function(a, b, c) {
    var d;
    if (a) {
      return b = (b || "fx") + "queue", d = p._data(a, b), c && (!d || p.isArray(c) ? d = p._data(a, b, p.makeArray(c)) : d.push(c)), d || []
    }
  },dequeue: function(a, b) {
    b = b || "fx";
    var c = p.queue(a, b), d = c.length, e = c.shift(), f = p._queueHooks(a, b), g = function() {
      p.dequeue(a, b)
    };
    e === "inprogress" && (e = c.shift(), d--), e && (b === "fx" && c.unshift("inprogress"), delete f.stop, e.call(a, g, f)), !d && f && f.empty.fire()
  },_queueHooks: function(a, b) {
    var c = b + "queueHooks";
    return p._data(a, c) || p._data(a, c, {empty: p.Callbacks("once memory").add(function() {
      p.removeData(a, b + "queue", !0), p.removeData(a, c, !0)
    })})
  }}), p.fn.extend({queue: function(a, c) {
    var d = 2;
    return typeof a != "string" && (c = a, a = "fx", d--), arguments.length < d ? p.queue(this[0], a) : c === b ? this : this.each(function() {
      var b = p.queue(this, a, c);
      p._queueHooks(this, a), a === "fx" && b[0] !== "inprogress" && p.dequeue(this, a)
    })
  },dequeue: function(a) {
    return this.each(function() {
      p.dequeue(this, a)
    })
  },delay: function(a, b) {
    return a = p.fx ? p.fx.speeds[a] || a : a, b = b || "fx", this.queue(b, function(b, c) {
      var d = setTimeout(b, a);
      c.stop = function() {
        clearTimeout(d)
      }
    })
  },clearQueue: function(a) {
    return this.queue(a || "fx", [])
  },promise: function(a, c) {
    var d, e = 1, f = p.Deferred(), g = this, h = this.length, i = function() {
      --e || f.resolveWith(g, [g])
    };
    typeof a != "string" && (c = a, a = b), a = a || "fx";
    while (h--) {
      d = p._data(g[h], a + "queueHooks"), d && d.empty && (e++, d.empty.add(i))
    }
    return i(), f.promise(c)
  }});
  var L, M, N, O = /[\t\r\n]/g, P = /\r/g, Q = /^(?:button|input)$/i, R = /^(?:button|input|object|select|textarea)$/i, S = /^a(?:rea|)$/i, T = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i, U = p.support.getSetAttribute;
  p.fn.extend({attr: function(a, b) {
    return p.access(this, p.attr, a, b, arguments.length > 1)
  },removeAttr: function(a) {
    return this.each(function() {
      p.removeAttr(this, a)
    })
  },prop: function(a, b) {
    return p.access(this, p.prop, a, b, arguments.length > 1)
  },removeProp: function(a) {
    return a = p.propFix[a] || a, this.each(function() {
      try {
        this[a] = b, delete this[a]
      } catch (c) {
      }
    })
  },addClass: function(a) {
    var b, c, d, e, f, g, h;
    if (p.isFunction(a)) {
      return this.each(function(b) {
        p(this).addClass(a.call(this, b, this.className))
      })
    }
    if (a && typeof a == "string") {
      b = a.split(s);
      for (c = 0, d = this.length; c < d; c++) {
        e = this[c];
        if (e.nodeType === 1) {
          if (!e.className && b.length === 1) {
            e.className = a
          } else {
            f = " " + e.className + " ";
            for (g = 0, h = b.length; g < h; g++) {
              f.indexOf(" " + b[g] + " ") < 0 && (f += b[g] + " ")
            }
            e.className = p.trim(f)
          }
        }
      }
    }
    return this
  },removeClass: function(a) {
    var c, d, e, f, g, h, i;
    if (p.isFunction(a)) {
      return this.each(function(b) {
        p(this).removeClass(a.call(this, b, this.className))
      })
    }
    if (a && typeof a == "string" || a === b) {
      c = (a || "").split(s);
      for (h = 0, i = this.length; h < i; h++) {
        e = this[h];
        if (e.nodeType === 1 && e.className) {
          d = (" " + e.className + " ").replace(O, " ");
          for (f = 0, g = c.length; f < g; f++) {
            while (d.indexOf(" " + c[f] + " ") >= 0) {
              d = d.replace(" " + c[f] + " ", " ")
            }
          }
          e.className = a ? p.trim(d) : ""
        }
      }
    }
    return this
  },toggleClass: function(a, b) {
    var c = typeof a, d = typeof b == "boolean";
    return p.isFunction(a) ? this.each(function(c) {
      p(this).toggleClass(a.call(this, c, this.className, b), b)
    }) : this.each(function() {
      if (c === "string") {
        var e, f = 0, g = p(this), h = b, i = a.split(s);
        while (e = i[f++]) {
          h = d ? h : !g.hasClass(e), g[h ? "addClass" : "removeClass"](e)
        }
      } else {
        if (c === "undefined" || c === "boolean") {
          this.className && p._data(this, "__className__", this.className), this.className = this.className || a === !1 ? "" : p._data(this, "__className__") || ""
        }
      }
    })
  },hasClass: function(a) {
    var b = " " + a + " ", c = 0, d = this.length;
    for (; c < d; c++) {
      if (this[c].nodeType === 1 && (" " + this[c].className + " ").replace(O, " ").indexOf(b) >= 0) {
        return !0
      }
    }
    return !1
  },val: function(a) {
    var c, d, e, f = this[0];
    if (!arguments.length) {
      if (f) {
        return c = p.valHooks[f.type] || p.valHooks[f.nodeName.toLowerCase()], c && "get" in c && (d = c.get(f, "value")) !== b ? d : (d = f.value, typeof d == "string" ? d.replace(P, "") : d == null ? "" : d)
      }
      return
    }
    return e = p.isFunction(a), this.each(function(d) {
      var f, g = p(this);
      if (this.nodeType !== 1) {
        return
      }
      e ? f = a.call(this, d, g.val()) : f = a, f == null ? f = "" : typeof f == "number" ? f += "" : p.isArray(f) && (f = p.map(f, function(a) {
        return a == null ? "" : a + ""
      })), c = p.valHooks[this.type] || p.valHooks[this.nodeName.toLowerCase()];
      if (!c || !("set" in c) || c.set(this, f, "value") === b) {
        this.value = f
      }
    })
  }}), p.extend({valHooks: {option: {get: function(a) {
    var b = a.attributes.value;
    return !b || b.specified ? a.value : a.text
  }},select: {get: function(a) {
    var b, c, d, e, f = a.selectedIndex, g = [], h = a.options, i = a.type === "select-one";
    if (f < 0) {
      return null
    }
    c = i ? f : 0, d = i ? f + 1 : h.length;
    for (; c < d; c++) {
      e = h[c];
      if (e.selected && (p.support.optDisabled ? !e.disabled : e.getAttribute("disabled") === null) && (!e.parentNode.disabled || !p.nodeName(e.parentNode, "optgroup"))) {
        b = p(e).val();
        if (i) {
          return b
        }
        g.push(b)
      }
    }
    return i && !g.length && h.length ? p(h[f]).val() : g
  },set: function(a, b) {
    var c = p.makeArray(b);
    return p(a).find("option").each(function() {
      this.selected = p.inArray(p(this).val(), c) >= 0
    }), c.length || (a.selectedIndex = -1), c
  }}},attrFn: {},attr: function(a, c, d, e) {
    var f, g, h, i = a.nodeType;
    if (!a || i === 3 || i === 8 || i === 2) {
      return
    }
    if (e && p.isFunction(p.fn[c])) {
      return p(a)[c](d)
    }
    if (typeof a.getAttribute == "undefined") {
      return p.prop(a, c, d)
    }
    h = i !== 1 || !p.isXMLDoc(a), h && (c = c.toLowerCase(), g = p.attrHooks[c] || (T.test(c) ? M : L));
    if (d !== b) {
      if (d === null) {
        p.removeAttr(a, c);
        return
      }
      return g && "set" in g && h && (f = g.set(a, d, c)) !== b ? f : (a.setAttribute(c, d + ""), d)
    }
    return g && "get" in g && h && (f = g.get(a, c)) !== null ? f : (f = a.getAttribute(c), f === null ? b : f)
  },removeAttr: function(a, b) {
    var c, d, e, f, g = 0;
    if (b && a.nodeType === 1) {
      d = b.split(s);
      for (; g < d.length; g++) {
        e = d[g], e && (c = p.propFix[e] || e, f = T.test(e), f || p.attr(a, e, ""), a.removeAttribute(U ? e : c), f && c in a && (a[c] = !1))
      }
    }
  },attrHooks: {type: {set: function(a, b) {
    if (Q.test(a.nodeName) && a.parentNode) {
      p.error("type property can't be changed")
    } else {
      if (!p.support.radioValue && b === "radio" && p.nodeName(a, "input")) {
        var c = a.value;
        return a.setAttribute("type", b), c && (a.value = c), b
      }
    }
  }},value: {get: function(a, b) {
    return L && p.nodeName(a, "button") ? L.get(a, b) : b in a ? a.value : null
  },set: function(a, b, c) {
    if (L && p.nodeName(a, "button")) {
      return L.set(a, b, c)
    }
    a.value = b
  }}},propFix: {tabindex: "tabIndex",readonly: "readOnly","for": "htmlFor","class": "className",maxlength: "maxLength",cellspacing: "cellSpacing",cellpadding: "cellPadding",rowspan: "rowSpan",colspan: "colSpan",usemap: "useMap",frameborder: "frameBorder",contenteditable: "contentEditable"},prop: function(a, c, d) {
    var e, f, g, h = a.nodeType;
    if (!a || h === 3 || h === 8 || h === 2) {
      return
    }
    return g = h !== 1 || !p.isXMLDoc(a), g && (c = p.propFix[c] || c, f = p.propHooks[c]), d !== b ? f && "set" in f && (e = f.set(a, d, c)) !== b ? e : a[c] = d : f && "get" in f && (e = f.get(a, c)) !== null ? e : a[c]
  },propHooks: {tabIndex: {get: function(a) {
    var c = a.getAttributeNode("tabindex");
    return c && c.specified ? parseInt(c.value, 10) : R.test(a.nodeName) || S.test(a.nodeName) && a.href ? 0 : b
  }}}}), M = {get: function(a, c) {
    var d, e = p.prop(a, c);
    return e === !0 || typeof e != "boolean" && (d = a.getAttributeNode(c)) && d.nodeValue !== !1 ? c.toLowerCase() : b
  },set: function(a, b, c) {
    var d;
    return b === !1 ? p.removeAttr(a, c) : (d = p.propFix[c] || c, d in a && (a[d] = !0), a.setAttribute(c, c.toLowerCase())), c
  }}, U || (N = {name: !0,id: !0,coords: !0}, L = p.valHooks.button = {get: function(a, c) {
    var d;
    return d = a.getAttributeNode(c), d && (N[c] ? d.value !== "" : d.specified) ? d.value : b
  },set: function(a, b, c) {
    var d = a.getAttributeNode(c);
    return d || (d = e.createAttribute(c), a.setAttributeNode(d)), d.value = b + ""
  }}, p.each(["width", "height"], function(a, b) {
    p.attrHooks[b] = p.extend(p.attrHooks[b], {set: function(a, c) {
      if (c === "") {
        return a.setAttribute(b, "auto"), c
      }
    }})
  }), p.attrHooks.contenteditable = {get: L.get,set: function(a, b, c) {
    b === "" && (b = "false"), L.set(a, b, c)
  }}), p.support.hrefNormalized || p.each(["href", "src", "width", "height"], function(a, c) {
    p.attrHooks[c] = p.extend(p.attrHooks[c], {get: function(a) {
      var d = a.getAttribute(c, 2);
      return d === null ? b : d
    }})
  }), p.support.style || (p.attrHooks.style = {get: function(a) {
    return a.style.cssText.toLowerCase() || b
  },set: function(a, b) {
    return a.style.cssText = b + ""
  }}), p.support.optSelected || (p.propHooks.selected = p.extend(p.propHooks.selected, {get: function(a) {
    var b = a.parentNode;
    return b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex), null
  }})), p.support.enctype || (p.propFix.enctype = "encoding"), p.support.checkOn || p.each(["radio", "checkbox"], function() {
    p.valHooks[this] = {get: function(a) {
      return a.getAttribute("value") === null ? "on" : a.value
    }}
  }), p.each(["radio", "checkbox"], function() {
    p.valHooks[this] = p.extend(p.valHooks[this], {set: function(a, b) {
      if (p.isArray(b)) {
        return a.checked = p.inArray(p(a).val(), b) >= 0
      }
    }})
  });
  var V = /^(?:textarea|input|select)$/i, W = /^([^\.]*|)(?:\.(.+)|)$/, X = /(?:^|\s)hover(\.\S+|)\b/, Y = /^key/, Z = /^(?:mouse|contextmenu)|click/, $ = /^(?:focusinfocus|focusoutblur)$/, _ = function(a) {
    return p.event.special.hover ? a : a.replace(X, "mouseenter$1 mouseleave$1")
  };
  p.event = {add: function(a, c, d, e, f) {
    var g, h, i, j, k, l, m, n, o, q, r;
    if (a.nodeType === 3 || a.nodeType === 8 || !c || !d || !(g = p._data(a))) {
      return
    }
    d.handler && (o = d, d = o.handler, f = o.selector), d.guid || (d.guid = p.guid++), i = g.events, i || (g.events = i = {}), h = g.handle, h || (g.handle = h = function(a) {
      return typeof p != "undefined" && (!a || p.event.triggered !== a.type) ? p.event.dispatch.apply(h.elem, arguments) : b
    }, h.elem = a), c = p.trim(_(c)).split(" ");
    for (j = 0; j < c.length; j++) {
      k = W.exec(c[j]) || [], l = k[1], m = (k[2] || "").split(".").sort(), r = p.event.special[l] || {}, l = (f ? r.delegateType : r.bindType) || l, r = p.event.special[l] || {}, n = p.extend({type: l,origType: k[1],data: e,handler: d,guid: d.guid,selector: f,needsContext: f && p.expr.match.needsContext.test(f),namespace: m.join(".")}, o), q = i[l];
      if (!q) {
        q = i[l] = [], q.delegateCount = 0;
        if (!r.setup || r.setup.call(a, e, m, h) === !1) {
          a.addEventListener ? a.addEventListener(l, h, !1) : a.attachEvent && a.attachEvent("on" + l, h)
        }
      }
      r.add && (r.add.call(a, n), n.handler.guid || (n.handler.guid = d.guid)), f ? q.splice(q.delegateCount++, 0, n) : q.push(n), p.event.global[l] = !0
    }
    a = null
  },global: {},remove: function(a, b, c, d, e) {
    var f, g, h, i, j, k, l, m, n, o, q, r = p.hasData(a) && p._data(a);
    if (!r || !(m = r.events)) {
      return
    }
    b = p.trim(_(b || "")).split(" ");
    for (f = 0; f < b.length; f++) {
      g = W.exec(b[f]) || [], h = i = g[1], j = g[2];
      if (!h) {
        for (h in m) {
          p.event.remove(a, h + b[f], c, d, !0)
        }
        continue
      }
      n = p.event.special[h] || {}, h = (d ? n.delegateType : n.bindType) || h, o = m[h] || [], k = o.length, j = j ? new RegExp("(^|\\.)" + j.split(".").sort().join("\\.(?:.*\\.|)") + "(\\.|$)") : null;
      for (l = 0; l < o.length; l++) {
        q = o[l], (e || i === q.origType) && (!c || c.guid === q.guid) && (!j || j.test(q.namespace)) && (!d || d === q.selector || d === "**" && q.selector) && (o.splice(l--, 1), q.selector && o.delegateCount--, n.remove && n.remove.call(a, q))
      }
      o.length === 0 && k !== o.length && ((!n.teardown || n.teardown.call(a, j, r.handle) === !1) && p.removeEvent(a, h, r.handle), delete m[h])
    }
    p.isEmptyObject(m) && (delete r.handle, p.removeData(a, "events", !0))
  },customEvent: {getData: !0,setData: !0,changeData: !0},trigger: function(c, d, f, g) {
    if (!f || f.nodeType !== 3 && f.nodeType !== 8) {
      var h, i, j, k, l, m, n, o, q, r, s = c.type || c, t = [];
      if ($.test(s + p.event.triggered)) {
        return
      }
      s.indexOf("!") >= 0 && (s = s.slice(0, -1), i = !0), s.indexOf(".") >= 0 && (t = s.split("."), s = t.shift(), t.sort());
      if ((!f || p.event.customEvent[s]) && !p.event.global[s]) {
        return
      }
      c = typeof c == "object" ? c[p.expando] ? c : new p.Event(s, c) : new p.Event(s), c.type = s, c.isTrigger = !0, c.exclusive = i, c.namespace = t.join("."), c.namespace_re = c.namespace ? new RegExp("(^|\\.)" + t.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, m = s.indexOf(":") < 0 ? "on" + s : "";
      if (!f) {
        h = p.cache;
        for (j in h) {
          h[j].events && h[j].events[s] && p.event.trigger(c, d, h[j].handle.elem, !0)
        }
        return
      }
      c.result = b, c.target || (c.target = f), d = d != null ? p.makeArray(d) : [], d.unshift(c), n = p.event.special[s] || {};
      if (n.trigger && n.trigger.apply(f, d) === !1) {
        return
      }
      q = [[f, n.bindType || s]];
      if (!g && !n.noBubble && !p.isWindow(f)) {
        r = n.delegateType || s, k = $.test(r + s) ? f : f.parentNode;
        for (l = f; k; k = k.parentNode) {
          q.push([k, r]), l = k
        }
        l === (f.ownerDocument || e) && q.push([l.defaultView || l.parentWindow || a, r])
      }
      for (j = 0; j < q.length && !c.isPropagationStopped(); j++) {
        k = q[j][0], c.type = q[j][1], o = (p._data(k, "events") || {})[c.type] && p._data(k, "handle"), o && o.apply(k, d), o = m && k[m], o && p.acceptData(k) && o.apply && o.apply(k, d) === !1 && c.preventDefault()
      }
      return c.type = s, !g && !c.isDefaultPrevented() && (!n._default || n._default.apply(f.ownerDocument, d) === !1) && (s !== "click" || !p.nodeName(f, "a")) && p.acceptData(f) && m && f[s] && (s !== "focus" && s !== "blur" || c.target.offsetWidth !== 0) && !p.isWindow(f) && (l = f[m], l && (f[m] = null), p.event.triggered = s, f[s](), p.event.triggered = b, l && (f[m] = l)), c.result
    }
    return
  },dispatch: function(c) {
    c = p.event.fix(c || a.event);
    var d, e, f, g, h, i, j, l, m, n, o = (p._data(this, "events") || {})[c.type] || [], q = o.delegateCount, r = k.call(arguments), s = !c.exclusive && !c.namespace, t = p.event.special[c.type] || {}, u = [];
    r[0] = c, c.delegateTarget = this;
    if (t.preDispatch && t.preDispatch.call(this, c) === !1) {
      return
    }
    if (q && (!c.button || c.type !== "click")) {
      for (f = c.target; f != this; f = f.parentNode || this) {
        if (f.disabled !== !0 || c.type !== "click") {
          h = {}, j = [];
          for (d = 0; d < q; d++) {
            l = o[d], m = l.selector, h[m] === b && (h[m] = l.needsContext ? p(m, this).index(f) >= 0 : p.find(m, this, null, [f]).length), h[m] && j.push(l)
          }
          j.length && u.push({elem: f,matches: j})
        }
      }
    }
    o.length > q && u.push({elem: this,matches: o.slice(q)});
    for (d = 0; d < u.length && !c.isPropagationStopped(); d++) {
      i = u[d], c.currentTarget = i.elem;
      for (e = 0; e < i.matches.length && !c.isImmediatePropagationStopped(); e++) {
        l = i.matches[e];
        if (s || !c.namespace && !l.namespace || c.namespace_re && c.namespace_re.test(l.namespace)) {
          c.data = l.data, c.handleObj = l, g = ((p.event.special[l.origType] || {}).handle || l.handler).apply(i.elem, r), g !== b && (c.result = g, g === !1 && (c.preventDefault(), c.stopPropagation()))
        }
      }
    }
    return t.postDispatch && t.postDispatch.call(this, c), c.result
  },props: "attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks: {},keyHooks: {props: "char charCode key keyCode".split(" "),filter: function(a, b) {
    return a.which == null && (a.which = b.charCode != null ? b.charCode : b.keyCode), a
  }},mouseHooks: {props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter: function(a, c) {
    var d, f, g, h = c.button, i = c.fromElement;
    return a.pageX == null && c.clientX != null && (d = a.target.ownerDocument || e, f = d.documentElement, g = d.body, a.pageX = c.clientX + (f && f.scrollLeft || g && g.scrollLeft || 0) - (f && f.clientLeft || g && g.clientLeft || 0), a.pageY = c.clientY + (f && f.scrollTop || g && g.scrollTop || 0) - (f && f.clientTop || g && g.clientTop || 0)), !a.relatedTarget && i && (a.relatedTarget = i === a.target ? c.toElement : i), !a.which && h !== b && (a.which = h & 1 ? 1 : h & 2 ? 3 : h & 4 ? 2 : 0), a
  }},fix: function(a) {
    if (a[p.expando]) {
      return a
    }
    var b, c, d = a, f = p.event.fixHooks[a.type] || {}, g = f.props ? this.props.concat(f.props) : this.props;
    a = p.Event(d);
    for (b = g.length; b; ) {
      c = g[--b], a[c] = d[c]
    }
    return a.target || (a.target = d.srcElement || e), a.target.nodeType === 3 && (a.target = a.target.parentNode), a.metaKey = !!a.metaKey, f.filter ? f.filter(a, d) : a
  },special: {load: {noBubble: !0},focus: {delegateType: "focusin"},blur: {delegateType: "focusout"},beforeunload: {setup: function(a, b, c) {
    p.isWindow(this) && (this.onbeforeunload = c)
  },teardown: function(a, b) {
    this.onbeforeunload === b && (this.onbeforeunload = null)
  }}},simulate: function(a, b, c, d) {
    var e = p.extend(new p.Event, c, {type: a,isSimulated: !0,originalEvent: {}});
    d ? p.event.trigger(e, null, b) : p.event.dispatch.call(b, e), e.isDefaultPrevented() && c.preventDefault()
  }}, p.event.handle = p.event.dispatch, p.removeEvent = e.removeEventListener ? function(a, b, c) {
    a.removeEventListener && a.removeEventListener(b, c, !1)
  } : function(a, b, c) {
    var d = "on" + b;
    a.detachEvent && (typeof a[d] == "undefined" && (a[d] = null), a.detachEvent(d, c))
  }, p.Event = function(a, b) {
    if (this instanceof p.Event) {
      a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || a.returnValue === !1 || a.getPreventDefault && a.getPreventDefault() ? bb : ba) : this.type = a, b && p.extend(this, b), this.timeStamp = a && a.timeStamp || p.now(), this[p.expando] = !0
    } else {
      return new p.Event(a, b)
    }
  }, p.Event.prototype = {preventDefault: function() {
    this.isDefaultPrevented = bb;
    var a = this.originalEvent;
    if (!a) {
      return
    }
    a.preventDefault ? a.preventDefault() : a.returnValue = !1
  },stopPropagation: function() {
    this.isPropagationStopped = bb;
    var a = this.originalEvent;
    if (!a) {
      return
    }
    a.stopPropagation && a.stopPropagation(), a.cancelBubble = !0
  },stopImmediatePropagation: function() {
    this.isImmediatePropagationStopped = bb, this.stopPropagation()
  },isDefaultPrevented: ba,isPropagationStopped: ba,isImmediatePropagationStopped: ba}, p.each({mouseenter: "mouseover",mouseleave: "mouseout"}, function(a, b) {
    p.event.special[a] = {delegateType: b,bindType: b,handle: function(a) {
      var c, d = this, e = a.relatedTarget, f = a.handleObj, g = f.selector;
      if (!e || e !== d && !p.contains(d, e)) {
        a.type = f.origType, c = f.handler.apply(this, arguments), a.type = b
      }
      return c
    }}
  }), p.support.submitBubbles || (p.event.special.submit = {setup: function() {
    if (p.nodeName(this, "form")) {
      return !1
    }
    p.event.add(this, "click._submit keypress._submit", function(a) {
      var c = a.target, d = p.nodeName(c, "input") || p.nodeName(c, "button") ? c.form : b;
      d && !p._data(d, "_submit_attached") && (p.event.add(d, "submit._submit", function(a) {
        a._submit_bubble = !0
      }), p._data(d, "_submit_attached", !0))
    })
  },postDispatch: function(a) {
    a._submit_bubble && (delete a._submit_bubble, this.parentNode && !a.isTrigger && p.event.simulate("submit", this.parentNode, a, !0))
  },teardown: function() {
    if (p.nodeName(this, "form")) {
      return !1
    }
    p.event.remove(this, "._submit")
  }}), p.support.changeBubbles || (p.event.special.change = {setup: function() {
    if (V.test(this.nodeName)) {
      if (this.type === "checkbox" || this.type === "radio") {
        p.event.add(this, "propertychange._change", function(a) {
          a.originalEvent.propertyName === "checked" && (this._just_changed = !0)
        }), p.event.add(this, "click._change", function(a) {
          this._just_changed && !a.isTrigger && (this._just_changed = !1), p.event.simulate("change", this, a, !0)
        })
      }
      return !1
    }
    p.event.add(this, "beforeactivate._change", function(a) {
      var b = a.target;
      V.test(b.nodeName) && !p._data(b, "_change_attached") && (p.event.add(b, "change._change", function(a) {
        this.parentNode && !a.isSimulated && !a.isTrigger && p.event.simulate("change", this.parentNode, a, !0)
      }), p._data(b, "_change_attached", !0))
    })
  },handle: function(a) {
    var b = a.target;
    if (this !== b || a.isSimulated || a.isTrigger || b.type !== "radio" && b.type !== "checkbox") {
      return a.handleObj.handler.apply(this, arguments)
    }
  },teardown: function() {
    return p.event.remove(this, "._change"), !V.test(this.nodeName)
  }}), p.support.focusinBubbles || p.each({focus: "focusin",blur: "focusout"}, function(a, b) {
    var c = 0, d = function(a) {
      p.event.simulate(b, a.target, p.event.fix(a), !0)
    };
    p.event.special[b] = {setup: function() {
      c++ === 0 && e.addEventListener(a, d, !0)
    },teardown: function() {
      --c === 0 && e.removeEventListener(a, d, !0)
    }}
  }), p.fn.extend({on: function(a, c, d, e, f) {
    var g, h;
    if (typeof a == "object") {
      typeof c != "string" && (d = d || c, c = b);
      for (h in a) {
        this.on(h, c, d, a[h], f)
      }
      return this
    }
    d == null && e == null ? (e = c, d = c = b) : e == null && (typeof c == "string" ? (e = d, d = b) : (e = d, d = c, c = b));
    if (e === !1) {
      e = ba
    } else {
      if (!e) {
        return this
      }
    }
    return f === 1 && (g = e, e = function(a) {
      return p().off(a), g.apply(this, arguments)
    }, e.guid = g.guid || (g.guid = p.guid++)), this.each(function() {
      p.event.add(this, a, e, d, c)
    })
  },one: function(a, b, c, d) {
    return this.on(a, b, c, d, 1)
  },off: function(a, c, d) {
    var e, f;
    if (a && a.preventDefault && a.handleObj) {
      return e = a.handleObj, p(a.delegateTarget).off(e.namespace ? e.origType + "." + e.namespace : e.origType, e.selector, e.handler), this
    }
    if (typeof a == "object") {
      for (f in a) {
        this.off(f, c, a[f])
      }
      return this
    }
    if (c === !1 || typeof c == "function") {
      d = c, c = b
    }
    return d === !1 && (d = ba), this.each(function() {
      p.event.remove(this, a, d, c)
    })
  },bind: function(a, b, c) {
    return this.on(a, null, b, c)
  },unbind: function(a, b) {
    return this.off(a, null, b)
  },live: function(a, b, c) {
    return p(this.context).on(a, this.selector, b, c), this
  },die: function(a, b) {
    return p(this.context).off(a, this.selector || "**", b), this
  },delegate: function(a, b, c, d) {
    return this.on(b, a, c, d)
  },undelegate: function(a, b, c) {
    return arguments.length === 1 ? this.off(a, "**") : this.off(b, a || "**", c)
  },trigger: function(a, b) {
    return this.each(function() {
      p.event.trigger(a, b, this)
    })
  },triggerHandler: function(a, b) {
    if (this[0]) {
      return p.event.trigger(a, b, this[0], !0)
    }
  },toggle: function(a) {
    var b = arguments, c = a.guid || p.guid++, d = 0, e = function(c) {
      var e = (p._data(this, "lastToggle" + a.guid) || 0) % d;
      return p._data(this, "lastToggle" + a.guid, e + 1), c.preventDefault(), b[e].apply(this, arguments) || !1
    };
    e.guid = c;
    while (d < b.length) {
      b[d++].guid = c
    }
    return this.click(e)
  },hover: function(a, b) {
    return this.mouseenter(a).mouseleave(b || a)
  }}), p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(a, b) {
    p.fn[b] = function(a, c) {
      return c == null && (c = a, a = null), arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b)
    }, Y.test(b) && (p.event.fixHooks[b] = p.event.keyHooks), Z.test(b) && (p.event.fixHooks[b] = p.event.mouseHooks)
  }), function(a, b) {
    function bc(a, b, c, d) {
      c = c || [], b = b || r;
      var e, f, i, j, k = b.nodeType;
      if (!a || typeof a != "string") {
        return c
      }
      if (k !== 1 && k !== 9) {
        return []
      }
      i = g(b);
      if (!i && !d) {
        if (e = P.exec(a)) {
          if (j = e[1]) {
            if (k === 9) {
              f = b.getElementById(j);
              if (!f || !f.parentNode) {
                return c
              }
              if (f.id === j) {
                return c.push(f), c
              }
            } else {
              if (b.ownerDocument && (f = b.ownerDocument.getElementById(j)) && h(b, f) && f.id === j) {
                return c.push(f), c
              }
            }
          } else {
            if (e[2]) {
              return w.apply(c, x.call(b.getElementsByTagName(a), 0)), c
            }
            if ((j = e[3]) && _ && b.getElementsByClassName) {
              return w.apply(c, x.call(b.getElementsByClassName(j), 0)), c
            }
          }
        }
      }
      return bp(a.replace(L, "$1"), b, c, d, i)
    }
    function bd(a) {
      return function(b) {
        var c = b.nodeName.toLowerCase();
        return c === "input" && b.type === a
      }
    }
    function be(a) {
      return function(b) {
        var c = b.nodeName.toLowerCase();
        return (c === "input" || c === "button") && b.type === a
      }
    }
    function bf(a) {
      return z(function(b) {
        return b = +b, z(function(c, d) {
          var e, f = a([], c.length, b), g = f.length;
          while (g--) {
            c[e = f[g]] && (c[e] = !(d[e] = c[e]))
          }
        })
      })
    }
    function bg(a, b, c) {
      if (a === b) {
        return c
      }
      var d = a.nextSibling;
      while (d) {
        if (d === b) {
          return -1
        }
        d = d.nextSibling
      }
      return 1
    }
    function bh(a, b) {
      var c, d, f, g, h, i, j, k = C[o][a];
      if (k) {
        return b ? 0 : k.slice(0)
      }
      h = a, i = [], j = e.preFilter;
      while (h) {
        if (!c || (d = M.exec(h))) {
          d && (h = h.slice(d[0].length)), i.push(f = [])
        }
        c = !1;
        if (d = N.exec(h)) {
          f.push(c = new q(d.shift())), h = h.slice(c.length), c.type = d[0].replace(L, " ")
        }
        for (g in e.filter) {
          (d = W[g].exec(h)) && (!j[g] || (d = j[g](d, r, !0))) && (f.push(c = new q(d.shift())), h = h.slice(c.length), c.type = g, c.matches = d)
        }
        if (!c) {
          break
        }
      }
      return b ? h.length : h ? bc.error(a) : C(a, i).slice(0)
    }
    function bi(a, b, d) {
      var e = b.dir, f = d && b.dir === "parentNode", g = u++;
      return b.first ? function(b, c, d) {
        while (b = b[e]) {
          if (f || b.nodeType === 1) {
            return a(b, c, d)
          }
        }
      } : function(b, d, h) {
        if (!h) {
          var i, j = t + " " + g + " ", k = j + c;
          while (b = b[e]) {
            if (f || b.nodeType === 1) {
              if ((i = b[o]) === k) {
                return b.sizset
              }
              if (typeof i == "string" && i.indexOf(j) === 0) {
                if (b.sizset) {
                  return b
                }
              } else {
                b[o] = k;
                if (a(b, d, h)) {
                  return b.sizset = !0, b
                }
                b.sizset = !1
              }
            }
          }
        } else {
          while (b = b[e]) {
            if (f || b.nodeType === 1) {
              if (a(b, d, h)) {
                return b
              }
            }
          }
        }
      }
    }
    function bj(a) {
      return a.length > 1 ? function(b, c, d) {
        var e = a.length;
        while (e--) {
          if (!a[e](b, c, d)) {
            return !1
          }
        }
        return !0
      } : a[0]
    }
    function bk(a, b, c, d, e) {
      var f, g = [], h = 0, i = a.length, j = b != null;
      for (; h < i; h++) {
        if (f = a[h]) {
          if (!c || c(f, d, e)) {
            g.push(f), j && b.push(h)
          }
        }
      }
      return g
    }
    function bl(a, b, c, d, e, f) {
      return d && !d[o] && (d = bl(d)), e && !e[o] && (e = bl(e, f)), z(function(f, g, h, i) {
        if (f && e) {
          return
        }
        var j, k, l, m = [], n = [], o = g.length, p = f || bo(b || "*", h.nodeType ? [h] : h, [], f), q = a && (f || !b) ? bk(p, m, a, h, i) : p, r = c ? e || (f ? a : o || d) ? [] : g : q;
        c && c(q, r, h, i);
        if (d) {
          l = bk(r, n), d(l, [], h, i), j = l.length;
          while (j--) {
            if (k = l[j]) {
              r[n[j]] = !(q[n[j]] = k)
            }
          }
        }
        if (f) {
          j = a && r.length;
          while (j--) {
            if (k = r[j]) {
              f[m[j]] = !(g[m[j]] = k)
            }
          }
        } else {
          r = bk(r === g ? r.splice(o, r.length) : r), e ? e(null, g, r, i) : w.apply(g, r)
        }
      })
    }
    function bm(a) {
      var b, c, d, f = a.length, g = e.relative[a[0].type], h = g || e.relative[" "], i = g ? 1 : 0, j = bi(function(a) {
        return a === b
      }, h, !0), k = bi(function(a) {
        return y.call(b, a) > -1
      }, h, !0), m = [function(a, c, d) {
        return !g && (d || c !== l) || ((b = c).nodeType ? j(a, c, d) : k(a, c, d))
      }];
      for (; i < f; i++) {
        if (c = e.relative[a[i].type]) {
          m = [bi(bj(m), c)]
        } else {
          c = e.filter[a[i].type].apply(null, a[i].matches);
          if (c[o]) {
            d = ++i;
            for (; d < f; d++) {
              if (e.relative[a[d].type]) {
                break
              }
            }
            return bl(i > 1 && bj(m), i > 1 && a.slice(0, i - 1).join("").replace(L, "$1"), c, i < d && bm(a.slice(i, d)), d < f && bm(a = a.slice(d)), d < f && a.join(""))
          }
          m.push(c)
        }
      }
      return bj(m)
    }
    function bn(a, b) {
      var d = b.length > 0, f = a.length > 0, g = function(h, i, j, k, m) {
        var n, o, p, q = [], s = 0, u = "0", x = h && [], y = m != null, z = l, A = h || f && e.find.TAG("*", m && i.parentNode || i), B = t += z == null ? 1 : Math.E;
        y && (l = i !== r && i, c = g.el);
        for (; (n = A[u]) != null; u++) {
          if (f && n) {
            for (o = 0; p = a[o]; o++) {
              if (p(n, i, j)) {
                k.push(n);
                break
              }
            }
            y && (t = B, c = ++g.el)
          }
          d && ((n = !p && n) && s--, h && x.push(n))
        }
        s += u;
        if (d && u !== s) {
          for (o = 0; p = b[o]; o++) {
            p(x, q, i, j)
          }
          if (h) {
            if (s > 0) {
              while (u--) {
                !x[u] && !q[u] && (q[u] = v.call(k))
              }
            }
            q = bk(q)
          }
          w.apply(k, q), y && !h && q.length > 0 && s + b.length > 1 && bc.uniqueSort(k)
        }
        return y && (t = B, l = z), x
      };
      return g.el = 0, d ? z(g) : g
    }
    function bo(a, b, c, d) {
      var e = 0, f = b.length;
      for (; e < f; e++) {
        bc(a, b[e], c, d)
      }
      return c
    }
    function bp(a, b, c, d, f) {
      var g, h, j, k, l, m = bh(a), n = m.length;
      if (!d && m.length === 1) {
        h = m[0] = m[0].slice(0);
        if (h.length > 2 && (j = h[0]).type === "ID" && b.nodeType === 9 && !f && e.relative[h[1].type]) {
          b = e.find.ID(j.matches[0].replace(V, ""), b, f)[0];
          if (!b) {
            return c
          }
          a = a.slice(h.shift().length)
        }
        for (g = W.POS.test(a) ? -1 : h.length - 1; g >= 0; g--) {
          j = h[g];
          if (e.relative[k = j.type]) {
            break
          }
          if (l = e.find[k]) {
            if (d = l(j.matches[0].replace(V, ""), R.test(h[0].type) && b.parentNode || b, f)) {
              h.splice(g, 1), a = d.length && h.join("");
              if (!a) {
                return w.apply(c, x.call(d, 0)), c
              }
              break
            }
          }
        }
      }
      return i(a, m)(d, b, f, c, R.test(a)), c
    }
    function bq() {
    }
    var c, d, e, f, g, h, i, j, k, l, m = !0, n = "undefined", o = ("sizcache" + Math.random()).replace(".", ""), q = String, r = a.document, s = r.documentElement, t = 0, u = 0, v = [].pop, w = [].push, x = [].slice, y = [].indexOf || function(a) {
      var b = 0, c = this.length;
      for (; b < c; b++) {
        if (this[b] === a) {
          return b
        }
      }
      return -1
    }, z = function(a, b) {
      return a[o] = b == null || b, a
    }, A = function() {
      var a = {}, b = [];
      return z(function(c, d) {
        return b.push(c) > e.cacheLength && delete a[b.shift()], a[c] = d
      }, a)
    }, B = A(), C = A(), D = A(), E = "[\\x20\\t\\r\\n\\f]", F = "(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+", G = F.replace("w", "w#"), H = "([*^$|!~]?=)", I = "\\[" + E + "*(" + F + ")" + E + "*(?:" + H + E + "*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|(" + G + ")|)|)" + E + "*\\]", J = ":(" + F + ")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:" + I + ")|[^:]|\\\\.)*|.*))\\)|)", K = ":(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + E + "*((?:-\\d)?\\d*)" + E + "*\\)|)(?=[^-]|$)", L = new RegExp("^" + E + "+|((?:^|[^\\\\])(?:\\\\.)*)" + E + "+$", "g"), M = new RegExp("^" + E + "*," + E + "*"), N = new RegExp("^" + E + "*([\\x20\\t\\r\\n\\f>+~])" + E + "*"), O = new RegExp(J), P = /^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/, Q = /^:not/, R = /[\x20\t\r\n\f]*[+~]/, S = /:not\($/, T = /h\d/i, U = /input|select|textarea|button/i, V = /\\(?!\\)/g, W = {ID: new RegExp("^#(" + F + ")"),CLASS: new RegExp("^\\.(" + F + ")"),NAME: new RegExp("^\\[name=['\"]?(" + F + ")['\"]?\\]"),TAG: new RegExp("^(" + F.replace("w", "w*") + ")"),ATTR: new RegExp("^" + I),PSEUDO: new RegExp("^" + J),POS: new RegExp(K, "i"),CHILD: new RegExp("^:(only|nth|first|last)-child(?:\\(" + E + "*(even|odd|(([+-]|)(\\d*)n|)" + E + "*(?:([+-]|)" + E + "*(\\d+)|))" + E + "*\\)|)", "i"),needsContext: new RegExp("^" + E + "*[>+~]|" + K, "i")}, X = function(a) {
      var b = r.createElement("div");
      try {
        return a(b)
      } catch (c) {
        return !1
      }finally {
        b = null
      }
    }, Y = X(function(a) {
      return a.appendChild(r.createComment("")), !a.getElementsByTagName("*").length
    }), Z = X(function(a) {
      return a.innerHTML = "<a href='#'></a>", a.firstChild && typeof a.firstChild.getAttribute !== n && a.firstChild.getAttribute("href") === "#"
    }), $ = X(function(a) {
      a.innerHTML = "<select></select>";
      var b = typeof a.lastChild.getAttribute("multiple");
      return b !== "boolean" && b !== "string"
    }), _ = X(function(a) {
      return a.innerHTML = "<div class='hidden e'></div><div class='hidden'></div>", !a.getElementsByClassName || !a.getElementsByClassName("e").length ? !1 : (a.lastChild.className = "e", a.getElementsByClassName("e").length === 2)
    }), ba = X(function(a) {
      a.id = o + 0, a.innerHTML = "<a name='" + o + "'></a><div name='" + o + "'></div>", s.insertBefore(a, s.firstChild);
      var b = r.getElementsByName && r.getElementsByName(o).length === 2 + r.getElementsByName(o + 0).length;
      return d = !r.getElementById(o), s.removeChild(a), b
    });
    try {
      x.call(s.childNodes, 0)[0].nodeType
    } catch (bb) {
      x = function(a) {
        var b, c = [];
        for (; b = this[a]; a++) {
          c.push(b)
        }
        return c
      }
    }
    bc.matches = function(a, b) {
      return bc(a, null, null, b)
    }, bc.matchesSelector = function(a, b) {
      return bc(b, null, null, [a]).length > 0
    }, f = bc.getText = function(a) {
      var b, c = "", d = 0, e = a.nodeType;
      if (e) {
        if (e === 1 || e === 9 || e === 11) {
          if (typeof a.textContent == "string") {
            return a.textContent
          }
          for (a = a.firstChild; a; a = a.nextSibling) {
            c += f(a)
          }
        } else {
          if (e === 3 || e === 4) {
            return a.nodeValue
          }
        }
      } else {
        for (; b = a[d]; d++) {
          c += f(b)
        }
      }
      return c
    }, g = bc.isXML = function(a) {
      var b = a && (a.ownerDocument || a).documentElement;
      return b ? b.nodeName !== "HTML" : !1
    }, h = bc.contains = s.contains ? function(a, b) {
      var c = a.nodeType === 9 ? a.documentElement : a, d = b && b.parentNode;
      return a === d || !!(d && d.nodeType === 1 && c.contains && c.contains(d))
    } : s.compareDocumentPosition ? function(a, b) {
      return b && !!(a.compareDocumentPosition(b) & 16)
    } : function(a, b) {
      while (b = b.parentNode) {
        if (b === a) {
          return !0
        }
      }
      return !1
    }, bc.attr = function(a, b) {
      var c, d = g(a);
      return d || (b = b.toLowerCase()), (c = e.attrHandle[b]) ? c(a) : d || $ ? a.getAttribute(b) : (c = a.getAttributeNode(b), c ? typeof a[b] == "boolean" ? a[b] ? b : null : c.specified ? c.value : null : null)
    }, e = bc.selectors = {cacheLength: 50,createPseudo: z,match: W,attrHandle: Z ? {} : {href: function(a) {
      return a.getAttribute("href", 2)
    },type: function(a) {
      return a.getAttribute("type")
    }},find: {ID: d ? function(a, b, c) {
      if (typeof b.getElementById !== n && !c) {
        var d = b.getElementById(a);
        return d && d.parentNode ? [d] : []
      }
    } : function(a, c, d) {
      if (typeof c.getElementById !== n && !d) {
        var e = c.getElementById(a);
        return e ? e.id === a || typeof e.getAttributeNode !== n && e.getAttributeNode("id").value === a ? [e] : b : []
      }
    },TAG: Y ? function(a, b) {
      if (typeof b.getElementsByTagName !== n) {
        return b.getElementsByTagName(a)
      }
    } : function(a, b) {
      var c = b.getElementsByTagName(a);
      if (a === "*") {
        var d, e = [], f = 0;
        for (; d = c[f]; f++) {
          d.nodeType === 1 && e.push(d)
        }
        return e
      }
      return c
    },NAME: ba && function(a, b) {
      if (typeof b.getElementsByName !== n) {
        return b.getElementsByName(name)
      }
    },CLASS: _ && function(a, b, c) {
      if (typeof b.getElementsByClassName !== n && !c) {
        return b.getElementsByClassName(a)
      }
    }},relative: {">": {dir: "parentNode",first: !0}," ": {dir: "parentNode"},"+": {dir: "previousSibling",first: !0},"~": {dir: "previousSibling"}},preFilter: {ATTR: function(a) {
      return a[1] = a[1].replace(V, ""), a[3] = (a[4] || a[5] || "").replace(V, ""), a[2] === "~=" && (a[3] = " " + a[3] + " "), a.slice(0, 4)
    },CHILD: function(a) {
      return a[1] = a[1].toLowerCase(), a[1] === "nth" ? (a[2] || bc.error(a[0]), a[3] = +(a[3] ? a[4] + (a[5] || 1) : 2 * (a[2] === "even" || a[2] === "odd")), a[4] = +(a[6] + a[7] || a[2] === "odd")) : a[2] && bc.error(a[0]), a
    },PSEUDO: function(a) {
      var b, c;
      if (W.CHILD.test(a[0])) {
        return null
      }
      if (a[3]) {
        a[2] = a[3]
      } else {
        if (b = a[4]) {
          O.test(b) && (c = bh(b, !0)) && (c = b.indexOf(")", b.length - c) - b.length) && (b = b.slice(0, c), a[0] = a[0].slice(0, c)), a[2] = b
        }
      }
      return a.slice(0, 3)
    }},filter: {ID: d ? function(a) {
      return a = a.replace(V, ""), function(b) {
        return b.getAttribute("id") === a
      }
    } : function(a) {
      return a = a.replace(V, ""), function(b) {
        var c = typeof b.getAttributeNode !== n && b.getAttributeNode("id");
        return c && c.value === a
      }
    },TAG: function(a) {
      return a === "*" ? function() {
        return !0
      } : (a = a.replace(V, "").toLowerCase(), function(b) {
        return b.nodeName && b.nodeName.toLowerCase() === a
      })
    },CLASS: function(a) {
      var b = B[o][a];
      return b || (b = B(a, new RegExp("(^|" + E + ")" + a + "(" + E + "|$)"))), function(a) {
        return b.test(a.className || typeof a.getAttribute !== n && a.getAttribute("class") || "")
      }
    },ATTR: function(a, b, c) {
      return function(d, e) {
        var f = bc.attr(d, a);
        return f == null ? b === "!=" : b ? (f += "", b === "=" ? f === c : b === "!=" ? f !== c : b === "^=" ? c && f.indexOf(c) === 0 : b === "*=" ? c && f.indexOf(c) > -1 : b === "$=" ? c && f.substr(f.length - c.length) === c : b === "~=" ? (" " + f + " ").indexOf(c) > -1 : b === "|=" ? f === c || f.substr(0, c.length + 1) === c + "-" : !1) : !0
      }
    },CHILD: function(a, b, c, d) {
      return a === "nth" ? function(a) {
        var b, e, f = a.parentNode;
        if (c === 1 && d === 0) {
          return !0
        }
        if (f) {
          e = 0;
          for (b = f.firstChild; b; b = b.nextSibling) {
            if (b.nodeType === 1) {
              e++;
              if (a === b) {
                break
              }
            }
          }
        }
        return e -= d, e === c || e % c === 0 && e / c >= 0
      } : function(b) {
        var c = b;
        switch (a) {
          case "only":
          case "first":
            while (c = c.previousSibling) {
              if (c.nodeType === 1) {
                return !1
              }
            }
            if (a === "first") {
              return !0
            }
            c = b;
          case "last":
            while (c = c.nextSibling) {
              if (c.nodeType === 1) {
                return !1
              }
            }
            return !0
        }
      }
    },PSEUDO: function(a, b) {
      var c, d = e.pseudos[a] || e.setFilters[a.toLowerCase()] || bc.error("unsupported pseudo: " + a);
      return d[o] ? d(b) : d.length > 1 ? (c = [a, a, "", b], e.setFilters.hasOwnProperty(a.toLowerCase()) ? z(function(a, c) {
        var e, f = d(a, b), g = f.length;
        while (g--) {
          e = y.call(a, f[g]), a[e] = !(c[e] = f[g])
        }
      }) : function(a) {
        return d(a, 0, c)
      }) : d
    }},pseudos: {not: z(function(a) {
      var b = [], c = [], d = i(a.replace(L, "$1"));
      return d[o] ? z(function(a, b, c, e) {
        var f, g = d(a, null, e, []), h = a.length;
        while (h--) {
          if (f = g[h]) {
            a[h] = !(b[h] = f)
          }
        }
      }) : function(a, e, f) {
        return b[0] = a, d(b, null, f, c), !c.pop()
      }
    }),has: z(function(a) {
      return function(b) {
        return bc(a, b).length > 0
      }
    }),contains: z(function(a) {
      return function(b) {
        return (b.textContent || b.innerText || f(b)).indexOf(a) > -1
      }
    }),enabled: function(a) {
      return a.disabled === !1
    },disabled: function(a) {
      return a.disabled === !0
    },checked: function(a) {
      var b = a.nodeName.toLowerCase();
      return b === "input" && !!a.checked || b === "option" && !!a.selected
    },selected: function(a) {
      return a.parentNode && a.parentNode.selectedIndex, a.selected === !0
    },parent: function(a) {
      return !e.pseudos.empty(a)
    },empty: function(a) {
      var b;
      a = a.firstChild;
      while (a) {
        if (a.nodeName > "@" || (b = a.nodeType) === 3 || b === 4) {
          return !1
        }
        a = a.nextSibling
      }
      return !0
    },header: function(a) {
      return T.test(a.nodeName)
    },text: function(a) {
      var b, c;
      return a.nodeName.toLowerCase() === "input" && (b = a.type) === "text" && ((c = a.getAttribute("type")) == null || c.toLowerCase() === b)
    },radio: bd("radio"),checkbox: bd("checkbox"),file: bd("file"),password: bd("password"),image: bd("image"),submit: be("submit"),reset: be("reset"),button: function(a) {
      var b = a.nodeName.toLowerCase();
      return b === "input" && a.type === "button" || b === "button"
    },input: function(a) {
      return U.test(a.nodeName)
    },focus: function(a) {
      var b = a.ownerDocument;
      return a === b.activeElement && (!b.hasFocus || b.hasFocus()) && (!!a.type || !!a.href)
    },active: function(a) {
      return a === a.ownerDocument.activeElement
    },first: bf(function(a, b, c) {
      return [0]
    }),last: bf(function(a, b, c) {
      return [b - 1]
    }),eq: bf(function(a, b, c) {
      return [c < 0 ? c + b : c]
    }),even: bf(function(a, b, c) {
      for (var d = 0; d < b; d += 2) {
        a.push(d)
      }
      return a
    }),odd: bf(function(a, b, c) {
      for (var d = 1; d < b; d += 2) {
        a.push(d)
      }
      return a
    }),lt: bf(function(a, b, c) {
      for (var d = c < 0 ? c + b : c; --d >= 0; ) {
        a.push(d)
      }
      return a
    }),gt: bf(function(a, b, c) {
      for (var d = c < 0 ? c + b : c; ++d < b; ) {
        a.push(d)
      }
      return a
    })}}, j = s.compareDocumentPosition ? function(a, b) {
      return a === b ? (k = !0, 0) : (!a.compareDocumentPosition || !b.compareDocumentPosition ? a.compareDocumentPosition : a.compareDocumentPosition(b) & 4) ? -1 : 1
    } : function(a, b) {
      if (a === b) {
        return k = !0, 0
      }
      if (a.sourceIndex && b.sourceIndex) {
        return a.sourceIndex - b.sourceIndex
      }
      var c, d, e = [], f = [], g = a.parentNode, h = b.parentNode, i = g;
      if (g === h) {
        return bg(a, b)
      }
      if (!g) {
        return -1
      }
      if (!h) {
        return 1
      }
      while (i) {
        e.unshift(i), i = i.parentNode
      }
      i = h;
      while (i) {
        f.unshift(i), i = i.parentNode
      }
      c = e.length, d = f.length;
      for (var j = 0; j < c && j < d; j++) {
        if (e[j] !== f[j]) {
          return bg(e[j], f[j])
        }
      }
      return j === c ? bg(a, f[j], -1) : bg(e[j], b, 1)
    }, [0, 0].sort(j), m = !k, bc.uniqueSort = function(a) {
      var b, c = 1;
      k = m, a.sort(j);
      if (k) {
        for (; b = a[c]; c++) {
          b === a[c - 1] && a.splice(c--, 1)
        }
      }
      return a
    }, bc.error = function(a) {
      throw new Error("Syntax error, unrecognized expression: " + a)
    }, i = bc.compile = function(a, b) {
      var c, d = [], e = [], f = D[o][a];
      if (!f) {
        b || (b = bh(a)), c = b.length;
        while (c--) {
          f = bm(b[c]), f[o] ? d.push(f) : e.push(f)
        }
        f = D(a, bn(e, d))
      }
      return f
    }, r.querySelectorAll && function() {
      var a, b = bp, c = /'|\\/g, d = /\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g, e = [":focus"], f = [":active", ":focus"], h = s.matchesSelector || s.mozMatchesSelector || s.webkitMatchesSelector || s.oMatchesSelector || s.msMatchesSelector;
      X(function(a) {
        a.innerHTML = "<select><option selected=''></option></select>", a.querySelectorAll("[selected]").length || e.push("\\[" + E + "*(?:checked|disabled|ismap|multiple|readonly|selected|value)"), a.querySelectorAll(":checked").length || e.push(":checked")
      }), X(function(a) {
        a.innerHTML = "<p test=''></p>", a.querySelectorAll("[test^='']").length && e.push("[*^$]=" + E + "*(?:\"\"|'')"), a.innerHTML = "<input type='hidden'/>", a.querySelectorAll(":enabled").length || e.push(":enabled", ":disabled")
      }), e = new RegExp(e.join("|")), bp = function(a, d, f, g, h) {
        if (!g && !h && (!e || !e.test(a))) {
          var i, j, k = !0, l = o, m = d, n = d.nodeType === 9 && a;
          if (d.nodeType === 1 && d.nodeName.toLowerCase() !== "object") {
            i = bh(a), (k = d.getAttribute("id")) ? l = k.replace(c, "\\$&") : d.setAttribute("id", l), l = "[id='" + l + "'] ", j = i.length;
            while (j--) {
              i[j] = l + i[j].join("")
            }
            m = R.test(a) && d.parentNode || d, n = i.join(",")
          }
          if (n) {
            try {
              return w.apply(f, x.call(m.querySelectorAll(n), 0)), f
            } catch (p) {
            }finally {
              k || d.removeAttribute("id")
            }
          }
        }
        return b(a, d, f, g, h)
      }, h && (X(function(b) {
        a = h.call(b, "div");
        try {
          h.call(b, "[test!='']:sizzle"), f.push("!=", J)
        } catch (c) {
        }
      }), f = new RegExp(f.join("|")), bc.matchesSelector = function(b, c) {
        c = c.replace(d, "='$1']");
        if (!g(b) && !f.test(c) && (!e || !e.test(c))) {
          try {
            var i = h.call(b, c);
            if (i || a || b.document && b.document.nodeType !== 11) {
              return i
            }
          } catch (j) {
          }
        }
        return bc(c, null, null, [b]).length > 0
      })
    }(), e.pseudos.nth = e.pseudos.eq, e.filters = bq.prototype = e.pseudos, e.setFilters = new bq, bc.attr = p.attr, p.find = bc, p.expr = bc.selectors, p.expr[":"] = p.expr.pseudos, p.unique = bc.uniqueSort, p.text = bc.getText, p.isXMLDoc = bc.isXML, p.contains = bc.contains
  }(a);
  var bc = /Until$/, bd = /^(?:parents|prev(?:Until|All))/, be = /^.[^:#\[\.,]*$/, bf = p.expr.match.needsContext, bg = {children: !0,contents: !0,next: !0,prev: !0};
  p.fn.extend({find: function(a) {
    var b, c, d, e, f, g, h = this;
    if (typeof a != "string") {
      return p(a).filter(function() {
        for (b = 0, c = h.length; b < c; b++) {
          if (p.contains(h[b], this)) {
            return !0
          }
        }
      })
    }
    g = this.pushStack("", "find", a);
    for (b = 0, c = this.length; b < c; b++) {
      d = g.length, p.find(a, this[b], g);
      if (b > 0) {
        for (e = d; e < g.length; e++) {
          for (f = 0; f < d; f++) {
            if (g[f] === g[e]) {
              g.splice(e--, 1);
              break
            }
          }
        }
      }
    }
    return g
  },has: function(a) {
    var b, c = p(a, this), d = c.length;
    return this.filter(function() {
      for (b = 0; b < d; b++) {
        if (p.contains(this, c[b])) {
          return !0
        }
      }
    })
  },not: function(a) {
    return this.pushStack(bj(this, a, !1), "not", a)
  },filter: function(a) {
    return this.pushStack(bj(this, a, !0), "filter", a)
  },is: function(a) {
    return !!a && (typeof a == "string" ? bf.test(a) ? p(a, this.context).index(this[0]) >= 0 : p.filter(a, this).length > 0 : this.filter(a).length > 0)
  },closest: function(a, b) {
    var c, d = 0, e = this.length, f = [], g = bf.test(a) || typeof a != "string" ? p(a, b || this.context) : 0;
    for (; d < e; d++) {
      c = this[d];
      while (c && c.ownerDocument && c !== b && c.nodeType !== 11) {
        if (g ? g.index(c) > -1 : p.find.matchesSelector(c, a)) {
          f.push(c);
          break
        }
        c = c.parentNode
      }
    }
    return f = f.length > 1 ? p.unique(f) : f, this.pushStack(f, "closest", a)
  },index: function(a) {
    return a ? typeof a == "string" ? p.inArray(this[0], p(a)) : p.inArray(a.jquery ? a[0] : a, this) : this[0] && this[0].parentNode ? this.prevAll().length : -1
  },add: function(a, b) {
    var c = typeof a == "string" ? p(a, b) : p.makeArray(a && a.nodeType ? [a] : a), d = p.merge(this.get(), c);
    return this.pushStack(bh(c[0]) || bh(d[0]) ? d : p.unique(d))
  },addBack: function(a) {
    return this.add(a == null ? this.prevObject : this.prevObject.filter(a))
  }}), p.fn.andSelf = p.fn.addBack, p.each({parent: function(a) {
    var b = a.parentNode;
    return b && b.nodeType !== 11 ? b : null
  },parents: function(a) {
    return p.dir(a, "parentNode")
  },parentsUntil: function(a, b, c) {
    return p.dir(a, "parentNode", c)
  },next: function(a) {
    return bi(a, "nextSibling")
  },prev: function(a) {
    return bi(a, "previousSibling")
  },nextAll: function(a) {
    return p.dir(a, "nextSibling")
  },prevAll: function(a) {
    return p.dir(a, "previousSibling")
  },nextUntil: function(a, b, c) {
    return p.dir(a, "nextSibling", c)
  },prevUntil: function(a, b, c) {
    return p.dir(a, "previousSibling", c)
  },siblings: function(a) {
    return p.sibling((a.parentNode || {}).firstChild, a)
  },children: function(a) {
    return p.sibling(a.firstChild)
  },contents: function(a) {
    return p.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document : p.merge([], a.childNodes)
  }}, function(a, b) {
    p.fn[a] = function(c, d) {
      var e = p.map(this, b, c);
      return bc.test(a) || (d = c), d && typeof d == "string" && (e = p.filter(d, e)), e = this.length > 1 && !bg[a] ? p.unique(e) : e, this.length > 1 && bd.test(a) && (e = e.reverse()), this.pushStack(e, a, k.call(arguments).join(","))
    }
  }), p.extend({filter: function(a, b, c) {
    return c && (a = ":not(" + a + ")"), b.length === 1 ? p.find.matchesSelector(b[0], a) ? [b[0]] : [] : p.find.matches(a, b)
  },dir: function(a, c, d) {
    var e = [], f = a[c];
    while (f && f.nodeType !== 9 && (d === b || f.nodeType !== 1 || !p(f).is(d))) {
      f.nodeType === 1 && e.push(f), f = f[c]
    }
    return e
  },sibling: function(a, b) {
    var c = [];
    for (; a; a = a.nextSibling) {
      a.nodeType === 1 && a !== b && c.push(a)
    }
    return c
  }});
  var bl = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video", bm = / jQuery\d+="(?:null|\d+)"/g, bn = /^\s+/, bo = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi, bp = /<([\w:]+)/, bq = /<tbody/i, br = /<|&#?\w+;/, bs = /<(?:script|style|link)/i, bt = /<(?:script|object|embed|option|style)/i, bu = new RegExp("<(?:" + bl + ")[\\s/>]", "i"), bv = /^(?:checkbox|radio)$/, bw = /checked\s*(?:[^=]|=\s*.checked.)/i, bx = /\/(java|ecma)script/i, by = /^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g, bz = {option: [1, "<select multiple='multiple'>", "</select>"],legend: [1, "<fieldset>", "</fieldset>"],thead: [1, "<table>", "</table>"],tr: [2, "<table><tbody>", "</tbody></table>"],td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"],area: [1, "<map>", "</map>"],_default: [0, "", ""]}, bA = bk(e), bB = bA.appendChild(e.createElement("div"));
  bz.optgroup = bz.option, bz.tbody = bz.tfoot = bz.colgroup = bz.caption = bz.thead, bz.th = bz.td, p.support.htmlSerialize || (bz._default = [1, "X<div>", "</div>"]), p.fn.extend({text: function(a) {
    return p.access(this, function(a) {
      return a === b ? p.text(this) : this.empty().append((this[0] && this[0].ownerDocument || e).createTextNode(a))
    }, null, a, arguments.length)
  },wrapAll: function(a) {
    if (p.isFunction(a)) {
      return this.each(function(b) {
        p(this).wrapAll(a.call(this, b))
      })
    }
    if (this[0]) {
      var b = p(a, this[0].ownerDocument).eq(0).clone(!0);
      this[0].parentNode && b.insertBefore(this[0]), b.map(function() {
        var a = this;
        while (a.firstChild && a.firstChild.nodeType === 1) {
          a = a.firstChild
        }
        return a
      }).append(this)
    }
    return this
  },wrapInner: function(a) {
    return p.isFunction(a) ? this.each(function(b) {
      p(this).wrapInner(a.call(this, b))
    }) : this.each(function() {
      var b = p(this), c = b.contents();
      c.length ? c.wrapAll(a) : b.append(a)
    })
  },wrap: function(a) {
    var b = p.isFunction(a);
    return this.each(function(c) {
      p(this).wrapAll(b ? a.call(this, c) : a)
    })
  },unwrap: function() {
    return this.parent().each(function() {
      p.nodeName(this, "body") || p(this).replaceWith(this.childNodes)
    }).end()
  },append: function() {
    return this.domManip(arguments, !0, function(a) {
      (this.nodeType === 1 || this.nodeType === 11) && this.appendChild(a)
    })
  },prepend: function() {
    return this.domManip(arguments, !0, function(a) {
      (this.nodeType === 1 || this.nodeType === 11) && this.insertBefore(a, this.firstChild)
    })
  },before: function() {
    if (!bh(this[0])) {
      return this.domManip(arguments, !1, function(a) {
        this.parentNode.insertBefore(a, this)
      })
    }
    if (arguments.length) {
      var a = p.clean(arguments);
      return this.pushStack(p.merge(a, this), "before", this.selector)
    }
  },after: function() {
    if (!bh(this[0])) {
      return this.domManip(arguments, !1, function(a) {
        this.parentNode.insertBefore(a, this.nextSibling)
      })
    }
    if (arguments.length) {
      var a = p.clean(arguments);
      return this.pushStack(p.merge(this, a), "after", this.selector)
    }
  },remove: function(a, b) {
    var c, d = 0;
    for (; (c = this[d]) != null; d++) {
      if (!a || p.filter(a, [c]).length) {
        !b && c.nodeType === 1 && (p.cleanData(c.getElementsByTagName("*")), p.cleanData([c])), c.parentNode && c.parentNode.removeChild(c)
      }
    }
    return this
  },empty: function() {
    var a, b = 0;
    for (; (a = this[b]) != null; b++) {
      a.nodeType === 1 && p.cleanData(a.getElementsByTagName("*"));
      while (a.firstChild) {
        a.removeChild(a.firstChild)
      }
    }
    return this
  },clone: function(a, b) {
    return a = a == null ? !1 : a, b = b == null ? a : b, this.map(function() {
      return p.clone(this, a, b)
    })
  },html: function(a) {
    return p.access(this, function(a) {
      var c = this[0] || {}, d = 0, e = this.length;
      if (a === b) {
        return c.nodeType === 1 ? c.innerHTML.replace(bm, "") : b
      }
      if (typeof a == "string" && !bs.test(a) && (p.support.htmlSerialize || !bu.test(a)) && (p.support.leadingWhitespace || !bn.test(a)) && !bz[(bp.exec(a) || ["", ""])[1].toLowerCase()]) {
        a = a.replace(bo, "<$1></$2>");
        try {
          for (; d < e; d++) {
            c = this[d] || {}, c.nodeType === 1 && (p.cleanData(c.getElementsByTagName("*")), c.innerHTML = a)
          }
          c = 0
        } catch (f) {
        }
      }
      c && this.empty().append(a)
    }, null, a, arguments.length)
  },replaceWith: function(a) {
    return bh(this[0]) ? this.length ? this.pushStack(p(p.isFunction(a) ? a() : a), "replaceWith", a) : this : p.isFunction(a) ? this.each(function(b) {
      var c = p(this), d = c.html();
      c.replaceWith(a.call(this, b, d))
    }) : (typeof a != "string" && (a = p(a).detach()), this.each(function() {
      var b = this.nextSibling, c = this.parentNode;
      p(this).remove(), b ? p(b).before(a) : p(c).append(a)
    }))
  },detach: function(a) {
    return this.remove(a, !0)
  },domManip: function(a, c, d) {
    a = [].concat.apply([], a);
    var e, f, g, h, i = 0, j = a[0], k = [], l = this.length;
    if (!p.support.checkClone && l > 1 && typeof j == "string" && bw.test(j)) {
      return this.each(function() {
        p(this).domManip(a, c, d)
      })
    }
    if (p.isFunction(j)) {
      return this.each(function(e) {
        var f = p(this);
        a[0] = j.call(this, e, c ? f.html() : b), f.domManip(a, c, d)
      })
    }
    if (this[0]) {
      e = p.buildFragment(a, this, k), g = e.fragment, f = g.firstChild, g.childNodes.length === 1 && (g = f);
      if (f) {
        c = c && p.nodeName(f, "tr");
        for (h = e.cacheable || l - 1; i < l; i++) {
          d.call(c && p.nodeName(this[i], "table") ? bC(this[i], "tbody") : this[i], i === h ? g : p.clone(g, !0, !0))
        }
      }
      g = f = null, k.length && p.each(k, function(a, b) {
        b.src ? p.ajax ? p.ajax({url: b.src,type: "GET",dataType: "script",async: !1,global: !1,"throws": !0}) : p.error("no ajax") : p.globalEval((b.text || b.textContent || b.innerHTML || "").replace(by, "")), b.parentNode && b.parentNode.removeChild(b)
      })
    }
    return this
  }}), p.buildFragment = function(a, c, d) {
    var f, g, h, i = a[0];
    return c = c || e, c = !c.nodeType && c[0] || c, c = c.ownerDocument || c, a.length === 1 && typeof i == "string" && i.length < 512 && c === e && i.charAt(0) === "<" && !bt.test(i) && (p.support.checkClone || !bw.test(i)) && (p.support.html5Clone || !bu.test(i)) && (g = !0, f = p.fragments[i], h = f !== b), f || (f = c.createDocumentFragment(), p.clean(a, c, f, d), g && (p.fragments[i] = h && f)), {fragment: f,cacheable: g}
  }, p.fragments = {}, p.each({appendTo: "append",prependTo: "prepend",insertBefore: "before",insertAfter: "after",replaceAll: "replaceWith"}, function(a, b) {
    p.fn[a] = function(c) {
      var d, e = 0, f = [], g = p(c), h = g.length, i = this.length === 1 && this[0].parentNode;
      if ((i == null || i && i.nodeType === 11 && i.childNodes.length === 1) && h === 1) {
        return g[b](this[0]), this
      }
      for (; e < h; e++) {
        d = (e > 0 ? this.clone(!0) : this).get(), p(g[e])[b](d), f = f.concat(d)
      }
      return this.pushStack(f, a, g.selector)
    }
  }), p.extend({clone: function(a, b, c) {
    var d, e, f, g;
    p.support.html5Clone || p.isXMLDoc(a) || !bu.test("<" + a.nodeName + ">") ? g = a.cloneNode(!0) : (bB.innerHTML = a.outerHTML, bB.removeChild(g = bB.firstChild));
    if ((!p.support.noCloneEvent || !p.support.noCloneChecked) && (a.nodeType === 1 || a.nodeType === 11) && !p.isXMLDoc(a)) {
      bE(a, g), d = bF(a), e = bF(g);
      for (f = 0; d[f]; ++f) {
        e[f] && bE(d[f], e[f])
      }
    }
    if (b) {
      bD(a, g);
      if (c) {
        d = bF(a), e = bF(g);
        for (f = 0; d[f]; ++f) {
          bD(d[f], e[f])
        }
      }
    }
    return d = e = null, g
  },clean: function(a, b, c, d) {
    var f, g, h, i, j, k, l, m, n, o, q, r, s = b === e && bA, t = [];
    if (!b || typeof b.createDocumentFragment == "undefined") {
      b = e
    }
    for (f = 0; (h = a[f]) != null; f++) {
      typeof h == "number" && (h += "");
      if (!h) {
        continue
      }
      if (typeof h == "string") {
        if (!br.test(h)) {
          h = b.createTextNode(h)
        } else {
          s = s || bk(b), l = b.createElement("div"), s.appendChild(l), h = h.replace(bo, "<$1></$2>"), i = (bp.exec(h) || ["", ""])[1].toLowerCase(), j = bz[i] || bz._default, k = j[0], l.innerHTML = j[1] + h + j[2];
          while (k--) {
            l = l.lastChild
          }
          if (!p.support.tbody) {
            m = bq.test(h), n = i === "table" && !m ? l.firstChild && l.firstChild.childNodes : j[1] === "<table>" && !m ? l.childNodes : [];
            for (g = n.length - 1; g >= 0; --g) {
              p.nodeName(n[g], "tbody") && !n[g].childNodes.length && n[g].parentNode.removeChild(n[g])
            }
          }
          !p.support.leadingWhitespace && bn.test(h) && l.insertBefore(b.createTextNode(bn.exec(h)[0]), l.firstChild), h = l.childNodes, l.parentNode.removeChild(l)
        }
      }
      h.nodeType ? t.push(h) : p.merge(t, h)
    }
    l && (h = l = s = null);
    if (!p.support.appendChecked) {
      for (f = 0; (h = t[f]) != null; f++) {
        p.nodeName(h, "input") ? bG(h) : typeof h.getElementsByTagName != "undefined" && p.grep(h.getElementsByTagName("input"), bG)
      }
    }
    if (c) {
      q = function(a) {
        if (!a.type || bx.test(a.type)) {
          return d ? d.push(a.parentNode ? a.parentNode.removeChild(a) : a) : c.appendChild(a)
        }
      };
      for (f = 0; (h = t[f]) != null; f++) {
        if (!p.nodeName(h, "script") || !q(h)) {
          c.appendChild(h), typeof h.getElementsByTagName != "undefined" && (r = p.grep(p.merge([], h.getElementsByTagName("script")), q), t.splice.apply(t, [f + 1, 0].concat(r)), f += r.length)
        }
      }
    }
    return t
  },cleanData: function(a, b) {
    var c, d, e, f, g = 0, h = p.expando, i = p.cache, j = p.support.deleteExpando, k = p.event.special;
    for (; (e = a[g]) != null; g++) {
      if (b || p.acceptData(e)) {
        d = e[h], c = d && i[d];
        if (c) {
          if (c.events) {
            for (f in c.events) {
              k[f] ? p.event.remove(e, f) : p.removeEvent(e, f, c.handle)
            }
          }
          i[d] && (delete i[d], j ? delete e[h] : e.removeAttribute ? e.removeAttribute(h) : e[h] = null, p.deletedIds.push(d))
        }
      }
    }
  }}), function() {
    var a, b;
    p.uaMatch = function(a) {
      a = a.toLowerCase();
      var b = /(chrome)[ \/]([\w.]+)/.exec(a) || /(webkit)[ \/]([\w.]+)/.exec(a) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a) || /(msie) ([\w.]+)/.exec(a) || a.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a) || [];
      return {browser: b[1] || "",version: b[2] || "0"}
    }, a = p.uaMatch(g.userAgent), b = {}, a.browser && (b[a.browser] = !0, b.version = a.version), b.chrome ? b.webkit = !0 : b.webkit && (b.safari = !0), p.browser = b, p.sub = function() {
      function a(b, c) {
        return new a.fn.init(b, c)
      }
      p.extend(!0, a, this), a.superclass = this, a.fn = a.prototype = this(), a.fn.constructor = a, a.sub = this.sub, a.fn.init = function c(c, d) {
        return d && d instanceof p && !(d instanceof a) && (d = a(d)), p.fn.init.call(this, c, d, b)
      }, a.fn.init.prototype = a.fn;
      var b = a(e);
      return a
    }
  }();
  var bH, bI, bJ, bK = /alpha\([^)]*\)/i, bL = /opacity=([^)]*)/, bM = /^(top|right|bottom|left)$/, bN = /^(none|table(?!-c[ea]).+)/, bO = /^margin/, bP = new RegExp("^(" + q + ")(.*)$", "i"), bQ = new RegExp("^(" + q + ")(?!px)[a-z%]+$", "i"), bR = new RegExp("^([-+])=(" + q + ")", "i"), bS = {}, bT = {position: "absolute",visibility: "hidden",display: "block"}, bU = {letterSpacing: 0,fontWeight: 400}, bV = ["Top", "Right", "Bottom", "Left"], bW = ["Webkit", "O", "Moz", "ms"], bX = p.fn.toggle;
  p.fn.extend({css: function(a, c) {
    return p.access(this, function(a, c, d) {
      return d !== b ? p.style(a, c, d) : p.css(a, c)
    }, a, c, arguments.length > 1)
  },show: function() {
    return b$(this, !0)
  },hide: function() {
    return b$(this)
  },toggle: function(a, b) {
    var c = typeof a == "boolean";
    return p.isFunction(a) && p.isFunction(b) ? bX.apply(this, arguments) : this.each(function() {
      (c ? a : bZ(this)) ? p(this).show() : p(this).hide()
    })
  }}), p.extend({cssHooks: {opacity: {get: function(a, b) {
    if (b) {
      var c = bH(a, "opacity");
      return c === "" ? "1" : c
    }
  }}},cssNumber: {fillOpacity: !0,fontWeight: !0,lineHeight: !0,opacity: !0,orphans: !0,widows: !0,zIndex: !0,zoom: !0},cssProps: {"float": p.support.cssFloat ? "cssFloat" : "styleFloat"},style: function(a, c, d, e) {
    if (!a || a.nodeType === 3 || a.nodeType === 8 || !a.style) {
      return
    }
    var f, g, h, i = p.camelCase(c), j = a.style;
    c = p.cssProps[i] || (p.cssProps[i] = bY(j, i)), h = p.cssHooks[c] || p.cssHooks[i];
    if (d === b) {
      return h && "get" in h && (f = h.get(a, !1, e)) !== b ? f : j[c]
    }
    g = typeof d, g === "string" && (f = bR.exec(d)) && (d = (f[1] + 1) * f[2] + parseFloat(p.css(a, c)), g = "number");
    if (d == null || g === "number" && isNaN(d)) {
      return
    }
    g === "number" && !p.cssNumber[i] && (d += "px");
    if (!h || !("set" in h) || (d = h.set(a, d, e)) !== b) {
      try {
        j[c] = d
      } catch (k) {
      }
    }
  },css: function(a, c, d, e) {
    var f, g, h, i = p.camelCase(c);
    return c = p.cssProps[i] || (p.cssProps[i] = bY(a.style, i)), h = p.cssHooks[c] || p.cssHooks[i], h && "get" in h && (f = h.get(a, !0, e)), f === b && (f = bH(a, c)), f === "normal" && c in bU && (f = bU[c]), d || e !== b ? (g = parseFloat(f), d || p.isNumeric(g) ? g || 0 : f) : f
  },swap: function(a, b, c) {
    var d, e, f = {};
    for (e in b) {
      f[e] = a.style[e], a.style[e] = b[e]
    }
    d = c.call(a);
    for (e in b) {
      a.style[e] = f[e]
    }
    return d
  }}), a.getComputedStyle ? bH = function(b, c) {
    var d, e, f, g, h = a.getComputedStyle(b, null), i = b.style;
    return h && (d = h[c], d === "" && !p.contains(b.ownerDocument, b) && (d = p.style(b, c)), bQ.test(d) && bO.test(c) && (e = i.width, f = i.minWidth, g = i.maxWidth, i.minWidth = i.maxWidth = i.width = d, d = h.width, i.width = e, i.minWidth = f, i.maxWidth = g)), d
  } : e.documentElement.currentStyle && (bH = function(a, b) {
    var c, d, e = a.currentStyle && a.currentStyle[b], f = a.style;
    return e == null && f && f[b] && (e = f[b]), bQ.test(e) && !bM.test(b) && (c = f.left, d = a.runtimeStyle && a.runtimeStyle.left, d && (a.runtimeStyle.left = a.currentStyle.left), f.left = b === "fontSize" ? "1em" : e, e = f.pixelLeft + "px", f.left = c, d && (a.runtimeStyle.left = d)), e === "" ? "auto" : e
  }), p.each(["height", "width"], function(a, b) {
    p.cssHooks[b] = {get: function(a, c, d) {
      if (c) {
        return a.offsetWidth === 0 && bN.test(bH(a, "display")) ? p.swap(a, bT, function() {
          return cb(a, b, d)
        }) : cb(a, b, d)
      }
    },set: function(a, c, d) {
      return b_(a, c, d ? ca(a, b, d, p.support.boxSizing && p.css(a, "boxSizing") === "border-box") : 0)
    }}
  }), p.support.opacity || (p.cssHooks.opacity = {get: function(a, b) {
    return bL.test((b && a.currentStyle ? a.currentStyle.filter : a.style.filter) || "") ? 0.01 * parseFloat(RegExp.$1) + "" : b ? "1" : ""
  },set: function(a, b) {
    var c = a.style, d = a.currentStyle, e = p.isNumeric(b) ? "alpha(opacity=" + b * 100 + ")" : "", f = d && d.filter || c.filter || "";
    c.zoom = 1;
    if (b >= 1 && p.trim(f.replace(bK, "")) === "" && c.removeAttribute) {
      c.removeAttribute("filter");
      if (d && !d.filter) {
        return
      }
    }
    c.filter = bK.test(f) ? f.replace(bK, e) : f + " " + e
  }}), p(function() {
    p.support.reliableMarginRight || (p.cssHooks.marginRight = {get: function(a, b) {
      return p.swap(a, {display: "inline-block"}, function() {
        if (b) {
          return bH(a, "marginRight")
        }
      })
    }}), !p.support.pixelPosition && p.fn.position && p.each(["top", "left"], function(a, b) {
      p.cssHooks[b] = {get: function(a, c) {
        if (c) {
          var d = bH(a, b);
          return bQ.test(d) ? p(a).position()[b] + "px" : d
        }
      }}
    })
  }), p.expr && p.expr.filters && (p.expr.filters.hidden = function(a) {
    return a.offsetWidth === 0 && a.offsetHeight === 0 || !p.support.reliableHiddenOffsets && (a.style && a.style.display || bH(a, "display")) === "none"
  }, p.expr.filters.visible = function(a) {
    return !p.expr.filters.hidden(a)
  }), p.each({margin: "",padding: "",border: "Width"}, function(a, b) {
    p.cssHooks[a + b] = {expand: function(c) {
      var d, e = typeof c == "string" ? c.split(" ") : [c], f = {};
      for (d = 0; d < 4; d++) {
        f[a + bV[d] + b] = e[d] || e[d - 2] || e[0]
      }
      return f
    }}, bO.test(a) || (p.cssHooks[a + b].set = b_)
  });
  var cd = /%20/g, ce = /\[\]$/, cf = /\r?\n/g, cg = /^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i, ch = /^(?:select|textarea)/i;
  p.fn.extend({serialize: function() {
    return p.param(this.serializeArray())
  },serializeArray: function() {
    return this.map(function() {
      return this.elements ? p.makeArray(this.elements) : this
    }).filter(function() {
        return this.name && !this.disabled && (this.checked || ch.test(this.nodeName) || cg.test(this.type))
      }).map(function(a, b) {
        var c = p(this).val();
        return c == null ? null : p.isArray(c) ? p.map(c, function(a, c) {
          return {name: b.name,value: a.replace(cf, "\r\n")}
        }) : {name: b.name,value: c.replace(cf, "\r\n")}
      }).get()
  }}), p.param = function(a, c) {
    var d, e = [], f = function(a, b) {
      b = p.isFunction(b) ? b() : b == null ? "" : b, e[e.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b)
    };
    c === b && (c = p.ajaxSettings && p.ajaxSettings.traditional);
    if (p.isArray(a) || a.jquery && !p.isPlainObject(a)) {
      p.each(a, function() {
        f(this.name, this.value)
      })
    } else {
      for (d in a) {
        ci(d, a[d], c, f)
      }
    }
    return e.join("&").replace(cd, "+")
  };
  var cj, ck, cl = /#.*$/, cm = /^(.*?):[ \t]*([^\r\n]*)\r?$/mg, cn = /^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/, co = /^(?:GET|HEAD)$/, cp = /^\/\//, cq = /\?/, cr = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, cs = /([?&])_=[^&]*/, ct = /^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/, cu = p.fn.load, cv = {}, cw = {}, cx = ["*/"] + ["*"];
  try {
    ck = f.href
  } catch (cy) {
    ck = e.createElement("a"), ck.href = "", ck = ck.href
  }
  cj = ct.exec(ck.toLowerCase()) || [], p.fn.load = function(a, c, d) {
    if (typeof a != "string" && cu) {
      return cu.apply(this, arguments)
    }
    if (!this.length) {
      return this
    }
    var e, f, g, h = this, i = a.indexOf(" ");
    return i >= 0 && (e = a.slice(i, a.length), a = a.slice(0, i)), p.isFunction(c) ? (d = c, c = b) : c && typeof c == "object" && (f = "POST"), p.ajax({url: a,type: f,dataType: "html",data: c,complete: function(a, b) {
      d && h.each(d, g || [a.responseText, b, a])
    }}).done(function(a) {
        g = arguments, h.html(e ? p("<div>").append(a.replace(cr, "")).find(e) : a)
      }), this
  }, p.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "), function(a, b) {
    p.fn[b] = function(a) {
      return this.on(b, a)
    }
  }), p.each(["get", "post"], function(a, c) {
    p[c] = function(a, d, e, f) {
      return p.isFunction(d) && (f = f || e, e = d, d = b), p.ajax({type: c,url: a,data: d,success: e,dataType: f})
    }
  }), p.extend({getScript: function(a, c) {
    return p.get(a, b, c, "script")
  },getJSON: function(a, b, c) {
    return p.get(a, b, c, "json")
  },ajaxSetup: function(a, b) {
    return b ? cB(a, p.ajaxSettings) : (b = a, a = p.ajaxSettings), cB(a, b), a
  },ajaxSettings: {url: ck,isLocal: cn.test(cj[1]),global: !0,type: "GET",contentType: "application/x-www-form-urlencoded; charset=UTF-8",processData: !0,async: !0,accepts: {xml: "application/xml, text/xml",html: "text/html",text: "text/plain",json: "application/json, text/javascript","*": cx},contents: {xml: /xml/,html: /html/,json: /json/},responseFields: {xml: "responseXML",text: "responseText"},converters: {"* text": a.String,"text html": !0,"text json": p.parseJSON,"text xml": p.parseXML},flatOptions: {context: !0,url: !0}},ajaxPrefilter: cz(cv),ajaxTransport: cz(cw),ajax: function(a, c) {
    function y(a, c, f, i) {
      var k, s, t, u, w, y = c;
      if (v === 2) {
        return
      }
      v = 2, h && clearTimeout(h), g = b, e = i || "", x.readyState = a > 0 ? 4 : 0, f && (u = cC(l, x, f));
      if (a >= 200 && a < 300 || a === 304) {
        l.ifModified && (w = x.getResponseHeader("Last-Modified"), w && (p.lastModified[d] = w), w = x.getResponseHeader("Etag"), w && (p.etag[d] = w)), a === 304 ? (y = "notmodified", k = !0) : (k = cD(l, u), y = k.state, s = k.data, t = k.error, k = !t)
      } else {
        t = y;
        if (!y || a) {
          y = "error", a < 0 && (a = 0)
        }
      }
      x.status = a, x.statusText = (c || y) + "", k ? o.resolveWith(m, [s, y, x]) : o.rejectWith(m, [x, y, t]), x.statusCode(r), r = b, j && n.trigger("ajax" + (k ? "Success" : "Error"), [x, l, k ? s : t]), q.fireWith(m, [x, y]), j && (n.trigger("ajaxComplete", [x, l]), --p.active || p.event.trigger("ajaxStop"))
    }
    typeof a == "object" && (c = a, a = b), c = c || {};
    var d, e, f, g, h, i, j, k, l = p.ajaxSetup({}, c), m = l.context || l, n = m !== l && (m.nodeType || m instanceof p) ? p(m) : p.event, o = p.Deferred(), q = p.Callbacks("once memory"), r = l.statusCode || {}, t = {}, u = {}, v = 0, w = "canceled", x = {readyState: 0,setRequestHeader: function(a, b) {
      if (!v) {
        var c = a.toLowerCase();
        a = u[c] = u[c] || a, t[a] = b
      }
      return this
    },getAllResponseHeaders: function() {
      return v === 2 ? e : null
    },getResponseHeader: function(a) {
      var c;
      if (v === 2) {
        if (!f) {
          f = {};
          while (c = cm.exec(e)) {
            f[c[1].toLowerCase()] = c[2]
          }
        }
        c = f[a.toLowerCase()]
      }
      return c === b ? null : c
    },overrideMimeType: function(a) {
      return v || (l.mimeType = a), this
    },abort: function(a) {
      return a = a || w, g && g.abort(a), y(0, a), this
    }};
    o.promise(x), x.success = x.done, x.error = x.fail, x.complete = q.add, x.statusCode = function(a) {
      if (a) {
        var b;
        if (v < 2) {
          for (b in a) {
            r[b] = [r[b], a[b]]
          }
        } else {
          b = a[x.status], x.always(b)
        }
      }
      return this
    }, l.url = ((a || l.url) + "").replace(cl, "").replace(cp, cj[1] + "//"), l.dataTypes = p.trim(l.dataType || "*").toLowerCase().split(s), l.crossDomain == null && (i = ct.exec(l.url.toLowerCase()) || !1, l.crossDomain = i && i.join(":") + (i[3] ? "" : i[1] === "http:" ? 80 : 443) !== cj.join(":") + (cj[3] ? "" : cj[1] === "http:" ? 80 : 443)), l.data && l.processData && typeof l.data != "string" && (l.data = p.param(l.data, l.traditional)), cA(cv, l, c, x);
    if (v === 2) {
      return x
    }
    j = l.global, l.type = l.type.toUpperCase(), l.hasContent = !co.test(l.type), j && p.active++ === 0 && p.event.trigger("ajaxStart");
    if (!l.hasContent) {
      l.data && (l.url += (cq.test(l.url) ? "&" : "?") + l.data, delete l.data), d = l.url;
      if (l.cache === !1) {
        var z = p.now(), A = l.url.replace(cs, "$1_=" + z);
        l.url = A + (A === l.url ? (cq.test(l.url) ? "&" : "?") + "_=" + z : "")
      }
    }
    (l.data && l.hasContent && l.contentType !== !1 || c.contentType) && x.setRequestHeader("Content-Type", l.contentType), l.ifModified && (d = d || l.url, p.lastModified[d] && x.setRequestHeader("If-Modified-Since", p.lastModified[d]), p.etag[d] && x.setRequestHeader("If-None-Match", p.etag[d])), x.setRequestHeader("Accept", l.dataTypes[0] && l.accepts[l.dataTypes[0]] ? l.accepts[l.dataTypes[0]] + (l.dataTypes[0] !== "*" ? ", " + cx + "; q=0.01" : "") : l.accepts["*"]);
    for (k in l.headers) {
      x.setRequestHeader(k, l.headers[k])
    }
    if (!l.beforeSend || l.beforeSend.call(m, x, l) !== !1 && v !== 2) {
      w = "abort";
      for (k in {success: 1,error: 1,complete: 1}) {
        x[k](l[k])
      }
      g = cA(cw, l, c, x);
      if (!g) {
        y(-1, "No Transport")
      } else {
        x.readyState = 1, j && n.trigger("ajaxSend", [x, l]), l.async && l.timeout > 0 && (h = setTimeout(function() {
          x.abort("timeout")
        }, l.timeout));
        try {
          v = 1, g.send(t, y)
        } catch (B) {
          if (v < 2) {
            y(-1, B)
          } else {
            throw B
          }
        }
      }
      return x
    }
    return x.abort()
  },active: 0,lastModified: {},etag: {}});
  var cE = [], cF = /\?/, cG = /(=)\?(?=&|$)|\?\?/, cH = p.now();
  p.ajaxSetup({jsonp: "callback",jsonpCallback: function() {
    var a = cE.pop() || p.expando + "_" + cH++;
    return this[a] = !0, a
  }}), p.ajaxPrefilter("json jsonp", function(c, d, e) {
    var f, g, h, i = c.data, j = c.url, k = c.jsonp !== !1, l = k && cG.test(j), m = k && !l && typeof i == "string" && !(c.contentType || "").indexOf("application/x-www-form-urlencoded") && cG.test(i);
    if (c.dataTypes[0] === "jsonp" || l || m) {
      return f = c.jsonpCallback = p.isFunction(c.jsonpCallback) ? c.jsonpCallback() : c.jsonpCallback, g = a[f], l ? c.url = j.replace(cG, "$1" + f) : m ? c.data = i.replace(cG, "$1" + f) : k && (c.url += (cF.test(j) ? "&" : "?") + c.jsonp + "=" + f), c.converters["script json"] = function() {
        return h || p.error(f + " was not called"), h[0]
      }, c.dataTypes[0] = "json", a[f] = function() {
        h = arguments
      }, e.always(function() {
        a[f] = g, c[f] && (c.jsonpCallback = d.jsonpCallback, cE.push(f)), h && p.isFunction(g) && g(h[0]), h = g = b
      }), "script"
    }
  }), p.ajaxSetup({accepts: {script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents: {script: /javascript|ecmascript/},converters: {"text script": function(a) {
    return p.globalEval(a), a
  }}}), p.ajaxPrefilter("script", function(a) {
    a.cache === b && (a.cache = !1), a.crossDomain && (a.type = "GET", a.global = !1)
  }), p.ajaxTransport("script", function(a) {
    if (a.crossDomain) {
      var c, d = e.head || e.getElementsByTagName("head")[0] || e.documentElement;
      return {send: function(f, g) {
        c = e.createElement("script"), c.async = "async", a.scriptCharset && (c.charset = a.scriptCharset), c.src = a.url, c.onload = c.onreadystatechange = function(a, e) {
          if (e || !c.readyState || /loaded|complete/.test(c.readyState)) {
            c.onload = c.onreadystatechange = null, d && c.parentNode && d.removeChild(c), c = b, e || g(200, "success")
          }
        }, d.insertBefore(c, d.firstChild)
      },abort: function() {
        c && c.onload(0, 1)
      }}
    }
  });
  var cI, cJ = a.ActiveXObject ? function() {
    for (var a in cI) {
      cI[a](0, 1)
    }
  } : !1, cK = 0;
  p.ajaxSettings.xhr = a.ActiveXObject ? function() {
    return !this.isLocal && cL() || cM()
  } : cL, function(a) {
    p.extend(p.support, {ajax: !!a,cors: !!a && "withCredentials" in a})
  }(p.ajaxSettings.xhr()), p.support.ajax && p.ajaxTransport(function(c) {
    if (!c.crossDomain || p.support.cors) {
      var d;
      return {send: function(e, f) {
        var g, h, i = c.xhr();
        c.username ? i.open(c.type, c.url, c.async, c.username, c.password) : i.open(c.type, c.url, c.async);
        if (c.xhrFields) {
          for (h in c.xhrFields) {
            i[h] = c.xhrFields[h]
          }
        }
        c.mimeType && i.overrideMimeType && i.overrideMimeType(c.mimeType), !c.crossDomain && !e["X-Requested-With"] && (e["X-Requested-With"] = "XMLHttpRequest");
        try {
          for (h in e) {
            i.setRequestHeader(h, e[h])
          }
        } catch (j) {
        }
        i.send(c.hasContent && c.data || null), d = function(a, e) {
          var h, j, k, l, m;
          try {
            if (d && (e || i.readyState === 4)) {
              d = b, g && (i.onreadystatechange = p.noop, cJ && delete cI[g]);
              if (e) {
                i.readyState !== 4 && i.abort()
              } else {
                h = i.status, k = i.getAllResponseHeaders(), l = {}, m = i.responseXML, m && m.documentElement && (l.xml = m);
                try {
                  l.text = i.responseText
                } catch (a) {
                }
                try {
                  j = i.statusText
                } catch (n) {
                  j = ""
                }
                !h && c.isLocal && !c.crossDomain ? h = l.text ? 200 : 404 : h === 1223 && (h = 204)
              }
            }
          } catch (o) {
            e || f(-1, o)
          }
          l && f(h, j, l, k)
        }, c.async ? i.readyState === 4 ? setTimeout(d, 0) : (g = ++cK, cJ && (cI || (cI = {}, p(a).unload(cJ)), cI[g] = d), i.onreadystatechange = d) : d()
      },abort: function() {
        d && d(0, 1)
      }}
    }
  });
  var cN, cO, cP = /^(?:toggle|show|hide)$/, cQ = new RegExp("^(?:([-+])=|)(" + q + ")([a-z%]*)$", "i"), cR = /queueHooks$/, cS = [cY], cT = {"*": [function(a, b) {
    var c, d, e = this.createTween(a, b), f = cQ.exec(b), g = e.cur(), h = +g || 0, i = 1, j = 20;
    if (f) {
      c = +f[2], d = f[3] || (p.cssNumber[a] ? "" : "px");
      if (d !== "px" && h) {
        h = p.css(e.elem, a, !0) || c || 1;
        do {
          i = i || ".5", h = h / i, p.style(e.elem, a, h + d)
        } while (i !== (i = e.cur() / g) && i !== 1 && --j)
      }
      e.unit = d, e.start = h, e.end = f[1] ? h + (f[1] + 1) * c : c
    }
    return e
  }]};
  p.Animation = p.extend(cW, {tweener: function(a, b) {
    p.isFunction(a) ? (b = a, a = ["*"]) : a = a.split(" ");
    var c, d = 0, e = a.length;
    for (; d < e; d++) {
      c = a[d], cT[c] = cT[c] || [], cT[c].unshift(b)
    }
  },prefilter: function(a, b) {
    b ? cS.unshift(a) : cS.push(a)
  }}), p.Tween = cZ, cZ.prototype = {constructor: cZ,init: function(a, b, c, d, e, f) {
    this.elem = a, this.prop = c, this.easing = e || "swing", this.options = b, this.start = this.now = this.cur(), this.end = d, this.unit = f || (p.cssNumber[c] ? "" : "px")
  },cur: function() {
    var a = cZ.propHooks[this.prop];
    return a && a.get ? a.get(this) : cZ.propHooks._default.get(this)
  },run: function(a) {
    var b, c = cZ.propHooks[this.prop];
    return this.options.duration ? this.pos = b = p.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration) : this.pos = b = a, this.now = (this.end - this.start) * b + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), c && c.set ? c.set(this) : cZ.propHooks._default.set(this), this
  }}, cZ.prototype.init.prototype = cZ.prototype, cZ.propHooks = {_default: {get: function(a) {
    var b;
    return a.elem[a.prop] == null || !!a.elem.style && a.elem.style[a.prop] != null ? (b = p.css(a.elem, a.prop, !1, ""), !b || b === "auto" ? 0 : b) : a.elem[a.prop]
  },set: function(a) {
    p.fx.step[a.prop] ? p.fx.step[a.prop](a) : a.elem.style && (a.elem.style[p.cssProps[a.prop]] != null || p.cssHooks[a.prop]) ? p.style(a.elem, a.prop, a.now + a.unit) : a.elem[a.prop] = a.now
  }}}, cZ.propHooks.scrollTop = cZ.propHooks.scrollLeft = {set: function(a) {
    a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now)
  }}, p.each(["toggle", "show", "hide"], function(a, b) {
    var c = p.fn[b];
    p.fn[b] = function(d, e, f) {
      return d == null || typeof d == "boolean" || !a && p.isFunction(d) && p.isFunction(e) ? c.apply(this, arguments) : this.animate(c$(b, !0), d, e, f)
    }
  }), p.fn.extend({fadeTo: function(a, b, c, d) {
    return this.filter(bZ).css("opacity", 0).show().end().animate({opacity: b}, a, c, d)
  },animate: function(a, b, c, d) {
    var e = p.isEmptyObject(a), f = p.speed(b, c, d), g = function() {
      var b = cW(this, p.extend({}, a), f);
      e && b.stop(!0)
    };
    return e || f.queue === !1 ? this.each(g) : this.queue(f.queue, g)
  },stop: function(a, c, d) {
    var e = function(a) {
      var b = a.stop;
      delete a.stop, b(d)
    };
    return typeof a != "string" && (d = c, c = a, a = b), c && a !== !1 && this.queue(a || "fx", []), this.each(function() {
      var b = !0, c = a != null && a + "queueHooks", f = p.timers, g = p._data(this);
      if (c) {
        g[c] && g[c].stop && e(g[c])
      } else {
        for (c in g) {
          g[c] && g[c].stop && cR.test(c) && e(g[c])
        }
      }
      for (c = f.length; c--; ) {
        f[c].elem === this && (a == null || f[c].queue === a) && (f[c].anim.stop(d), b = !1, f.splice(c, 1))
      }
      (b || !d) && p.dequeue(this, a)
    })
  }}), p.each({slideDown: c$("show"),slideUp: c$("hide"),slideToggle: c$("toggle"),fadeIn: {opacity: "show"},fadeOut: {opacity: "hide"},fadeToggle: {opacity: "toggle"}}, function(a, b) {
    p.fn[a] = function(a, c, d) {
      return this.animate(b, a, c, d)
    }
  }), p.speed = function(a, b, c) {
    var d = a && typeof a == "object" ? p.extend({}, a) : {complete: c || !c && b || p.isFunction(a) && a,duration: a,easing: c && b || b && !p.isFunction(b) && b};
    d.duration = p.fx.off ? 0 : typeof d.duration == "number" ? d.duration : d.duration in p.fx.speeds ? p.fx.speeds[d.duration] : p.fx.speeds._default;
    if (d.queue == null || d.queue === !0) {
      d.queue = "fx"
    }
    return d.old = d.complete, d.complete = function() {
      p.isFunction(d.old) && d.old.call(this), d.queue && p.dequeue(this, d.queue)
    }, d
  }, p.easing = {linear: function(a) {
    return a
  },swing: function(a) {
    return 0.5 - Math.cos(a * Math.PI) / 2
  }}, p.timers = [], p.fx = cZ.prototype.init, p.fx.tick = function() {
    var a, b = p.timers, c = 0;
    for (; c < b.length; c++) {
      a = b[c], !a() && b[c] === a && b.splice(c--, 1)
    }
    b.length || p.fx.stop()
  }, p.fx.timer = function(a) {
    a() && p.timers.push(a) && !cO && (cO = setInterval(p.fx.tick, p.fx.interval))
  }, p.fx.interval = 13, p.fx.stop = function() {
    clearInterval(cO), cO = null
  }, p.fx.speeds = {slow: 600,fast: 200,_default: 400}, p.fx.step = {}, p.expr && p.expr.filters && (p.expr.filters.animated = function(a) {
    return p.grep(p.timers, function(b) {
      return a === b.elem
    }).length
  });
  var c_ = /^(?:body|html)$/i;
  p.fn.offset = function(a) {
    if (arguments.length) {
      return a === b ? this : this.each(function(b) {
        p.offset.setOffset(this, a, b)
      })
    }
    var c, d, e, f, g, h, i, j = {top: 0,left: 0}, k = this[0], l = k && k.ownerDocument;
    if (!l) {
      return
    }
    return (d = l.body) === k ? p.offset.bodyOffset(k) : (c = l.documentElement, p.contains(c, k) ? (typeof k.getBoundingClientRect != "undefined" && (j = k.getBoundingClientRect()), e = da(l), f = c.clientTop || d.clientTop || 0, g = c.clientLeft || d.clientLeft || 0, h = e.pageYOffset || c.scrollTop, i = e.pageXOffset || c.scrollLeft, {top: j.top + h - f,left: j.left + i - g}) : j)
  }, p.offset = {bodyOffset: function(a) {
    var b = a.offsetTop, c = a.offsetLeft;
    return p.support.doesNotIncludeMarginInBodyOffset && (b += parseFloat(p.css(a, "marginTop")) || 0, c += parseFloat(p.css(a, "marginLeft")) || 0), {top: b,left: c}
  },setOffset: function(a, b, c) {
    var d = p.css(a, "position");
    d === "static" && (a.style.position = "relative");
    var e = p(a), f = e.offset(), g = p.css(a, "top"), h = p.css(a, "left"), i = (d === "absolute" || d === "fixed") && p.inArray("auto", [g, h]) > -1, j = {}, k = {}, l, m;
    i ? (k = e.position(), l = k.top, m = k.left) : (l = parseFloat(g) || 0, m = parseFloat(h) || 0), p.isFunction(b) && (b = b.call(a, c, f)), b.top != null && (j.top = b.top - f.top + l), b.left != null && (j.left = b.left - f.left + m), "using" in b ? b.using.call(a, j) : e.css(j)
  }}, p.fn.extend({position: function() {
    if (!this[0]) {
      return
    }
    var a = this[0], b = this.offsetParent(), c = this.offset(), d = c_.test(b[0].nodeName) ? {top: 0,left: 0} : b.offset();
    return c.top -= parseFloat(p.css(a, "marginTop")) || 0, c.left -= parseFloat(p.css(a, "marginLeft")) || 0, d.top += parseFloat(p.css(b[0], "borderTopWidth")) || 0, d.left += parseFloat(p.css(b[0], "borderLeftWidth")) || 0, {top: c.top - d.top,left: c.left - d.left}
  },offsetParent: function() {
    return this.map(function() {
      var a = this.offsetParent || e.body;
      while (a && !c_.test(a.nodeName) && p.css(a, "position") === "static") {
        a = a.offsetParent
      }
      return a || e.body
    })
  }}), p.each({scrollLeft: "pageXOffset",scrollTop: "pageYOffset"}, function(a, c) {
    var d = /Y/.test(c);
    p.fn[a] = function(e) {
      return p.access(this, function(a, e, f) {
        var g = da(a);
        if (f === b) {
          return g ? c in g ? g[c] : g.document.documentElement[e] : a[e]
        }
        g ? g.scrollTo(d ? p(g).scrollLeft() : f, d ? f : p(g).scrollTop()) : a[e] = f
      }, a, e, arguments.length, null)
    }
  }), p.each({Height: "height",Width: "width"}, function(a, c) {
    p.each({padding: "inner" + a,content: c,"": "outer" + a}, function(d, e) {
      p.fn[e] = function(e, f) {
        var g = arguments.length && (d || typeof e != "boolean"), h = d || (e === !0 || f === !0 ? "margin" : "border");
        return p.access(this, function(c, d, e) {
          var f;
          return p.isWindow(c) ? c.document.documentElement["client" + a] : c.nodeType === 9 ? (f = c.documentElement, Math.max(c.body["scroll" + a], f["scroll" + a], c.body["offset" + a], f["offset" + a], f["client" + a])) : e === b ? p.css(c, d, e, h) : p.style(c, d, e, h)
        }, c, g ? e : b, g, null)
      }
    })
  }), a.jQuery = a.$ = p, typeof define == "function" && define.amd && define.amd.jQuery && define("jquery", [], function() {
    return p
  })
})(window);
/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(b, c) {
  var $ = b.jQuery || b.Cowboy || (b.Cowboy = {}), a;
  $.throttle = a = function(e, f, l, k) {
    var h, d = 0;
    if (typeof f !== "boolean") {
      k = l;
      l = f;
      f = c
    }
    function g() {
      var q = this, o = +new Date() - d, p = arguments;
      function n() {
        d = +new Date();
        l.apply(q, p)
      }
      function m() {
        h = c
      }
      if (k && !h) {
        n()
      }
      h && clearTimeout(h);
      if (k === c && o > e) {
        n()
      } else {
        if (f !== true) {
          h = setTimeout(k ? m : n, k === c ? e - o : e)
        }
      }
    }
    if ($.guid) {
      g.guid = l.guid = l.guid || $.guid++
    }
    return g
  };
  $.debounce = function(d, e, f) {
    return f === c ? a(d, e, false) : a(d, f, e !== false)
  }
})(this);
/* jQuery UI - v1.9.2 - 2013-02-14
 * http://jqueryui.com
 * Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js
 * Copyright (c) 2013 jQuery Foundation and other contributors Licensed MIT */
(function(f, b) {
  function a(k, p) {
    var l, h, m, e = k.nodeName.toLowerCase();
    return "area" === e ? (l = k.parentNode, h = l.name, !k.href || !h || l.nodeName.toLowerCase() !== "map" ? !1 : (m = f("img[usemap=#" + h + "]")[0], !!m && c(m))) : (/input|select|textarea|button|object/.test(e) ? !k.disabled : "a" === e ? k.href || p : p) && c(k)
  }
  function c(e) {
    return f.expr.filters.visible(e) && !f(e).parents().andSelf().filter(function() {
      return f.css(this, "visibility") === "hidden"
    }).length
  }
  var g = 0, d = /^ui-id-\d+$/;
  f.ui = f.ui || {};
  if (f.ui.version) {
    return
  }
  f.extend(f.ui, {version: "1.9.2",keyCode: {BACKSPACE: 8,COMMA: 188,DELETE: 46,DOWN: 40,END: 35,ENTER: 13,ESCAPE: 27,HOME: 36,LEFT: 37,NUMPAD_ADD: 107,NUMPAD_DECIMAL: 110,NUMPAD_DIVIDE: 111,NUMPAD_ENTER: 108,NUMPAD_MULTIPLY: 106,NUMPAD_SUBTRACT: 109,PAGE_DOWN: 34,PAGE_UP: 33,PERIOD: 190,RIGHT: 39,SPACE: 32,TAB: 9,UP: 38}}), f.fn.extend({_focus: f.fn.focus,focus: function(e, h) {
    return typeof e == "number" ? this.each(function() {
      var k = this;
      setTimeout(function() {
        f(k).focus(), h && h.call(k)
      }, e)
    }) : this._focus.apply(this, arguments)
  },scrollParent: function() {
    var e;
    return f.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? e = this.parents().filter(function() {
      return /(relative|absolute|fixed)/.test(f.css(this, "position")) && /(auto|scroll)/.test(f.css(this, "overflow") + f.css(this, "overflow-y") + f.css(this, "overflow-x"))
    }).eq(0) : e = this.parents().filter(function() {
      return /(auto|scroll)/.test(f.css(this, "overflow") + f.css(this, "overflow-y") + f.css(this, "overflow-x"))
    }).eq(0), /fixed/.test(this.css("position")) || !e.length ? f(document) : e
  },zIndex: function(l) {
    if (l !== b) {
      return this.css("zIndex", l)
    }
    if (this.length) {
      var k = f(this[0]), e, h;
      while (k.length && k[0] !== document) {
        e = k.css("position");
        if (e === "absolute" || e === "relative" || e === "fixed") {
          h = parseInt(k.css("zIndex"), 10);
          if (!isNaN(h) && h !== 0) {
            return h
          }
        }
        k = k.parent()
      }
    }
    return 0
  },uniqueId: function() {
    return this.each(function() {
      this.id || (this.id = "ui-id-" + ++g)
    })
  },removeUniqueId: function() {
    return this.each(function() {
      d.test(this.id) && f(this).removeAttr("id")
    })
  }}), f.extend(f.expr[":"], {data: f.expr.createPseudo ? f.expr.createPseudo(function(e) {
    return function(h) {
      return !!f.data(h, e)
    }
  }) : function(e, k, h) {
    return !!f.data(e, h[3])
  },focusable: function(e) {
    return a(e, !isNaN(f.attr(e, "tabindex")))
  },tabbable: function(e) {
    var k = f.attr(e, "tabindex"), h = isNaN(k);
    return (h || k >= 0) && a(e, !h)
  }}), f(function() {
    var e = document.body, h = e.appendChild(h = document.createElement("div"));
    h.offsetHeight, f.extend(h.style, {minHeight: "100px",height: "auto",padding: 0,borderWidth: 0}), f.support.minHeight = h.offsetHeight === 100, f.support.selectstart = "onselectstart" in h, e.removeChild(h).style.display = "none"
  }), f("<a>").outerWidth(1).jquery || f.each(["Width", "Height"], function(p, l) {
    function e(o, v, u, q) {
      return f.each(h, function() {
        v -= parseFloat(f.css(o, "padding" + this)) || 0, u && (v -= parseFloat(f.css(o, "border" + this + "Width")) || 0), q && (v -= parseFloat(f.css(o, "margin" + this)) || 0)
      }), v
    }
    var h = l === "Width" ? ["Left", "Right"] : ["Top", "Bottom"], k = l.toLowerCase(), m = {innerWidth: f.fn.innerWidth,innerHeight: f.fn.innerHeight,outerWidth: f.fn.outerWidth,outerHeight: f.fn.outerHeight};
    f.fn["inner" + l] = function(o) {
      return o === b ? m["inner" + l].call(this) : this.each(function() {
        f(this).css(k, e(this, o) + "px")
      })
    }, f.fn["outer" + l] = function(o, q) {
      return typeof o != "number" ? m["outer" + l].call(this, o) : this.each(function() {
        f(this).css(k, e(this, o, !0, q) + "px")
      })
    }
  }), f("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (f.fn.removeData = function(e) {
    return function(h) {
      return arguments.length ? e.call(this, f.camelCase(h)) : e.call(this)
    }
  }(f.fn.removeData)), function() {
    var e = /msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase()) || [];
    f.ui.ie = e.length ? !0 : !1, f.ui.ie6 = parseFloat(e[1], 10) === 6
  }(), f.fn.extend({disableSelection: function() {
    return this.bind((f.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function(h) {
      h.preventDefault()
    })
  },enableSelection: function() {
    return this.unbind(".ui-disableSelection")
  }}), f.extend(f.ui, {plugin: {add: function(h, m, l) {
    var e, k = f.ui[h].prototype;
    for (e in l) {
      k.plugins[e] = k.plugins[e] || [], k.plugins[e].push([m, l[e]])
    }
  },call: function(m, k, o) {
    var l, h = m.plugins[k];
    if (!h || !m.element[0].parentNode || m.element[0].parentNode.nodeType === 11) {
      return
    }
    for (l = 0; l < h.length; l++) {
      m.options[h[l][0]] && h[l][1].apply(m.element, o)
    }
  }},contains: f.contains,hasScroll: function(h, l) {
    if (f(h).css("overflow") === "hidden") {
      return !1
    }
    var k = l && l === "left" ? "scrollLeft" : "scrollTop", e = !1;
    return h[k] > 0 ? !0 : (h[k] = 1, e = h[k] > 0, h[k] = 0, e)
  },isOverAxis: function(k, h, l) {
    return k > h && k < h + l
  },isOver: function(h, p, l, e, k, m) {
    return f.ui.isOverAxis(h, l, k) && f.ui.isOverAxis(p, e, m)
  }})
})(jQuery);
(function(d, b) {
  var f = 0, c = Array.prototype.slice, a = d.cleanData;
  d.cleanData = function(e) {
    for (var k = 0, h; (h = e[k]) != null; k++) {
      try {
        d(h).triggerHandler("remove")
      } catch (g) {
      }
    }
    a(e)
  }, d.widget = function(k, q, m) {
    var h, l, p, g, e = k.split(".")[0];
    k = k.split(".")[1], h = e + "-" + k, m || (m = q, q = d.Widget), d.expr[":"][h.toLowerCase()] = function(n) {
      return !!d.data(n, h)
    }, d[e] = d[e] || {}, l = d[e][k], p = d[e][k] = function(o, n) {
      if (!this._createWidget) {
        return new p(o, n)
      }
      arguments.length && this._createWidget(o, n)
    }, d.extend(p, l, {version: m.version,_proto: d.extend({}, m),_childConstructors: []}), g = new q, g.options = d.widget.extend({}, g.options), d.each(m, function(o, n) {
      d.isFunction(n) && (m[o] = function() {
        var t = function() {
          return q.prototype[o].apply(this, arguments)
        }, s = function(r) {
          return q.prototype[o].apply(this, r)
        };
        return function() {
          var r = this._super, v = this._superApply, u;
          return this._super = t, this._superApply = s, u = n.apply(this, arguments), this._super = r, this._superApply = v, u
        }
      }())
    }), p.prototype = d.widget.extend(g, {widgetEventPrefix: l ? g.widgetEventPrefix : k}, m, {constructor: p,namespace: e,widgetName: k,widgetBaseClass: h,widgetFullName: h}), l ? (d.each(l._childConstructors, function(o, u) {
      var s = u.prototype;
      d.widget(s.namespace + "." + s.widgetName, p, u._proto)
    }), delete l._childConstructors) : q._childConstructors.push(p), d.widget.bridge(k, p)
  }, d.widget.extend = function(m) {
    var h = c.call(arguments, 1), k = 0, l = h.length, g, e;
    for (; k < l; k++) {
      for (g in h[k]) {
        e = h[k][g], h[k].hasOwnProperty(g) && e !== b && (d.isPlainObject(e) ? m[g] = d.isPlainObject(m[g]) ? d.widget.extend({}, m[g], e) : d.widget.extend({}, e) : m[g] = e)
      }
    }
    return m
  }, d.widget.bridge = function(h, e) {
    var g = e.prototype.widgetFullName || h;
    d.fn[h] = function(n) {
      var l = typeof n == "string", k = c.call(arguments, 1), m = this;
      return n = !l && k.length ? d.widget.extend.apply(null, [n].concat(k)) : n, l ? this.each(function() {
        var p, o = d.data(this, g);
        if (!o) {
          return d.error("cannot call methods on " + h + " prior to initialization; attempted to call method '" + n + "'")
        }
        if (!d.isFunction(o[n]) || n.charAt(0) === "_") {
          return d.error("no such method '" + n + "' for " + h + " widget instance")
        }
        p = o[n].apply(o, k);
        if (p !== o && p !== b) {
          return m = p && p.jquery ? m.pushStack(p.get()) : p, !1
        }
      }) : this.each(function() {
        var o = d.data(this, g);
        o ? o.option(n || {})._init() : d.data(this, g, new e(n, this))
      }), m
    }
  }, d.Widget = function() {
  }, d.Widget._childConstructors = [], d.Widget.prototype = {widgetName: "widget",widgetEventPrefix: "",defaultElement: "<div>",options: {disabled: !1,create: null},_createWidget: function(e, g) {
    g = d(g || this.defaultElement || this)[0], this.element = d(g), this.uuid = f++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = d.widget.extend({}, this.options, this._getCreateOptions(), e), this.bindings = d(), this.hoverable = d(), this.focusable = d(), g !== this && (d.data(g, this.widgetName, this), d.data(g, this.widgetFullName, this), this._on(!0, this.element, {remove: function(h) {
      h.target === g && this.destroy()
    }}), this.document = d(g.style ? g.ownerDocument : g.document || g), this.window = d(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
  },_getCreateOptions: d.noop,_getCreateEventData: d.noop,_create: d.noop,_init: d.noop,destroy: function() {
    this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(d.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
  },_destroy: d.noop,widget: function() {
    return this.element
  },option: function(m, k) {
    var g = m, h, l, e;
    if (arguments.length === 0) {
      return d.widget.extend({}, this.options)
    }
    if (typeof m == "string") {
      g = {}, h = m.split("."), m = h.shift();
      if (h.length) {
        l = g[m] = d.widget.extend({}, this.options[m]);
        for (e = 0; e < h.length - 1; e++) {
          l[h[e]] = l[h[e]] || {}, l = l[h[e]]
        }
        m = h.pop();
        if (k === b) {
          return l[m] === b ? null : l[m]
        }
        l[m] = k
      } else {
        if (k === b) {
          return this.options[m] === b ? null : this.options[m]
        }
        g[m] = k
      }
    }
    return this._setOptions(g), this
  },_setOptions: function(h) {
    var g;
    for (g in h) {
      this._setOption(g, h[g])
    }
    return this
  },_setOption: function(h, g) {
    return this.options[h] = g, h === "disabled" && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!g).attr("aria-disabled", g), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
  },enable: function() {
    return this._setOption("disabled", !1)
  },disable: function() {
    return this._setOption("disabled", !0)
  },_on: function(g, l, k) {
    var e, h = this;
    typeof g != "boolean" && (k = l, l = g, g = !1), k ? (l = e = d(l), this.bindings = this.bindings.add(l)) : (k = l, l = this.element, e = this.widget()), d.each(k, function(q, t) {
      function p() {
        if (!g && (h.options.disabled === !0 || d(this).hasClass("ui-state-disabled"))) {
          return
        }
        return (typeof t == "string" ? h[t] : t).apply(h, arguments)
      }
      typeof t != "string" && (p.guid = t.guid = t.guid || p.guid || d.guid++);
      var n = q.match(/^(\w+)\s*(.*)$/), s = n[1] + h.eventNamespace, m = n[2];
      m ? e.delegate(m, s, p) : l.bind(s, p)
    })
  },_off: function(h, g) {
    g = (g || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, h.unbind(g).undelegate(g)
  },_delay: function(k, g) {
    function l() {
      return (typeof k == "string" ? h[k] : k).apply(h, arguments)
    }
    var h = this;
    return setTimeout(l, g || 0)
  },_hoverable: function(e) {
    this.hoverable = this.hoverable.add(e), this._on(e, {mouseenter: function(g) {
      d(g.currentTarget).addClass("ui-state-hover")
    },mouseleave: function(g) {
      d(g.currentTarget).removeClass("ui-state-hover")
    }})
  },_focusable: function(e) {
    this.focusable = this.focusable.add(e), this._on(e, {focusin: function(g) {
      d(g.currentTarget).addClass("ui-state-focus")
    },focusout: function(g) {
      d(g.currentTarget).removeClass("ui-state-focus")
    }})
  },_trigger: function(g, m, k) {
    var e, h, l = this.options[g];
    k = k || {}, m = d.Event(m), m.type = (g === this.widgetEventPrefix ? g : this.widgetEventPrefix + g).toLowerCase(), m.target = this.element[0], h = m.originalEvent;
    if (h) {
      for (e in h) {
        e in m || (m[e] = h[e])
      }
    }
    return this.element.trigger(m, k), !(d.isFunction(l) && l.apply(this.element[0], [m].concat(k)) === !1 || m.isDefaultPrevented())
  }}, d.each({show: "fadeIn",hide: "fadeOut"}, function(e, g) {
    d.Widget.prototype["_" + e] = function(m, k, l) {
      typeof k == "string" && (k = {effect: k});
      var n, h = k ? k === !0 || typeof k == "number" ? g : k.effect || g : e;
      k = k || {}, typeof k == "number" && (k = {duration: k}), n = !d.isEmptyObject(k), k.complete = l, k.delay && m.delay(k.delay), n && d.effects && (d.effects.effect[h] || d.uiBackCompat !== !1 && d.effects[h]) ? m[e](k) : h !== e && m[h] ? m[h](k.duration, k.easing, l) : m.queue(function(o) {
        d(this)[e](), l && l.call(m[0]), o()
      })
    }
  }), d.uiBackCompat !== !1 && (d.Widget.prototype._getCreateOptions = function() {
    return d.metadata && d.metadata.get(this.element[0])[this.widgetName]
  })
})(jQuery);
(function(b, a) {
  var c = !1;
  b(document).mouseup(function(d) {
    c = !1
  }), b.widget("ui.mouse", {version: "1.9.2",options: {cancel: "input,textarea,button,select,option",distance: 1,delay: 0},_mouseInit: function() {
    var d = this;
    this.element.bind("mousedown." + this.widgetName, function(f) {
      return d._mouseDown(f)
    }).bind("click." + this.widgetName, function(e) {
        if (!0 === b.data(e.target, d.widgetName + ".preventClickEvent")) {
          return b.removeData(e.target, d.widgetName + ".preventClickEvent"), e.stopImmediatePropagation(), !1
        }
      }), this.started = !1
  },_mouseDestroy: function() {
    this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && b(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
  },_mouseDown: function(e) {
    if (c) {
      return
    }
    this._mouseStarted && this._mouseUp(e), this._mouseDownEvent = e;
    var g = this, d = e.which === 1, f = typeof this.options.cancel == "string" && e.target.nodeName ? b(e.target).closest(this.options.cancel).length : !1;
    if (!d || f || !this._mouseCapture(e)) {
      return !0
    }
    this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
      g.mouseDelayMet = !0
    }, this.options.delay));
    if (this._mouseDistanceMet(e) && this._mouseDelayMet(e)) {
      this._mouseStarted = this._mouseStart(e) !== !1;
      if (!this._mouseStarted) {
        return e.preventDefault(), !0
      }
    }
    return !0 === b.data(e.target, this.widgetName + ".preventClickEvent") && b.removeData(e.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(h) {
      return g._mouseMove(h)
    }, this._mouseUpDelegate = function(h) {
      return g._mouseUp(h)
    }, b(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), e.preventDefault(), c = !0, !0
  },_mouseMove: function(d) {
    return !b.ui.ie || document.documentMode >= 9 || !!d.button ? this._mouseStarted ? (this._mouseDrag(d), d.preventDefault()) : (this._mouseDistanceMet(d) && this._mouseDelayMet(d) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, d) !== !1, this._mouseStarted ? this._mouseDrag(d) : this._mouseUp(d)), !this._mouseStarted) : this._mouseUp(d)
  },_mouseUp: function(d) {
    return b(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, d.target === this._mouseDownEvent.target && b.data(d.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(d)), !1
  },_mouseDistanceMet: function(d) {
    return Math.max(Math.abs(this._mouseDownEvent.pageX - d.pageX), Math.abs(this._mouseDownEvent.pageY - d.pageY)) >= this.options.distance
  },_mouseDelayMet: function(d) {
    return this.mouseDelayMet
  },_mouseStart: function(d) {
  },_mouseDrag: function(d) {
  },_mouseStop: function(d) {
  },_mouseCapture: function(d) {
    return !0
  }})
})(jQuery);
(function(b, a) {
  b.widget("ui.draggable", b.ui.mouse, {version: "1.9.2",widgetEventPrefix: "drag",options: {addClasses: !0,appendTo: "parent",axis: !1,connectToSortable: !1,containment: !1,cursor: "auto",cursorAt: !1,grid: !1,handle: !1,helper: "original",iframeFix: !1,opacity: !1,refreshPositions: !1,revert: !1,revertDuration: 500,scope: "default",scroll: !0,scrollSensitivity: 20,scrollSpeed: 20,snap: !1,snapMode: "both",snapTolerance: 20,stack: !1,zIndex: !1},_create: function() {
    this.options.helper == "original" && !/^(?:r|a|f)/.test(this.element.css("position")) && (this.element[0].style.position = "relative"), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._mouseInit()
  },_destroy: function() {
    this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy()
  },_mouseCapture: function(c) {
    var d = this.options;
    return this.helper || d.disabled || b(c.target).is(".ui-resizable-handle") ? !1 : (this.handle = this._getHandle(c), this.handle ? (b(d.iframeFix === !0 ? "iframe" : d.iframeFix).each(function() {
      b('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width: this.offsetWidth + "px",height: this.offsetHeight + "px",position: "absolute",opacity: "0.001",zIndex: 1000}).css(b(this).offset()).appendTo("body")
    }), !0) : !1)
  },_mouseStart: function(c) {
    var d = this.options;
    return this.helper = this._createHelper(c), this.helper.addClass("ui-draggable-dragging"), this._cacheHelperProportions(), b.ui.ddmanager && (b.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offset = this.positionAbs = this.element.offset(), this.offset = {top: this.offset.top - this.margins.top,left: this.offset.left - this.margins.left}, b.extend(this.offset, {click: {left: c.pageX - this.offset.left,top: c.pageY - this.offset.top},parent: this._getParentOffset(),relative: this._getRelativeOffset()}), this.originalPosition = this.position = this._generatePosition(c), this.originalPageX = c.pageX, this.originalPageY = c.pageY, d.cursorAt && this._adjustOffsetFromHelper(d.cursorAt), d.containment && this._setContainment(), this._trigger("start", c) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), b.ui.ddmanager && !d.dropBehaviour && b.ui.ddmanager.prepareOffsets(this, c), this._mouseDrag(c, !0), b.ui.ddmanager && b.ui.ddmanager.dragStart(this, c), !0)
  },_mouseDrag: function(c, e) {
    this.position = this._generatePosition(c), this.positionAbs = this._convertPositionTo("absolute");
    if (!e) {
      var d = this._uiHash();
      if (this._trigger("drag", c, d) === !1) {
        return this._mouseUp({}), !1
      }
      this.position = d.position
    }
    if (!this.options.axis || this.options.axis != "y") {
      this.helper[0].style.left = this.position.left + "px"
    }
    if (!this.options.axis || this.options.axis != "x") {
      this.helper[0].style.top = this.position.top + "px"
    }
    return b.ui.ddmanager && b.ui.ddmanager.drag(this, c), !1
  },_mouseStop: function(d) {
    var g = !1;
    b.ui.ddmanager && !this.options.dropBehaviour && (g = b.ui.ddmanager.drop(this, d)), this.dropped && (g = this.dropped, this.dropped = !1);
    var f = this.element[0], c = !1;
    while (f && (f = f.parentNode)) {
      f == document && (c = !0)
    }
    if (!c && this.options.helper === "original") {
      return !1
    }
    if (this.options.revert == "invalid" && !g || this.options.revert == "valid" && g || this.options.revert === !0 || b.isFunction(this.options.revert) && this.options.revert.call(this.element, g)) {
      var e = this;
      b(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
        e._trigger("stop", d) !== !1 && e._clear()
      })
    } else {
      this._trigger("stop", d) !== !1 && this._clear()
    }
    return !1
  },_mouseUp: function(c) {
    return b("div.ui-draggable-iframeFix").each(function() {
      this.parentNode.removeChild(this)
    }), b.ui.ddmanager && b.ui.ddmanager.dragStop(this, c), b.ui.mouse.prototype._mouseUp.call(this, c)
  },cancel: function() {
    return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
  },_getHandle: function(c) {
    var d = !this.options.handle || !b(this.options.handle, this.element).length ? !0 : !1;
    return b(this.options.handle, this.element).find("*").andSelf().each(function() {
      this == c.target && (d = !0)
    }), d
  },_createHelper: function(c) {
    var e = this.options, d = b.isFunction(e.helper) ? b(e.helper.apply(this.element[0], [c])) : e.helper == "clone" ? this.element.clone().removeAttr("id") : this.element;
    return d.parents("body").length || d.appendTo(e.appendTo == "parent" ? this.element[0].parentNode : e.appendTo), d[0] != this.element[0] && !/(fixed|absolute)/.test(d.css("position")) && d.css("position", "absolute"), d
  },_adjustOffsetFromHelper: function(c) {
    typeof c == "string" && (c = c.split(" ")), b.isArray(c) && (c = {left: +c[0],top: +c[1] || 0}), "left" in c && (this.offset.click.left = c.left + this.margins.left), "right" in c && (this.offset.click.left = this.helperProportions.width - c.right + this.margins.left), "top" in c && (this.offset.click.top = c.top + this.margins.top), "bottom" in c && (this.offset.click.top = this.helperProportions.height - c.bottom + this.margins.top)
  },_getParentOffset: function() {
    this.offsetParent = this.helper.offsetParent();
    var c = this.offsetParent.offset();
    this.cssPosition == "absolute" && this.scrollParent[0] != document && b.contains(this.scrollParent[0], this.offsetParent[0]) && (c.left += this.scrollParent.scrollLeft(), c.top += this.scrollParent.scrollTop());
    if (this.offsetParent[0] == document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() == "html" && b.ui.ie) {
      c = {top: 0,left: 0}
    }
    return {top: c.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),left: c.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
  },_getRelativeOffset: function() {
    if (this.cssPosition == "relative") {
      var c = this.element.position();
      return {top: c.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),left: c.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
    }
    return {top: 0,left: 0}
  },_cacheMargins: function() {
    this.margins = {left: parseInt(this.element.css("marginLeft"), 10) || 0,top: parseInt(this.element.css("marginTop"), 10) || 0,right: parseInt(this.element.css("marginRight"), 10) || 0,bottom: parseInt(this.element.css("marginBottom"), 10) || 0}
  },_cacheHelperProportions: function() {
    this.helperProportions = {width: this.helper.outerWidth(),height: this.helper.outerHeight()}
  },_setContainment: function() {
    var d = this.options;
    d.containment == "parent" && (d.containment = this.helper[0].parentNode);
    if (d.containment == "document" || d.containment == "window") {
      this.containment = [d.containment == "document" ? 0 : b(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, d.containment == "document" ? 0 : b(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, (d.containment == "document" ? 0 : b(window).scrollLeft()) + b(d.containment == "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (d.containment == "document" ? 0 : b(window).scrollTop()) + (b(d.containment == "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]
    }
    if (!/^(document|window|parent)$/.test(d.containment) && d.containment.constructor != Array) {
      var g = b(d.containment), f = g[0];
      if (!f) {
        return
      }
      var c = g.offset(), e = b(f).css("overflow") != "hidden";
      this.containment = [(parseInt(b(f).css("borderLeftWidth"), 10) || 0) + (parseInt(b(f).css("paddingLeft"), 10) || 0), (parseInt(b(f).css("borderTopWidth"), 10) || 0) + (parseInt(b(f).css("paddingTop"), 10) || 0), (e ? Math.max(f.scrollWidth, f.offsetWidth) : f.offsetWidth) - (parseInt(b(f).css("borderLeftWidth"), 10) || 0) - (parseInt(b(f).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (e ? Math.max(f.scrollHeight, f.offsetHeight) : f.offsetHeight) - (parseInt(b(f).css("borderTopWidth"), 10) || 0) - (parseInt(b(f).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = g
    } else {
      d.containment.constructor == Array && (this.containment = d.containment)
    }
  },_convertPositionTo: function(d, h) {
    h || (h = this.position);
    var f = d == "absolute" ? 1 : -1, c = this.options, e = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!b.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, g = /(html|body)/i.test(e[0].tagName);
    return {top: h.top + this.offset.relative.top * f + this.offset.parent.top * f - (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : g ? 0 : e.scrollTop()) * f,left: h.left + this.offset.relative.left * f + this.offset.parent.left * f - (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : g ? 0 : e.scrollLeft()) * f}
  },_generatePosition: function(q) {
    var e = this.options, c = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!b.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, h = /(html|body)/i.test(c[0].tagName), v = q.pageX, d = q.pageY;
    if (this.originalPosition) {
      var p;
      if (this.containment) {
        if (this.relative_container) {
          var m = this.relative_container.offset();
          p = [this.containment[0] + m.left, this.containment[1] + m.top, this.containment[2] + m.left, this.containment[3] + m.top]
        } else {
          p = this.containment
        }
        q.pageX - this.offset.click.left < p[0] && (v = p[0] + this.offset.click.left), q.pageY - this.offset.click.top < p[1] && (d = p[1] + this.offset.click.top), q.pageX - this.offset.click.left > p[2] && (v = p[2] + this.offset.click.left), q.pageY - this.offset.click.top > p[3] && (d = p[3] + this.offset.click.top)
      }
      if (e.grid) {
        var k = e.grid[1] ? this.originalPageY + Math.round((d - this.originalPageY) / e.grid[1]) * e.grid[1] : this.originalPageY;
        d = p ? k - this.offset.click.top < p[1] || k - this.offset.click.top > p[3] ? k - this.offset.click.top < p[1] ? k + e.grid[1] : k - e.grid[1] : k : k;
        var g = e.grid[0] ? this.originalPageX + Math.round((v - this.originalPageX) / e.grid[0]) * e.grid[0] : this.originalPageX;
        v = p ? g - this.offset.click.left < p[0] || g - this.offset.click.left > p[2] ? g - this.offset.click.left < p[0] ? g + e.grid[0] : g - e.grid[0] : g : g
      }
    }
    return {top: d - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : h ? 0 : c.scrollTop()),left: v - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : h ? 0 : c.scrollLeft())}
  },_clear: function() {
    this.helper.removeClass("ui-draggable-dragging"), this.helper[0] != this.element[0] && !this.cancelHelperRemoval && this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1
  },_trigger: function(c, e, d) {
    return d = d || this._uiHash(), b.ui.plugin.call(this, c, [e, d]), c == "drag" && (this.positionAbs = this._convertPositionTo("absolute")), b.Widget.prototype._trigger.call(this, c, e, d)
  },plugins: {},_uiHash: function(c) {
    return {helper: this.helper,position: this.position,originalPosition: this.originalPosition,offset: this.positionAbs}
  }}), b.ui.plugin.add("draggable", "connectToSortable", {start: function(d, g) {
    var f = b(this).data("draggable"), c = f.options, e = b.extend({}, g, {item: f.element});
    f.sortables = [], b(c.connectToSortable).each(function() {
      var h = b.data(this, "sortable");
      h && !h.options.disabled && (f.sortables.push({instance: h,shouldRevert: h.options.revert}), h.refreshPositions(), h._trigger("activate", d, e))
    })
  },stop: function(d, f) {
    var e = b(this).data("draggable"), c = b.extend({}, f, {item: e.element});
    b.each(e.sortables, function() {
      this.instance.isOver ? (this.instance.isOver = 0, e.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = !0), this.instance._mouseStop(d), this.instance.options.helper = this.instance.options._helper, e.options.helper == "original" && this.instance.currentItem.css({top: "auto",left: "auto"})) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", d, c))
    })
  },drag: function(d, g) {
    var f = b(this).data("draggable"), c = this, e = function(w) {
      var l = this.offset.click.top, h = this.offset.click.left, m = this.positionAbs.top, x = this.positionAbs.left, k = w.height, v = w.width, q = w.top, p = w.left;
      return b.ui.isOver(m + l, x + h, q, p, k, v)
    };
    b.each(f.sortables, function(k) {
      var l = !1, h = this;
      this.instance.positionAbs = f.positionAbs, this.instance.helperProportions = f.helperProportions, this.instance.offset.click = f.offset.click, this.instance._intersectsWith(this.instance.containerCache) && (l = !0, b.each(f.sortables, function() {
        return this.instance.positionAbs = f.positionAbs, this.instance.helperProportions = f.helperProportions, this.instance.offset.click = f.offset.click, this != h && this.instance._intersectsWith(this.instance.containerCache) && b.ui.contains(h.instance.element[0], this.instance.element[0]) && (l = !1), l
      })), l ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = b(c).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function() {
        return g.helper[0]
      }, d.target = this.instance.currentItem[0], this.instance._mouseCapture(d, !0), this.instance._mouseStart(d, !0, !0), this.instance.offset.click.top = f.offset.click.top, this.instance.offset.click.left = f.offset.click.left, this.instance.offset.parent.left -= f.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= f.offset.parent.top - this.instance.offset.parent.top, f._trigger("toSortable", d), f.dropped = this.instance.element, f.currentItem = f.element, this.instance.fromOutside = f), this.instance.currentItem && this.instance._mouseDrag(d)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", d, this.instance._uiHash(this.instance)), this.instance._mouseStop(d, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), f._trigger("fromSortable", d), f.dropped = !1)
    })
  }}), b.ui.plugin.add("draggable", "cursor", {start: function(d, f) {
    var e = b("body"), c = b(this).data("draggable").options;
    e.css("cursor") && (c._cursor = e.css("cursor")), e.css("cursor", c.cursor)
  },stop: function(c, e) {
    var d = b(this).data("draggable").options;
    d._cursor && b("body").css("cursor", d._cursor)
  }}), b.ui.plugin.add("draggable", "opacity", {start: function(d, f) {
    var e = b(f.helper), c = b(this).data("draggable").options;
    e.css("opacity") && (c._opacity = e.css("opacity")), e.css("opacity", c.opacity)
  },stop: function(c, e) {
    var d = b(this).data("draggable").options;
    d._opacity && b(e.helper).css("opacity", d._opacity)
  }}), b.ui.plugin.add("draggable", "scroll", {start: function(c, e) {
    var d = b(this).data("draggable");
    d.scrollParent[0] != document && d.scrollParent[0].tagName != "HTML" && (d.overflowOffset = d.scrollParent.offset())
  },drag: function(d, g) {
    var f = b(this).data("draggable"), c = f.options, e = !1;
    if (f.scrollParent[0] != document && f.scrollParent[0].tagName != "HTML") {
      if (!c.axis || c.axis != "x") {
        f.overflowOffset.top + f.scrollParent[0].offsetHeight - d.pageY < c.scrollSensitivity ? f.scrollParent[0].scrollTop = e = f.scrollParent[0].scrollTop + c.scrollSpeed : d.pageY - f.overflowOffset.top < c.scrollSensitivity && (f.scrollParent[0].scrollTop = e = f.scrollParent[0].scrollTop - c.scrollSpeed)
      }
      if (!c.axis || c.axis != "y") {
        f.overflowOffset.left + f.scrollParent[0].offsetWidth - d.pageX < c.scrollSensitivity ? f.scrollParent[0].scrollLeft = e = f.scrollParent[0].scrollLeft + c.scrollSpeed : d.pageX - f.overflowOffset.left < c.scrollSensitivity && (f.scrollParent[0].scrollLeft = e = f.scrollParent[0].scrollLeft - c.scrollSpeed)
      }
    } else {
      if (!c.axis || c.axis != "x") {
        d.pageY - b(document).scrollTop() < c.scrollSensitivity ? e = b(document).scrollTop(b(document).scrollTop() - c.scrollSpeed) : b(window).height() - (d.pageY - b(document).scrollTop()) < c.scrollSensitivity && (e = b(document).scrollTop(b(document).scrollTop() + c.scrollSpeed))
      }
      if (!c.axis || c.axis != "y") {
        d.pageX - b(document).scrollLeft() < c.scrollSensitivity ? e = b(document).scrollLeft(b(document).scrollLeft() - c.scrollSpeed) : b(window).width() - (d.pageX - b(document).scrollLeft()) < c.scrollSensitivity && (e = b(document).scrollLeft(b(document).scrollLeft() + c.scrollSpeed))
      }
    }
    e !== !1 && b.ui.ddmanager && !c.dropBehaviour && b.ui.ddmanager.prepareOffsets(f, d)
  }}), b.ui.plugin.add("draggable", "snap", {start: function(d, f) {
    var e = b(this).data("draggable"), c = e.options;
    e.snapElements = [], b(c.snap.constructor != String ? c.snap.items || ":data(draggable)" : c.snap).each(function() {
      var g = b(this), h = g.offset();
      this != e.element[0] && e.snapElements.push({item: this,width: g.outerWidth(),height: g.outerHeight(),top: h.top,left: h.left})
    })
  },drag: function(w, C) {
    var z = b(this).data("draggable"), F = z.options, x = F.snapTolerance, B = C.offset.left, q = B + z.helperProportions.width, M = C.offset.top, I = M + z.helperProportions.height;
    for (var E = z.snapElements.length - 1; E >= 0; E--) {
      var K = z.snapElements[E].left, G = K + z.snapElements[E].width, A = z.snapElements[E].top, J = A + z.snapElements[E].height;
      if (!(K - x < B && B < G + x && A - x < M && M < J + x || K - x < B && B < G + x && A - x < I && I < J + x || K - x < q && q < G + x && A - x < M && M < J + x || K - x < q && q < G + x && A - x < I && I < J + x)) {
        z.snapElements[E].snapping && z.options.snap.release && z.options.snap.release.call(z.element, w, b.extend(z._uiHash(), {snapItem: z.snapElements[E].item})), z.snapElements[E].snapping = !1;
        continue
      }
      if (F.snapMode != "inner") {
        var k = Math.abs(A - I) <= x, D = Math.abs(J - M) <= x, H = Math.abs(K - q) <= x, e = Math.abs(G - B) <= x;
        k && (C.position.top = z._convertPositionTo("relative", {top: A - z.helperProportions.height,left: 0}).top - z.margins.top), D && (C.position.top = z._convertPositionTo("relative", {top: J,left: 0}).top - z.margins.top), H && (C.position.left = z._convertPositionTo("relative", {top: 0,left: K - z.helperProportions.width}).left - z.margins.left), e && (C.position.left = z._convertPositionTo("relative", {top: 0,left: G}).left - z.margins.left)
      }
      var L = k || D || H || e;
      if (F.snapMode != "outer") {
        var k = Math.abs(A - M) <= x, D = Math.abs(J - I) <= x, H = Math.abs(K - B) <= x, e = Math.abs(G - q) <= x;
        k && (C.position.top = z._convertPositionTo("relative", {top: A,left: 0}).top - z.margins.top), D && (C.position.top = z._convertPositionTo("relative", {top: J - z.helperProportions.height,left: 0}).top - z.margins.top), H && (C.position.left = z._convertPositionTo("relative", {top: 0,left: K}).left - z.margins.left), e && (C.position.left = z._convertPositionTo("relative", {top: 0,left: G - z.helperProportions.width}).left - z.margins.left)
      }
      !z.snapElements[E].snapping && (k || D || H || e || L) && z.options.snap.snap && z.options.snap.snap.call(z.element, w, b.extend(z._uiHash(), {snapItem: z.snapElements[E].item})), z.snapElements[E].snapping = k || D || H || e || L
    }
  }}), b.ui.plugin.add("draggable", "stack", {start: function(d, g) {
    var f = b(this).data("draggable").options, c = b.makeArray(b(f.stack)).sort(function(h, k) {
      return (parseInt(b(h).css("zIndex"), 10) || 0) - (parseInt(b(k).css("zIndex"), 10) || 0)
    });
    if (!c.length) {
      return
    }
    var e = parseInt(c[0].style.zIndex) || 0;
    b(c).each(function(h) {
      this.style.zIndex = e + h
    }), this[0].style.zIndex = e + c.length
  }}), b.ui.plugin.add("draggable", "zIndex", {start: function(d, f) {
    var e = b(f.helper), c = b(this).data("draggable").options;
    e.css("zIndex") && (c._zIndex = e.css("zIndex")), e.css("zIndex", c.zIndex)
  },stop: function(c, e) {
    var d = b(this).data("draggable").options;
    d._zIndex && b(e.helper).css("zIndex", d._zIndex)
  }})
})(jQuery);
(function(b, a) {
  b.widget("ui.droppable", {version: "1.9.2",widgetEventPrefix: "drop",options: {accept: "*",activeClass: !1,addClasses: !0,greedy: !1,hoverClass: !1,scope: "default",tolerance: "intersect"},_create: function() {
    var c = this.options, d = c.accept;
    this.isover = 0, this.isout = 1, this.accept = b.isFunction(d) ? d : function(f) {
      return f.is(d)
    }, this.proportions = {width: this.element[0].offsetWidth,height: this.element[0].offsetHeight}, b.ui.ddmanager.droppables[c.scope] = b.ui.ddmanager.droppables[c.scope] || [], b.ui.ddmanager.droppables[c.scope].push(this), c.addClasses && this.element.addClass("ui-droppable")
  },_destroy: function() {
    var c = b.ui.ddmanager.droppables[this.options.scope];
    for (var d = 0; d < c.length; d++) {
      c[d] == this && c.splice(d, 1)
    }
    this.element.removeClass("ui-droppable ui-droppable-disabled")
  },_setOption: function(c, d) {
    c == "accept" && (this.accept = b.isFunction(d) ? d : function(f) {
      return f.is(d)
    }), b.Widget.prototype._setOption.apply(this, arguments)
  },_activate: function(c) {
    var d = b.ui.ddmanager.current;
    this.options.activeClass && this.element.addClass(this.options.activeClass), d && this._trigger("activate", c, this.ui(d))
  },_deactivate: function(c) {
    var d = b.ui.ddmanager.current;
    this.options.activeClass && this.element.removeClass(this.options.activeClass), d && this._trigger("deactivate", c, this.ui(d))
  },_over: function(c) {
    var d = b.ui.ddmanager.current;
    if (!d || (d.currentItem || d.element)[0] == this.element[0]) {
      return
    }
    this.accept.call(this.element[0], d.currentItem || d.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", c, this.ui(d)))
  },_out: function(c) {
    var d = b.ui.ddmanager.current;
    if (!d || (d.currentItem || d.element)[0] == this.element[0]) {
      return
    }
    this.accept.call(this.element[0], d.currentItem || d.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", c, this.ui(d)))
  },_drop: function(d, f) {
    var e = f || b.ui.ddmanager.current;
    if (!e || (e.currentItem || e.element)[0] == this.element[0]) {
      return !1
    }
    var c = !1;
    return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function() {
      var g = b.data(this, "droppable");
      if (g.options.greedy && !g.options.disabled && g.options.scope == e.options.scope && g.accept.call(g.element[0], e.currentItem || e.element) && b.ui.intersect(e, b.extend(g, {offset: g.element.offset()}), g.options.tolerance)) {
        return c = !0, !1
      }
    }), c ? !1 : this.accept.call(this.element[0], e.currentItem || e.element) ? (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", d, this.ui(e)), this.element) : !1
  },ui: function(c) {
    return {draggable: c.currentItem || c.element,helper: c.helper,position: c.position,offset: c.positionAbs}
  }}), b.ui.intersect = function(C, m, e) {
    if (!m.offset) {
      return !1
    }
    var v = (C.positionAbs || C.position.absolute).left, D = v + C.helperProportions.width, k = (C.positionAbs || C.position.absolute).top, B = k + C.helperProportions.height, A = m.offset.left, x = A + m.proportions.width, q = m.offset.top, z = q + m.proportions.height;
    switch (e) {
      case "fit":
        return A <= v && D <= x && q <= k && B <= z;
      case "intersect":
        return A < v + C.helperProportions.width / 2 && D - C.helperProportions.width / 2 < x && q < k + C.helperProportions.height / 2 && B - C.helperProportions.height / 2 < z;
      case "pointer":
        var w = (C.positionAbs || C.position.absolute).left + (C.clickOffset || C.offset.click).left, g = (C.positionAbs || C.position.absolute).top + (C.clickOffset || C.offset.click).top, y = b.ui.isOver(g, w, q, A, m.proportions.height, m.proportions.width);
        return y;
      case "touch":
        return (k >= q && k <= z || B >= q && B <= z || k < q && B > z) && (v >= A && v <= x || D >= A && D <= x || v < A && D > x);
      default:
        return !1
    }
  }, b.ui.ddmanager = {current: null,droppables: {"default": []},prepareOffsets: function(e, k) {
    var g = b.ui.ddmanager.droppables[e.options.scope] || [], d = k ? k.type : null, f = (e.currentItem || e.element).find(":data(droppable)").andSelf();
    b: for (var h = 0; h < g.length; h++) {
      if (g[h].options.disabled || e && !g[h].accept.call(g[h].element[0], e.currentItem || e.element)) {
        continue
      }
      for (var c = 0; c < f.length; c++) {
        if (f[c] == g[h].element[0]) {
          g[h].proportions.height = 0;
          continue b
        }
      }
      g[h].visible = g[h].element.css("display") != "none";
      if (!g[h].visible) {
        continue
      }
      d == "mousedown" && g[h]._activate.call(g[h], k), g[h].offset = g[h].element.offset(), g[h].proportions = {width: g[h].element[0].offsetWidth,height: g[h].element[0].offsetHeight}
    }
  },drop: function(c, e) {
    var d = !1;
    return b.each(b.ui.ddmanager.droppables[c.options.scope] || [], function() {
      if (!this.options) {
        return
      }
      !this.options.disabled && this.visible && b.ui.intersect(c, this, this.options.tolerance) && (d = this._drop.call(this, e) || d), !this.options.disabled && this.visible && this.accept.call(this.element[0], c.currentItem || c.element) && (this.isout = 1, this.isover = 0, this._deactivate.call(this, e))
    }), d
  },dragStart: function(c, d) {
    c.element.parentsUntil("body").bind("scroll.droppable", function() {
      c.options.refreshPositions || b.ui.ddmanager.prepareOffsets(c, d)
    })
  },drag: function(c, d) {
    c.options.refreshPositions && b.ui.ddmanager.prepareOffsets(c, d), b.each(b.ui.ddmanager.droppables[c.options.scope] || [], function() {
      if (this.options.disabled || this.greedyChild || !this.visible) {
        return
      }
      var h = b.ui.intersect(c, this, this.options.tolerance), f = !h && this.isover == 1 ? "isout" : h && this.isover == 0 ? "isover" : null;
      if (!f) {
        return
      }
      var g;
      if (this.options.greedy) {
        var k = this.options.scope, e = this.element.parents(":data(droppable)").filter(function() {
          return b.data(this, "droppable").options.scope === k
        });
        e.length && (g = b.data(e[0], "droppable"), g.greedyChild = f == "isover" ? 1 : 0)
      }
      g && f == "isover" && (g.isover = 0, g.isout = 1, g._out.call(g, d)), this[f] = 1, this[f == "isout" ? "isover" : "isout"] = 0, this[f == "isover" ? "_over" : "_out"].call(this, d), g && f == "isout" && (g.isout = 0, g.isover = 1, g._over.call(g, d))
    })
  },dragStop: function(c, d) {
    c.element.parentsUntil("body").unbind("scroll.droppable"), c.options.refreshPositions || b.ui.ddmanager.prepareOffsets(c, d)
  }}
})(jQuery);
(function(c, a) {
  c.widget("ui.resizable", c.ui.mouse, {version: "1.9.2",widgetEventPrefix: "resize",options: {alsoResize: !1,animate: !1,animateDuration: "slow",animateEasing: "swing",aspectRatio: !1,autoHide: !1,containment: !1,ghost: !1,grid: !1,handles: "e,s,se",helper: !1,maxHeight: null,maxWidth: null,minHeight: 10,minWidth: 10,zIndex: 1000},_create: function() {
    var g = this, m = this.options;
    this.element.addClass("ui-resizable"), c.extend(this, {_aspectRatio: !!m.aspectRatio,aspectRatio: m.aspectRatio,originalElement: this.element,_proportionallyResizeElements: [],_helper: m.helper || m.ghost || m.animate ? m.helper || "ui-resizable-helper" : null}), this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i) && (this.element.wrap(c('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position: this.element.css("position"),width: this.element.outerWidth(),height: this.element.outerHeight(),top: this.element.css("top"),left: this.element.css("left")})), this.element = this.element.parent().data("resizable", this.element.data("resizable")), this.elementIsWrapper = !0, this.element.css({marginLeft: this.originalElement.css("marginLeft"),marginTop: this.originalElement.css("marginTop"),marginRight: this.originalElement.css("marginRight"),marginBottom: this.originalElement.css("marginBottom")}), this.originalElement.css({marginLeft: 0,marginTop: 0,marginRight: 0,marginBottom: 0}), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), this._proportionallyResizeElements.push(this.originalElement.css({position: "static",zoom: 1,display: "block"})), this.originalElement.css({margin: this.originalElement.css("margin")}), this._proportionallyResize()), this.handles = m.handles || (c(".ui-resizable-handle", this.element).length ? {n: ".ui-resizable-n",e: ".ui-resizable-e",s: ".ui-resizable-s",w: ".ui-resizable-w",se: ".ui-resizable-se",sw: ".ui-resizable-sw",ne: ".ui-resizable-ne",nw: ".ui-resizable-nw"} : "e,s,se");
    if (this.handles.constructor == String) {
      this.handles == "all" && (this.handles = "n,e,s,w,se,sw,ne,nw");
      var k = this.handles.split(",");
      this.handles = {};
      for (var f = 0; f < k.length; f++) {
        var h = c.trim(k[f]), l = "ui-resizable-" + h, e = c('<div class="ui-resizable-handle ' + l + '"></div>');
        e.css({zIndex: m.zIndex}), "se" == h && e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"), this.handles[h] = ".ui-resizable-" + h, this.element.append(e)
      }
    }
    this._renderAxis = function(p) {
      p = p || this.element;
      for (var v in this.handles) {
        this.handles[v].constructor == String && (this.handles[v] = c(this.handles[v], this.element).show());
        if (this.elementIsWrapper && this.originalElement[0].nodeName.match(/textarea|input|select|button/i)) {
          var u = c(this.handles[v], this.element), o = 0;
          o = /sw|ne|nw|se|n|s/.test(v) ? u.outerHeight() : u.outerWidth();
          var q = ["padding", /ne|nw|n/.test(v) ? "Top" : /se|sw|s/.test(v) ? "Bottom" : /^e$/.test(v) ? "Right" : "Left"].join("");
          p.css(q, o), this._proportionallyResize()
        }
        if (!c(this.handles[v]).length) {
          continue
        }
      }
    }, this._renderAxis(this.element), this._handles = c(".ui-resizable-handle", this.element).disableSelection(), this._handles.mouseover(function() {
      if (!g.resizing) {
        if (this.className) {
          var n = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)
        }
        g.axis = n && n[1] ? n[1] : "se"
      }
    }), m.autoHide && (this._handles.hide(), c(this.element).addClass("ui-resizable-autohide").mouseenter(function() {
      if (m.disabled) {
        return
      }
      c(this).removeClass("ui-resizable-autohide"), g._handles.show()
    }).mouseleave(function() {
        if (m.disabled) {
          return
        }
        g.resizing || (c(this).addClass("ui-resizable-autohide"), g._handles.hide())
      })), this._mouseInit()
  },_destroy: function() {
    this._mouseDestroy();
    var e = function(g) {
      c(g).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()
    };
    if (this.elementIsWrapper) {
      e(this.element);
      var f = this.element;
      this.originalElement.css({position: f.css("position"),width: f.outerWidth(),height: f.outerHeight(),top: f.css("top"),left: f.css("left")}).insertAfter(f), f.remove()
    }
    return this.originalElement.css("resize", this.originalResizeStyle), e(this.originalElement), this
  },_mouseCapture: function(e) {
    var g = !1;
    for (var f in this.handles) {
      c(this.handles[f])[0] == e.target && (g = !0)
    }
    return !this.options.disabled && g
  },_mouseStart: function(h) {
    var l = this.options, g = this.element.position(), k = this.element;
    this.resizing = !0, this.documentScroll = {top: c(document).scrollTop(),left: c(document).scrollLeft()}, (k.is(".ui-draggable") || /absolute/.test(k.css("position"))) && k.css({position: "absolute",top: g.top,left: g.left}), this._renderProxy();
    var m = d(this.helper.css("left")), f = d(this.helper.css("top"));
    l.containment && (m += c(l.containment).scrollLeft() || 0, f += c(l.containment).scrollTop() || 0), this.offset = this.helper.offset(), this.position = {left: m,top: f}, this.size = this._helper ? {width: k.outerWidth(),height: k.outerHeight()} : {width: k.width(),height: k.height()}, this.originalSize = this._helper ? {width: k.outerWidth(),height: k.outerHeight()} : {width: k.width(),height: k.height()}, this.originalPosition = {left: m,top: f}, this.sizeDiff = {width: k.outerWidth() - k.width(),height: k.outerHeight() - k.height()}, this.originalMousePosition = {left: h.pageX,top: h.pageY}, this.aspectRatio = typeof l.aspectRatio == "number" ? l.aspectRatio : this.originalSize.width / this.originalSize.height || 1;
    var e = c(".ui-resizable-" + this.axis).css("cursor");
    return c("body").css("cursor", e == "auto" ? this.axis + "-resize" : e), k.addClass("ui-resizable-resizing"), this._propagate("start", h), !0
  },_mouseDrag: function(v) {
    var y = this.helper, k = this.options, g = {}, p = this, z = this.originalMousePosition, h = this.axis, x = v.pageX - z.left || 0, w = v.pageY - z.top || 0, q = this._change[h];
    if (!q) {
      return !1
    }
    var m = q.apply(this, [v, x, w]);
    this._updateVirtualBoundaries(v.shiftKey);
    if (this._aspectRatio || v.shiftKey) {
      m = this._updateRatio(m, v)
    }
    return m = this._respectSize(m, v), this._propagate("resize", v), y.css({top: this.position.top + "px",left: this.position.left + "px",width: this.size.width + "px",height: this.size.height + "px"}), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), this._updateCache(m), this._trigger("resize", v, this.ui()), !1
  },_mouseStop: function(w) {
    this.resizing = !1;
    var h = this.options, e = this;
    if (this._helper) {
      var m = this._proportionallyResizeElements, x = m.length && /textarea/i.test(m[0].nodeName), g = x && c.ui.hasScroll(m[0], "left") ? 0 : e.sizeDiff.height, v = x ? 0 : e.sizeDiff.width, q = {width: e.helper.width() - v,height: e.helper.height() - g}, p = parseInt(e.element.css("left"), 10) + (e.position.left - e.originalPosition.left) || null, k = parseInt(e.element.css("top"), 10) + (e.position.top - e.originalPosition.top) || null;
      h.animate || this.element.css(c.extend(q, {top: k,left: p})), e.helper.height(e.size.height), e.helper.width(e.size.width), this._helper && !h.animate && this._proportionallyResize()
    }
    return c("body").css("cursor", "auto"), this.element.removeClass("ui-resizable-resizing"), this._propagate("stop", w), this._helper && this.helper.remove(), !1
  },_updateVirtualBoundaries: function(l) {
    var h = this.options, p, g, k, m, f;
    f = {minWidth: b(h.minWidth) ? h.minWidth : 0,maxWidth: b(h.maxWidth) ? h.maxWidth : Infinity,minHeight: b(h.minHeight) ? h.minHeight : 0,maxHeight: b(h.maxHeight) ? h.maxHeight : Infinity};
    if (this._aspectRatio || l) {
      p = f.minHeight * this.aspectRatio, k = f.minWidth / this.aspectRatio, g = f.maxHeight * this.aspectRatio, m = f.maxWidth / this.aspectRatio, p > f.minWidth && (f.minWidth = p), k > f.minHeight && (f.minHeight = k), g < f.maxWidth && (f.maxWidth = g), m < f.maxHeight && (f.maxHeight = m)
    }
    this._vBoundaries = f
  },_updateCache: function(g) {
    var f = this.options;
    this.offset = this.helper.offset(), b(g.left) && (this.position.left = g.left), b(g.top) && (this.position.top = g.top), b(g.height) && (this.size.height = g.height), b(g.width) && (this.size.width = g.width)
  },_updateRatio: function(k, g) {
    var m = this.options, f = this.position, h = this.size, l = this.axis;
    return b(k.height) ? k.width = k.height * this.aspectRatio : b(k.width) && (k.height = k.width / this.aspectRatio), l == "sw" && (k.left = f.left + (h.width - k.width), k.top = null), l == "nw" && (k.top = f.top + (h.height - k.height), k.left = f.left + (h.width - k.width)), k
  },_respectSize: function(y, E) {
    var m = this.helper, r = this._vBoundaries, F = this._aspectRatio || E.shiftKey, k = this.axis, D = b(y.width) && r.maxWidth && r.maxWidth < y.width, B = b(y.height) && r.maxHeight && r.maxHeight < y.height, x = b(y.width) && r.minWidth && r.minWidth > y.width, q = b(y.height) && r.minHeight && r.minHeight > y.height;
    x && (y.width = r.minWidth), q && (y.height = r.minHeight), D && (y.width = r.maxWidth), B && (y.height = r.maxHeight);
    var A = this.originalPosition.left + this.originalSize.width, w = this.position.top + this.size.height, g = /sw|nw|w/.test(k), z = /nw|ne|n/.test(k);
    x && g && (y.left = A - r.minWidth), D && g && (y.left = A - r.maxWidth), q && z && (y.top = w - r.minHeight), B && z && (y.top = w - r.maxHeight);
    var C = !y.width && !y.height;
    return C && !y.left && y.top ? y.top = null : C && !y.top && y.left && (y.left = null), y
  },_proportionallyResize: function() {
    var f = this.options;
    if (!this._proportionallyResizeElements.length) {
      return
    }
    var l = this.helper || this.element;
    for (var h = 0; h < this._proportionallyResizeElements.length; h++) {
      var e = this._proportionallyResizeElements[h];
      if (!this.borderDif) {
        var g = [e.css("borderTopWidth"), e.css("borderRightWidth"), e.css("borderBottomWidth"), e.css("borderLeftWidth")], k = [e.css("paddingTop"), e.css("paddingRight"), e.css("paddingBottom"), e.css("paddingLeft")];
        this.borderDif = c.map(g, function(p, m) {
          var q = parseInt(p, 10) || 0, o = parseInt(k[m], 10) || 0;
          return q + o
        })
      }
      e.css({height: l.height() - this.borderDif[0] - this.borderDif[2] || 0,width: l.width() - this.borderDif[1] - this.borderDif[3] || 0})
    }
  },_renderProxy: function() {
    var f = this.element, h = this.options;
    this.elementOffset = f.offset();
    if (this._helper) {
      this.helper = this.helper || c('<div style="overflow:hidden;"></div>');
      var g = c.ui.ie6 ? 1 : 0, e = c.ui.ie6 ? 2 : -1;
      this.helper.addClass(this._helper).css({width: this.element.outerWidth() + e,height: this.element.outerHeight() + e,position: "absolute",left: this.elementOffset.left - g + "px",top: this.elementOffset.top - g + "px",zIndex: ++h.zIndex}), this.helper.appendTo("body").disableSelection()
    } else {
      this.helper = this.element
    }
  },_change: {e: function(g, f, h) {
    return {width: this.originalSize.width + f}
  },w: function(l, g, m) {
    var k = this.options, f = this.originalSize, h = this.originalPosition;
    return {left: h.left + g,width: f.width - g}
  },n: function(l, g, m) {
    var k = this.options, f = this.originalSize, h = this.originalPosition;
    return {top: h.top + m,height: f.height - m}
  },s: function(g, f, h) {
    return {height: this.originalSize.height + h}
  },se: function(e, g, f) {
    return c.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [e, g, f]))
  },sw: function(e, g, f) {
    return c.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [e, g, f]))
  },ne: function(e, g, f) {
    return c.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [e, g, f]))
  },nw: function(e, g, f) {
    return c.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [e, g, f]))
  }},_propagate: function(e, f) {
    c.ui.plugin.call(this, e, [f, this.ui()]), e != "resize" && this._trigger(e, f, this.ui())
  },plugins: {},ui: function() {
    return {originalElement: this.originalElement,element: this.element,helper: this.helper,position: this.position,size: this.size,originalSize: this.originalSize,originalPosition: this.originalPosition}
  }}), c.ui.plugin.add("resizable", "alsoResize", {start: function(f, k) {
    var h = c(this).data("resizable"), e = h.options, g = function(l) {
      c(l).each(function() {
        var m = c(this);
        m.data("resizable-alsoresize", {width: parseInt(m.width(), 10),height: parseInt(m.height(), 10),left: parseInt(m.css("left"), 10),top: parseInt(m.css("top"), 10)})
      })
    };
    typeof e.alsoResize == "object" && !e.alsoResize.parentNode ? e.alsoResize.length ? (e.alsoResize = e.alsoResize[0], g(e.alsoResize)) : c.each(e.alsoResize, function(l) {
      g(l)
    }) : g(e.alsoResize)
  },resize: function(h, p) {
    var l = c(this).data("resizable"), g = l.options, k = l.originalSize, m = l.originalPosition, f = {height: l.size.height - k.height || 0,width: l.size.width - k.width || 0,top: l.position.top - m.top || 0,left: l.position.left - m.left || 0}, e = function(n, o) {
      c(n).each(function() {
        var r = c(this), q = c(this).data("resizable-alsoresize"), u = {}, v = o && o.length ? o : r.parents(p.originalElement[0]).length ? ["width", "height"] : ["width", "height", "top", "left"];
        c.each(v, function(w, s) {
          var x = (q[s] || 0) + (f[s] || 0);
          x && x >= 0 && (u[s] = x || null)
        }), r.css(u)
      })
    };
    typeof g.alsoResize == "object" && !g.alsoResize.nodeType ? c.each(g.alsoResize, function(o, n) {
      e(o, n)
    }) : e(g.alsoResize)
  },stop: function(e, f) {
    c(this).removeData("resizable-alsoresize")
  }}), c.ui.plugin.add("resizable", "animate", {stop: function(x, h) {
    var e = c(this).data("resizable"), m = e.options, y = e._proportionallyResizeElements, g = y.length && /textarea/i.test(y[0].nodeName), w = g && c.ui.hasScroll(y[0], "left") ? 0 : e.sizeDiff.height, v = g ? 0 : e.sizeDiff.width, p = {width: e.size.width - v,height: e.size.height - w}, k = parseInt(e.element.css("left"), 10) + (e.position.left - e.originalPosition.left) || null, q = parseInt(e.element.css("top"), 10) + (e.position.top - e.originalPosition.top) || null;
    e.element.animate(c.extend(p, q && k ? {top: q,left: k} : {}), {duration: m.animateDuration,easing: m.animateEasing,step: function() {
      var f = {width: parseInt(e.element.css("width"), 10),height: parseInt(e.element.css("height"), 10),top: parseInt(e.element.css("top"), 10),left: parseInt(e.element.css("left"), 10)};
      y && y.length && c(y[0]).css({width: f.width,height: f.height}), e._updateCache(f), e._propagate("resize", x)
    }})
  }}), c.ui.plugin.add("resizable", "containment", {start: function(C, e) {
    var n = c(this).data("resizable"), D = n.options, k = n.element, B = D.containment, z = B instanceof c ? B.get(0) : /parent/.test(B) ? k.parent().get(0) : B;
    if (!z) {
      return
    }
    n.containerElement = c(z);
    if (/document/.test(B) || B == document) {
      n.containerOffset = {left: 0,top: 0}, n.containerPosition = {left: 0,top: 0}, n.parentData = {element: c(document),left: 0,top: 0,width: c(document).width(),height: c(document).height() || document.body.parentNode.scrollHeight}
    } else {
      var w = c(z), m = [];
      c(["Top", "Right", "Left", "Bottom"]).each(function(h, f) {
        m[h] = d(w.css("padding" + f))
      }), n.containerOffset = w.offset(), n.containerPosition = w.position(), n.containerSize = {height: w.innerHeight() - m[3],width: w.innerWidth() - m[1]};
      var y = n.containerOffset, q = n.containerSize.height, g = n.containerSize.width, x = c.ui.hasScroll(z, "left") ? z.scrollWidth : g, A = c.ui.hasScroll(z) ? z.scrollHeight : q;
      n.parentData = {element: z,left: y.left,top: y.top,width: x,height: A}
    }
  },resize: function(E, m) {
    var e = c(this).data("resizable"), w = e.options, F = e.containerSize, k = e.containerOffset, D = e.size, B = e.position, y = e._aspectRatio || E.shiftKey, q = {top: 0,left: 0}, A = e.containerElement;
    A[0] != document && /static/.test(A.css("position")) && (q = k), B.left < (e._helper ? k.left : 0) && (e.size.width = e.size.width + (e._helper ? e.position.left - k.left : e.position.left - q.left), y && (e.size.height = e.size.width / e.aspectRatio), e.position.left = w.helper ? k.left : 0), B.top < (e._helper ? k.top : 0) && (e.size.height = e.size.height + (e._helper ? e.position.top - k.top : e.position.top), y && (e.size.width = e.size.height * e.aspectRatio), e.position.top = e._helper ? k.top : 0), e.offset.left = e.parentData.left + e.position.left, e.offset.top = e.parentData.top + e.position.top;
    var x = Math.abs((e._helper ? e.offset.left - q.left : e.offset.left - q.left) + e.sizeDiff.width), g = Math.abs((e._helper ? e.offset.top - q.top : e.offset.top - k.top) + e.sizeDiff.height), z = e.containerElement.get(0) == e.element.parent().get(0), C = /relative|absolute/.test(e.containerElement.css("position"));
    z && C && (x -= e.parentData.left), x + e.size.width >= e.parentData.width && (e.size.width = e.parentData.width - x, y && (e.size.height = e.size.width / e.aspectRatio)), g + e.size.height >= e.parentData.height && (e.size.height = e.parentData.height - g, y && (e.size.width = e.size.height * e.aspectRatio))
  },stop: function(z, k) {
    var e = c(this).data("resizable"), p = e.options, A = e.position, g = e.containerOffset, y = e.containerPosition, x = e.containerElement, v = c(e.helper), m = v.offset(), w = v.outerWidth() - e.sizeDiff.width, q = v.outerHeight() - e.sizeDiff.height;
    e._helper && !p.animate && /relative/.test(x.css("position")) && c(this).css({left: m.left - y.left - g.left,width: w,height: q}), e._helper && !p.animate && /static/.test(x.css("position")) && c(this).css({left: m.left - y.left - g.left,width: w,height: q})
  }}), c.ui.plugin.add("resizable", "ghost", {start: function(f, k) {
    var h = c(this).data("resizable"), e = h.options, g = h.size;
    h.ghost = h.originalElement.clone(), h.ghost.css({opacity: 0.25,display: "block",position: "relative",height: g.height,width: g.width,margin: 0,left: 0,top: 0}).addClass("ui-resizable-ghost").addClass(typeof e.ghost == "string" ? e.ghost : ""), h.ghost.appendTo(h.helper)
  },resize: function(f, h) {
    var g = c(this).data("resizable"), e = g.options;
    g.ghost && g.ghost.css({position: "relative",height: g.size.height,width: g.size.width})
  },stop: function(f, h) {
    var g = c(this).data("resizable"), e = g.options;
    g.ghost && g.helper && g.helper.get(0).removeChild(g.ghost.get(0))
  }}), c.ui.plugin.add("resizable", "grid", {resize: function(x, h) {
    var e = c(this).data("resizable"), m = e.options, y = e.size, g = e.originalSize, w = e.originalPosition, v = e.axis, p = m._aspectRatio || x.shiftKey;
    m.grid = typeof m.grid == "number" ? [m.grid, m.grid] : m.grid;
    var k = Math.round((y.width - g.width) / (m.grid[0] || 1)) * (m.grid[0] || 1), q = Math.round((y.height - g.height) / (m.grid[1] || 1)) * (m.grid[1] || 1);
    /^(se|s|e)$/.test(v) ? (e.size.width = g.width + k, e.size.height = g.height + q) : /^(ne)$/.test(v) ? (e.size.width = g.width + k, e.size.height = g.height + q, e.position.top = w.top - q) : /^(sw)$/.test(v) ? (e.size.width = g.width + k, e.size.height = g.height + q, e.position.left = w.left - k) : (e.size.width = g.width + k, e.size.height = g.height + q, e.position.top = w.top - q, e.position.left = w.left - k)
  }});
  var d = function(f) {
    return parseInt(f, 10) || 0
  }, b = function(f) {
    return !isNaN(parseInt(f, 10))
  }
})(jQuery);
(function(b, a) {
  b.widget("ui.selectable", b.ui.mouse, {version: "1.9.2",options: {appendTo: "body",autoRefresh: !0,distance: 0,filter: "*",tolerance: "touch"},_create: function() {
    var c = this;
    this.element.addClass("ui-selectable"), this.dragged = !1;
    var d;
    this.refresh = function() {
      d = b(c.options.filter, c.element[0]), d.addClass("ui-selectee"), d.each(function() {
        var e = b(this), f = e.offset();
        b.data(this, "selectable-item", {element: this,$element: e,left: f.left,top: f.top,right: f.left + e.outerWidth(),bottom: f.top + e.outerHeight(),startselected: !1,selected: e.hasClass("ui-selected"),selecting: e.hasClass("ui-selecting"),unselecting: e.hasClass("ui-unselecting")})
      })
    }, this.refresh(), this.selectees = d.addClass("ui-selectee"), this._mouseInit(), this.helper = b("<div class='ui-selectable-helper'></div>")
  },_destroy: function() {
    this.selectees.removeClass("ui-selectee").removeData("selectable-item"), this.element.removeClass("ui-selectable ui-selectable-disabled"), this._mouseDestroy()
  },_mouseStart: function(c) {
    var e = this;
    this.opos = [c.pageX, c.pageY];
    if (this.options.disabled) {
      return
    }
    var d = this.options;
    this.selectees = b(d.filter, this.element[0]), this._trigger("start", c), b(d.appendTo).append(this.helper), this.helper.css({left: c.clientX,top: c.clientY,width: 0,height: 0}), d.autoRefresh && this.refresh(), this.selectees.filter(".ui-selected").each(function() {
      var f = b.data(this, "selectable-item");
      f.startselected = !0, !c.metaKey && !c.ctrlKey && (f.$element.removeClass("ui-selected"), f.selected = !1, f.$element.addClass("ui-unselecting"), f.unselecting = !0, e._trigger("unselecting", c, {unselecting: f.element}))
    }), b(c.target).parents().andSelf().each(function() {
      var g = b.data(this, "selectable-item");
      if (g) {
        var f = !c.metaKey && !c.ctrlKey || !g.$element.hasClass("ui-selected");
        return g.$element.removeClass(f ? "ui-unselecting" : "ui-selected").addClass(f ? "ui-selecting" : "ui-unselecting"), g.unselecting = !f, g.selecting = f, g.selected = f, f ? e._trigger("selecting", c, {selecting: g.element}) : e._trigger("unselecting", c, {unselecting: g.element}), !1
      }
    })
  },_mouseDrag: function(f) {
    var l = this;
    this.dragged = !0;
    if (this.options.disabled) {
      return
    }
    var h = this.options, e = this.opos[0], g = this.opos[1], k = f.pageX, d = f.pageY;
    if (e > k) {
      var c = k;
      k = e, e = c
    }
    if (g > d) {
      var c = d;
      d = g, g = c
    }
    return this.helper.css({left: e,top: g,width: k - e,height: d - g}), this.selectees.each(function() {
      var m = b.data(this, "selectable-item");
      if (!m || m.element == l.element[0]) {
        return
      }
      var n = !1;
      h.tolerance == "touch" ? n = !(m.left > k || m.right < e || m.top > d || m.bottom < g) : h.tolerance == "fit" && (n = m.left > e && m.right < k && m.top > g && m.bottom < d), n ? (m.selected && (m.$element.removeClass("ui-selected"), m.selected = !1), m.unselecting && (m.$element.removeClass("ui-unselecting"), m.unselecting = !1), m.selecting || (m.$element.addClass("ui-selecting"), m.selecting = !0, l._trigger("selecting", f, {selecting: m.element}))) : (m.selecting && ((f.metaKey || f.ctrlKey) && m.startselected ? (m.$element.removeClass("ui-selecting"), m.selecting = !1, m.$element.addClass("ui-selected"), m.selected = !0) : (m.$element.removeClass("ui-selecting"), m.selecting = !1, m.startselected && (m.$element.addClass("ui-unselecting"), m.unselecting = !0), l._trigger("unselecting", f, {unselecting: m.element}))), m.selected && !f.metaKey && !f.ctrlKey && !m.startselected && (m.$element.removeClass("ui-selected"), m.selected = !1, m.$element.addClass("ui-unselecting"), m.unselecting = !0, l._trigger("unselecting", f, {unselecting: m.element})))
    }), !1
  },_mouseStop: function(c) {
    var e = this;
    this.dragged = !1;
    var d = this.options;
    return b(".ui-unselecting", this.element[0]).each(function() {
      var f = b.data(this, "selectable-item");
      f.$element.removeClass("ui-unselecting"), f.unselecting = !1, f.startselected = !1, e._trigger("unselected", c, {unselected: f.element})
    }), b(".ui-selecting", this.element[0]).each(function() {
      var f = b.data(this, "selectable-item");
      f.$element.removeClass("ui-selecting").addClass("ui-selected"), f.selecting = !1, f.selected = !0, f.startselected = !0, e._trigger("selected", c, {selected: f.element})
    }), this._trigger("stop", c), this.helper.remove(), !1
  }})
})(jQuery);
(function(b, a) {
  b.widget("ui.sortable", b.ui.mouse, {version: "1.9.2",widgetEventPrefix: "sort",ready: !1,options: {appendTo: "parent",axis: !1,connectWith: !1,containment: !1,cursor: "auto",cursorAt: !1,dropOnEmpty: !0,forcePlaceholderSize: !1,forceHelperSize: !1,grid: !1,handle: !1,helper: "original",items: "> *",opacity: !1,placeholder: !1,revert: !1,scroll: !0,scrollSensitivity: 20,scrollSpeed: 20,scope: "default",tolerance: "intersect",zIndex: 1000},_create: function() {
    var c = this.options;
    this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? c.axis === "x" || /left|right/.test(this.items[0].item.css("float")) || /inline|table-cell/.test(this.items[0].item.css("display")) : !1, this.offset = this.element.offset(), this._mouseInit(), this.ready = !0
  },_destroy: function() {
    this.element.removeClass("ui-sortable ui-sortable-disabled"), this._mouseDestroy();
    for (var c = this.items.length - 1; c >= 0; c--) {
      this.items[c].item.removeData(this.widgetName + "-item")
    }
    return this
  },_setOption: function(c, d) {
    c === "disabled" ? (this.options[c] = d, this.widget().toggleClass("ui-sortable-disabled", !!d)) : b.Widget.prototype._setOption.apply(this, arguments)
  },_mouseCapture: function(d, h) {
    var f = this;
    if (this.reverting) {
      return !1
    }
    if (this.options.disabled || this.options.type == "static") {
      return !1
    }
    this._refreshItems(d);
    var c = null, e = b(d.target).parents().each(function() {
      if (b.data(this, f.widgetName + "-item") == f) {
        return c = b(this), !1
      }
    });
    b.data(d.target, f.widgetName + "-item") == f && (c = b(d.target));
    if (!c) {
      return !1
    }
    if (this.options.handle && !h) {
      var g = !1;
      b(this.options.handle, c).find("*").andSelf().each(function() {
        this == d.target && (g = !0)
      });
      if (!g) {
        return !1
      }
    }
    return this.currentItem = c, this._removeCurrentsFromItems(), !0
  },_mouseStart: function(d, g, f) {
    var c = this.options;
    this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(d), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {top: this.offset.top - this.margins.top,left: this.offset.left - this.margins.left}, b.extend(this.offset, {click: {left: d.pageX - this.offset.left,top: d.pageY - this.offset.top},parent: this._getParentOffset(),relative: this._getRelativeOffset()}), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(d), this.originalPageX = d.pageX, this.originalPageY = d.pageY, c.cursorAt && this._adjustOffsetFromHelper(c.cursorAt), this.domPosition = {prev: this.currentItem.prev()[0],parent: this.currentItem.parent()[0]}, this.helper[0] != this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), c.containment && this._setContainment(), c.cursor && (b("body").css("cursor") && (this._storedCursor = b("body").css("cursor")), b("body").css("cursor", c.cursor)), c.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", c.opacity)), c.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", c.zIndex)), this.scrollParent[0] != document && this.scrollParent[0].tagName != "HTML" && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", d, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions();
    if (!f) {
      for (var e = this.containers.length - 1; e >= 0; e--) {
        this.containers[e]._trigger("activate", d, this._uiHash(this))
      }
    }
    return b.ui.ddmanager && (b.ui.ddmanager.current = this), b.ui.ddmanager && !c.dropBehaviour && b.ui.ddmanager.prepareOffsets(this, d), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(d), !0
  },_mouseDrag: function(e) {
    this.position = this._generatePosition(e), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs);
    if (this.options.scroll) {
      var k = this.options, g = !1;
      this.scrollParent[0] != document && this.scrollParent[0].tagName != "HTML" ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - e.pageY < k.scrollSensitivity ? this.scrollParent[0].scrollTop = g = this.scrollParent[0].scrollTop + k.scrollSpeed : e.pageY - this.overflowOffset.top < k.scrollSensitivity && (this.scrollParent[0].scrollTop = g = this.scrollParent[0].scrollTop - k.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - e.pageX < k.scrollSensitivity ? this.scrollParent[0].scrollLeft = g = this.scrollParent[0].scrollLeft + k.scrollSpeed : e.pageX - this.overflowOffset.left < k.scrollSensitivity && (this.scrollParent[0].scrollLeft = g = this.scrollParent[0].scrollLeft - k.scrollSpeed)) : (e.pageY - b(document).scrollTop() < k.scrollSensitivity ? g = b(document).scrollTop(b(document).scrollTop() - k.scrollSpeed) : b(window).height() - (e.pageY - b(document).scrollTop()) < k.scrollSensitivity && (g = b(document).scrollTop(b(document).scrollTop() + k.scrollSpeed)), e.pageX - b(document).scrollLeft() < k.scrollSensitivity ? g = b(document).scrollLeft(b(document).scrollLeft() - k.scrollSpeed) : b(window).width() - (e.pageX - b(document).scrollLeft()) < k.scrollSensitivity && (g = b(document).scrollLeft(b(document).scrollLeft() + k.scrollSpeed))), g !== !1 && b.ui.ddmanager && !k.dropBehaviour && b.ui.ddmanager.prepareOffsets(this, e)
    }
    this.positionAbs = this._convertPositionTo("absolute");
    if (!this.options.axis || this.options.axis != "y") {
      this.helper[0].style.left = this.position.left + "px"
    }
    if (!this.options.axis || this.options.axis != "x") {
      this.helper[0].style.top = this.position.top + "px"
    }
    for (var d = this.items.length - 1; d >= 0; d--) {
      var f = this.items[d], h = f.item[0], c = this._intersectsWithPointer(f);
      if (!c) {
        continue
      }
      if (f.instance !== this.currentContainer) {
        continue
      }
      if (h != this.currentItem[0] && this.placeholder[c == 1 ? "next" : "prev"]()[0] != h && !b.contains(this.placeholder[0], h) && (this.options.type == "semi-dynamic" ? !b.contains(this.element[0], h) : !0)) {
        this.direction = c == 1 ? "down" : "up";
        if (this.options.tolerance != "pointer" && !this._intersectsWithSides(f)) {
          break
        }
        this._rearrange(e, f), this._trigger("change", e, this._uiHash());
        break
      }
    }
    return this._contactContainers(e), b.ui.ddmanager && b.ui.ddmanager.drag(this, e), this._trigger("sort", e, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
  },_mouseStop: function(d, f) {
    if (!d) {
      return
    }
    b.ui.ddmanager && !this.options.dropBehaviour && b.ui.ddmanager.drop(this, d);
    if (this.options.revert) {
      var e = this, c = this.placeholder.offset();
      this.reverting = !0, b(this.helper).animate({left: c.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollLeft),top: c.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollTop)}, parseInt(this.options.revert, 10) || 500, function() {
        e._clear(d)
      })
    } else {
      this._clear(d, f)
    }
    return !1
  },cancel: function() {
    if (this.dragging) {
      this._mouseUp({target: null}), this.options.helper == "original" ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
      for (var c = this.containers.length - 1; c >= 0; c--) {
        this.containers[c]._trigger("deactivate", null, this._uiHash(this)), this.containers[c].containerCache.over && (this.containers[c]._trigger("out", null, this._uiHash(this)), this.containers[c].containerCache.over = 0)
      }
    }
    return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.options.helper != "original" && this.helper && this.helper[0].parentNode && this.helper.remove(), b.extend(this, {helper: null,dragging: !1,reverting: !1,_noFinalSort: null}), this.domPosition.prev ? b(this.domPosition.prev).after(this.currentItem) : b(this.domPosition.parent).prepend(this.currentItem)), this
  },serialize: function(c) {
    var e = this._getItemsAsjQuery(c && c.connected), d = [];
    return c = c || {}, b(e).each(function() {
      var f = (b(c.item || this).attr(c.attribute || "id") || "").match(c.expression || /(.+)[-=_](.+)/);
      f && d.push((c.key || f[1] + "[]") + "=" + (c.key && c.expression ? f[1] : f[2]))
    }), !d.length && c.key && d.push(c.key + "="), d.join("&")
  },toArray: function(c) {
    var e = this._getItemsAsjQuery(c && c.connected), d = [];
    return c = c || {}, e.each(function() {
      d.push(b(c.item || this).attr(c.attribute || "id") || "")
    }), d
  },_intersectsWith: function(q) {
    var y = this.positionAbs.left, h = y + this.helperProportions.width, d = this.positionAbs.top, m = d + this.helperProportions.height, z = q.left, g = z + q.width, x = q.top, w = x + q.height, p = this.offset.click.top, k = this.offset.click.left, v = d + p > x && d + p < w && y + k > z && y + k < g;
    return this.options.tolerance == "pointer" || this.options.forcePointerForContainers || this.options.tolerance != "pointer" && this.helperProportions[this.floating ? "width" : "height"] > q[this.floating ? "width" : "height"] ? v : z < y + this.helperProportions.width / 2 && h - this.helperProportions.width / 2 < g && x < d + this.helperProportions.height / 2 && m - this.helperProportions.height / 2 < w
  },_intersectsWithPointer: function(d) {
    var h = this.options.axis === "x" || b.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, d.top, d.height), f = this.options.axis === "y" || b.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, d.left, d.width), c = h && f, e = this._getDragVerticalDirection(), g = this._getDragHorizontalDirection();
    return c ? this.floating ? g && g == "right" || e == "down" ? 2 : 1 : e && (e == "down" ? 2 : 1) : !1
  },_intersectsWithSides: function(d) {
    var g = b.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, d.top + d.height / 2, d.height), f = b.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, d.left + d.width / 2, d.width), c = this._getDragVerticalDirection(), e = this._getDragHorizontalDirection();
    return this.floating && e ? e == "right" && f || e == "left" && !f : c && (c == "down" && g || c == "up" && !g)
  },_getDragVerticalDirection: function() {
    var c = this.positionAbs.top - this.lastPositionAbs.top;
    return c != 0 && (c > 0 ? "down" : "up")
  },_getDragHorizontalDirection: function() {
    var c = this.positionAbs.left - this.lastPositionAbs.left;
    return c != 0 && (c > 0 ? "right" : "left")
  },refresh: function(c) {
    return this._refreshItems(c), this.refreshPositions(), this
  },_connectWith: function() {
    var c = this.options;
    return c.connectWith.constructor == String ? [c.connectWith] : c.connectWith
  },_getItemsAsjQuery: function(f) {
    var l = [], h = [], e = this._connectWith();
    if (e && f) {
      for (var g = e.length - 1; g >= 0; g--) {
        var k = b(e[g]);
        for (var d = k.length - 1; d >= 0; d--) {
          var c = b.data(k[d], this.widgetName);
          c && c != this && !c.options.disabled && h.push([b.isFunction(c.options.items) ? c.options.items.call(c.element) : b(c.options.items, c.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), c])
        }
      }
    }
    h.push([b.isFunction(this.options.items) ? this.options.items.call(this.element, null, {options: this.options,item: this.currentItem}) : b(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);
    for (var g = h.length - 1; g >= 0; g--) {
      h[g][0].each(function() {
        l.push(this)
      })
    }
    return b(l)
  },_removeCurrentsFromItems: function() {
    var c = this.currentItem.find(":data(" + this.widgetName + "-item)");
    this.items = b.grep(this.items, function(d) {
      for (var f = 0; f < c.length; f++) {
        if (c[f] == d.item[0]) {
          return !1
        }
      }
      return !0
    })
  },_refreshItems: function(y) {
    this.items = [], this.containers = [this];
    var g = this.items, d = [[b.isFunction(this.options.items) ? this.options.items.call(this.element[0], y, {item: this.currentItem}) : b(this.options.items, this.element), this]], m = this._connectWith();
    if (m && this.ready) {
      for (var z = m.length - 1; z >= 0; z--) {
        var e = b(m[z]);
        for (var x = e.length - 1; x >= 0; x--) {
          var w = b.data(e[x], this.widgetName);
          w && w != this && !w.options.disabled && (d.push([b.isFunction(w.options.items) ? w.options.items.call(w.element[0], y, {item: this.currentItem}) : b(w.options.items, w.element), w]), this.containers.push(w))
        }
      }
    }
    for (var z = d.length - 1; z >= 0; z--) {
      var q = d[z][1], k = d[z][0];
      for (var x = 0, v = k.length; x < v; x++) {
        var p = b(k[x]);
        p.data(this.widgetName + "-item", q), g.push({item: p,instance: q,width: 0,height: 0,left: 0,top: 0})
      }
    }
  },refreshPositions: function(d) {
    this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
    for (var g = this.items.length - 1; g >= 0; g--) {
      var f = this.items[g];
      if (f.instance != this.currentContainer && this.currentContainer && f.item[0] != this.currentItem[0]) {
        continue
      }
      var c = this.options.toleranceElement ? b(this.options.toleranceElement, f.item) : f.item;
      d || (f.width = c.outerWidth(), f.height = c.outerHeight());
      var e = c.offset();
      f.left = e.left, f.top = e.top
    }
    if (this.options.custom && this.options.custom.refreshContainers) {
      this.options.custom.refreshContainers.call(this)
    } else {
      for (var g = this.containers.length - 1; g >= 0; g--) {
        var e = this.containers[g].element.offset();
        this.containers[g].containerCache.left = e.left, this.containers[g].containerCache.top = e.top, this.containers[g].containerCache.width = this.containers[g].element.outerWidth(), this.containers[g].containerCache.height = this.containers[g].element.outerHeight()
      }
    }
    return this
  },_createPlaceholder: function(c) {
    c = c || this;
    var e = c.options;
    if (!e.placeholder || e.placeholder.constructor == String) {
      var d = e.placeholder;
      e.placeholder = {element: function() {
        var f = b(document.createElement(c.currentItem[0].nodeName)).addClass(d || c.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
        return d || (f.style.visibility = "hidden"), f
      },update: function(g, f) {
        if (d && !e.forcePlaceholderSize) {
          return
        }
        f.height() || f.height(c.currentItem.innerHeight() - parseInt(c.currentItem.css("paddingTop") || 0, 10) - parseInt(c.currentItem.css("paddingBottom") || 0, 10)), f.width() || f.width(c.currentItem.innerWidth() - parseInt(c.currentItem.css("paddingLeft") || 0, 10) - parseInt(c.currentItem.css("paddingRight") || 0, 10))
      }}
    }
    c.placeholder = b(e.placeholder.element.call(c.element, c.currentItem)), c.currentItem.after(c.placeholder), e.placeholder.update(c, c.placeholder)
  },_contactContainers: function(y) {
    var g = null, d = null;
    for (var m = this.containers.length - 1; m >= 0; m--) {
      if (b.contains(this.currentItem[0], this.containers[m].element[0])) {
        continue
      }
      if (this._intersectsWith(this.containers[m].containerCache)) {
        if (g && b.contains(this.containers[m].element[0], g.element[0])) {
          continue
        }
        g = this.containers[m], d = m
      } else {
        this.containers[m].containerCache.over && (this.containers[m]._trigger("out", y, this._uiHash(this)), this.containers[m].containerCache.over = 0)
      }
    }
    if (!g) {
      return
    }
    if (this.containers.length === 1) {
      this.containers[d]._trigger("over", y, this._uiHash(this)), this.containers[d].containerCache.over = 1
    } else {
      var z = 10000, e = null, x = this.containers[d].floating ? "left" : "top", w = this.containers[d].floating ? "width" : "height", q = this.positionAbs[x] + this.offset.click[x];
      for (var k = this.items.length - 1; k >= 0; k--) {
        if (!b.contains(this.containers[d].element[0], this.items[k].item[0])) {
          continue
        }
        if (this.items[k].item[0] == this.currentItem[0]) {
          continue
        }
        var v = this.items[k].item.offset()[x], p = !1;
        Math.abs(v - q) > Math.abs(v + this.items[k][w] - q) && (p = !0, v += this.items[k][w]), Math.abs(v - q) < z && (z = Math.abs(v - q), e = this.items[k], this.direction = p ? "up" : "down")
      }
      if (!e && !this.options.dropOnEmpty) {
        return
      }
      this.currentContainer = this.containers[d], e ? this._rearrange(y, e, null, !0) : this._rearrange(y, null, this.containers[d].element, !0), this._trigger("change", y, this._uiHash()), this.containers[d]._trigger("change", y, this._uiHash(this)), this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[d]._trigger("over", y, this._uiHash(this)), this.containers[d].containerCache.over = 1
    }
  },_createHelper: function(c) {
    var e = this.options, d = b.isFunction(e.helper) ? b(e.helper.apply(this.element[0], [c, this.currentItem])) : e.helper == "clone" ? this.currentItem.clone() : this.currentItem;
    return d.parents("body").length || b(e.appendTo != "parent" ? e.appendTo : this.currentItem[0].parentNode)[0].appendChild(d[0]), d[0] == this.currentItem[0] && (this._storedCSS = {width: this.currentItem[0].style.width,height: this.currentItem[0].style.height,position: this.currentItem.css("position"),top: this.currentItem.css("top"),left: this.currentItem.css("left")}), (d[0].style.width == "" || e.forceHelperSize) && d.width(this.currentItem.width()), (d[0].style.height == "" || e.forceHelperSize) && d.height(this.currentItem.height()), d
  },_adjustOffsetFromHelper: function(c) {
    typeof c == "string" && (c = c.split(" ")), b.isArray(c) && (c = {left: +c[0],top: +c[1] || 0}), "left" in c && (this.offset.click.left = c.left + this.margins.left), "right" in c && (this.offset.click.left = this.helperProportions.width - c.right + this.margins.left), "top" in c && (this.offset.click.top = c.top + this.margins.top), "bottom" in c && (this.offset.click.top = this.helperProportions.height - c.bottom + this.margins.top)
  },_getParentOffset: function() {
    this.offsetParent = this.helper.offsetParent();
    var c = this.offsetParent.offset();
    this.cssPosition == "absolute" && this.scrollParent[0] != document && b.contains(this.scrollParent[0], this.offsetParent[0]) && (c.left += this.scrollParent.scrollLeft(), c.top += this.scrollParent.scrollTop());
    if (this.offsetParent[0] == document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() == "html" && b.ui.ie) {
      c = {top: 0,left: 0}
    }
    return {top: c.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),left: c.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
  },_getRelativeOffset: function() {
    if (this.cssPosition == "relative") {
      var c = this.currentItem.position();
      return {top: c.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),left: c.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
    }
    return {top: 0,left: 0}
  },_cacheMargins: function() {
    this.margins = {left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,top: parseInt(this.currentItem.css("marginTop"), 10) || 0}
  },_cacheHelperProportions: function() {
    this.helperProportions = {width: this.helper.outerWidth(),height: this.helper.outerHeight()}
  },_setContainment: function() {
    var d = this.options;
    d.containment == "parent" && (d.containment = this.helper[0].parentNode);
    if (d.containment == "document" || d.containment == "window") {
      this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, b(d.containment == "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (b(d.containment == "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]
    }
    if (!/^(document|window|parent)$/.test(d.containment)) {
      var f = b(d.containment)[0], e = b(d.containment).offset(), c = b(f).css("overflow") != "hidden";
      this.containment = [e.left + (parseInt(b(f).css("borderLeftWidth"), 10) || 0) + (parseInt(b(f).css("paddingLeft"), 10) || 0) - this.margins.left, e.top + (parseInt(b(f).css("borderTopWidth"), 10) || 0) + (parseInt(b(f).css("paddingTop"), 10) || 0) - this.margins.top, e.left + (c ? Math.max(f.scrollWidth, f.offsetWidth) : f.offsetWidth) - (parseInt(b(f).css("borderLeftWidth"), 10) || 0) - (parseInt(b(f).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, e.top + (c ? Math.max(f.scrollHeight, f.offsetHeight) : f.offsetHeight) - (parseInt(b(f).css("borderTopWidth"), 10) || 0) - (parseInt(b(f).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top]
    }
  },_convertPositionTo: function(d, h) {
    h || (h = this.position);
    var f = d == "absolute" ? 1 : -1, c = this.options, e = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!b.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, g = /(html|body)/i.test(e[0].tagName);
    return {top: h.top + this.offset.relative.top * f + this.offset.parent.top * f - (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : g ? 0 : e.scrollTop()) * f,left: h.left + this.offset.relative.left * f + this.offset.parent.left * f - (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : g ? 0 : e.scrollLeft()) * f}
  },_generatePosition: function(f) {
    var l = this.options, h = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!b.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, e = /(html|body)/i.test(h[0].tagName);
    this.cssPosition == "relative" && (this.scrollParent[0] == document || this.scrollParent[0] == this.offsetParent[0]) && (this.offset.relative = this._getRelativeOffset());
    var g = f.pageX, k = f.pageY;
    if (this.originalPosition) {
      this.containment && (f.pageX - this.offset.click.left < this.containment[0] && (g = this.containment[0] + this.offset.click.left), f.pageY - this.offset.click.top < this.containment[1] && (k = this.containment[1] + this.offset.click.top), f.pageX - this.offset.click.left > this.containment[2] && (g = this.containment[2] + this.offset.click.left), f.pageY - this.offset.click.top > this.containment[3] && (k = this.containment[3] + this.offset.click.top));
      if (l.grid) {
        var d = this.originalPageY + Math.round((k - this.originalPageY) / l.grid[1]) * l.grid[1];
        k = this.containment ? d - this.offset.click.top < this.containment[1] || d - this.offset.click.top > this.containment[3] ? d - this.offset.click.top < this.containment[1] ? d + l.grid[1] : d - l.grid[1] : d : d;
        var c = this.originalPageX + Math.round((g - this.originalPageX) / l.grid[0]) * l.grid[0];
        g = this.containment ? c - this.offset.click.left < this.containment[0] || c - this.offset.click.left > this.containment[2] ? c - this.offset.click.left < this.containment[0] ? c + l.grid[0] : c - l.grid[0] : c : c
      }
    }
    return {top: k - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : e ? 0 : h.scrollTop()),left: g - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : e ? 0 : h.scrollLeft())}
  },_rearrange: function(g, d, h, f) {
    h ? h[0].appendChild(this.placeholder[0]) : d.item[0].parentNode.insertBefore(this.placeholder[0], this.direction == "down" ? d.item[0] : d.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
    var c = this.counter;
    this._delay(function() {
      c == this.counter && this.refreshPositions(!f)
    })
  },_clear: function(d, f) {
    this.reverting = !1;
    var e = [];
    !this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null;
    if (this.helper[0] == this.currentItem[0]) {
      for (var c in this._storedCSS) {
        if (this._storedCSS[c] == "auto" || this._storedCSS[c] == "static") {
          this._storedCSS[c] = ""
        }
      }
      this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
    } else {
      this.currentItem.show()
    }
    this.fromOutside && !f && e.push(function(g) {
      this._trigger("receive", g, this._uiHash(this.fromOutside))
    }), (this.fromOutside || this.domPosition.prev != this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent != this.currentItem.parent()[0]) && !f && e.push(function(g) {
      this._trigger("update", g, this._uiHash())
    }), this !== this.currentContainer && (f || (e.push(function(g) {
      this._trigger("remove", g, this._uiHash())
    }), e.push(function(g) {
      return function(h) {
        g._trigger("receive", h, this._uiHash(this))
      }
    }.call(this, this.currentContainer)), e.push(function(g) {
      return function(h) {
        g._trigger("update", h, this._uiHash(this))
      }
    }.call(this, this.currentContainer))));
    for (var c = this.containers.length - 1; c >= 0; c--) {
      f || e.push(function(g) {
        return function(h) {
          g._trigger("deactivate", h, this._uiHash(this))
        }
      }.call(this, this.containers[c])), this.containers[c].containerCache.over && (e.push(function(g) {
        return function(h) {
          g._trigger("out", h, this._uiHash(this))
        }
      }.call(this, this.containers[c])), this.containers[c].containerCache.over = 0)
    }
    this._storedCursor && b("body").css("cursor", this._storedCursor), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", this._storedZIndex == "auto" ? "" : this._storedZIndex), this.dragging = !1;
    if (this.cancelHelperRemoval) {
      if (!f) {
        this._trigger("beforeStop", d, this._uiHash());
        for (var c = 0; c < e.length; c++) {
          e[c].call(this, d)
        }
        this._trigger("stop", d, this._uiHash())
      }
      return this.fromOutside = !1, !1
    }
    f || this._trigger("beforeStop", d, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] != this.currentItem[0] && this.helper.remove(), this.helper = null;
    if (!f) {
      for (var c = 0; c < e.length; c++) {
        e[c].call(this, d)
      }
      this._trigger("stop", d, this._uiHash())
    }
    return this.fromOutside = !1, !0
  },_trigger: function() {
    b.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel()
  },_uiHash: function(c) {
    var d = c || this;
    return {helper: d.helper,placeholder: d.placeholder || b([]),position: d.position,originalPosition: d.originalPosition,offset: d.positionAbs,item: d.currentItem,sender: c ? c.element : null}
  }})
})(jQuery);
/*
 * jQuery Cookie Plugin v1.3
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function(f, b, g) {
  var a = /\+/g;
  function e(h) {
    return h
  }
  function c(h) {
    return decodeURIComponent(h.replace(a, " "))
  }
  var d = f.cookie = function(q, p, v) {
    if (p !== g) {
      v = f.extend({}, d.defaults, v);
      if (p === null) {
        v.expires = -1
      }
      if (typeof v.expires === "number") {
        var r = v.expires, u = v.expires = new Date();
        u.setDate(u.getDate() + r)
      }
      p = d.json ? JSON.stringify(p) : String(p);
      return (b.cookie = [encodeURIComponent(q), "=", d.raw ? p : encodeURIComponent(p), v.expires ? "; expires=" + v.expires.toUTCString() : "", v.path ? "; path=" + v.path : "", v.domain ? "; domain=" + v.domain : "", v.secure ? "; secure" : ""].join(""))
    }
    var h = d.raw ? e : c;
    var s = b.cookie.split("; ");
    for (var o = 0, m = s.length; o < m; o++) {
      var n = s[o].split("=");
      if (h(n.shift()) === q) {
        var k = h(n.join("="));
        return d.json ? JSON.parse(k) : k
      }
    }
    return null
  };
  d.defaults = {};
  f.removeCookie = function(k, h) {
    if (f.cookie(k) !== null) {
      f.cookie(k, null, h);
      return true
    }
    return false
  }
})(jQuery, document);
(function() {
  (function(a) {
    if (typeof define === "function" && define.amd) {
      return define(["jquery"], a)
    } else {
      return a(jQuery)
    }
  })(function(d) {
    var h, g, e, c, b, a, f;
    a = function() {
      var k;
      k = b(this);
      if (!isNaN(k.datetime)) {
        d(this).text(c(k.datetime))
      }
      return this
    };
    b = function(k) {
      var l;
      k = d(k);
      if (!k.data("elapsed")) {
        k.data("elapsed", {datetime: h.datetime(k)});
        l = d.trim(k.text());
        if (h.settings.localeTitle) {
          k.attr("title", k.data("elapsed").datetime.toLocaleString())
        } else {
          if (l.length > 0 && !(h.isTime(k) && k.attr("title"))) {
            k.attr("title", l)
          }
        }
      }
      return k.data("elapsed")
    };
    c = function(k) {
      return h.inWords(g(k))
    };
    g = function(k) {
      return new Date().getTime() - k.getTime()
    };
    f = function(l) {
      var k;
      k = {year: "год",m: "мес",w: "нед",d: "д",h: "ч",min: "мин",sec: "сек",now: "сейчас"};
      if (d.cookie("lang") === "ru") {
        return k[l]
      } else {
        return l
      }
    };
    d.elapsed = function(k) {
      if (k instanceof Date) {
        return c(k)
      } else {
        if (typeof k === "string") {
          return c(d.elapsed.parse(k))
        } else {
          if (typeof k === "number") {
            return c(new Date(k))
          } else {
            return c(d.elapsed.datetime(k))
          }
        }
      }
    };
    h = d.elapsed;
    d.extend(d.elapsed, {settings: {refreshMillis: 60000,allowFuture: false,localeTitle: false,strings: {prefixAgo: null,prefixFromNow: null,suffixAgo: "",suffixFromNow: "from now",seconds: "" + (f("now")),minute: "1 " + (f("min")),minutes: "%d " + (f("min")),hour: "1 " + (f("h")),hours: "%d " + (f("h")),day: "1 " + (f("d")),days: "%d " + (f("d")),month: "1 " + (f("m")),months: "%d " + (f("m")),year: "1 " + (f("year")),years: "%d " + (f("year")),wordSeparator: " ",numbers: []}},inWords: function(q) {
      var r, v, s, k, n, t, l, m, u, p, o;
      m = function(w, y) {
        var x, z;
        x = (d.isFunction(w) ? w(y, q) : w);
        z = (r.numbers && r.numbers[y]) || y;
        return x.replace(/%d/i, z)
      };
      r = this.settings.strings;
      n = r.prefixAgo;
      u = r.suffixAgo;
      if (this.settings.allowFuture) {
        if (q < 0) {
          n = r.prefixFromNow;
          u = r.suffixFromNow
        }
      }
      t = Math.abs(q) / 1000;
      k = t / 60;
      s = k / 60;
      v = s / 24;
      o = v / 365;
      p = t < 45 && m(r.seconds, Math.round(t)) || t < 90 && m(r.minute, 1) || k < 45 && m(r.minutes, Math.round(k)) || k < 90 && m(r.hour, 1) || s < 24 && m(r.hours, Math.round(s)) || s < 42 && m(r.day, 1) || v < 30 && m(r.days, Math.round(v)) || v < 45 && m(r.month, 1) || v < 365 && m(r.months, Math.round(v / 30)) || o < 1.5 && m(r.year, 1) || m(r.years, Math.round(o));
      l = r.wordSeparator || "";
      if (r.wordSeparator === undefined) {
        l = " "
      }
      return d.trim([n, p, u].join(l))
    },parse: function(l) {
      var k;
      k = d.trim(l);
      k = k.replace(/\.\d+/, "");
      k = k.replace(/-/, "/").replace(/-/, "/");
      k = k.replace(/T/, " ").replace(/Z/, " UTC");
      k = k.replace(/([\+\-]\d\d)\:?(\d\d)/, " $1$2");
      return new Date(k)
    },datetime: function(l) {
      var k;
      k = (h.isTime(l) ? d(l).attr("datetime") : d(l).attr("title"));
      return h.parse(k)
    },isTime: function(k) {
      var l;
      return ((l = d(k).get(0)) != null ? l.tagName.toLowerCase() : void 0) === "time"
    }});
    e = {init: function() {
      var k, l;
      l = d.proxy(a, this);
      l();
      k = h.settings;
      if (k.refreshMillis > 0) {
        return setInterval(l, k.refreshMillis)
      }
    },update: function(k) {
      d(this).data("elapsed", {datetime: h.parse(k)});
      return a.apply(this)
    }};
    d.fn.elapsed = function(m, k) {
      var l;
      l = (m ? e[m] : e.init);
      if (!l) {
        throw new Error("Unknown function name '" + m + "' for elapsed")
      }
      this.each(function() {
        return l.call(this, k)
      });
      return this
    };
    document.createElement("abbr");
    return document.createElement("time")
  })
}).call(this);
function utf8_encode(a) {
  if (a === null || typeof a === "undefined") {
    return ""
  }
  var h = (a + "");
  var k = "", b, e, c = 0;
  b = e = 0;
  c = h.length;
  for (var d = 0; d < c; d++) {
    var g = h.charCodeAt(d);
    var f = null;
    if (g < 128) {
      e++
    } else {
      if (g > 127 && g < 2048) {
        f = String.fromCharCode((g >> 6) | 192) + String.fromCharCode((g & 63) | 128)
      } else {
        f = String.fromCharCode((g >> 12) | 224) + String.fromCharCode(((g >> 6) & 63) | 128) + String.fromCharCode((g & 63) | 128)
      }
    }
    if (f !== null) {
      if (e > b) {
        k += h.slice(b, e)
      }
      k += f;
      b = e = d + 1
    }
  }
  if (e > b) {
    k += h.slice(b, c)
  }
  return k
}
function md5(E) {
  var F;
  var z = function(b, a) {
    return (b << a) | (b >>> (32 - a))
  };
  var J = function(k, b) {
    var X, a, d, x, c;
    d = (k & 2147483648);
    x = (b & 2147483648);
    X = (k & 1073741824);
    a = (b & 1073741824);
    c = (k & 1073741823) + (b & 1073741823);
    if (X & a) {
      return (c ^ 2147483648 ^ d ^ x)
    }
    if (X | a) {
      if (c & 1073741824) {
        return (c ^ 3221225472 ^ d ^ x)
      } else {
        return (c ^ 1073741824 ^ d ^ x)
      }
    } else {
      return (c ^ d ^ x)
    }
  };
  var t = function(a, c, b) {
    return (a & c) | ((~a) & b)
  };
  var s = function(a, c, b) {
    return (a & b) | (c & (~b))
  };
  var r = function(a, c, b) {
    return (a ^ c ^ b)
  };
  var p = function(a, c, b) {
    return (c ^ (a | (~b)))
  };
  var w = function(Y, X, ad, ab, k, Z, aa) {
    Y = J(Y, J(J(t(X, ad, ab), k), aa));
    return J(z(Y, Z), X)
  };
  var f = function(Y, X, ad, ab, k, Z, aa) {
    Y = J(Y, J(J(s(X, ad, ab), k), aa));
    return J(z(Y, Z), X)
  };
  var H = function(Y, X, ad, ab, k, Z, aa) {
    Y = J(Y, J(J(r(X, ad, ab), k), aa));
    return J(z(Y, Z), X)
  };
  var v = function(Y, X, ad, ab, k, Z, aa) {
    Y = J(Y, J(J(p(X, ad, ab), k), aa));
    return J(z(Y, Z), X)
  };
  var e = function(X) {
    var Y;
    var d = X.length;
    var c = d + 8;
    var b = (c - (c % 64)) / 64;
    var x = (b + 1) * 16;
    var Z = new Array(x - 1);
    var a = 0;
    var k = 0;
    while (k < d) {
      Y = (k - (k % 4)) / 4;
      a = (k % 4) * 8;
      Z[Y] = (Z[Y] | (X.charCodeAt(k) << a));
      k++
    }
    Y = (k - (k % 4)) / 4;
    a = (k % 4) * 8;
    Z[Y] = Z[Y] | (128 << a);
    Z[x - 2] = d << 3;
    Z[x - 1] = d >>> 29;
    return Z
  };
  var u = function(d) {
    var a = "", b = "", k, c;
    for (c = 0; c <= 3; c++) {
      k = (d >>> (c * 8)) & 255;
      b = "0" + k.toString(16);
      a = a + b.substr(b.length - 2, 2)
    }
    return a
  };
  var G = [], N, h, I, y, g, W, V, U, T, Q = 7, O = 12, L = 17, K = 22, D = 5, C = 9, B = 14, A = 20, q = 4, o = 11, n = 16, m = 23, S = 6, R = 10, P = 15, M = 21;
  E = this.utf8_encode(E);
  G = e(E);
  W = 1732584193;
  V = 4023233417;
  U = 2562383102;
  T = 271733878;
  F = G.length;
  for (N = 0; N < F; N += 16) {
    h = W;
    I = V;
    y = U;
    g = T;
    W = w(W, V, U, T, G[N + 0], Q, 3614090360);
    T = w(T, W, V, U, G[N + 1], O, 3905402710);
    U = w(U, T, W, V, G[N + 2], L, 606105819);
    V = w(V, U, T, W, G[N + 3], K, 3250441966);
    W = w(W, V, U, T, G[N + 4], Q, 4118548399);
    T = w(T, W, V, U, G[N + 5], O, 1200080426);
    U = w(U, T, W, V, G[N + 6], L, 2821735955);
    V = w(V, U, T, W, G[N + 7], K, 4249261313);
    W = w(W, V, U, T, G[N + 8], Q, 1770035416);
    T = w(T, W, V, U, G[N + 9], O, 2336552879);
    U = w(U, T, W, V, G[N + 10], L, 4294925233);
    V = w(V, U, T, W, G[N + 11], K, 2304563134);
    W = w(W, V, U, T, G[N + 12], Q, 1804603682);
    T = w(T, W, V, U, G[N + 13], O, 4254626195);
    U = w(U, T, W, V, G[N + 14], L, 2792965006);
    V = w(V, U, T, W, G[N + 15], K, 1236535329);
    W = f(W, V, U, T, G[N + 1], D, 4129170786);
    T = f(T, W, V, U, G[N + 6], C, 3225465664);
    U = f(U, T, W, V, G[N + 11], B, 643717713);
    V = f(V, U, T, W, G[N + 0], A, 3921069994);
    W = f(W, V, U, T, G[N + 5], D, 3593408605);
    T = f(T, W, V, U, G[N + 10], C, 38016083);
    U = f(U, T, W, V, G[N + 15], B, 3634488961);
    V = f(V, U, T, W, G[N + 4], A, 3889429448);
    W = f(W, V, U, T, G[N + 9], D, 568446438);
    T = f(T, W, V, U, G[N + 14], C, 3275163606);
    U = f(U, T, W, V, G[N + 3], B, 4107603335);
    V = f(V, U, T, W, G[N + 8], A, 1163531501);
    W = f(W, V, U, T, G[N + 13], D, 2850285829);
    T = f(T, W, V, U, G[N + 2], C, 4243563512);
    U = f(U, T, W, V, G[N + 7], B, 1735328473);
    V = f(V, U, T, W, G[N + 12], A, 2368359562);
    W = H(W, V, U, T, G[N + 5], q, 4294588738);
    T = H(T, W, V, U, G[N + 8], o, 2272392833);
    U = H(U, T, W, V, G[N + 11], n, 1839030562);
    V = H(V, U, T, W, G[N + 14], m, 4259657740);
    W = H(W, V, U, T, G[N + 1], q, 2763975236);
    T = H(T, W, V, U, G[N + 4], o, 1272893353);
    U = H(U, T, W, V, G[N + 7], n, 4139469664);
    V = H(V, U, T, W, G[N + 10], m, 3200236656);
    W = H(W, V, U, T, G[N + 13], q, 681279174);
    T = H(T, W, V, U, G[N + 0], o, 3936430074);
    U = H(U, T, W, V, G[N + 3], n, 3572445317);
    V = H(V, U, T, W, G[N + 6], m, 76029189);
    W = H(W, V, U, T, G[N + 9], q, 3654602809);
    T = H(T, W, V, U, G[N + 12], o, 3873151461);
    U = H(U, T, W, V, G[N + 15], n, 530742520);
    V = H(V, U, T, W, G[N + 2], m, 3299628645);
    W = v(W, V, U, T, G[N + 0], S, 4096336452);
    T = v(T, W, V, U, G[N + 7], R, 1126891415);
    U = v(U, T, W, V, G[N + 14], P, 2878612391);
    V = v(V, U, T, W, G[N + 5], M, 4237533241);
    W = v(W, V, U, T, G[N + 12], S, 1700485571);
    T = v(T, W, V, U, G[N + 3], R, 2399980690);
    U = v(U, T, W, V, G[N + 10], P, 4293915773);
    V = v(V, U, T, W, G[N + 1], M, 2240044497);
    W = v(W, V, U, T, G[N + 8], S, 1873313359);
    T = v(T, W, V, U, G[N + 15], R, 4264355552);
    U = v(U, T, W, V, G[N + 6], P, 2734768916);
    V = v(V, U, T, W, G[N + 13], M, 1309151649);
    W = v(W, V, U, T, G[N + 4], S, 4149444226);
    T = v(T, W, V, U, G[N + 11], R, 3174756917);
    U = v(U, T, W, V, G[N + 2], P, 718787259);
    V = v(V, U, T, W, G[N + 9], M, 3951481745);
    W = J(W, h);
    V = J(V, I);
    U = J(U, y);
    T = J(T, g)
  }
  var l = u(W) + u(V) + u(U) + u(T);
  return l.toLowerCase()
}
var Base64 = {_keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode: function(c) {
  var a = "";
  var l, h, f, k, g, e, d;
  var b = 0;
  c = Base64._utf8_encode(c);
  while (b < c.length) {
    l = c.charCodeAt(b++);
    h = c.charCodeAt(b++);
    f = c.charCodeAt(b++);
    k = l >> 2;
    g = ((l & 3) << 4) | (h >> 4);
    e = ((h & 15) << 2) | (f >> 6);
    d = f & 63;
    if (isNaN(h)) {
      e = d = 64
    } else {
      if (isNaN(f)) {
        d = 64
      }
    }
    a = a + this._keyStr.charAt(k) + this._keyStr.charAt(g) + this._keyStr.charAt(e) + this._keyStr.charAt(d)
  }
  return a
},decode: function(c) {
  var a = "";
  var l, h, f;
  var k, g, e, d;
  var b = 0;
  c = c.replace(/[^A-Za-z0-9\+\/\=]/g, "");
  while (b < c.length) {
    k = this._keyStr.indexOf(c.charAt(b++));
    g = this._keyStr.indexOf(c.charAt(b++));
    e = this._keyStr.indexOf(c.charAt(b++));
    d = this._keyStr.indexOf(c.charAt(b++));
    l = (k << 2) | (g >> 4);
    h = ((g & 15) << 4) | (e >> 2);
    f = ((e & 3) << 6) | d;
    a = a + String.fromCharCode(l);
    if (e != 64) {
      a = a + String.fromCharCode(h)
    }
    if (d != 64) {
      a = a + String.fromCharCode(f)
    }
  }
  a = Base64._utf8_decode(a);
  return a
},_utf8_encode: function(b) {
  b = b.replace(/\r\n/g, "\n");
  var a = "";
  for (var e = 0; e < b.length; e++) {
    var d = b.charCodeAt(e);
    if (d < 128) {
      a += String.fromCharCode(d)
    } else {
      if ((d > 127) && (d < 2048)) {
        a += String.fromCharCode((d >> 6) | 192);
        a += String.fromCharCode((d & 63) | 128)
      } else {
        a += String.fromCharCode((d >> 12) | 224);
        a += String.fromCharCode(((d >> 6) & 63) | 128);
        a += String.fromCharCode((d & 63) | 128)
      }
    }
  }
  return a
},_utf8_decode: function(a) {
  var b = "";
  var d = 0;
  var e = c1 = c2 = 0;
  while (d < a.length) {
    e = a.charCodeAt(d);
    if (e < 128) {
      b += String.fromCharCode(e);
      d++
    } else {
      if ((e > 191) && (e < 224)) {
        c2 = a.charCodeAt(d + 1);
        b += String.fromCharCode(((e & 31) << 6) | (c2 & 63));
        d += 2
      } else {
        c2 = a.charCodeAt(d + 1);
        c3 = a.charCodeAt(d + 2);
        b += String.fromCharCode(((e & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
        d += 3
      }
    }
  }
  return b
}};
(function() {
  var y = this;
  var m = y._;
  var F = {};
  var E = Array.prototype, f = Object.prototype, t = Function.prototype;
  var J = E.push, q = E.slice, A = E.concat, d = f.toString, l = f.hasOwnProperty;
  var N = E.forEach, s = E.map, G = E.reduce, c = E.reduceRight, b = E.filter, D = E.every, r = E.some, p = E.indexOf, n = E.lastIndexOf, w = Array.isArray, e = Object.keys, H = t.bind;
  var O = function(P) {
    if (P instanceof O) {
      return P
    }
    if (!(this instanceof O)) {
      return new O(P)
    }
    this._wrapped = P
  };
  if (typeof exports !== "undefined") {
    if (typeof module !== "undefined" && module.exports) {
      exports = module.exports = O
    }
    exports._ = O
  } else {
    y._ = O
  }
  O.VERSION = "1.4.3";
  var K = O.each = O.forEach = function(U, T, S) {
    if (U == null) {
      return
    }
    if (N && U.forEach === N) {
      U.forEach(T, S)
    } else {
      if (U.length === +U.length) {
        for (var R = 0, P = U.length; R < P; R++) {
          if (T.call(S, U[R], R, U) === F) {
            return
          }
        }
      } else {
        for (var Q in U) {
          if (O.has(U, Q)) {
            if (T.call(S, U[Q], Q, U) === F) {
              return
            }
          }
        }
      }
    }
  };
  O.map = O.collect = function(S, R, Q) {
    var P = [];
    if (S == null) {
      return P
    }
    if (s && S.map === s) {
      return S.map(R, Q)
    }
    K(S, function(V, T, U) {
      P[P.length] = R.call(Q, V, T, U)
    });
    return P
  };
  var g = "Reduce of empty array with no initial value";
  O.reduce = O.foldl = O.inject = function(T, S, P, R) {
    var Q = arguments.length > 2;
    if (T == null) {
      T = []
    }
    if (G && T.reduce === G) {
      if (R) {
        S = O.bind(S, R)
      }
      return Q ? T.reduce(S, P) : T.reduce(S)
    }
    K(T, function(W, U, V) {
      if (!Q) {
        P = W;
        Q = true
      } else {
        P = S.call(R, P, W, U, V)
      }
    });
    if (!Q) {
      throw new TypeError(g)
    }
    return P
  };
  O.reduceRight = O.foldr = function(V, S, P, R) {
    var Q = arguments.length > 2;
    if (V == null) {
      V = []
    }
    if (c && V.reduceRight === c) {
      if (R) {
        S = O.bind(S, R)
      }
      return Q ? V.reduceRight(S, P) : V.reduceRight(S)
    }
    var U = V.length;
    if (U !== +U) {
      var T = O.keys(V);
      U = T.length
    }
    K(V, function(Y, W, X) {
      W = T ? T[--U] : --U;
      if (!Q) {
        P = V[W];
        Q = true
      } else {
        P = S.call(R, P, V[W], W, X)
      }
    });
    if (!Q) {
      throw new TypeError(g)
    }
    return P
  };
  O.find = O.detect = function(S, R, Q) {
    var P;
    C(S, function(V, T, U) {
      if (R.call(Q, V, T, U)) {
        P = V;
        return true
      }
    });
    return P
  };
  O.filter = O.select = function(S, R, Q) {
    var P = [];
    if (S == null) {
      return P
    }
    if (b && S.filter === b) {
      return S.filter(R, Q)
    }
    K(S, function(V, T, U) {
      if (R.call(Q, V, T, U)) {
        P[P.length] = V
      }
    });
    return P
  };
  O.reject = function(R, Q, P) {
    return O.filter(R, function(U, S, T) {
      return !Q.call(P, U, S, T)
    }, P)
  };
  O.every = O.all = function(S, R, Q) {
    R || (R = O.identity);
    var P = true;
    if (S == null) {
      return P
    }
    if (D && S.every === D) {
      return S.every(R, Q)
    }
    K(S, function(V, T, U) {
      if (!(P = P && R.call(Q, V, T, U))) {
        return F
      }
    });
    return !!P
  };
  var C = O.some = O.any = function(S, R, Q) {
    R || (R = O.identity);
    var P = false;
    if (S == null) {
      return P
    }
    if (r && S.some === r) {
      return S.some(R, Q)
    }
    K(S, function(V, T, U) {
      if (P || (P = R.call(Q, V, T, U))) {
        return F
      }
    });
    return !!P
  };
  O.contains = O.include = function(Q, P) {
    if (Q == null) {
      return false
    }
    if (p && Q.indexOf === p) {
      return Q.indexOf(P) != -1
    }
    return C(Q, function(R) {
      return R === P
    })
  };
  O.invoke = function(Q, R) {
    var P = q.call(arguments, 2);
    return O.map(Q, function(S) {
      return (O.isFunction(R) ? R : S[R]).apply(S, P)
    })
  };
  O.pluck = function(Q, P) {
    return O.map(Q, function(R) {
      return R[P]
    })
  };
  O.where = function(Q, P) {
    if (O.isEmpty(P)) {
      return []
    }
    return O.filter(Q, function(S) {
      for (var R in P) {
        if (P[R] !== S[R]) {
          return false
        }
      }
      return true
    })
  };
  O.max = function(S, R, Q) {
    if (!R && O.isArray(S) && S[0] === +S[0] && S.length < 65535) {
      return Math.max.apply(Math, S)
    }
    if (!R && O.isEmpty(S)) {
      return -Infinity
    }
    var P = {computed: -Infinity,value: -Infinity};
    K(S, function(W, T, V) {
      var U = R ? R.call(Q, W, T, V) : W;
      U >= P.computed && (P = {value: W,computed: U})
    });
    return P.value
  };
  O.min = function(S, R, Q) {
    if (!R && O.isArray(S) && S[0] === +S[0] && S.length < 65535) {
      return Math.min.apply(Math, S)
    }
    if (!R && O.isEmpty(S)) {
      return Infinity
    }
    var P = {computed: Infinity,value: Infinity};
    K(S, function(W, T, V) {
      var U = R ? R.call(Q, W, T, V) : W;
      U < P.computed && (P = {value: W,computed: U})
    });
    return P.value
  };
  O.shuffle = function(S) {
    var R;
    var Q = 0;
    var P = [];
    K(S, function(T) {
      R = O.random(Q++);
      P[Q - 1] = P[R];
      P[R] = T
    });
    return P
  };
  var a = function(P) {
    return O.isFunction(P) ? P : function(Q) {
      return Q[P]
    }
  };
  O.sortBy = function(S, R, P) {
    var Q = a(R);
    return O.pluck(O.map(S, function(V, T, U) {
      return {value: V,index: T,criteria: Q.call(P, V, T, U)}
    }).sort(function(W, V) {
        var U = W.criteria;
        var T = V.criteria;
        if (U !== T) {
          if (U > T || U === void 0) {
            return 1
          }
          if (U < T || T === void 0) {
            return -1
          }
        }
        return W.index < V.index ? -1 : 1
      }), "value")
  };
  var v = function(U, T, Q, S) {
    var P = {};
    var R = a(T || O.identity);
    K(U, function(X, V) {
      var W = R.call(Q, X, V, U);
      S(P, W, X)
    });
    return P
  };
  O.groupBy = function(R, Q, P) {
    return v(R, Q, P, function(S, T, U) {
      (O.has(S, T) ? S[T] : (S[T] = [])).push(U)
    })
  };
  O.countBy = function(R, Q, P) {
    return v(R, Q, P, function(S, T) {
      if (!O.has(S, T)) {
        S[T] = 0
      }
      S[T]++
    })
  };
  O.sortedIndex = function(W, V, S, R) {
    S = S == null ? O.identity : a(S);
    var U = S.call(R, V);
    var P = 0, T = W.length;
    while (P < T) {
      var Q = (P + T) >>> 1;
      S.call(R, W[Q]) < U ? P = Q + 1 : T = Q
    }
    return P
  };
  O.toArray = function(P) {
    if (!P) {
      return []
    }
    if (O.isArray(P)) {
      return q.call(P)
    }
    if (P.length === +P.length) {
      return O.map(P, O.identity)
    }
    return O.values(P)
  };
  O.size = function(P) {
    if (P == null) {
      return 0
    }
    return (P.length === +P.length) ? P.length : O.keys(P).length
  };
  O.first = O.head = O.take = function(R, Q, P) {
    if (R == null) {
      return void 0
    }
    return (Q != null) && !P ? q.call(R, 0, Q) : R[0]
  };
  O.initial = function(R, Q, P) {
    return q.call(R, 0, R.length - ((Q == null) || P ? 1 : Q))
  };
  O.last = function(R, Q, P) {
    if (R == null) {
      return void 0
    }
    if ((Q != null) && !P) {
      return q.call(R, Math.max(R.length - Q, 0))
    } else {
      return R[R.length - 1]
    }
  };
  O.rest = O.tail = O.drop = function(R, Q, P) {
    return q.call(R, (Q == null) || P ? 1 : Q)
  };
  O.compact = function(P) {
    return O.filter(P, O.identity)
  };
  var z = function(Q, R, P) {
    K(Q, function(S) {
      if (O.isArray(S)) {
        R ? J.apply(P, S) : z(S, R, P)
      } else {
        P.push(S)
      }
    });
    return P
  };
  O.flatten = function(Q, P) {
    return z(Q, P, [])
  };
  O.without = function(P) {
    return O.difference(P, q.call(arguments, 1))
  };
  O.uniq = O.unique = function(V, U, T, S) {
    if (O.isFunction(U)) {
      S = T;
      T = U;
      U = false
    }
    var Q = T ? O.map(V, T, S) : V;
    var R = [];
    var P = [];
    K(Q, function(X, W) {
      if (U ? (!W || P[P.length - 1] !== X) : !O.contains(P, X)) {
        P.push(X);
        R.push(V[W])
      }
    });
    return R
  };
  O.union = function() {
    return O.uniq(A.apply(E, arguments))
  };
  O.intersection = function(Q) {
    var P = q.call(arguments, 1);
    return O.filter(O.uniq(Q), function(R) {
      return O.every(P, function(S) {
        return O.indexOf(S, R) >= 0
      })
    })
  };
  O.difference = function(Q) {
    var P = A.apply(E, q.call(arguments, 1));
    return O.filter(Q, function(R) {
      return !O.contains(P, R)
    })
  };
  O.zip = function() {
    var P = q.call(arguments);
    var S = O.max(O.pluck(P, "length"));
    var R = new Array(S);
    for (var Q = 0; Q < S; Q++) {
      R[Q] = O.pluck(P, "" + Q)
    }
    return R
  };
  O.object = function(T, R) {
    if (T == null) {
      return {}
    }
    var P = {};
    for (var S = 0, Q = T.length; S < Q; S++) {
      if (R) {
        P[T[S]] = R[S]
      } else {
        P[T[S][0]] = T[S][1]
      }
    }
    return P
  };
  O.indexOf = function(T, R, S) {
    if (T == null) {
      return -1
    }
    var Q = 0, P = T.length;
    if (S) {
      if (typeof S == "number") {
        Q = (S < 0 ? Math.max(0, P + S) : S)
      } else {
        Q = O.sortedIndex(T, R);
        return T[Q] === R ? Q : -1
      }
    }
    if (p && T.indexOf === p) {
      return T.indexOf(R, S)
    }
    for (; Q < P; Q++) {
      if (T[Q] === R) {
        return Q
      }
    }
    return -1
  };
  O.lastIndexOf = function(T, R, S) {
    if (T == null) {
      return -1
    }
    var P = S != null;
    if (n && T.lastIndexOf === n) {
      return P ? T.lastIndexOf(R, S) : T.lastIndexOf(R)
    }
    var Q = (P ? S : T.length);
    while (Q--) {
      if (T[Q] === R) {
        return Q
      }
    }
    return -1
  };
  O.range = function(U, S, T) {
    if (arguments.length <= 1) {
      S = U || 0;
      U = 0
    }
    T = arguments[2] || 1;
    var Q = Math.max(Math.ceil((S - U) / T), 0);
    var P = 0;
    var R = new Array(Q);
    while (P < Q) {
      R[P++] = U;
      U += T
    }
    return R
  };
  var I = function() {
  };
  O.bind = function(S, Q) {
    var P, R;
    if (S.bind === H && H) {
      return H.apply(S, q.call(arguments, 1))
    }
    if (!O.isFunction(S)) {
      throw new TypeError
    }
    P = q.call(arguments, 2);
    return R = function() {
      if (!(this instanceof R)) {
        return S.apply(Q, P.concat(q.call(arguments)))
      }
      I.prototype = S.prototype;
      var U = new I;
      I.prototype = null;
      var T = S.apply(U, P.concat(q.call(arguments)));
      if (Object(T) === T) {
        return T
      }
      return U
    }
  };
  O.bindAll = function(Q) {
    var P = q.call(arguments, 1);
    if (P.length == 0) {
      P = O.functions(Q)
    }
    K(P, function(R) {
      Q[R] = O.bind(Q[R], Q)
    });
    return Q
  };
  O.memoize = function(R, Q) {
    var P = {};
    Q || (Q = O.identity);
    return function() {
      var S = Q.apply(this, arguments);
      return O.has(P, S) ? P[S] : (P[S] = R.apply(this, arguments))
    }
  };
  O.delay = function(Q, R) {
    var P = q.call(arguments, 2);
    return setTimeout(function() {
      return Q.apply(null, P)
    }, R)
  };
  O.defer = function(P) {
    return O.delay.apply(O, [P, 1].concat(q.call(arguments, 1)))
  };
  O.throttle = function(U, W) {
    var S, R, V, P;
    var T = 0;
    var Q = function() {
      T = new Date;
      V = null;
      P = U.apply(S, R)
    };
    return function() {
      var X = new Date;
      var Y = W - (X - T);
      S = this;
      R = arguments;
      if (Y <= 0) {
        clearTimeout(V);
        V = null;
        T = X;
        P = U.apply(S, R)
      } else {
        if (!V) {
          V = setTimeout(Q, Y)
        }
      }
      return P
    }
  };
  O.debounce = function(R, T, Q) {
    var S, P;
    return function() {
      var X = this, W = arguments;
      var V = function() {
        S = null;
        if (!Q) {
          P = R.apply(X, W)
        }
      };
      var U = Q && !S;
      clearTimeout(S);
      S = setTimeout(V, T);
      if (U) {
        P = R.apply(X, W)
      }
      return P
    }
  };
  O.once = function(R) {
    var P = false, Q;
    return function() {
      if (P) {
        return Q
      }
      P = true;
      Q = R.apply(this, arguments);
      R = null;
      return Q
    }
  };
  O.wrap = function(P, Q) {
    return function() {
      var R = [P];
      J.apply(R, arguments);
      return Q.apply(this, R)
    }
  };
  O.compose = function() {
    var P = arguments;
    return function() {
      var Q = arguments;
      for (var R = P.length - 1; R >= 0; R--) {
        Q = [P[R].apply(this, Q)]
      }
      return Q[0]
    }
  };
  O.after = function(Q, P) {
    if (Q <= 0) {
      return P()
    }
    return function() {
      if (--Q < 1) {
        return P.apply(this, arguments)
      }
    }
  };
  O.keys = e || function(R) {
    if (R !== Object(R)) {
      throw new TypeError("Invalid object")
    }
    var Q = [];
    for (var P in R) {
      if (O.has(R, P)) {
        Q[Q.length] = P
      }
    }
    return Q
  };
  O.values = function(R) {
    var P = [];
    for (var Q in R) {
      if (O.has(R, Q)) {
        P.push(R[Q])
      }
    }
    return P
  };
  O.pairs = function(R) {
    var Q = [];
    for (var P in R) {
      if (O.has(R, P)) {
        Q.push([P, R[P]])
      }
    }
    return Q
  };
  O.invert = function(R) {
    var P = {};
    for (var Q in R) {
      if (O.has(R, Q)) {
        P[R[Q]] = Q
      }
    }
    return P
  };
  O.functions = O.methods = function(R) {
    var Q = [];
    for (var P in R) {
      if (O.isFunction(R[P])) {
        Q.push(P)
      }
    }
    return Q.sort()
  };
  O.extend = function(P) {
    K(q.call(arguments, 1), function(Q) {
      if (Q) {
        for (var R in Q) {
          P[R] = Q[R]
        }
      }
    });
    return P
  };
  O.pick = function(Q) {
    var R = {};
    var P = A.apply(E, q.call(arguments, 1));
    K(P, function(S) {
      if (S in Q) {
        R[S] = Q[S]
      }
    });
    return R
  };
  O.omit = function(R) {
    var S = {};
    var Q = A.apply(E, q.call(arguments, 1));
    for (var P in R) {
      if (!O.contains(Q, P)) {
        S[P] = R[P]
      }
    }
    return S
  };
  O.defaults = function(P) {
    K(q.call(arguments, 1), function(Q) {
      if (Q) {
        for (var R in Q) {
          if (P[R] == null) {
            P[R] = Q[R]
          }
        }
      }
    });
    return P
  };
  O.clone = function(P) {
    if (!O.isObject(P)) {
      return P
    }
    return O.isArray(P) ? P.slice() : O.extend({}, P)
  };
  O.tap = function(Q, P) {
    P(Q);
    return Q
  };
  var L = function(W, V, Q, R) {
    if (W === V) {
      return W !== 0 || 1 / W == 1 / V
    }
    if (W == null || V == null) {
      return W === V
    }
    if (W instanceof O) {
      W = W._wrapped
    }
    if (V instanceof O) {
      V = V._wrapped
    }
    var T = d.call(W);
    if (T != d.call(V)) {
      return false
    }
    switch (T) {
      case "[object String]":
        return W == String(V);
      case "[object Number]":
        return W != +W ? V != +V : (W == 0 ? 1 / W == 1 / V : W == +V);
      case "[object Date]":
      case "[object Boolean]":
        return +W == +V;
      case "[object RegExp]":
        return W.source == V.source && W.global == V.global && W.multiline == V.multiline && W.ignoreCase == V.ignoreCase
    }
    if (typeof W != "object" || typeof V != "object") {
      return false
    }
    var P = Q.length;
    while (P--) {
      if (Q[P] == W) {
        return R[P] == V
      }
    }
    Q.push(W);
    R.push(V);
    var Y = 0, Z = true;
    if (T == "[object Array]") {
      Y = W.length;
      Z = Y == V.length;
      if (Z) {
        while (Y--) {
          if (!(Z = L(W[Y], V[Y], Q, R))) {
            break
          }
        }
      }
    } else {
      var U = W.constructor, S = V.constructor;
      if (U !== S && !(O.isFunction(U) && (U instanceof U) && O.isFunction(S) && (S instanceof S))) {
        return false
      }
      for (var X in W) {
        if (O.has(W, X)) {
          Y++;
          if (!(Z = O.has(V, X) && L(W[X], V[X], Q, R))) {
            break
          }
        }
      }
      if (Z) {
        for (X in V) {
          if (O.has(V, X) && !(Y--)) {
            break
          }
        }
        Z = !Y
      }
    }
    Q.pop();
    R.pop();
    return Z
  };
  O.isEqual = function(Q, P) {
    return L(Q, P, [], [])
  };
  O.isEmpty = function(Q) {
    if (Q == null) {
      return true
    }
    if (O.isArray(Q) || O.isString(Q)) {
      return Q.length === 0
    }
    for (var P in Q) {
      if (O.has(Q, P)) {
        return false
      }
    }
    return true
  };
  O.isElement = function(P) {
    return !!(P && P.nodeType === 1)
  };
  O.isArray = w || function(P) {
    return d.call(P) == "[object Array]"
  };
  O.isObject = function(P) {
    return P === Object(P)
  };
  K(["Arguments", "Function", "String", "Number", "Date", "RegExp"], function(P) {
    O["is" + P] = function(Q) {
      return d.call(Q) == "[object " + P + "]"
    }
  });
  if (!O.isArguments(arguments)) {
    O.isArguments = function(P) {
      return !!(P && O.has(P, "callee"))
    }
  }
  if (typeof (/./) !== "function") {
    O.isFunction = function(P) {
      return typeof P === "function"
    }
  }
  O.isFinite = function(P) {
    return isFinite(P) && !isNaN(parseFloat(P))
  };
  O.isNaN = function(P) {
    return O.isNumber(P) && P != +P
  };
  O.isBoolean = function(P) {
    return P === true || P === false || d.call(P) == "[object Boolean]"
  };
  O.isNull = function(P) {
    return P === null
  };
  O.isUndefined = function(P) {
    return P === void 0
  };
  O.has = function(Q, P) {
    return l.call(Q, P)
  };
  O.noConflict = function() {
    y._ = m;
    return this
  };
  O.identity = function(P) {
    return P
  };
  O.times = function(T, S, R) {
    var P = Array(T);
    for (var Q = 0; Q < T; Q++) {
      P[Q] = S.call(R, Q)
    }
    return P
  };
  O.random = function(Q, P) {
    if (P == null) {
      P = Q;
      Q = 0
    }
    return Q + (0 | Math.random() * (P - Q + 1))
  };
  var o = {escape: {"&": "&amp;","<": "&lt;",">": "&gt;",'"': "&quot;","'": "&#x27;","/": "&#x2F;"}};
  o.unescape = O.invert(o.escape);
  var M = {escape: new RegExp("[" + O.keys(o.escape).join("") + "]", "g"),unescape: new RegExp("(" + O.keys(o.unescape).join("|") + ")", "g")};
  O.each(["escape", "unescape"], function(P) {
    O[P] = function(Q) {
      if (Q == null) {
        return ""
      }
      return ("" + Q).replace(M[P], function(R) {
        return o[P][R]
      })
    }
  });
  O.result = function(P, R) {
    if (P == null) {
      return null
    }
    var Q = P[R];
    return O.isFunction(Q) ? Q.call(P) : Q
  };
  O.mixin = function(P) {
    K(O.functions(P), function(Q) {
      var R = O[Q] = P[Q];
      O.prototype[Q] = function() {
        var S = [this._wrapped];
        J.apply(S, arguments);
        return u.call(this, R.apply(O, S))
      }
    })
  };
  var B = 0;
  O.uniqueId = function(P) {
    var Q = "" + ++B;
    return P ? P + Q : Q
  };
  O.templateSettings = {evaluate: /<%([\s\S]+?)%>/g,interpolate: /<%=([\s\S]+?)%>/g,escape: /<%-([\s\S]+?)%>/g};
  var x = /(.)^/;
  var h = {"'": "'","\\": "\\","\r": "r","\n": "n","\t": "t","\u2028": "u2028","\u2029": "u2029"};
  var k = /\\|'|\r|\n|\t|\u2028|\u2029/g;
  O.template = function(X, S, R) {
    R = O.defaults({}, R, O.templateSettings);
    var T = new RegExp([(R.escape || x).source, (R.interpolate || x).source, (R.evaluate || x).source].join("|") + "|$", "g");
    var U = 0;
    var P = "__p+='";
    X.replace(T, function(Z, aa, Y, ac, ab) {
      P += X.slice(U, ab).replace(k, function(ad) {
        return "\\" + h[ad]
      });
      if (aa) {
        P += "'+\n((__t=(" + aa + "))==null?'':_.escape(__t))+\n'"
      }
      if (Y) {
        P += "'+\n((__t=(" + Y + "))==null?'':__t)+\n'"
      }
      if (ac) {
        P += "';\n" + ac + "\n__p+='"
      }
      U = ab + Z.length;
      return Z
    });
    P += "';\n";
    if (!R.variable) {
      P = "with(obj||{}){\n" + P + "}\n"
    }
    P = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + P + "return __p;\n";
    try {
      var Q = new Function(R.variable || "obj", "_", P)
    } catch (V) {
      V.source = P;
      throw V
    }
    if (S) {
      return Q(S, O)
    }
    var W = function(Y) {
      return Q.call(this, Y, O)
    };
    W.source = "function(" + (R.variable || "obj") + "){\n" + P + "}";
    return W
  };
  O.chain = function(P) {
    return O(P).chain()
  };
  var u = function(P) {
    return this._chain ? O(P).chain() : P
  };
  O.mixin(O);
  K(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function(P) {
    var Q = E[P];
    O.prototype[P] = function() {
      var R = this._wrapped;
      Q.apply(R, arguments);
      if ((P == "shift" || P == "splice") && R.length === 0) {
        delete R[0]
      }
      return u.call(this, R)
    }
  });
  K(["concat", "join", "slice"], function(P) {
    var Q = E[P];
    O.prototype[P] = function() {
      return u.call(this, Q.apply(this._wrapped, arguments))
    }
  });
  O.extend(O.prototype, {chain: function() {
    this._chain = true;
    return this
  },value: function() {
    return this._wrapped
  }})
}).call(this);
!function(B, A) {
  var z = A.prototype.trim, y = A.prototype.trimRight, x = A.prototype.trimLeft, w = function(b) {
    return b * 1 || 0
  }, v = function(e, d) {
    if (d < 1) {
      return ""
    }
    var f = "";
    while (d > 0) {
      d & 1 && (f += e), d >>= 1, e += e
    }
    return f
  }, u = [].slice, t = function(b) {
    return b == null ? "\\s" : b.source ? b.source : "[" + o.escapeRegExp(b) + "]"
  }, s = {lt: "<",gt: ">",quot: '"',apos: "'",amp: "&"}, r = {};
  for (var q in s) {
    r[s[q]] = q
  }
  var p = function() {
    function b(c) {
      return Object.prototype.toString.call(c).slice(8, -1).toLowerCase()
    }
    var f = v, e = function() {
      return e.cache.hasOwnProperty(arguments[0]) || (e.cache[arguments[0]] = e.parse(arguments[0])), e.format.call(null, e.cache[arguments[0]], arguments)
    };
    return e.format = function(L, K) {
      var J = 1, I = L.length, H = "", G, F = [], E, D, C, m, c, a;
      for (E = 0; E < I; E++) {
        H = b(L[E]);
        if (H === "string") {
          F.push(L[E])
        } else {
          if (H === "array") {
            C = L[E];
            if (C[2]) {
              G = K[J];
              for (D = 0; D < C[2].length; D++) {
                if (!G.hasOwnProperty(C[2][D])) {
                  throw new Error(p('[_.sprintf] property "%s" does not exist', C[2][D]))
                }
                G = G[C[2][D]]
              }
            } else {
              C[1] ? G = K[C[1]] : G = K[J++]
            }
            if (/[^s]/.test(C[8]) && b(G) != "number") {
              throw new Error(p("[_.sprintf] expecting number but found %s", b(G)))
            }
            switch (C[8]) {
              case "b":
                G = G.toString(2);
                break;
              case "c":
                G = A.fromCharCode(G);
                break;
              case "d":
                G = parseInt(G, 10);
                break;
              case "e":
                G = C[7] ? G.toExponential(C[7]) : G.toExponential();
                break;
              case "f":
                G = C[7] ? parseFloat(G).toFixed(C[7]) : parseFloat(G);
                break;
              case "o":
                G = G.toString(8);
                break;
              case "s":
                G = (G = A(G)) && C[7] ? G.substring(0, C[7]) : G;
                break;
              case "u":
                G = Math.abs(G);
                break;
              case "x":
                G = G.toString(16);
                break;
              case "X":
                G = G.toString(16).toUpperCase()
            }
            G = /[def]/.test(C[8]) && C[3] && G >= 0 ? "+" + G : G, c = C[4] ? C[4] == "0" ? "0" : C[4].charAt(1) : " ", a = C[6] - A(G).length, m = C[6] ? f(c, a) : "", F.push(C[5] ? G + m : m + G)
          }
        }
      }
      return F.join("")
    }, e.cache = {}, e.parse = function(l) {
      var k = l, F = [], E = [], D = 0;
      while (k) {
        if ((F = /^[^\x25]+/.exec(k)) !== null) {
          E.push(F[0])
        } else {
          if ((F = /^\x25{2}/.exec(k)) !== null) {
            E.push("%")
          } else {
            if ((F = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(k)) === null) {
              throw new Error("[_.sprintf] huh?")
            }
            if (F[2]) {
              D |= 1;
              var C = [], n = F[2], m = [];
              if ((m = /^([a-z_][a-z_\d]*)/i.exec(n)) === null) {
                throw new Error("[_.sprintf] huh?")
              }
              C.push(m[1]);
              while ((n = n.substring(m[0].length)) !== "") {
                if ((m = /^\.([a-z_][a-z_\d]*)/i.exec(n)) !== null) {
                  C.push(m[1])
                } else {
                  if ((m = /^\[(\d+)\]/.exec(n)) === null) {
                    throw new Error("[_.sprintf] huh?")
                  }
                  C.push(m[1])
                }
              }
              F[2] = C
            } else {
              D |= 2
            }
            if (D === 3) {
              throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported")
            }
            E.push(F)
          }
        }
        k = k.substring(F[0].length)
      }
      return E
    }, e
  }(), o = {VERSION: "2.2.0rc",isBlank: function(b) {
    return b == null && (b = ""), /^\s*$/.test(b)
  },stripTags: function(b) {
    return b == null ? "" : A(b).replace(/<\/?[^>]+>/g, "")
  },capitalize: function(b) {
    return b = b == null ? "" : A(b), b.charAt(0).toUpperCase() + b.slice(1)
  },chop: function(b, d) {
    return b == null ? [] : (b = A(b), d = ~~d, d > 0 ? b.match(new RegExp(".{1," + d + "}", "g")) : [b])
  },clean: function(b) {
    return o.strip(b).replace(/\s+/g, " ")
  },count: function(b, d) {
    return b == null || d == null ? 0 : A(b).split(d).length - 1
  },chars: function(b) {
    return b == null ? [] : A(b).split("")
  },swapCase: function(b) {
    return b == null ? "" : A(b).replace(/\S/g, function(c) {
      return c === c.toUpperCase() ? c.toLowerCase() : c.toUpperCase()
    })
  },escapeHTML: function(b) {
    return b == null ? "" : A(b).replace(/[&<>"']/g, function(c) {
      return "&" + r[c] + ";"
    })
  },unescapeHTML: function(b) {
    return b == null ? "" : A(b).replace(/\&([^;]+);/g, function(e, g) {
      var f;
      return g in s ? s[g] : (f = g.match(/^#x([\da-fA-F]+)$/)) ? A.fromCharCode(parseInt(f[1], 16)) : (f = g.match(/^#(\d+)$/)) ? A.fromCharCode(~~f[1]) : e
    })
  },escapeRegExp: function(b) {
    return b == null ? "" : A(b).replace(/([.*+?^=!:${}()|[\]\/\\])/g, "\\$1")
  },splice: function(g, f, l, k) {
    var h = o.chars(g);
    return h.splice(~~f, ~~l, k), h.join("")
  },insert: function(e, d, f) {
    return o.splice(e, d, 0, f)
  },include: function(b, d) {
    return d === "" ? !0 : b == null ? !1 : A(b).indexOf(d) !== -1
  },join: function() {
    var d = u.call(arguments), c = d.shift();
    return c == null && (c = ""), d.join(c)
  },lines: function(b) {
    return b == null ? [] : A(b).split("\n")
  },reverse: function(b) {
    return o.chars(b).reverse().join("")
  },startsWith: function(b, d) {
    return d === "" ? !0 : b == null || d == null ? !1 : (b = A(b), d = A(d), b.length >= d.length && b.slice(0, d.length) === d)
  },endsWith: function(b, d) {
    return d === "" ? !0 : b == null || d == null ? !1 : (b = A(b), d = A(d), b.length >= d.length && b.slice(b.length - d.length) === d)
  },succ: function(b) {
    return b == null ? "" : (b = A(b), b.slice(0, -1) + A.fromCharCode(b.charCodeAt(b.length - 1) + 1))
  },titleize: function(b) {
    return b == null ? "" : A(b).replace(/(?:^|\s)\S/g, function(c) {
      return c.toUpperCase()
    })
  },camelize: function(b) {
    return o.trim(b).replace(/[-_\s]+(.)?/g, function(d, c) {
      return c.toUpperCase()
    })
  },underscored: function(b) {
    return o.trim(b).replace(/([a-z\d])([A-Z]+)/g, "$1_$2").replace(/[-\s]+/g, "_").toLowerCase()
  },dasherize: function(b) {
    return o.trim(b).replace(/([A-Z])/g, "-$1").replace(/[-_\s]+/g, "-").toLowerCase()
  },classify: function(b) {
    return o.titleize(A(b).replace(/_/g, " ")).replace(/\s/g, "")
  },humanize: function(b) {
    return o.capitalize(o.underscored(b).replace(/_id$/, "").replace(/_/g, " "))
  },trim: function(b, c) {
    return b == null ? "" : !c && z ? z.call(b) : (c = t(c), A(b).replace(new RegExp("^" + c + "+|" + c + "+$", "g"), ""))
  },ltrim: function(b, d) {
    return b == null ? "" : !d && x ? x.call(b) : (d = t(d), A(b).replace(new RegExp("^" + d + "+"), ""))
  },rtrim: function(b, d) {
    return b == null ? "" : !d && y ? y.call(b) : (d = t(d), A(b).replace(new RegExp(d + "+$"), ""))
  },truncate: function(b, f, e) {
    return b == null ? "" : (b = A(b), e = e || "...", f = ~~f, b.length > f ? b.slice(0, f) + e : b)
  },prune: function(b, l, k) {
    if (b == null) {
      return ""
    }
    b = A(b), l = ~~l, k = k != null ? A(k) : "...";
    if (b.length <= l) {
      return b
    }
    var h = function(c) {
      return c.toUpperCase() !== c.toLowerCase() ? "A" : " "
    }, g = b.slice(0, l + 1).replace(/.(?=\W*\w*$)/g, h);
    return g.slice(g.length - 2).match(/\w\w/) ? g = g.replace(/\s*\S+$/, "") : g = o.rtrim(g.slice(0, g.length - 1)), (g + k).length > b.length ? b : b.slice(0, g.length) + k
  },words: function(d, c) {
    return o.isBlank(d) ? [] : o.trim(d, c).split(c || /\s+/)
  },pad: function(b, l, k, h) {
    b = b == null ? "" : A(b), l = ~~l;
    var g = 0;
    k ? k.length > 1 && (k = k.charAt(0)) : k = " ";
    switch (h) {
      case "right":
        return g = l - b.length, b + v(k, g);
      case "both":
        return g = l - b.length, v(k, Math.ceil(g / 2)) + b + v(k, Math.floor(g / 2));
      default:
        return g = l - b.length, v(k, g) + b
    }
  },lpad: function(e, d, f) {
    return o.pad(e, d, f)
  },rpad: function(e, d, f) {
    return o.pad(e, d, f, "right")
  },lrpad: function(e, d, f) {
    return o.pad(e, d, f, "both")
  },sprintf: p,vsprintf: function(d, c) {
    return c.unshift(d), p.apply(null, c)
  },toNumber: function(b, f) {
    if (b == null || b == "") {
      return 0
    }
    b = A(b);
    var e = w(w(b).toFixed(~~f));
    return e === 0 && !b.match(/^0+$/) ? Number.NaN : e
  },numberFormat: function(k, h, D, C) {
    if (isNaN(k) || k == null) {
      return ""
    }
    k = k.toFixed(~~h), C = C || ",";
    var n = k.split("."), m = n[0], l = n[1] ? (D || ".") + n[1] : "";
    return m.replace(/(\d)(?=(?:\d{3})+$)/g, "$1" + C) + l
  },strRight: function(b, f) {
    if (b == null) {
      return ""
    }
    b = A(b), f = f != null ? A(f) : f;
    var e = f ? b.indexOf(f) : -1;
    return ~e ? b.slice(e + f.length, b.length) : b
  },strRightBack: function(b, f) {
    if (b == null) {
      return ""
    }
    b = A(b), f = f != null ? A(f) : f;
    var e = f ? b.lastIndexOf(f) : -1;
    return ~e ? b.slice(e + f.length, b.length) : b
  },strLeft: function(b, f) {
    if (b == null) {
      return ""
    }
    b = A(b), f = f != null ? A(f) : f;
    var e = f ? b.indexOf(f) : -1;
    return ~e ? b.slice(0, e) : b
  },strLeftBack: function(e, d) {
    if (e == null) {
      return ""
    }
    e += "", d = d != null ? "" + d : d;
    var f = e.lastIndexOf(d);
    return ~f ? e.slice(0, f) : e
  },toSentence: function(h, g, n, m) {
    g = g || ", ", n = n || " and ";
    var l = h.slice(), k = l.pop();
    return h.length > 2 && m && (n = o.rtrim(g) + n), l.length ? l.join(g) + n + k : k
  },toSentenceSerial: function() {
    var b = u.call(arguments);
    return b[3] = !0, o.toSentence.apply(o, b)
  },slugify: function(b) {
    if (b == null) {
      return ""
    }
    var h = "ąàáäâãćęèéëêìíïîłńòóöôõùúüûñçżź", g = "aaaaaaceeeeeiiiilnooooouuuunczz", f = new RegExp(t(h), "g");
    return b = A(b).toLowerCase().replace(f, function(d) {
      var c = h.indexOf(d);
      return g.charAt(c) || "-"
    }), o.dasherize(b.replace(/[^\w\s-]/g, ""))
  },surround: function(d, c) {
    return [c, d, c].join("")
  },quote: function(b) {
    return o.surround(b, '"')
  },exports: function() {
    var d = {};
    for (var c in this) {
      if (!this.hasOwnProperty(c) || c.match(/^(?:include|contains|reverse)$/)) {
        continue
      }
      d[c] = this[c]
    }
    return d
  },repeat: function(b, h, g) {
    if (b == null) {
      return ""
    }
    h = ~~h;
    if (g == null) {
      return v(A(b), h)
    }
    for (var f = []; h > 0; f[--h] = b) {
    }
    return f.join(g)
  },levenshtein: function(b, D) {
    if (b == null && D == null) {
      return 0
    }
    if (b == null) {
      return A(D).length
    }
    if (D == null) {
      return A(b).length
    }
    b = A(b), D = A(D);
    var C = [], n, m;
    for (var l = 0; l <= D.length; l++) {
      for (var k = 0; k <= b.length; k++) {
        l && k ? b.charAt(k - 1) === D.charAt(l - 1) ? m = n : m = Math.min(C[k], C[k - 1], n) + 1 : m = l + k, n = C[k], C[k] = m
      }
    }
    return C.pop()
  }};
  o.strip = o.trim, o.lstrip = o.ltrim, o.rstrip = o.rtrim, o.center = o.lrpad, o.rjust = o.lpad, o.ljust = o.rpad, o.contains = o.include, o.q = o.quote, typeof exports != "undefined" ? (typeof module != "undefined" && module.exports && (module.exports = o), exports._s = o) : typeof define == "function" && define.amd ? define("underscore.string", [], function() {
    return o
  }) : (B._ = B._ || {}, B._.string = B._.str = o)
}(this, String);
(function() {
  var w = this;
  var D = w.Backbone;
  var g = [];
  var F = g.push;
  var p = g.slice;
  var v = g.splice;
  var B;
  if (typeof exports !== "undefined") {
    B = exports
  } else {
    B = w.Backbone = {}
  }
  B.VERSION = "1.0.0";
  var N = w._;
  if (!N && (typeof require !== "undefined")) {
    N = require("underscore")
  }
  B.$ = w.jQuery || w.Zepto || w.ender || w.$;
  B.noConflict = function() {
    w.Backbone = D;
    return this
  };
  B.emulateHTTP = false;
  B.emulateJSON = false;
  var L = B.Events = {on: function(O, R, Q) {
    if (!z(this, "on", O, [R, Q]) || !R) {
      return this
    }
    this._events || (this._events = {});
    var P = this._events[O] || (this._events[O] = []);
    P.push({callback: R,context: Q,ctx: Q || this});
    return this
  },once: function(P, S, Q) {
    if (!z(this, "once", P, [S, Q]) || !S) {
      return this
    }
    var O = this;
    var R = N.once(function() {
      O.off(P, R);
      S.apply(this, arguments)
    });
    R._callback = S;
    return this.on(P, R, Q)
  },off: function(O, X, P) {
    var V, W, Y, U, T, Q, S, R;
    if (!this._events || !z(this, "off", O, [X, P])) {
      return this
    }
    if (!O && !X && !P) {
      this._events = {};
      return this
    }
    U = O ? [O] : N.keys(this._events);
    for (T = 0, Q = U.length; T < Q; T++) {
      O = U[T];
      if (Y = this._events[O]) {
        this._events[O] = V = [];
        if (X || P) {
          for (S = 0, R = Y.length; S < R; S++) {
            W = Y[S];
            if ((X && X !== W.callback && X !== W.callback._callback) || (P && P !== W.context)) {
              V.push(W)
            }
          }
        }
        if (!V.length) {
          delete this._events[O]
        }
      }
    }
    return this
  },trigger: function(Q) {
    if (!this._events) {
      return this
    }
    var P = p.call(arguments, 1);
    if (!z(this, "trigger", Q, P)) {
      return this
    }
    var R = this._events[Q];
    var O = this._events.all;
    if (R) {
      b(R, P)
    }
    if (O) {
      b(O, arguments)
    }
    return this
  },stopListening: function(R, O, T) {
    var P = this._listeners;
    if (!P) {
      return this
    }
    var Q = !O && !T;
    if (typeof O === "object") {
      T = this
    }
    if (R) {
      (P = {})[R._listenerId] = R
    }
    for (var S in P) {
      P[S].off(O, T, this);
      if (Q) {
        delete this._listeners[S]
      }
    }
    return this
  }};
  var y = /\s+/;
  var z = function(V, T, P, S) {
    if (!P) {
      return true
    }
    if (typeof P === "object") {
      for (var R in P) {
        V[T].apply(V, [R, P[R]].concat(S))
      }
      return false
    }
    if (y.test(P)) {
      var U = P.split(y);
      for (var Q = 0, O = U.length; Q < O; Q++) {
        V[T].apply(V, [U[Q]].concat(S))
      }
      return false
    }
    return true
  };
  var b = function(T, R) {
    var U, S = -1, Q = T.length, P = R[0], O = R[1], V = R[2];
    switch (R.length) {
      case 0:
        while (++S < Q) {
          (U = T[S]).callback.call(U.ctx)
        }
        return;
      case 1:
        while (++S < Q) {
          (U = T[S]).callback.call(U.ctx, P)
        }
        return;
      case 2:
        while (++S < Q) {
          (U = T[S]).callback.call(U.ctx, P, O)
        }
        return;
      case 3:
        while (++S < Q) {
          (U = T[S]).callback.call(U.ctx, P, O, V)
        }
        return;
      default:
        while (++S < Q) {
          (U = T[S]).callback.apply(U.ctx, R)
        }
    }
  };
  var E = {listenTo: "on",listenToOnce: "once"};
  N.each(E, function(O, P) {
    L[P] = function(S, Q, U) {
      var R = this._listeners || (this._listeners = {});
      var T = S._listenerId || (S._listenerId = N.uniqueId("l"));
      R[T] = S;
      if (typeof Q === "object") {
        U = this
      }
      S[O](Q, U, this);
      return this
    }
  });
  L.bind = L.on;
  L.unbind = L.off;
  N.extend(B, L);
  var G = B.Model = function(O, Q) {
    var R;
    var P = O || {};
    Q || (Q = {});
    this.cid = N.uniqueId("c");
    this.attributes = {};
    N.extend(this, N.pick(Q, H));
    if (Q.parse) {
      P = this.parse(P, Q) || {}
    }
    if (R = N.result(this, "defaults")) {
      P = N.defaults({}, P, R)
    }
    this.set(P, Q);
    this.changed = {};
    this.initialize.apply(this, arguments)
  };
  var H = ["url", "urlRoot", "collection"];
  N.extend(G.prototype, L, {changed: null,validationError: null,idAttribute: "id",initialize: function() {
  },toJSON: function(O) {
    return N.clone(this.attributes)
  },sync: function() {
    return B.sync.apply(this, arguments)
  },get: function(O) {
    return this.attributes[O]
  },escape: function(O) {
    return N.escape(this.get(O))
  },has: function(O) {
    return this.get(O) != null
  },set: function(W, O, aa) {
    var U, X, Y, V, T, Z, Q, S;
    if (W == null) {
      return this
    }
    if (typeof W === "object") {
      X = W;
      aa = O
    } else {
      (X = {})[W] = O
    }
    aa || (aa = {});
    if (!this._validate(X, aa)) {
      return false
    }
    Y = aa.unset;
    T = aa.silent;
    V = [];
    Z = this._changing;
    this._changing = true;
    if (!Z) {
      this._previousAttributes = N.clone(this.attributes);
      this.changed = {}
    }
    S = this.attributes, Q = this._previousAttributes;
    if (this.idAttribute in X) {
      this.id = X[this.idAttribute]
    }
    for (U in X) {
      O = X[U];
      if (!N.isEqual(S[U], O)) {
        V.push(U)
      }
      if (!N.isEqual(Q[U], O)) {
        this.changed[U] = O
      } else {
        delete this.changed[U]
      }
      Y ? delete S[U] : S[U] = O
    }
    if (!T) {
      if (V.length) {
        this._pending = true
      }
      for (var R = 0, P = V.length; R < P; R++) {
        this.trigger("change:" + V[R], this, S[V[R]], aa)
      }
    }
    if (Z) {
      return this
    }
    if (!T) {
      while (this._pending) {
        this._pending = false;
        this.trigger("change", this, aa)
      }
    }
    this._pending = false;
    this._changing = false;
    return this
  },unset: function(O, P) {
    return this.set(O, void 0, N.extend({}, P, {unset: true}))
  },clear: function(P) {
    var O = {};
    for (var Q in this.attributes) {
      O[Q] = void 0
    }
    return this.set(O, N.extend({}, P, {unset: true}))
  },hasChanged: function(O) {
    if (O == null) {
      return !N.isEmpty(this.changed)
    }
    return N.has(this.changed, O)
  },changedAttributes: function(Q) {
    if (!Q) {
      return this.hasChanged() ? N.clone(this.changed) : false
    }
    var S, R = false;
    var P = this._changing ? this._previousAttributes : this.attributes;
    for (var O in Q) {
      if (N.isEqual(P[O], (S = Q[O]))) {
        continue
      }
      (R || (R = {}))[O] = S
    }
    return R
  },previous: function(O) {
    if (O == null || !this._previousAttributes) {
      return null
    }
    return this._previousAttributes[O]
  },previousAttributes: function() {
    return N.clone(this._previousAttributes)
  },fetch: function(P) {
    P = P ? N.clone(P) : {};
    if (P.parse === void 0) {
      P.parse = true
    }
    var O = this;
    var Q = P.success;
    P.success = function(R) {
      if (!O.set(O.parse(R, P), P)) {
        return false
      }
      if (Q) {
        Q(O, R, P)
      }
      O.trigger("sync", O, R, P)
    };
    J(this, P);
    return this.sync("read", this, P)
  },save: function(S, P, W) {
    var T, O, V, Q = this.attributes;
    if (S == null || typeof S === "object") {
      T = S;
      W = P
    } else {
      (T = {})[S] = P
    }
    if (T && (!W || !W.wait) && !this.set(T, W)) {
      return false
    }
    W = N.extend({validate: true}, W);
    if (!this._validate(T, W)) {
      return false
    }
    if (T && W.wait) {
      this.attributes = N.extend({}, Q, T)
    }
    if (W.parse === void 0) {
      W.parse = true
    }
    var R = this;
    var U = W.success;
    W.success = function(Y) {
      R.attributes = Q;
      var X = R.parse(Y, W);
      if (W.wait) {
        X = N.extend(T || {}, X)
      }
      if (N.isObject(X) && !R.set(X, W)) {
        return false
      }
      if (U) {
        U(R, Y, W)
      }
      R.trigger("sync", R, Y, W)
    };
    J(this, W);
    O = this.isNew() ? "create" : (W.patch ? "patch" : "update");
    if (O === "patch") {
      W.attrs = T
    }
    V = this.sync(O, this, W);
    if (T && W.wait) {
      this.attributes = Q
    }
    return V
  },destroy: function(P) {
    P = P ? N.clone(P) : {};
    var O = this;
    var S = P.success;
    var Q = function() {
      O.trigger("destroy", O, O.collection, P)
    };
    P.success = function(T) {
      if (P.wait || O.isNew()) {
        Q()
      }
      if (S) {
        S(O, T, P)
      }
      if (!O.isNew()) {
        O.trigger("sync", O, T, P)
      }
    };
    if (this.isNew()) {
      P.success();
      return false
    }
    J(this, P);
    var R = this.sync("delete", this, P);
    if (!P.wait) {
      Q()
    }
    return R
  },url: function() {
    var O = N.result(this, "urlRoot") || N.result(this.collection, "url") || t();
    if (this.isNew()) {
      return O
    }
    return O + (O.charAt(O.length - 1) === "/" ? "" : "/") + encodeURIComponent(this.id)
  },parse: function(P, O) {
    return P
  },clone: function() {
    return new this.constructor(this.attributes)
  },isNew: function() {
    return this.id == null
  },isValid: function(O) {
    return this._validate({}, N.extend(O || {}, {validate: true}))
  },_validate: function(Q, P) {
    if (!P.validate || !this.validate) {
      return true
    }
    Q = N.extend({}, this.attributes, Q);
    var O = this.validationError = this.validate(Q, P) || null;
    if (!O) {
      return true
    }
    this.trigger("invalid", this, O, N.extend(P || {}, {validationError: O}));
    return false
  }});
  var a = ["keys", "values", "pairs", "invert", "pick", "omit"];
  N.each(a, function(O) {
    G.prototype[O] = function() {
      var P = p.call(arguments);
      P.unshift(this.attributes);
      return N[O].apply(N, P)
    }
  });
  var c = B.Collection = function(P, O) {
    O || (O = {});
    if (O.url) {
      this.url = O.url
    }
    if (O.model) {
      this.model = O.model
    }
    if (O.comparator !== void 0) {
      this.comparator = O.comparator
    }
    this._reset();
    this.initialize.apply(this, arguments);
    if (P) {
      this.reset(P, N.extend({silent: true}, O))
    }
  };
  var q = {add: true,remove: true,merge: true};
  var M = {add: true,merge: false,remove: false};
  N.extend(c.prototype, L, {model: G,initialize: function() {
  },toJSON: function(O) {
    return this.map(function(P) {
      return P.toJSON(O)
    })
  },sync: function() {
    return B.sync.apply(this, arguments)
  },add: function(P, O) {
    return this.set(P, N.defaults(O || {}, M))
  },remove: function(T, R) {
    T = N.isArray(T) ? T.slice() : [T];
    R || (R = {});
    var S, O, Q, P;
    for (S = 0, O = T.length; S < O; S++) {
      P = this.get(T[S]);
      if (!P) {
        continue
      }
      delete this._byId[P.id];
      delete this._byId[P.cid];
      Q = this.indexOf(P);
      this.models.splice(Q, 1);
      this.length--;
      if (!R.silent) {
        R.index = Q;
        P.trigger("remove", P, this, R)
      }
      this._removeReference(P)
    }
    return this
  },set: function(P, ab) {
    ab = N.defaults(ab || {}, q);
    if (ab.parse) {
      P = this.parse(P, ab)
    }
    if (!N.isArray(P)) {
      P = P ? [P] : []
    }
    var W, S, Y, Z, Q, X;
    var R = ab.at;
    var V = this.comparator && (R == null) && ab.sort !== false;
    var T = N.isString(this.comparator) ? this.comparator : null;
    var aa = [], O = [], U = {};
    for (W = 0, S = P.length; W < S; W++) {
      if (!(Y = this._prepareModel(P[W], ab))) {
        continue
      }
      if (Q = this.get(Y)) {
        if (ab.remove) {
          U[Q.cid] = true
        }
        if (ab.merge) {
          Q.set(Y.attributes, ab);
          if (V && !X && Q.hasChanged(T)) {
            X = true
          }
        }
      } else {
        if (ab.add) {
          aa.push(Y);
          Y.on("all", this._onModelEvent, this);
          this._byId[Y.cid] = Y;
          if (Y.id != null) {
            this._byId[Y.id] = Y
          }
        }
      }
    }
    if (ab.remove) {
      for (W = 0, S = this.length; W < S; ++W) {
        if (!U[(Y = this.models[W]).cid]) {
          O.push(Y)
        }
      }
      if (O.length) {
        this.remove(O, ab)
      }
    }
    if (aa.length) {
      if (V) {
        X = true
      }
      this.length += aa.length;
      if (R != null) {
        v.apply(this.models, [R, 0].concat(aa))
      } else {
        F.apply(this.models, aa)
      }
    }
    if (X) {
      this.sort({silent: true})
    }
    if (ab.silent) {
      return this
    }
    for (W = 0, S = aa.length; W < S; W++) {
      (Y = aa[W]).trigger("add", Y, this, ab)
    }
    if (X) {
      this.trigger("sort", this, ab)
    }
    return this
  },reset: function(R, P) {
    P || (P = {});
    for (var Q = 0, O = this.models.length; Q < O; Q++) {
      this._removeReference(this.models[Q])
    }
    P.previousModels = this.models;
    this._reset();
    this.add(R, N.extend({silent: true}, P));
    if (!P.silent) {
      this.trigger("reset", this, P)
    }
    return this
  },push: function(P, O) {
    P = this._prepareModel(P, O);
    this.add(P, N.extend({at: this.length}, O));
    return P
  },pop: function(P) {
    var O = this.at(this.length - 1);
    this.remove(O, P);
    return O
  },unshift: function(P, O) {
    P = this._prepareModel(P, O);
    this.add(P, N.extend({at: 0}, O));
    return P
  },shift: function(P) {
    var O = this.at(0);
    this.remove(O, P);
    return O
  },slice: function(P, O) {
    return this.models.slice(P, O)
  },get: function(O) {
    if (O == null) {
      return void 0
    }
    return this._byId[O.id != null ? O.id : O.cid || O]
  },at: function(O) {
    return this.models[O]
  },where: function(O, P) {
    if (N.isEmpty(O)) {
      return P ? void 0 : []
    }
    return this[P ? "find" : "filter"](function(Q) {
      for (var R in O) {
        if (O[R] !== Q.get(R)) {
          return false
        }
      }
      return true
    })
  },findWhere: function(O) {
    return this.where(O, true)
  },sort: function(O) {
    if (!this.comparator) {
      throw new Error("Cannot sort a set without a comparator")
    }
    O || (O = {});
    if (N.isString(this.comparator) || this.comparator.length === 1) {
      this.models = this.sortBy(this.comparator, this)
    } else {
      this.models.sort(N.bind(this.comparator, this))
    }
    if (!O.silent) {
      this.trigger("sort", this, O)
    }
    return this
  },sortedIndex: function(O, R, P) {
    R || (R = this.comparator);
    var Q = N.isFunction(R) ? R : function(S) {
      return S.get(R)
    };
    return N.sortedIndex(this.models, O, Q, P)
  },pluck: function(O) {
    return N.invoke(this.models, "get", O)
  },fetch: function(O) {
    O = O ? N.clone(O) : {};
    if (O.parse === void 0) {
      O.parse = true
    }
    var Q = O.success;
    var P = this;
    O.success = function(R) {
      var S = O.reset ? "reset" : "set";
      P[S](R, O);
      if (Q) {
        Q(P, R, O)
      }
      P.trigger("sync", P, R, O)
    };
    J(this, O);
    return this.sync("read", this, O)
  },create: function(P, O) {
    O = O ? N.clone(O) : {};
    if (!(P = this._prepareModel(P, O))) {
      return false
    }
    if (!O.wait) {
      this.add(P, O)
    }
    var R = this;
    var Q = O.success;
    O.success = function(S) {
      if (O.wait) {
        R.add(P, O)
      }
      if (Q) {
        Q(P, S, O)
      }
    };
    P.save(null, O);
    return P
  },parse: function(P, O) {
    return P
  },clone: function() {
    return new this.constructor(this.models)
  },_reset: function() {
    this.length = 0;
    this.models = [];
    this._byId = {}
  },_prepareModel: function(Q, P) {
    if (Q instanceof G) {
      if (!Q.collection) {
        Q.collection = this
      }
      return Q
    }
    P || (P = {});
    P.collection = this;
    var O = new this.model(Q, P);
    if (!O._validate(Q, P)) {
      this.trigger("invalid", this, Q, P);
      return false
    }
    return O
  },_removeReference: function(O) {
    if (this === O.collection) {
      delete O.collection
    }
    O.off("all", this._onModelEvent, this)
  },_onModelEvent: function(Q, P, R, O) {
    if ((Q === "add" || Q === "remove") && R !== this) {
      return
    }
    if (Q === "destroy") {
      this.remove(P, O)
    }
    if (P && Q === "change:" + P.idAttribute) {
      delete this._byId[P.previous(P.idAttribute)];
      if (P.id != null) {
        this._byId[P.id] = P
      }
    }
    this.trigger.apply(this, arguments)
  }});
  var A = ["forEach", "each", "map", "collect", "reduce", "foldl", "inject", "reduceRight", "foldr", "find", "detect", "filter", "select", "reject", "every", "all", "some", "any", "include", "contains", "invoke", "max", "min", "toArray", "size", "first", "head", "take", "initial", "rest", "tail", "drop", "last", "without", "indexOf", "shuffle", "lastIndexOf", "isEmpty", "chain"];
  N.each(A, function(O) {
    c.prototype[O] = function() {
      var P = p.call(arguments);
      P.unshift(this.models);
      return N[O].apply(N, P)
    }
  });
  var m = ["groupBy", "countBy", "sortBy"];
  N.each(m, function(O) {
    c.prototype[O] = function(R, P) {
      var Q = N.isFunction(R) ? R : function(S) {
        return S.get(R)
      };
      return N[O](this.models, Q, P)
    }
  });
  var I = B.View = function(O) {
    this.cid = N.uniqueId("view");
    this._configure(O || {});
    this._ensureElement();
    this.initialize.apply(this, arguments);
    this.delegateEvents()
  };
  var x = /^(\S+)\s*(.*)$/;
  var e = ["model", "collection", "el", "id", "attributes", "className", "tagName", "events"];
  N.extend(I.prototype, L, {tagName: "div",$: function(O) {
    return this.$el.find(O)
  },initialize: function() {
  },render: function() {
    return this
  },remove: function() {
    this.$el.remove();
    this.stopListening();
    return this
  },setElement: function(O, P) {
    if (this.$el) {
      this.undelegateEvents()
    }
    this.$el = O instanceof B.$ ? O : B.$(O);
    this.el = this.$el[0];
    if (P !== false) {
      this.delegateEvents()
    }
    return this
  },delegateEvents: function(S) {
    if (!(S || (S = N.result(this, "events")))) {
      return this
    }
    this.undelegateEvents();
    for (var R in S) {
      var T = S[R];
      if (!N.isFunction(T)) {
        T = this[S[R]]
      }
      if (!T) {
        continue
      }
      var Q = R.match(x);
      var P = Q[1], O = Q[2];
      T = N.bind(T, this);
      P += ".delegateEvents" + this.cid;
      if (O === "") {
        this.$el.on(P, T)
      } else {
        this.$el.on(P, O, T)
      }
    }
    return this
  },undelegateEvents: function() {
    this.$el.off(".delegateEvents" + this.cid);
    return this
  },_configure: function(O) {
    if (this.options) {
      O = N.extend({}, N.result(this, "options"), O)
    }
    N.extend(this, N.pick(O, e));
    this.options = O
  },_ensureElement: function() {
    if (!this.el) {
      var O = N.extend({}, N.result(this, "attributes"));
      if (this.id) {
        O.id = N.result(this, "id")
      }
      if (this.className) {
        O["class"] = N.result(this, "className")
      }
      var P = B.$("<" + N.result(this, "tagName") + ">").attr(O);
      this.setElement(P, false)
    } else {
      this.setElement(N.result(this, "el"), false)
    }
  }});
  B.sync = function(U, P, O) {
    var R = l[U];
    N.defaults(O || (O = {}), {emulateHTTP: B.emulateHTTP,emulateJSON: B.emulateJSON});
    var T = {type: R,dataType: "json"};
    if (!O.url) {
      T.url = N.result(P, "url") || t()
    }
    if (O.data == null && P && (U === "create" || U === "update" || U === "patch")) {
      T.contentType = "application/json";
      T.data = JSON.stringify(O.attrs || P.toJSON(O))
    }
    if (O.emulateJSON) {
      T.contentType = "application/x-www-form-urlencoded";
      T.data = T.data ? {model: T.data} : {}
    }
    if (O.emulateHTTP && (R === "PUT" || R === "DELETE" || R === "PATCH")) {
      T.type = "POST";
      if (O.emulateJSON) {
        T.data._method = R
      }
      var Q = O.beforeSend;
      O.beforeSend = function(V) {
        V.setRequestHeader("X-HTTP-Method-Override", R);
        if (Q) {
          return Q.apply(this, arguments)
        }
      }
    }
    if (T.type !== "GET" && !O.emulateJSON) {
      T.processData = false
    }
    if (T.type === "PATCH" && window.ActiveXObject && !(window.external && window.external.msActiveXFilteringEnabled)) {
      T.xhr = function() {
        return new ActiveXObject("Microsoft.XMLHTTP")
      }
    }
    var S = O.xhr = B.ajax(N.extend(T, O));
    P.trigger("request", P, S, O);
    return S
  };
  var l = {create: "POST",update: "PUT",patch: "PATCH","delete": "DELETE",read: "GET"};
  B.ajax = function() {
    return B.$.ajax.apply(B.$, arguments)
  };
  var r = B.Router = function(O) {
    O || (O = {});
    if (O.routes) {
      this.routes = O.routes
    }
    this._bindRoutes();
    this.initialize.apply(this, arguments)
  };
  var s = /\((.*?)\)/g;
  var u = /(\(\?)?:\w+/g;
  var d = /\*\w+/g;
  var h = /[\-{}\[\]+?.,\\\^$|#\s]/g;
  N.extend(r.prototype, L, {initialize: function() {
  },route: function(P, Q, R) {
    if (!N.isRegExp(P)) {
      P = this._routeToRegExp(P)
    }
    if (N.isFunction(Q)) {
      R = Q;
      Q = ""
    }
    if (!R) {
      R = this[Q]
    }
    var O = this;
    B.history.route(P, function(T) {
      var S = O._extractParameters(P, T);
      R && R.apply(O, S);
      O.trigger.apply(O, ["route:" + Q].concat(S));
      O.trigger("route", Q, S);
      B.history.trigger("route", O, Q, S)
    });
    return this
  },navigate: function(P, O) {
    B.history.navigate(P, O);
    return this
  },_bindRoutes: function() {
    if (!this.routes) {
      return
    }
    this.routes = N.result(this, "routes");
    var P, O = N.keys(this.routes);
    while ((P = O.pop()) != null) {
      this.route(P, this.routes[P])
    }
  },_routeToRegExp: function(O) {
    O = O.replace(h, "\\$&").replace(s, "(?:$1)?").replace(u, function(Q, P) {
      return P ? Q : "([^/]+)"
    }).replace(d, "(.*?)");
    return new RegExp("^" + O + "$")
  },_extractParameters: function(O, P) {
    var Q = O.exec(P).slice(1);
    return N.map(Q, function(R) {
      return R ? decodeURIComponent(R) : null
    })
  }});
  var k = B.History = function() {
    this.handlers = [];
    N.bindAll(this, "checkUrl");
    if (typeof window !== "undefined") {
      this.location = window.location;
      this.history = window.history
    }
  };
  var C = /^[#\/]|\s+$/g;
  var f = /^\/+|\/+$/g;
  var K = /msie [\w.]+/;
  var o = /\/$/;
  k.started = false;
  N.extend(k.prototype, L, {interval: 50,getHash: function(P) {
    var O = (P || this).location.href.match(/#(.*)$/);
    return O ? O[1] : ""
  },getFragment: function(Q, P) {
    if (Q == null) {
      if (this._hasPushState || !this._wantsHashChange || P) {
        Q = this.location.pathname;
        var O = this.root.replace(o, "");
        if (!Q.indexOf(O)) {
          Q = Q.substr(O.length)
        }
      } else {
        Q = this.getHash()
      }
    }
    return Q.replace(C, "")
  },start: function(Q) {
    if (k.started) {
      throw new Error("Backbone.history has already been started")
    }
    k.started = true;
    this.options = N.extend({}, {root: "/"}, this.options, Q);
    this.root = this.options.root;
    this._wantsHashChange = this.options.hashChange !== false;
    this._wantsPushState = !!this.options.pushState;
    this._hasPushState = !!(this.options.pushState && this.history && this.history.pushState);
    var P = this.getFragment();
    var O = document.documentMode;
    var S = (K.exec(navigator.userAgent.toLowerCase()) && (!O || O <= 7));
    this.root = ("/" + this.root + "/").replace(f, "/");
    if (S && this._wantsHashChange) {
      this.iframe = B.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;
      this.navigate(P)
    }
    if (this._hasPushState) {
      B.$(window).on("popstate", this.checkUrl)
    } else {
      if (this._wantsHashChange && ("onhashchange" in window) && !S) {
        B.$(window).on("hashchange", this.checkUrl)
      } else {
        if (this._wantsHashChange) {
          this._checkUrlInterval = setInterval(this.checkUrl, this.interval)
        }
      }
    }
    this.fragment = P;
    var T = this.location;
    var R = T.pathname.replace(/[^\/]$/, "$&/") === this.root;
    if (this._wantsHashChange && this._wantsPushState && !this._hasPushState && !R) {
      this.fragment = this.getFragment(null, true);
      this.location.replace(this.root + this.location.search + "#" + this.fragment);
      return true
    } else {
      if (this._wantsPushState && this._hasPushState && R && T.hash) {
        this.fragment = this.getHash().replace(C, "");
        this.history.replaceState({}, document.title, this.root + this.fragment + T.search)
      }
    }
    if (!this.options.silent) {
      return this.loadUrl()
    }
  },stop: function() {
    B.$(window).off("popstate", this.checkUrl).off("hashchange", this.checkUrl);
    clearInterval(this._checkUrlInterval);
    k.started = false
  },route: function(O, P) {
    this.handlers.unshift({route: O,callback: P})
  },checkUrl: function(P) {
    var O = this.getFragment();
    if (O === this.fragment && this.iframe) {
      O = this.getFragment(this.getHash(this.iframe))
    }
    if (O === this.fragment) {
      return false
    }
    if (this.iframe) {
      this.navigate(O)
    }
    this.loadUrl() || this.loadUrl(this.getHash())
  },loadUrl: function(Q) {
    var P = this.fragment = this.getFragment(Q);
    var O = N.any(this.handlers, function(R) {
      if (R.route.test(P)) {
        R.callback(P);
        return true
      }
    });
    return O
  },navigate: function(Q, P) {
    if (!k.started) {
      return false
    }
    if (!P || P === true) {
      P = {trigger: P}
    }
    Q = this.getFragment(Q || "");
    if (this.fragment === Q) {
      return
    }
    this.fragment = Q;
    var O = this.root + Q;
    if (this._hasPushState) {
      this.history[P.replace ? "replaceState" : "pushState"]({}, document.title, O)
    } else {
      if (this._wantsHashChange) {
        this._updateHash(this.location, Q, P.replace);
        if (this.iframe && (Q !== this.getFragment(this.getHash(this.iframe)))) {
          if (!P.replace) {
            this.iframe.document.open().close()
          }
          this._updateHash(this.iframe.location, Q, P.replace)
        }
      } else {
        return this.location.assign(O)
      }
    }
    if (P.trigger) {
      this.loadUrl(Q)
    }
  },_updateHash: function(O, Q, R) {
    if (R) {
      var P = O.href.replace(/(javascript:|#).*$/, "");
      O.replace(P + "#" + Q)
    } else {
      O.hash = "#" + Q
    }
  }});
  B.history = new k;
  var n = function(O, Q) {
    var P = this;
    var S;
    if (O && N.has(O, "constructor")) {
      S = O.constructor
    } else {
      S = function() {
        return P.apply(this, arguments)
      }
    }
    N.extend(S, P, Q);
    var R = function() {
      this.constructor = S
    };
    R.prototype = P.prototype;
    S.prototype = new R;
    if (O) {
      N.extend(S.prototype, O)
    }
    S.__super__ = P.prototype;
    return S
  };
  G.extend = c.extend = r.extend = I.extend = k.extend = n;
  var t = function() {
    throw new Error('A "url" property or function must be specified')
  };
  var J = function(Q, P) {
    var O = P.error;
    P.error = function(R) {
      if (O) {
        O(Q, R, P)
      }
      Q.trigger("error", Q, R, P)
    }
  }
}).call(this);
var ui = {};
(function(a) {
  a.Emitter = b;
  function b() {
    this.callbacks = {}
  }
  b.prototype.on = function(d, c) {
    (this.callbacks[d] = this.callbacks[d] || []).push(c);
    return this
  };
  b.prototype.once = function(f, e) {
    var d = this;
    function c() {
      d.off(f, c);
      e.apply(this, arguments)
    }
    this.on(f, c);
    return this
  };
  b.prototype.off = function(f, d) {
    var e = this.callbacks[f];
    if (!e) {
      return this
    }
    if (1 == arguments.length) {
      delete this.callbacks[f];
      return this
    }
    var c = e.indexOf(d);
    e.splice(c, 1);
    return this
  };
  b.prototype.emit = function(g) {
    var d = [].slice.call(arguments, 1), f = this.callbacks[g];
    if (f) {
      for (var e = 0, c = f.length; e < c; ++e) {
        f[e] && f[e].apply(this, d)
      }
    }
    return this
  }
})(ui);
(function(b, c) {
  var d;
  b.Dialog = a;
  b.dialog = function(f, e) {
    switch (arguments.length) {
      case 2:
        return new a({title: f,message: e});
      case 1:
        return new a({message: f})
    }
  };
  function a(e) {
    ui.Emitter.call(this);
    e = e || {};
    this.template = c;
    this.el = $(this.template);
    this.render(e);
    if (d) {
      d.hide()
    }
    if (a.effect) {
      this.effect(a.effect)
    }
    d = this
  }
  a.prototype = new ui.Emitter;
  a.prototype.render = function(f) {
    var g = this.el, k = f.title, h = f.message, e = this;
    g.find(".close").click(function() {
      e.emit("close");
      e.hide();
      return false
    });
    g.find("h1").text(k);
    if (!k) {
      g.find("h1").remove()
    }
    if ("string" == typeof h) {
      g.find("p").text(h)
    } else {
      if (h) {
        g.find("p").replaceWith(h.el || h)
      }
    }
    setTimeout(function() {
      g.removeClass("hide")
    }, 0)
  };
  a.prototype.closable = function() {
    this.el.addClass("closable");
    return this
  };
  a.prototype.effect = function(e) {
    this._effect = e;
    this.el.addClass(e);
    return this
  };
  a.prototype.modal = function() {
    this._overlay = ui.overlay();
    return this
  };
  a.prototype.overlay = function() {
    var e = this;
    this._overlay = ui.overlay({closable: true}).on("hide", function() {
      e.closedOverlay = true;
      e.hide()
    });
    return this
  };
  a.prototype.escapable = function() {
    var e = this;
    $(document).bind("keydown.dialog", function(f) {
      if (27 != f.which) {
        return
      }
      $(this).unbind("keydown.dialog");
      e.hide()
    })
  };
  a.prototype.show = function() {
    var e = this._overlay;
    this.emit("show");
    if (e) {
      e.show();
      this.el.addClass("modal")
    }
    if (!e || e.closable) {
      this.escapable()
    }
    this.el.appendTo("body");
    this.el.css({marginLeft: -(this.el.width() / 2) + "px"});
    return this
  };
  a.prototype.hide = function(f) {
    var e = this;
    this.emit("hide");
    if (f) {
      setTimeout(function() {
        e.hide()
      }, f);
      return this
    }
    this.el.addClass("hide");
    if (this._effect) {
      setTimeout(function(g) {
        g.remove()
      }, 500, this)
    } else {
      e.remove()
    }
    if (this._overlay && !e.closedOverlay) {
      this._overlay.hide()
    }
    return this
  };
  a.prototype.remove = function() {
    this.el.remove();
    return this
  }
})(ui, '<div id="dialog" class="hide">\n  <div class="content">\n    <h1>Title</h1>\n    <a href="#" class="close">×</a>\n    <p>Message</p>\n  </div>\n</div>');
(function(b, c) {
  b.Overlay = a;
  b.overlay = function(d) {
    return new a(d)
  };
  function a(e) {
    ui.Emitter.call(this);
    var d = this;
    e = e || {};
    this.closable = e.closable;
    this.el = $(c);
    this.el.appendTo("body");
    if (this.closable) {
      this.el.click(function() {
        d.hide()
      })
    }
  }
  a.prototype = new ui.Emitter;
  a.prototype.show = function() {
    this.emit("show");
    this.el.removeClass("hide");
    return this
  };
  a.prototype.hide = function() {
    var d = this;
    this.emit("hide");
    this.el.addClass("hide");
    setTimeout(function() {
      d.el.remove()
    }, 2000);
    return this
  }
})(ui, '<div id="overlay" class="hide"></div>');
(function(a, b) {
  a.Confirmation = c;
  a.confirm = function(e, d) {
    switch (arguments.length) {
      case 2:
        return new c({title: e,message: d});
      case 1:
        return new c({message: e})
    }
  };
  function c(d) {
    ui.Dialog.call(this, d)
  }
  c.prototype = new ui.Dialog;
  c.prototype.cancel = function(d) {
    this.el.find(".cancel").text(d);
    return this
  };
  c.prototype.ok = function(d) {
    this.el.find(".ok").text(d);
    return this
  };
  c.prototype.show = function(d) {
    ui.Dialog.prototype.show.call(this);
    this.el.find(".ok").focus();
    this.callback = d || function() {
    };
    return this
  };
  c.prototype.render = function(e) {
    ui.Dialog.prototype.render.call(this, e);
    var d = this, f = $(b);
    this.el.addClass("confirmation");
    this.el.append(f);
    this.on("close", function() {
      d.emit("cancel");
      d.callback(false)
    });
    f.find(".cancel").click(function(g) {
      g.preventDefault();
      d.emit("cancel");
      d.callback(false);
      d.hide()
    });
    f.find(".ok").click(function(g) {
      g.preventDefault();
      d.emit("ok");
      d.callback(true);
      d.hide()
    })
  }
})(ui, '<div class="actions">\n  <button class="cancel">Cancel</button>\n  <button class="ok main">Ok</button>\n</div>');
(function(a, b) {
  var d;
  a.Notification = e;
  $(function() {
    d = $('<ul id="notifications">');
    d.appendTo("body")
  });
  a.notify = function(g, f) {
    switch (arguments.length) {
      case 2:
        return new e({title: g,message: f}).show().hide(4000);
      case 1:
        return new e({message: g}).show().hide(4000)
    }
  };
  function c(f) {
    return function(h, g) {
      return a.notify.apply(this, arguments).type(f)
    }
  }
  a.info = a.notify;
  a.warn = c("warn");
  a.error = c("error");
  function e(f) {
    ui.Emitter.call(this);
    f = f || {};
    this.template = b;
    this.el = $(this.template);
    this.render(f);
    if (e.effect) {
      this.effect(e.effect)
    }
  }
  e.prototype = new ui.Emitter;
  e.prototype.render = function(g) {
    var h = this.el, l = g.title, k = g.message, f = this;
    h.find(".close").click(function() {
      f.hide();
      return false
    });
    h.click(function(m) {
      m.preventDefault();
      f.emit("click", m)
    });
    h.find("h1").text(l);
    if (!l) {
      h.find("h1").remove()
    }
    if ("string" == typeof k) {
      h.find("p").text(k)
    } else {
      if (k) {
        h.find("p").replaceWith(k.el || k)
      }
    }
    setTimeout(function() {
      h.removeClass("hide")
    }, 0)
  };
  e.prototype.closable = function() {
    this.el.addClass("closable");
    return this
  };
  e.prototype.effect = function(f) {
    this._effect = f;
    this.el.addClass(f);
    return this
  };
  e.prototype.show = function() {
    this.el.appendTo(d);
    return this
  };
  e.prototype.type = function(f) {
    this._type = f;
    this.el.addClass(f);
    return this
  };
  e.prototype.sticky = function() {
    return this.hide(0).closable()
  };
  e.prototype.hide = function(g) {
    var f = this;
    if ("number" == typeof g) {
      clearTimeout(this.timer);
      if (!g) {
        return this
      }
      this.timer = setTimeout(function() {
        f.hide()
      }, g);
      return this
    }
    this.el.addClass("hide");
    if (this._effect) {
      setTimeout(function(h) {
        h.remove()
      }, 500, this)
    } else {
      f.remove()
    }
    return this
  };
  e.prototype.remove = function() {
    this.el.remove();
    return this
  }
})(ui, '<li class="notification utils-notify-message"><div class="content"><a href="#" class="close">×</a>   <p>Message</p> </div></li>');
(function(b, c) {
  b.Menu = d;
  b.menu = function() {
    return new d
  };
  function d() {
    var e = this;
    ui.Emitter.call(this);
    this.items = {};
    this.el = $(c).hide().appendTo("body");
    $("html").click(function() {
      e.hide()
    })
  }
  d.prototype = new ui.Emitter;
  d.prototype.add = function(h, g) {
    var e = this, f = $('<li><a href="#">' + h + "</a></li>").addClass(a(h)).appendTo(this.el).click(function(k) {
      k.preventDefault();
      k.stopPropagation();
      e.hide();
      e.emit(h);
      g && g()
    });
    this.items[h] = f;
    return this
  };
  d.prototype.addDouble = function(h, g) {
    var e = this, f = $('<li><a href="#"><span>' + h + "</span></a></li>").addClass(a(h)).appendTo(this.el).click(function(k) {
      k.preventDefault();
      k.stopPropagation();
      e.hide();
      e.emit(h);
      g && g()
    });
    this.items[h] = f;
    return this
  };
  d.prototype.remove = function(f) {
    var e = this.items[f];
    if (!e) {
      throw new Error('no menu item named "' + f + '"')
    }
    this.emit("remove", f);
    e.remove();
    delete this.items[f];
    return this
  };
  d.prototype.has = function(e) {
    return !!this.items[e]
  };
  d.prototype.moveTo = function(e, f) {
    this.el.css({top: f,left: e});
    return this
  };
  d.prototype.show = function() {
    this.emit("show");
    this.el.show();
    return this
  };
  d.prototype.hide = function() {
    this.emit("hide");
    this.el.hide();
    return this
  };
  function a(e) {
    return e.toLowerCase().replace(/ +/g, "-").replace(/[^a-z0-9-]/g, "")
  }
})(ui, '<div class="menu">\n</div>');
/* 
 * jquery.event.drag - v 2.0.0 
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */
(function(d) {
  d.fn.drag = function(k, e, h) {
    var g = typeof k == "string" ? k : "", f = d.isFunction(k) ? k : d.isFunction(e) ? e : null;
    if (g.indexOf("drag") !== 0) {
      g = "drag" + g
    }
    h = (k == f ? e : h) || {};
    return f ? this.bind(g, h, f) : this.trigger(g)
  };
  var b = d.event, a = b.special, c = a.drag = {defaults: {which: 1,distance: 0,not: ":input",handle: null,relative: false,drop: true,click: false},datakey: "dragdata",livekey: "livedrag",add: function(g) {
    var f = d.data(this, c.datakey), e = g.data || {};
    f.related += 1;
    if (!f.live && g.selector) {
      f.live = true;
      b.add(this, "draginit." + c.livekey, c.delegate)
    }
    d.each(c.defaults, function(h, k) {
      if (e[h] !== undefined) {
        f[h] = e[h]
      }
    })
  },remove: function() {
    d.data(this, c.datakey).related -= 1
  },setup: function() {
    if (d.data(this, c.datakey)) {
      return
    }
    var e = d.extend({related: 0}, c.defaults);
    d.data(this, c.datakey, e);
    b.add(this, "mousedown", c.init, e);
    if (this.attachEvent) {
      this.attachEvent("ondragstart", c.dontstart)
    }
  },teardown: function() {
    if (d.data(this, c.datakey).related) {
      return
    }
    d.removeData(this, c.datakey);
    b.remove(this, "mousedown", c.init);
    b.remove(this, "draginit", c.delegate);
    c.textselect(true);
    if (this.detachEvent) {
      this.detachEvent("ondragstart", c.dontstart)
    }
  },init: function(g) {
    var e = g.data, f;
    if (e.which > 0 && g.which != e.which) {
      return
    }
    if (d(g.target).is(e.not)) {
      return
    }
    if (e.handle && !d(g.target).closest(e.handle, g.currentTarget).length) {
      return
    }
    e.propagates = 1;
    e.interactions = [c.interaction(this, e)];
    e.target = g.target;
    e.pageX = g.pageX;
    e.pageY = g.pageY;
    e.dragging = null;
    f = c.hijack(g, "draginit", e);
    if (!e.propagates) {
      return
    }
    f = c.flatten(f);
    if (f && f.length) {
      e.interactions = [];
      d.each(f, function() {
        e.interactions.push(c.interaction(this, e))
      })
    }
    e.propagates = e.interactions.length;
    if (e.drop !== false && a.drop) {
      a.drop.handler(g, e)
    }
    c.textselect(false);
    b.add(document, "mousemove mouseup", c.handler, e);
    return false
  },interaction: function(f, e) {
    return {drag: f,callback: new c.callback(),droppable: [],offset: d(f)[e.relative ? "position" : "offset"]() || {top: 0,left: 0}}
  },handler: function(f) {
    var e = f.data;
    switch (f.type) {
      case !e.dragging && "mousemove":
        if (Math.pow(f.pageX - e.pageX, 2) + Math.pow(f.pageY - e.pageY, 2) < Math.pow(e.distance, 2)) {
          break
        }
        f.target = e.target;
        c.hijack(f, "dragstart", e);
        if (e.propagates) {
          e.dragging = true
        }
      case "mousemove":
        if (e.dragging) {
          c.hijack(f, "drag", e);
          if (e.propagates) {
            if (e.drop !== false && a.drop) {
              a.drop.handler(f, e)
            }
            break
          }
          f.type = "mouseup"
        }
      case "mouseup":
        b.remove(document, "mousemove mouseup", c.handler);
        if (e.dragging) {
          if (e.drop !== false && a.drop) {
            a.drop.handler(f, e)
          }
          c.hijack(f, "dragend", e)
        }
        c.textselect(true);
        if (e.click === false && e.dragging) {
          jQuery.event.triggered = true;
          setTimeout(function() {
            jQuery.event.triggered = false
          }, 20);
          e.dragging = false
        }
        break
    }
  },delegate: function(g) {
    var e = [], h, f = d.data(this, "events") || {};
    d.each(f.live || [], function(k, l) {
      if (l.preType.indexOf("drag") !== 0) {
        return
      }
      h = d(g.target).closest(l.selector, g.currentTarget)[0];
      if (!h) {
        return
      }
      b.add(h, l.origType + "." + c.livekey, l.origHandler, l.data);
      if (d.inArray(h, e) < 0) {
        e.push(h)
      }
    });
    if (!e.length) {
      return false
    }
    return d(e).bind("dragend." + c.livekey, function() {
      b.remove(this, "." + c.livekey)
    })
  },hijack: function(f, n, q, o, h) {
    if (!q) {
      return
    }
    var p = {event: f.originalEvent,type: f.type}, l = n.indexOf("drop") ? "drag" : "drop", s, k = o || 0, g, e, r, m = !isNaN(o) ? o : q.interactions.length;
    f.type = n;
    f.originalEvent = null;
    q.results = [];
    do {
      if (g = q.interactions[k]) {
        if (n !== "dragend" && g.cancelled) {
          continue
        }
        r = c.properties(f, q, g);
        g.results = [];
        d(h || g[l] || q.droppable).each(function(u, t) {
          r.target = t;
          s = t ? b.handle.call(t, f, r) : null;
          if (s === false) {
            if (l == "drag") {
              g.cancelled = true;
              q.propagates -= 1
            }
            if (n == "drop") {
              g[l][u] = null
            }
          } else {
            if (n == "dropinit") {
              g.droppable.push(c.element(s) || t)
            }
          }
          if (n == "dragstart") {
            g.proxy = d(c.element(s) || g.drag)[0]
          }
          g.results.push(s);
          delete f.result;
          if (n !== "dropinit") {
            return s
          }
        });
        q.results[k] = c.flatten(g.results);
        if (n == "dropinit") {
          g.droppable = c.flatten(g.droppable)
        }
        if (n == "dragstart" && !g.cancelled) {
          r.update()
        }
      }
    } while (++k < m);
    f.type = p.type;
    f.originalEvent = p.event;
    return c.flatten(q.results)
  },properties: function(g, e, f) {
    var h = f.callback;
    h.drag = f.drag;
    h.proxy = f.proxy || f.drag;
    h.startX = e.pageX;
    h.startY = e.pageY;
    h.deltaX = g.pageX - e.pageX;
    h.deltaY = g.pageY - e.pageY;
    h.originalX = f.offset.left;
    h.originalY = f.offset.top;
    h.offsetX = g.pageX - (e.pageX - h.originalX);
    h.offsetY = g.pageY - (e.pageY - h.originalY);
    h.drop = c.flatten((f.drop || []).slice());
    h.available = c.flatten((f.droppable || []).slice());
    return h
  },element: function(e) {
    if (e && (e.jquery || e.nodeType == 1)) {
      return e
    }
  },flatten: function(e) {
    return d.map(e, function(f) {
      return f && f.jquery ? d.makeArray(f) : f && f.length ? c.flatten(f) : f
    })
  },textselect: function(e) {
    d(document)[e ? "unbind" : "bind"]("selectstart", c.dontstart).attr("unselectable", e ? "off" : "on").css("MozUserSelect", e ? "" : "none")
  },dontstart: function() {
    return false
  },callback: function() {
  }};
  c.callback.prototype = {update: function() {
    if (a.drop && this.available.length) {
      d.each(this.available, function(e) {
        a.drop.locate(this, e)
      })
    }
  }};
  a.draginit = a.dragstart = a.dragend = c
})(jQuery);
(function(d) {
  d.timeago = function(g) {
    if (g instanceof Date) {
      return a(g)
    } else {
      if (typeof g === "string") {
        return a(d.timeago.parse(g))
      } else {
        return a(d.timeago.datetime(g))
      }
    }
  };
  var f = d.timeago;
  d.extend(d.timeago, {settings: {refreshMillis: 60000,allowFuture: false,strings: {prefixAgo: null,prefixFromNow: null,suffixAgo: "ago",suffixFromNow: "from now",seconds: "less than a minute",minute: "about a minute",minutes: "%d minutes",hour: "about an hour",hours: "about %d hours",day: "a day",days: "%d days",month: "about a month",months: "%d months",year: "about a year",years: "%d years",numbers: []}},inWords: function(n) {
    var o = this.settings.strings;
    var k = o.prefixAgo;
    var s = o.suffixAgo;
    if (this.settings.allowFuture) {
      if (n < 0) {
        k = o.prefixFromNow;
        s = o.suffixFromNow
      }
      n = Math.abs(n)
    }
    var q = n / 1000;
    var g = q / 60;
    var p = g / 60;
    var r = p / 24;
    var l = r / 365;
    function h(t, v) {
      var u = d.isFunction(t) ? t(v, n) : t;
      var w = (o.numbers && o.numbers[v]) || v;
      return u.replace(/%d/i, w)
    }
    var m = q < 45 && h(o.seconds, Math.round(q)) || q < 90 && h(o.minute, 1) || g < 45 && h(o.minutes, Math.round(g)) || g < 90 && h(o.hour, 1) || p < 24 && h(o.hours, Math.round(p)) || p < 48 && h(o.day, 1) || r < 30 && h(o.days, Math.floor(r)) || r < 60 && h(o.month, 1) || r < 365 && h(o.months, Math.floor(r / 30)) || l < 2 && h(o.year, 1) || h(o.years, Math.floor(l));
    return d.trim([k, m, s].join(" "))
  },parse: function(h) {
    var g = d.trim(h);
    g = g.replace(/\.\d+/, "");
    g = g.replace(/-/, "/").replace(/-/, "/");
    g = g.replace(/T/, " ").replace(/Z/, " UTC");
    g = g.replace(/([\+\-]\d\d)\:?(\d\d)/, " $1$2");
    return new Date(g)
  },datetime: function(h) {
    var k = d(h).get(0).tagName.toLowerCase() === "time";
    var g = k ? d(h).attr("datetime") : d(h).attr("title");
    return f.parse(g)
  }});
  d.fn.timeago = function() {
    var h = this;
    h.each(c);
    var g = f.settings;
    if (g.refreshMillis > 0) {
      setInterval(function() {
        h.each(c)
      }, g.refreshMillis)
    }
    return h
  };
  function c() {
    var g = b(this);
    if (!isNaN(g.datetime)) {
      d(this).text(a(g.datetime))
    }
    return this
  }
  function b(g) {
    g = d(g);
    if (!g.data("timeago")) {
      g.data("timeago", {datetime: f.datetime(g)});
      var h = d.trim(g.text());
      if (h.length > 0) {
        g.attr("title", h)
      }
    }
    return g.data("timeago")
  }
  function a(g) {
    return f.inWords(e(g))
  }
  function e(g) {
    return (new Date().getTime() - g.getTime())
  }
}(jQuery));
(function() {
  function a(g, e, d, b) {
    var c = g % 10;
    if ((c == 1) && ((g == 1) || (g > 20))) {
      return e
    } else {
      if ((c > 1) && (c < 5) && ((g > 20) || (g < 10))) {
        return d
      } else {
        return b
      }
    }
  }
  jQuery.timeago.settings.strings = {prefixAgo: null,prefixFromNow: "через",suffixAgo: "назад",suffixFromNow: null,seconds: "меньше минуты",minute: "минуту",minutes: function(b) {
    return a(b, "%d минута", "%d минуты", "%d минут")
  },hour: "час",hours: function(b) {
    return a(b, "%d час", "%d часа", "%d часов")
  },day: "день",days: function(b) {
    return a(b, "%d день", "%d дня", "%d дней")
  },month: "месяц",months: function(b) {
    return a(b, "%d месяц", "%d месяца", "%d месяцев")
  },year: "год",years: function(b) {
    return a(b, "%d год", "%d года", "%d лет")
  }};
  if ($.cookie("lang") == "ru" || !$.cookie("lang")) {
    jQuery.timeago.settings.strings = {prefixAgo: null,prefixFromNow: "через",suffixAgo: "",suffixFromNow: null,seconds: "только что",minute: "1 мин.",minutes: function(b) {
      return a(b, "%d мин.", "%d мин.", "%d мин.")
    },hour: "1 час",hours: function(b) {
      return a(b, "%d час", "%d часа", "%d часов")
    },day: "1 день",days: function(b) {
      return a(b, "%d день", "%d дня", "%d дней")
    },month: "1 месяц",months: function(b) {
      return a(b, "%d мес.", "%d мес.", "%d мес.")
    },year: "1 год",years: function(b) {
      return a(b, "%d год", "%d года", "%d лет")
    }}
  }
  if ($.cookie("lang") == "en") {
    jQuery.timeago.settings.strings = {prefixAgo: null,prefixFromNow: null,suffixAgo: "",suffixFromNow: null,seconds: "just now",minute: "1 min.",minutes: "%d min.",hour: "1 hour",hours: "%d hours",day: "1 day",days: "%d days",month: "1 month",months: "%d months",year: "1 year",years: "%d years",numbers: []}
  }
})();
/* Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function(d) {
  var b = ["DOMMouseScroll", "mousewheel"];
  if (d.event.fixHooks) {
    for (var a = b.length; a; ) {
      d.event.fixHooks[b[--a]] = d.event.mouseHooks
    }
  }
  d.event.special.mousewheel = {setup: function() {
    if (this.addEventListener) {
      for (var e = b.length; e; ) {
        this.addEventListener(b[--e], c, false)
      }
    } else {
      this.onmousewheel = c
    }
  },teardown: function() {
    if (this.removeEventListener) {
      for (var e = b.length; e; ) {
        this.removeEventListener(b[--e], c, false)
      }
    } else {
      this.onmousewheel = null
    }
  }};
  d.fn.extend({mousewheel: function(e) {
    return e ? this.bind("mousewheel", e) : this.trigger("mousewheel")
  },unmousewheel: function(e) {
    return this.unbind("mousewheel", e)
  }});
  function c(l) {
    var h = l || window.event, g = [].slice.call(arguments, 1), m = 0, k = true, f = 0, e = 0;
    l = d.event.fix(h);
    l.type = "mousewheel";
    if (h.wheelDelta) {
      m = h.wheelDelta / 120
    }
    if (h.detail) {
      m = -h.detail / 3
    }
    e = m;
    if (h.axis !== undefined && h.axis === h.HORIZONTAL_AXIS) {
      e = 0;
      f = -1 * m
    }
    if (h.wheelDeltaY !== undefined) {
      e = h.wheelDeltaY / 120
    }
    if (h.wheelDeltaX !== undefined) {
      f = -1 * h.wheelDeltaX / 120
    }
    g.unshift(l, m, f, e);
    return (d.event.dispatch || d.event.handle).apply(this, g)
  }
})(jQuery);
!function(a, b) {
  if (typeof module != "undefined") {
    module.exports = b()
  } else {
    if (typeof define == "function" && define.amd) {
      define(a, b)
    } else {
      this[a] = b()
    }
  }
}("invoke", function() {
  function b(c) {
    this._curr = this._root = new a(c)
  }
  b.prototype = {then: function(c) {
    this._curr = this._curr.child(c);
    return this
  },and: function(c) {
    this._curr.sibling(c);
    return this
  },rescue: function(c) {
    this._rescue = c;
    return this
  },end: function(d, c) {
    this._root.exec(d, this._rescue, c)
  }};
  function a(c) {
    this._next = null;
    this._fns = [c];
    this._err = null
  }
  a.prototype = {child: function(c) {
    return this._next = new a(c)
  },sibling: function(c) {
    this._fns.push(c)
  },exec: function(d, l, c) {
    var f, k = this._fns.length, g = [], e = 0, m = this;
    function h(n, o) {
      return function() {
        o(d, function(p, q) {
          if (p) {
            m._err = p;
            return l(p)
          }
          if (m._err) {
            return
          }
          (k === 1) ? g = q : g[n] = q;
          if (++e === k) {
            m._next ? m._next.exec(g, l, c) : c(g)
          }
        })
      }
    }
    for (f = 0; f < k; f++) {
      h(f, this._fns[f])()
    }
  }};
  return function(c) {
    return new b(c)
  }
});
(function(d, e, f) {
  d.fn.jScrollPane = function(a) {
    function b(br, bb) {
      var bk, a9 = this, a1, bF, aK, bD, a6, a0, s, aO, bi, bS, bs, aW, bh, aX, aV, bO, a5, bz, a2, aM, bw, by, bJ, bC, bl, aT, bu, bm, aI, bq, bP, aZ, be, bG = true, ba = true, bQ = false, aU = false, bA = br.clone(false, false).empty(), bM = d.fn.mwheelIntent ? "mwheelIntent.jsp" : "mousewheel.jsp";
      bP = br.css("paddingTop") + " " + br.css("paddingRight") + " " + br.css("paddingBottom") + " " + br.css("paddingLeft");
      aZ = (parseInt(br.css("paddingLeft"), 10) || 0) + (parseInt(br.css("paddingRight"), 10) || 0);
      function bx(k) {
        var p, n, o, g, h, l, m = false, q = false;
        bk = k;
        if (a1 === f) {
          h = br.scrollTop();
          l = br.scrollLeft();
          br.css({overflow: "hidden",padding: 0});
          bF = br.innerWidth() + aZ;
          aK = br.innerHeight();
          br.width(bF);
          a1 = d('<div class="jspPane" />').css("padding", bP).append(br.children());
          bD = d('<div class="jspContainer" />').css({width: bF + "px",height: aK + "px"}).append(a1).appendTo(br)
        } else {
          br.css("width", "");
          m = bk.stickToBottom && bf();
          q = bk.stickToRight && bv();
          g = br.innerWidth() + aZ != bF || br.outerHeight() != aK;
          if (g) {
            bF = br.innerWidth() + aZ;
            aK = br.innerHeight();
            bD.css({width: bF + "px",height: aK + "px"})
          }
          if (!g && be == a6 && a1.outerHeight() == a0) {
            br.width(bF);
            return
          }
          be = a6;
          a1.css("width", "");
          br.width(bF);
          bD.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()
        }
        a1.css("overflow", "auto");
        if (k.contentWidth) {
          a6 = k.contentWidth
        } else {
          a6 = a1[0].scrollWidth
        }
        a0 = a1[0].scrollHeight;
        a1.css("overflow", "");
        s = a6 / bF;
        aO = a0 / aK;
        bi = aO > 1;
        bS = s > 1;
        if (!(bS || bi)) {
          br.removeClass("jspScrollable");
          a1.css({top: 0,width: bD.width() - aZ});
          aR();
          bp();
          a8();
          aJ()
        } else {
          br.addClass("jspScrollable");
          p = bk.maintainPosition && (bh || bO);
          if (p) {
            n = bU();
            o = bW()
          }
          bR();
          c();
          bn();
          if (p) {
            bc(q ? (a6 - bF) : n, false);
            bd(m ? (a0 - aK) : o, false)
          }
          bg();
          bI();
          bB();
          if (bk.enableKeyboardNavigation) {
            a7()
          }
          if (bk.clickOnTrack) {
            aP()
          }
          bt();
          if (bk.hijackInternalLinks) {
            aS()
          }
        }
        if (bk.autoReinitialise && !bq) {
          bq = setInterval(function() {
            bx(bk)
          }, bk.autoReinitialiseDelay)
        } else {
          if (!bk.autoReinitialise && bq) {
            clearInterval(bq)
          }
        }
        h && br.scrollTop(0) && bd(h, false);
        l && br.scrollLeft(0) && bc(l, false);
        br.trigger("jsp-initialised", [bS || bi])
      }
      function bR() {
        if (bi) {
          bD.append(d('<div class="jspVerticalBar" />').append(d('<div class="jspCap jspCapTop" />'), d('<div class="jspTrack" />').append(d('<div class="jspDrag" />').append(d('<div class="jspDragTop" />'), d('<div class="jspDragBottom" />'))), d('<div class="jspCap jspCapBottom" />')));
          a5 = bD.find(">.jspVerticalBar");
          bz = a5.find(">.jspTrack");
          bs = bz.find(">.jspDrag");
          if (bk.showArrows) {
            by = d('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp", bT(0, -1)).bind("click.jsp", bV);
            bJ = d('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp", bT(0, 1)).bind("click.jsp", bV);
            if (bk.arrowScrollOnHover) {
              by.bind("mouseover.jsp", bT(0, -1, by));
              bJ.bind("mouseover.jsp", bT(0, 1, bJ))
            }
            bE(bz, bk.verticalArrowPositions, by, bJ)
          }
          aM = aK;
          bD.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function() {
            aM -= d(this).outerHeight()
          });
          bs.hover(function() {
            bs.addClass("jspHover")
          }, function() {
            bs.removeClass("jspHover")
          }).bind("mousedown.jsp", function(h) {
              d("html").bind("dragstart.jsp selectstart.jsp", bV);
              bs.addClass("jspActive");
              var g = h.pageY - bs.position().top;
              d("html").bind("mousemove.jsp", function(k) {
                a4(k.pageY - g, false)
              }).bind("mouseup.jsp mouseleave.jsp", bo);
              return false
            });
          aQ()
        }
      }
      function aQ() {
        bz.height(aM + "px");
        bh = 0;
        a2 = bk.verticalGutter + bz.outerWidth();
        a1.width(bF - a2 - aZ);
        try {
          if (a5.position().left === 0) {
            a1.css("margin-left", a2 + "px")
          }
        } catch (g) {
        }
      }
      function c() {
        if (bS) {
          bD.append(d('<div class="jspHorizontalBar" />').append(d('<div class="jspCap jspCapLeft" />'), d('<div class="jspTrack" />').append(d('<div class="jspDrag" />').append(d('<div class="jspDragLeft" />'), d('<div class="jspDragRight" />'))), d('<div class="jspCap jspCapRight" />')));
          bC = bD.find(">.jspHorizontalBar");
          bl = bC.find(">.jspTrack");
          aX = bl.find(">.jspDrag");
          if (bk.showArrows) {
            bm = d('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp", bT(-1, 0)).bind("click.jsp", bV);
            aI = d('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp", bT(1, 0)).bind("click.jsp", bV);
            if (bk.arrowScrollOnHover) {
              bm.bind("mouseover.jsp", bT(-1, 0, bm));
              aI.bind("mouseover.jsp", bT(1, 0, aI))
            }
            bE(bl, bk.horizontalArrowPositions, bm, aI)
          }
          aX.hover(function() {
            aX.addClass("jspHover")
          }, function() {
            aX.removeClass("jspHover")
          }).bind("mousedown.jsp", function(h) {
              d("html").bind("dragstart.jsp selectstart.jsp", bV);
              aX.addClass("jspActive");
              var g = h.pageX - aX.position().left;
              d("html").bind("mousemove.jsp", function(k) {
                a3(k.pageX - g, false)
              }).bind("mouseup.jsp mouseleave.jsp", bo);
              return false
            });
          aT = bD.innerWidth();
          bH()
        }
      }
      function bH() {
        bD.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function() {
          aT -= d(this).outerWidth()
        });
        bl.width(aT + "px");
        bO = 0
      }
      function bn() {
        if (bS && bi) {
          var h = bl.outerHeight(), g = bz.outerWidth();
          aM -= h;
          d(bC).find(">.jspCap:visible,>.jspArrow").each(function() {
            aT += d(this).outerWidth()
          });
          aT -= g;
          aK -= g;
          bF -= h;
          bl.parent().append(d('<div class="jspCorner" />').css("width", h + "px"));
          aQ();
          bH()
        }
        if (bS) {
          a1.width((bD.outerWidth() - aZ) + "px")
        }
        a0 = a1.outerHeight();
        aO = a0 / aK;
        if (bS) {
          bu = Math.ceil(1 / s * aT);
          if (bu > bk.horizontalDragMaxWidth) {
            bu = bk.horizontalDragMaxWidth
          } else {
            if (bu < bk.horizontalDragMinWidth) {
              bu = bk.horizontalDragMinWidth
            }
          }
          aX.width(bu + "px");
          aV = aT - bu;
          bK(bO)
        }
        if (bi) {
          bw = Math.ceil(1 / aO * aM);
          if (bw > bk.verticalDragMaxHeight) {
            bw = bk.verticalDragMaxHeight
          } else {
            if (bw < bk.verticalDragMinHeight) {
              bw = bk.verticalDragMinHeight
            }
          }
          bs.height(bw + "px");
          aW = aM - bw;
          bL(bh)
        }
      }
      function bE(n, l, o, h) {
        var g = "before", m = "after", k;
        if (l == "os") {
          l = /Mac/.test(navigator.platform) ? "after" : "split"
        }
        if (l == g) {
          m = l
        } else {
          if (l == m) {
            g = l;
            k = o;
            o = h;
            h = k
          }
        }
        n[g](o)[m](h)
      }
      function bT(k, g, h) {
        return function() {
          bj(k, g, this, h);
          this.blur();
          return false
        }
      }
      function bj(m, n, g, k) {
        g = d(g).addClass("jspActive");
        var l, o, p = true, h = function() {
          if (m !== 0) {
            a9.scrollByX(m * bk.arrowButtonSpeed)
          }
          if (n !== 0) {
            a9.scrollByY(n * bk.arrowButtonSpeed)
          }
          o = setTimeout(h, p ? bk.initialDelay : bk.arrowRepeatFreq);
          p = false
        };
        h();
        l = k ? "mouseout.jsp" : "mouseup.jsp";
        k = k || d("html");
        k.bind(l, function() {
          g.removeClass("jspActive");
          o && clearTimeout(o);
          o = null;
          k.unbind(l)
        })
      }
      function aP() {
        aJ();
        if (bi) {
          bz.bind("mousedown.jsp", function(k) {
            if (k.originalTarget === f || k.originalTarget == k.currentTarget) {
              var m = d(this), g = m.offset(), l = k.pageY - g.top - bh, o, p = true, h = function() {
                var r = m.offset(), q = k.pageY - r.top - bw / 2, u = aK * bk.scrollPagePercent, t = aW * u / (a0 - aK);
                if (l < 0) {
                  if (bh - t > q) {
                    a9.scrollByY(-u)
                  } else {
                    a4(q)
                  }
                } else {
                  if (l > 0) {
                    if (bh + t < q) {
                      a9.scrollByY(u)
                    } else {
                      a4(q)
                    }
                  } else {
                    n();
                    return
                  }
                }
                o = setTimeout(h, p ? bk.initialDelay : bk.trackClickRepeatFreq);
                p = false
              }, n = function() {
                o && clearTimeout(o);
                o = null;
                d(document).unbind("mouseup.jsp", n)
              };
              h();
              d(document).bind("mouseup.jsp", n);
              return false
            }
          })
        }
        if (bS) {
          bl.bind("mousedown.jsp", function(k) {
            if (k.originalTarget === f || k.originalTarget == k.currentTarget) {
              var m = d(this), g = m.offset(), l = k.pageX - g.left - bO, o, p = true, h = function() {
                var r = m.offset(), q = k.pageX - r.left - bu / 2, u = bF * bk.scrollPagePercent, t = aV * u / (a6 - bF);
                if (l < 0) {
                  if (bO - t > q) {
                    a9.scrollByX(-u)
                  } else {
                    a3(q)
                  }
                } else {
                  if (l > 0) {
                    if (bO + t < q) {
                      a9.scrollByX(u)
                    } else {
                      a3(q)
                    }
                  } else {
                    n();
                    return
                  }
                }
                o = setTimeout(h, p ? bk.initialDelay : bk.trackClickRepeatFreq);
                p = false
              }, n = function() {
                o && clearTimeout(o);
                o = null;
                d(document).unbind("mouseup.jsp", n)
              };
              h();
              d(document).bind("mouseup.jsp", n);
              return false
            }
          })
        }
      }
      function aJ() {
        if (bl) {
          bl.unbind("mousedown.jsp")
        }
        if (bz) {
          bz.unbind("mousedown.jsp")
        }
      }
      function bo() {
        d("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");
        if (bs) {
          bs.removeClass("jspActive")
        }
        if (aX) {
          aX.removeClass("jspActive")
        }
      }
      function a4(g, h) {
        if (!bi) {
          return
        }
        if (g < 0) {
          g = 0
        } else {
          if (g > aW) {
            g = aW
          }
        }
        if (h === f) {
          h = bk.animateScroll
        }
        if (h) {
          a9.animate(bs, "top", g, bL)
        } else {
          bs.css("top", g);
          bL(g)
        }
      }
      function bL(m) {
        if (m === f) {
          m = bs.position().top
        }
        bD.scrollTop(0);
        bh = m;
        var h = bh === 0, l = bh == aW, k = m / aW, g = -k * (a0 - aK);
        if (bG != h || bQ != l) {
          bG = h;
          bQ = l;
          br.trigger("jsp-arrow-change", [bG, bQ, ba, aU])
        }
        aL(h, l);
        a1.css("top", g);
        br.trigger("jsp-scroll-y", [-g, h, l]).trigger("scroll")
      }
      function a3(h, g) {
        if (!bS) {
          return
        }
        if (h < 0) {
          h = 0
        } else {
          if (h > aV) {
            h = aV
          }
        }
        if (g === f) {
          g = bk.animateScroll
        }
        if (g) {
          a9.animate(aX, "left", h, bK)
        } else {
          aX.css("left", h);
          bK(h)
        }
      }
      function bK(m) {
        if (m === f) {
          m = aX.position().left
        }
        bD.scrollTop(0);
        bO = m;
        var h = bO === 0, k = bO == aV, l = m / aV, g = -l * (a6 - bF);
        if (ba != h || aU != k) {
          ba = h;
          aU = k;
          br.trigger("jsp-arrow-change", [bG, bQ, ba, aU])
        }
        aN(h, k);
        a1.css("left", g);
        br.trigger("jsp-scroll-x", [-g, h, k]).trigger("scroll")
      }
      function aL(h, g) {
        if (bk.showArrows) {
          by[h ? "addClass" : "removeClass"]("jspDisabled");
          bJ[g ? "addClass" : "removeClass"]("jspDisabled")
        }
      }
      function aN(h, g) {
        if (bk.showArrows) {
          bm[h ? "addClass" : "removeClass"]("jspDisabled");
          aI[g ? "addClass" : "removeClass"]("jspDisabled")
        }
      }
      function bd(g, k) {
        var h = g / (a0 - aK);
        a4(h * aW, k)
      }
      function bc(k, g) {
        var h = k / (a6 - bF);
        a3(h * aV, g)
      }
      function bN(k, p, g) {
        var t, w, v, x = 0, l = 0, h, q, r, n, o, m;
        try {
          t = d(k)
        } catch (u) {
          return
        }
        w = t.outerHeight();
        v = t.outerWidth();
        bD.scrollTop(0);
        bD.scrollLeft(0);
        while (!t.is(".jspPane")) {
          x += t.position().top;
          l += t.position().left;
          t = t.offsetParent();
          if (/^body|html$/i.test(t[0].nodeName)) {
            return
          }
        }
        h = bW();
        r = h + aK;
        if (x < h || p) {
          o = x - bk.verticalGutter
        } else {
          if (x + w > r) {
            o = x - aK + w + bk.verticalGutter
          }
        }
        if (o) {
          bd(o, g)
        }
        q = bU();
        n = q + bF;
        if (l < q || p) {
          m = l - bk.horizontalGutter
        } else {
          if (l + v > n) {
            m = l - bF + v + bk.horizontalGutter
          }
        }
        if (m) {
          bc(m, g)
        }
      }
      function bU() {
        return -a1.position().left
      }
      function bW() {
        return -a1.position().top
      }
      function bf() {
        var g = a0 - aK;
        return (g > 20) && (g - bW() < 10)
      }
      function bv() {
        var g = a6 - bF;
        return (g > 20) && (g - bU() < 10)
      }
      function bI() {
        bD.unbind(bM).bind(bM, function(k, h, l, n) {
          var m = bO, g = bh;
          a9.scrollBy(l * bk.mouseWheelSpeed, -n * bk.mouseWheelSpeed, false);
          return m == bO && g == bh
        })
      }
      function aR() {
        bD.unbind(bM)
      }
      function bV() {
        return false
      }
      function bg() {
        a1.find(":input,a").unbind("focus.jsp").bind("focus.jsp", function(g) {
          bN(g.target, false)
        })
      }
      function bp() {
        a1.find(":input,a").unbind("focus.jsp")
      }
      function a7() {
        var g, l, h = [];
        bS && h.push(bC[0]);
        bi && h.push(a5[0]);
        a1.focus(function() {
          br.focus()
        });
        br.attr("tabindex", 0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp", function(m) {
          if (m.target !== this && !(h.length && d(m.target).closest(h).length)) {
            return
          }
          var n = bO, o = bh;
          switch (m.keyCode) {
            case 40:
            case 38:
            case 34:
            case 32:
            case 33:
            case 39:
            case 37:
              g = m.keyCode;
              k();
              break;
            case 35:
              bd(a0 - aK);
              g = null;
              break;
            case 36:
              bd(0);
              g = null;
              break
          }
          l = m.keyCode == g && n != bO || o != bh;
          return !l
        }).bind("keypress.jsp", function(m) {
            if (m.keyCode == g) {
              k()
            }
            return !l
          });
        if (bk.hideFocus) {
          br.css("outline", "none");
          if ("hideFocus" in bD[0]) {
            br.attr("hideFocus", true)
          }
        } else {
          br.css("outline", "");
          if ("hideFocus" in bD[0]) {
            br.attr("hideFocus", false)
          }
        }
        function k() {
          var m = bO, n = bh;
          switch (g) {
            case 40:
              a9.scrollByY(bk.keyboardSpeed, false);
              break;
            case 38:
              a9.scrollByY(-bk.keyboardSpeed, false);
              break;
            case 34:
            case 32:
              a9.scrollByY(aK * bk.scrollPagePercent, false);
              break;
            case 33:
              a9.scrollByY(-aK * bk.scrollPagePercent, false);
              break;
            case 39:
              a9.scrollByX(bk.keyboardSpeed, false);
              break;
            case 37:
              a9.scrollByX(-bk.keyboardSpeed, false);
              break
          }
          l = m != bO || n != bh;
          return l
        }
      }
      function a8() {
        br.attr("tabindex", "-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")
      }
      function bt() {
        if (location.hash && location.hash.length > 1) {
          var h, l, k = escape(location.hash.substr(1));
          try {
            h = d("#" + k + ', a[name="' + k + '"]')
          } catch (g) {
            return
          }
          if (h.length && a1.find(k)) {
            if (bD.scrollTop() === 0) {
              l = setInterval(function() {
                if (bD.scrollTop() > 0) {
                  bN(h, true);
                  d(document).scrollTop(bD.position().top);
                  clearInterval(l)
                }
              }, 50)
            } else {
              bN(h, true);
              d(document).scrollTop(bD.position().top)
            }
          }
        }
      }
      function aS() {
        if (d(document.body).data("jspHijack")) {
          return
        }
        d(document.body).data("jspHijack", true);
        d(document.body).delegate("a[href*=#]", "click", function(r) {
          var h = this.href.substr(0, this.href.indexOf("#")), q = location.href, m, l, g, o, p, n;
          if (location.href.indexOf("#") !== -1) {
            q = location.href.substr(0, location.href.indexOf("#"))
          }
          if (h !== q) {
            return
          }
          m = escape(this.href.substr(this.href.indexOf("#") + 1));
          l;
          try {
            l = d("#" + m + ', a[name="' + m + '"]')
          } catch (k) {
            return
          }
          if (!l.length) {
            return
          }
          g = l.closest(".jspScrollable");
          o = g.data("jsp");
          o.scrollToElement(l, true);
          if (g[0].scrollIntoView) {
            p = d(e).scrollTop();
            n = l.offset().top;
            if (n < p || n > p + d(e).height()) {
              g[0].scrollIntoView()
            }
          }
          r.preventDefault()
        })
      }
      function bB() {
        var m, n, k, l, h, g = false;
        bD.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp", function(p) {
          var o = p.originalEvent.touches[0];
          m = bU();
          n = bW();
          k = o.pageX;
          l = o.pageY;
          h = false;
          g = true
        }).bind("touchmove.jsp", function(o) {
            if (!g) {
              return
            }
            var p = o.originalEvent.touches[0], q = bO, r = bh;
            a9.scrollTo(m + k - p.pageX, n + l - p.pageY);
            h = h || Math.abs(k - p.pageX) > 5 || Math.abs(l - p.pageY) > 5;
            return q == bO && r == bh
          }).bind("touchend.jsp", function(o) {
            g = false
          }).bind("click.jsp-touchclick", function(o) {
            if (h) {
              h = false;
              return false
            }
          })
      }
      function aY() {
        var g = bW(), h = bU();
        br.removeClass("jspScrollable").unbind(".jsp");
        br.replaceWith(bA.append(a1.children()));
        bA.scrollTop(g);
        bA.scrollLeft(h);
        if (bq) {
          clearInterval(bq)
        }
      }
      d.extend(a9, {reinitialise: function(g) {
        g = d.extend({}, bk, g);
        bx(g)
      },scrollToElement: function(h, k, g) {
        bN(h, k, g)
      },scrollTo: function(h, g, k) {
        bc(h, k);
        bd(g, k)
      },scrollToX: function(h, g) {
        bc(h, g)
      },scrollToY: function(g, h) {
        bd(g, h)
      },scrollToPercentX: function(h, g) {
        bc(h * (a6 - bF), g)
      },scrollToPercentY: function(h, g) {
        bd(h * (a0 - aK), g)
      },scrollBy: function(k, g, h) {
        a9.scrollByX(k, h);
        a9.scrollByY(g, h)
      },scrollByX: function(g, k) {
        var l = bU() + Math[g < 0 ? "floor" : "ceil"](g), h = l / (a6 - bF);
        a3(h * aV, k)
      },scrollByY: function(g, k) {
        var l = bW() + Math[g < 0 ? "floor" : "ceil"](g), h = l / (a0 - aK);
        a4(h * aW, k)
      },positionDragX: function(g, h) {
        a3(g, h)
      },positionDragY: function(h, g) {
        a4(h, g)
      },animate: function(m, h, g, k) {
        var l = {};
        l[h] = g;
        m.animate(l, {duration: bk.animateDuration,easing: bk.animateEase,queue: false,step: k})
      },getContentPositionX: function() {
        return bU()
      },getContentPositionY: function() {
        return bW()
      },getContentWidth: function() {
        return a6
      },getContentHeight: function() {
        return a0
      },getPercentScrolledX: function() {
        return bU() / (a6 - bF)
      },getPercentScrolledY: function() {
        return bW() / (a0 - aK)
      },getIsScrollableH: function() {
        return bS
      },getIsScrollableV: function() {
        return bi
      },getContentPane: function() {
        return a1
      },scrollToBottom: function(g) {
        a4(aW, g)
      },hijackInternalLinks: d.noop,destroy: function() {
        aY()
      }});
      bx(bb)
    }
    a = d.extend({}, d.fn.jScrollPane.defaults, a);
    d.each(["mouseWheelSpeed", "arrowButtonSpeed", "trackClickSpeed", "keyboardSpeed"], function() {
      a[this] = a[this] || a.speed
    });
    return this.each(function() {
      var h = d(this), c = h.data("jsp");
      if (c) {
        c.reinitialise(a)
      } else {
        d("script", h).filter('[type="text/javascript"],:not([type])').remove();
        c = new b(h, a);
        h.data("jsp", c)
      }
    })
  };
  d.fn.jScrollPane.defaults = {showArrows: false,maintainPosition: true,stickToBottom: false,stickToRight: false,clickOnTrack: true,autoReinitialise: false,autoReinitialiseDelay: 500,verticalDragMinHeight: 0,verticalDragMaxHeight: 99999,horizontalDragMinWidth: 0,horizontalDragMaxWidth: 99999,contentWidth: f,animateScroll: false,animateDuration: 300,animateEase: "linear",hijackInternalLinks: false,verticalGutter: 4,horizontalGutter: 4,mouseWheelSpeed: 0,arrowButtonSpeed: 0,arrowRepeatFreq: 50,arrowScrollOnHover: false,trackClickSpeed: 0,trackClickRepeatFreq: 70,verticalArrowPositions: "split",horizontalArrowPositions: "split",enableKeyboardNavigation: true,hideFocus: false,keyboardSpeed: 0,initialDelay: 300,speed: 30,scrollPagePercent: 0.8}
})(jQuery, this);
(function(e, f, g) {
  var b = f.event, a = f.event.handle ? "handle" : "dispatch", d;
  b.special.smartresize = {setup: function() {
    f(this).bind("resize", b.special.smartresize.handler)
  },teardown: function() {
    f(this).unbind("resize", b.special.smartresize.handler)
  },handler: function(m, h) {
    var l = this, k = arguments;
    m.type = "smartresize";
    if (d) {
      clearTimeout(d)
    }
    d = setTimeout(function() {
      b[a].apply(l, k)
    }, h === "execAsap" ? 0 : 100)
  }};
  f.fn.smartresize = function(h) {
    return h ? this.bind("smartresize", h) : this.trigger("smartresize", ["execAsap"])
  };
  f.Mason = function(h, k) {
    this.element = f(k);
    this._create(h);
    this._init()
  };
  f.Mason.settings = {isResizable: true,isAnimated: false,animationOptions: {queue: false,duration: 500},gutterWidth: 0,isRTL: false,isFitWidth: false,containerStyle: {position: "relative"}};
  f.Mason.prototype = {_filterFindBricks: function(k) {
    var h = this.options.itemSelector;
    return !h ? k : k.filter(h).add(k.find(h))
  },_getBricks: function(k) {
    var h = this._filterFindBricks(k).css({position: "absolute"}).addClass("masonry-brick");
    return h
  },_create: function(m) {
    this.options = f.extend(true, {}, f.Mason.settings, m);
    this.styleQueue = [];
    var l = this.element[0].style;
    this.originalStyle = {height: l.height || ""};
    var n = this.options.containerStyle;
    for (var p in n) {
      this.originalStyle[p] = l[p] || ""
    }
    this.element.css(n);
    this.horizontalDirection = this.options.isRTL ? "right" : "left";
    var k = this.element.css("padding-" + this.horizontalDirection);
    var o = this.element.css("padding-top");
    this.offset = {x: k ? parseInt(k, 10) : 0,y: o ? parseInt(o, 10) : 0};
    this.isFluid = this.options.columnWidth && typeof this.options.columnWidth === "function";
    var h = this;
    setTimeout(function() {
      h.element.addClass("masonry")
    }, 0);
    if (this.options.isResizable) {
      f(e).bind("smartresize.masonry", function() {
        h.resize()
      })
    }
    this.reloadItems()
  },_init: function(h) {
    this._getColumns();
    this._reLayout(h)
  },option: function(h, k) {
    if (f.isPlainObject(h)) {
      this.options = f.extend(true, this.options, h)
    }
  },layout: function(q, r) {
    for (var o = 0, p = q.length; o < p; o++) {
      this._placeBrick(q[o])
    }
    var h = {};
    h.height = Math.max.apply(Math, this.colYs);
    if (this.options.isFitWidth) {
      var m = 0;
      o = this.cols;
      while (--o) {
        if (this.colYs[o] !== 0) {
          break
        }
        m++
      }
      h.width = (this.cols - m) * this.columnWidth - this.options.gutterWidth
    }
    this.styleQueue.push({$el: this.element,style: h});
    var k = !this.isLaidOut ? "css" : (this.options.isAnimated ? "animate" : "css"), l = this.options.animationOptions;
    var n;
    for (o = 0, p = this.styleQueue.length; o < p; o++) {
      n = this.styleQueue[o];
      n.$el[k](n.style, l)
    }
    this.styleQueue = [];
    if (r) {
      r.call(q)
    }
    this.isLaidOut = true
  },_getColumns: function() {
    var h = this.options.isFitWidth ? this.element.parent() : this.element, k = h.width();
    this.columnWidth = this.isFluid ? this.options.columnWidth(k) : this.options.columnWidth || this.$bricks.outerWidth(true) || k;
    this.columnWidth += this.options.gutterWidth;
    this.cols = Math.floor((k + this.options.gutterWidth) / this.columnWidth);
    this.cols = Math.max(this.cols, 1)
  },_placeBrick: function(q) {
    var o = f(q), s, w, l, u, m;
    s = Math.ceil(o.outerWidth(true) / this.columnWidth);
    s = Math.min(s, this.cols);
    if (s === 1) {
      l = this.colYs
    } else {
      w = this.cols + 1 - s;
      l = [];
      for (m = 0; m < w; m++) {
        u = this.colYs.slice(m, m + s);
        l[m] = Math.max.apply(Math, u)
      }
    }
    var h = Math.min.apply(Math, l), v = 0;
    for (var n = 0, r = l.length; n < r; n++) {
      if (l[n] === h) {
        v = n;
        break
      }
    }
    var p = {top: h + this.offset.y};
    p[this.horizontalDirection] = this.columnWidth * v + this.offset.x;
    this.styleQueue.push({$el: o,style: p});
    var t = h + o.outerHeight(true), k = this.cols + 1 - r;
    for (n = 0; n < k; n++) {
      this.colYs[v + n] = t
    }
  },resize: function() {
    var h = this.cols;
    this._getColumns();
    if (this.isFluid || this.cols !== h) {
      this._reLayout()
    }
  },_reLayout: function(l) {
    var h = this.cols;
    this.colYs = [];
    while (h--) {
      this.colYs.push(0)
    }
    this.layout(this.$bricks, l);
    f(this.element).data("masonry", this);
    var k = f.Event("masonry:complete");
    f(this.element).trigger(k)
  },reloadItems: function() {
    this.$bricks = this._getBricks(this.element.children())
  },reload: function(h) {
    this.reloadItems();
    this._init(h)
  },appended: function(k, l, m) {
    if (l) {
      this._filterFindBricks(k).css({top: this.element.height()});
      var h = this;
      setTimeout(function() {
        h._appended(k, m)
      }, 1)
    } else {
      this._appended(k, m)
    }
  },_appended: function(h, l) {
    var k = this._getBricks(h);
    this.$bricks = this.$bricks.add(k);
    this.layout(k, l)
  },remove: function(h) {
    this.$bricks = this.$bricks.not(h);
    h.remove()
  },destroy: function() {
    this.$bricks.removeClass("masonry-brick").each(function() {
      this.style.position = "";
      this.style.top = "";
      this.style.left = ""
    });
    var h = this.element[0].style;
    for (var k in this.originalStyle) {
      h[k] = this.originalStyle[k]
    }
    this.element.unbind(".masonry").removeClass("masonry").removeData("masonry");
    f(e).unbind(".masonry")
  }};
  /*
   * jQuery imagesLoaded plugin v1.1.0
   * http://github.com/desandro/imagesloaded
   *
   * MIT License. by Paul Irish et al.
   */
  f.fn.imagesLoaded = function(q) {
    var o = this, m = o.find("img").add(o.filter("img")), h = m.length, p = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==", l = [];
    function n() {
      q.call(o, m)
    }
    function k(s) {
      var r = s.target;
      if (r.src !== p && f.inArray(r, l) === -1) {
        l.push(r);
        if (--h <= 0) {
          setTimeout(n);
          m.unbind(".imagesLoaded", k)
        }
      }
    }
    if (!h) {
      n()
    }
    m.bind("load.imagesLoaded error.imagesLoaded", k).each(function() {
      var r = this.src;
      this.src = p;
      this.src = r
    });
    return o
  };
  var c = function(h) {
    if (e.console) {
      e.console.error(h)
    }
  };
  f.fn.masonry = function(k) {
    if (typeof k === "string") {
      var h = Array.prototype.slice.call(arguments, 1);
      this.each(function() {
        var l = f.data(this, "masonry");
        if (!l) {
          c("cannot call methods on masonry prior to initialization; attempted to call method '" + k + "'");
          return
        }
        if (!f.isFunction(l[k]) || k.charAt(0) === "_") {
          c("no such method '" + k + "' for masonry instance");
          return
        }
        l[k].apply(l, h)
      })
    } else {
      this.each(function() {
        var l = f.data(this, "masonry");
        if (l) {
          l.option(k || {});
          l._init()
        } else {
          var m = new f.Mason(k, this)
        }
      })
    }
    return this
  }
})(window, jQuery);
(function(a3) {
  function al(b, a) {
    return function(c) {
      return aX(b.call(this, c), a)
    }
  }
  function an(a) {
    return function(b) {
      return this.lang().ordinal(a.call(this, b))
    }
  }
  function a8() {
  }
  function ay(a) {
    at(this, a)
  }
  function ak(k) {
    var p = this._data = {}, d = k.years || k.year || k.y || 0, b = k.months || k.month || k.M || 0, g = k.weeks || k.week || k.w || 0, q = k.days || k.day || k.d || 0, c = k.hours || k.hour || k.h || 0, m = k.minutes || k.minute || k.m || 0, l = k.seconds || k.second || k.s || 0, h = k.milliseconds || k.millisecond || k.ms || 0;
    this._milliseconds = h + l * 1000 + m * 60000 + c * 3600000, this._days = q + g * 7, this._months = b + d * 12, p.milliseconds = h % 1000, l += aA(h / 1000), p.seconds = l % 60, m += aA(l / 60), p.minutes = m % 60, c += aA(m / 60), p.hours = c % 24, q += aA(c / 24), q += g * 7, p.days = q % 30, b += aA(q / 30), p.months = b % 12, d += aA(b / 12), p.years = d
  }
  function at(b, a) {
    for (var c in a) {
      a.hasOwnProperty(c) && (b[c] = a[c])
    }
    return b
  }
  function aA(a) {
    return a < 0 ? Math.ceil(a) : Math.floor(a)
  }
  function aX(b, a) {
    var c = b + "";
    while (c.length < a) {
      c = "0" + c
    }
    return c
  }
  function aw(f, b, h) {
    var d = b._milliseconds, a = b._days, c = b._months, g;
    d && f._d.setTime(+f + d * h), a && f.date(f.date() + a * h), c && (g = f.date(), f.date(1).month(f.month() + c * h).date(Math.min(g, f.daysInMonth())))
  }
  function ar(a) {
    return Object.prototype.toString.call(a) === "[object Array]"
  }
  function aO(f, b) {
    var g = Math.min(f.length, b.length), d = Math.abs(f.length - b.length), a = 0, c;
    for (c = 0; c < g; c++) {
      ~~f[c] !== ~~b[c] && a++
    }
    return a + d
  }
  function ai(b, a) {
    return a.abbr = b, aM[b] || (aM[b] = new a8), aM[b].set(a), aM[b]
  }
  function af(a) {
    return a ? (!aM[a] && aR && require("./lang/" + a), aM[a]) : aL.fn._lang
  }
  function aF(a) {
    return a.match(/\[.*\]/) ? a.replace(/^\[|\]$/g, "") : a.replace(/\\/g, "")
  }
  function ad(c) {
    var a = c.match(a7), d, b;
    for (d = 0, b = a.length; d < b; d++) {
      aB[a[d]] ? a[d] = aB[a[d]] : a[d] = aF(a[d])
    }
    return function(e) {
      var f = "";
      for (d = 0; d < b; d++) {
        f += typeof a[d].call == "function" ? a[d].call(e, c) : a[d]
      }
      return f
    }
  }
  function ac(c, a) {
    function b(e) {
      return c.lang().longDateFormat(e) || e
    }
    var d = 5;
    while (d-- && a1.test(a)) {
      a = a.replace(a1, b)
    }
    return az[a] || (az[a] = ad(a)), az[a](c)
  }
  function ae(a) {
    switch (a) {
      case "DDDD":
        return aP;
      case "YYYY":
        return a4;
      case "YYYYY":
        return aJ;
      case "S":
      case "SS":
      case "SSS":
      case "DDD":
        return aZ;
      case "MMM":
      case "MMMM":
      case "dd":
      case "ddd":
      case "dddd":
      case "a":
      case "A":
        return aT;
      case "X":
        return a6;
      case "Z":
      case "ZZ":
        return a0;
      case "T":
        return aG;
      case "MM":
      case "DD":
      case "YY":
      case "HH":
      case "hh":
      case "mm":
      case "ss":
      case "M":
      case "D":
      case "d":
      case "H":
      case "h":
      case "m":
      case "s":
        return a5;
      default:
        return new RegExp(a.replace("\\", ""))
    }
  }
  function aE(f, b, g) {
    var d, a, c = g._a;
    switch (f) {
      case "M":
      case "MM":
        c[1] = b == null ? 0 : ~~b - 1;
        break;
      case "MMM":
      case "MMMM":
        d = af(g._l).monthsParse(b), d != null ? c[1] = d : g._isValid = !1;
        break;
      case "D":
      case "DD":
      case "DDD":
      case "DDDD":
        b != null && (c[2] = ~~b);
        break;
      case "YY":
        c[0] = ~~b + (~~b > 68 ? 1900 : 2000);
        break;
      case "YYYY":
      case "YYYYY":
        c[0] = ~~b;
        break;
      case "a":
      case "A":
        g._isPm = (b + "").toLowerCase() === "pm";
        break;
      case "H":
      case "HH":
      case "h":
      case "hh":
        c[3] = ~~b;
        break;
      case "m":
      case "mm":
        c[4] = ~~b;
        break;
      case "s":
      case "ss":
        c[5] = ~~b;
        break;
      case "S":
      case "SS":
      case "SSS":
        c[6] = ~~(("0." + b) * 1000);
        break;
      case "X":
        g._d = new Date(parseFloat(b) * 1000);
        break;
      case "Z":
      case "ZZ":
        g._useUTC = !0, d = (b + "").match(aH), d && d[1] && (g._tzh = ~~d[1]), d && d[2] && (g._tzm = ~~d[2]), d && d[0] === "+" && (g._tzh = -g._tzh, g._tzm = -g._tzm)
    }
    b == null && (g._isValid = !1)
  }
  function aq(c) {
    var a, d, b = [];
    if (c._d) {
      return
    }
    for (a = 0; a < 7; a++) {
      c._a[a] = b[a] = c._a[a] == null ? a === 2 ? 1 : 0 : c._a[a]
    }
    b[3] += c._tzh || 0, b[4] += c._tzm || 0, d = new Date(0), c._useUTC ? (d.setUTCFullYear(b[0], b[1], b[2]), d.setUTCHours(b[3], b[4], b[5], b[6])) : (d.setFullYear(b[0], b[1], b[2]), d.setHours(b[3], b[4], b[5], b[6])), c._d = d
  }
  function ap(d) {
    var b = d._f.match(a7), f = d._i, c, a;
    d._a = [];
    for (c = 0; c < b.length; c++) {
      a = (ae(b[c]).exec(f) || [])[0], a && (f = f.slice(f.indexOf(a) + a.length)), aB[b[c]] && aE(b[c], a, d)
    }
    d._isPm && d._a[3] < 12 && (d._a[3] += 12), d._isPm === !1 && d._a[3] === 12 && (d._a[3] = 0), aq(d)
  }
  function aj(g) {
    var c, k, f, b = 99, d, h, a;
    while (g._f.length) {
      c = at({}, g), c._f = g._f.pop(), ap(c), k = new ay(c);
      if (k.isValid()) {
        f = k;
        break
      }
      a = aO(c._a, k.toArray()), a < b && (b = a, f = k)
    }
    at(g, f)
  }
  function av(b) {
    var a, c = b._i;
    if (aI.exec(c)) {
      b._f = "YYYY-MM-DDT";
      for (a = 0; a < 4; a++) {
        if (ah[a][1].exec(c)) {
          b._f += ah[a][0];
          break
        }
      }
      a0.exec(c) && (b._f += " Z"), ap(b)
    } else {
      b._d = new Date(c)
    }
  }
  function ab(a) {
    var c = a._i, b = aK.exec(c);
    c === a3 ? a._d = new Date : b ? a._d = new Date(+b[1]) : typeof c == "string" ? av(a) : ar(c) ? (a._a = c.slice(0), aq(a)) : a._d = c instanceof Date ? new Date(+c) : new Date(c)
  }
  function aa(d, b, f, c, a) {
    return a.relativeTime(b || 1, !!f, d, c)
  }
  function aQ(h, m, c) {
    var d = aN(Math.abs(h) / 1000), p = aN(d / 60), b = aN(p / 60), l = aN(b / 24), k = aN(l / 365), g = d < 45 && ["s", d] || p === 1 && ["m"] || p < 45 && ["mm", p] || b === 1 && ["h"] || b < 22 && ["hh", b] || l === 1 && ["d"] || l <= 25 && ["dd", l] || l <= 45 && ["M"] || l < 345 && ["MM", aN(l / 30)] || k === 1 && ["y"] || ["yy", k];
    return g[2] = m, g[3] = h > 0, g[4] = c, aa.apply({}, g)
  }
  function a2(d, f, c) {
    var a = c - f, b = c - d.day();
    return b > a && (b -= 7), b < a - 7 && (b += 7), Math.ceil(aL(d).add("d", b).dayOfYear() / 7)
  }
  function aW(b) {
    var c = b._i, a = b._f;
    return c === null || c === "" ? null : (typeof c == "string" && (b._i = c = af().preparse(c)), aL.isMoment(c) ? (b = at({}, c), b._d = new Date(+c._d)) : a ? ar(a) ? aj(b) : ap(b) : ab(b), new ay(b))
  }
  function aD(a, b) {
    aL.fn[a] = aL.fn[a + "s"] = function(d) {
      var c = this._isUTC ? "UTC" : "";
      return d != null ? (this._d["set" + c + b](d), this) : this._d["get" + c + b]()
    }
  }
  function aC(a) {
    aL.duration.fn[a] = function() {
      return this._data[a]
    }
  }
  function au(a, b) {
    aL.duration.fn["as" + a] = function() {
      return +this / b
    }
  }
  var aL, aS = "2.0.0", aN = Math.round, aY, aM = {}, aR = typeof module != "undefined" && module.exports, aK = /^\/?Date\((\-?\d+)/i, a7 = /(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g, a1 = /(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g, aU = /([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi, a5 = /\d\d?/, aZ = /\d{1,3}/, aP = /\d{3}/, a4 = /\d{1,4}/, aJ = /[+\-]?\d{1,6}/, aT = /[0-9]*[a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF]+\s*?[\u0600-\u06FF]+/i, a0 = /Z|[\+\-]\d\d:?\d\d/i, aG = /T/i, a6 = /[\+\-]?\d+(\.\d{1,3})?/, aI = /^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/, ax = "YYYY-MM-DDTHH:mm:ssZ", ah = [["HH:mm:ss.S", /(T| )\d\d:\d\d:\d\d\.\d{1,3}/], ["HH:mm:ss", /(T| )\d\d:\d\d:\d\d/], ["HH:mm", /(T| )\d\d:\d\d/], ["HH", /(T| )\d\d/]], aH = /([\+\-]|\d\d)/gi, ag = "Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"), am = {Milliseconds: 1,Seconds: 1000,Minutes: 60000,Hours: 3600000,Days: 86400000,Months: 2592000000,Years: 31536000000}, az = {}, aV = "DDD w W M D d".split(" "), ao = "M D H h m s w W".split(" "), aB = {M: function() {
    return this.month() + 1
  },MMM: function(a) {
    return this.lang().monthsShort(this, a)
  },MMMM: function(a) {
    return this.lang().months(this, a)
  },D: function() {
    return this.date()
  },DDD: function() {
    return this.dayOfYear()
  },d: function() {
    return this.day()
  },dd: function(a) {
    return this.lang().weekdaysMin(this, a)
  },ddd: function(a) {
    return this.lang().weekdaysShort(this, a)
  },dddd: function(a) {
    return this.lang().weekdays(this, a)
  },w: function() {
    return this.week()
  },W: function() {
    return this.isoWeek()
  },YY: function() {
    return aX(this.year() % 100, 2)
  },YYYY: function() {
    return aX(this.year(), 4)
  },YYYYY: function() {
    return aX(this.year(), 5)
  },a: function() {
    return this.lang().meridiem(this.hours(), this.minutes(), !0)
  },A: function() {
    return this.lang().meridiem(this.hours(), this.minutes(), !1)
  },H: function() {
    return this.hours()
  },h: function() {
    return this.hours() % 12 || 12
  },m: function() {
    return this.minutes()
  },s: function() {
    return this.seconds()
  },S: function() {
    return ~~(this.milliseconds() / 100)
  },SS: function() {
    return aX(~~(this.milliseconds() / 10), 2)
  },SSS: function() {
    return aX(this.milliseconds(), 3)
  },Z: function() {
    var b = -this.zone(), a = "+";
    return b < 0 && (b = -b, a = "-"), a + aX(~~(b / 60), 2) + ":" + aX(~~b % 60, 2)
  },ZZ: function() {
    var b = -this.zone(), a = "+";
    return b < 0 && (b = -b, a = "-"), a + aX(~~(10 * b / 6), 4)
  },X: function() {
    return this.unix()
  }};
  while (aV.length) {
    aY = aV.pop(), aB[aY + "o"] = an(aB[aY])
  }
  while (ao.length) {
    aY = ao.pop(), aB[aY + aY] = al(aB[aY], 2)
  }
  aB.DDDD = al(aB.DDD, 3), a8.prototype = {set: function(b) {
    var a, c;
    for (c in b) {
      a = b[c], typeof a == "function" ? this[c] = a : this["_" + c] = a
    }
  },_months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months: function(a) {
    return this._months[a.month()]
  },_monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort: function(a) {
    return this._monthsShort[a.month()]
  },monthsParse: function(d) {
    var f, c, a, b;
    this._monthsParse || (this._monthsParse = []);
    for (f = 0; f < 12; f++) {
      this._monthsParse[f] || (c = aL([2000, f]), a = "^" + this.months(c, "") + "|^" + this.monthsShort(c, ""), this._monthsParse[f] = new RegExp(a.replace(".", ""), "i"));
      if (this._monthsParse[f].test(d)) {
        return f
      }
    }
  },_weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays: function(a) {
    return this._weekdays[a.day()]
  },_weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort: function(a) {
    return this._weekdaysShort[a.day()]
  },_weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin: function(a) {
    return this._weekdaysMin[a.day()]
  },_longDateFormat: {LT: "h:mm A",L: "MM/DD/YYYY",LL: "MMMM D YYYY",LLL: "MMMM D YYYY LT",LLLL: "dddd, MMMM D YYYY LT"},longDateFormat: function(b) {
    var a = this._longDateFormat[b];
    return !a && this._longDateFormat[b.toUpperCase()] && (a = this._longDateFormat[b.toUpperCase()].replace(/MMMM|MM|DD|dddd/g, function(c) {
      return c.slice(1)
    }), this._longDateFormat[b] = a), a
  },meridiem: function(b, a, c) {
    return b > 11 ? c ? "pm" : "PM" : c ? "am" : "AM"
  },_calendar: {sameDay: "[Today at] LT",nextDay: "[Tomorrow at] LT",nextWeek: "dddd [at] LT",lastDay: "[Yesterday at] LT",lastWeek: "[last] dddd [at] LT",sameElse: "L"},calendar: function(b, a) {
    var c = this._calendar[b];
    return typeof c == "function" ? c.apply(a) : c
  },_relativeTime: {future: "in %s",past: "%s ago",s: "a few seconds",m: "a minute",mm: "%d minutes",h: "an hour",hh: "%d hours",d: "a day",dd: "%d days",M: "a month",MM: "%d months",y: "a year",yy: "%d years"},relativeTime: function(d, b, f, c) {
    var a = this._relativeTime[f];
    return typeof a == "function" ? a(d, b, f, c) : a.replace(/%d/i, d)
  },pastFuture: function(b, a) {
    var c = this._relativeTime[b > 0 ? "future" : "past"];
    return typeof c == "function" ? c(a) : c.replace(/%s/i, a)
  },ordinal: function(a) {
    return this._ordinal.replace("%d", a)
  },_ordinal: "%d",preparse: function(a) {
    return a
  },postformat: function(a) {
    return a
  },week: function(a) {
    return a2(a, this._week.dow, this._week.doy)
  },_week: {dow: 0,doy: 6}}, aL = function(b, a, c) {
    return aW({_i: b,_f: a,_l: c,_isUTC: !1})
  }, aL.utc = function(b, a, c) {
    return aW({_useUTC: !0,_isUTC: !0,_l: c,_i: b,_f: a})
  }, aL.unix = function(a) {
    return aL(a * 1000)
  }, aL.duration = function(d, g) {
    var c = aL.isDuration(d), a = typeof d == "number", b = c ? d._data : a ? {} : d, f;
    return a && (g ? b[g] = d : b.milliseconds = d), f = new ak(b), c && d.hasOwnProperty("_lang") && (f._lang = d._lang), f
  }, aL.version = aS, aL.defaultFormat = ax, aL.lang = function(b, c) {
    var a;
    if (!b) {
      return aL.fn._lang._abbr
    }
    c ? ai(b, c) : aM[b] || af(b), aL.duration.fn._lang = aL.fn._lang = af(b)
  }, aL.langData = function(a) {
    return a && a._lang && a._lang._abbr && (a = a._lang._abbr), af(a)
  }, aL.isMoment = function(a) {
    return a instanceof ay
  }, aL.isDuration = function(a) {
    return a instanceof ak
  }, aL.fn = ay.prototype = {clone: function() {
    return aL(this)
  },valueOf: function() {
    return +this._d
  },unix: function() {
    return Math.floor(+this._d / 1000)
  },toString: function() {
    return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")
  },toDate: function() {
    return this._d
  },toJSON: function() {
    return aL.utc(this).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")
  },toArray: function() {
    var a = this;
    return [a.year(), a.month(), a.date(), a.hours(), a.minutes(), a.seconds(), a.milliseconds()]
  },isValid: function() {
    return this._isValid == null && (this._a ? this._isValid = !aO(this._a, (this._isUTC ? aL.utc(this._a) : aL(this._a)).toArray()) : this._isValid = !isNaN(this._d.getTime())), !!this._isValid
  },utc: function() {
    return this._isUTC = !0, this
  },local: function() {
    return this._isUTC = !1, this
  },format: function(a) {
    var b = ac(this, a || aL.defaultFormat);
    return this.lang().postformat(b)
  },add: function(b, c) {
    var a;
    return typeof b == "string" ? a = aL.duration(+c, b) : a = aL.duration(b, c), aw(this, a, 1), this
  },subtract: function(b, c) {
    var a;
    return typeof b == "string" ? a = aL.duration(+c, b) : a = aL.duration(b, c), aw(this, a, -1), this
  },diff: function(f, h, d) {
    var b = this._isUTC ? aL(f).utc() : aL(f).local(), c = (this.zone() - b.zone()) * 60000, g, a;
    return h && (h = h.replace(/s$/, "")), h === "year" || h === "month" ? (g = (this.daysInMonth() + b.daysInMonth()) * 43200000, a = (this.year() - b.year()) * 12 + (this.month() - b.month()), a += (this - aL(this).startOf("month") - (b - aL(b).startOf("month"))) / g, h === "year" && (a /= 12)) : (g = this - b - c, a = h === "second" ? g / 1000 : h === "minute" ? g / 60000 : h === "hour" ? g / 3600000 : h === "day" ? g / 86400000 : h === "week" ? g / 604800000 : g), d ? a : aA(a)
  },from: function(a, b) {
    return aL.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)
  },fromNow: function(a) {
    return this.from(aL(), a)
  },calendar: function() {
    var a = this.diff(aL().startOf("day"), "days", !0), b = a < -6 ? "sameElse" : a < -1 ? "lastWeek" : a < 0 ? "lastDay" : a < 1 ? "sameDay" : a < 2 ? "nextDay" : a < 7 ? "nextWeek" : "sameElse";
    return this.format(this.lang().calendar(b, this))
  },isLeapYear: function() {
    var a = this.year();
    return a % 4 === 0 && a % 100 !== 0 || a % 400 === 0
  },isDST: function() {
    return this.zone() < aL([this.year()]).zone() || this.zone() < aL([this.year(), 5]).zone()
  },day: function(b) {
    var a = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
    return b == null ? a : this.add({d: b - a})
  },startOf: function(a) {
    a = a.replace(/s$/, "");
    switch (a) {
      case "year":
        this.month(0);
      case "month":
        this.date(1);
      case "week":
      case "day":
        this.hours(0);
      case "hour":
        this.minutes(0);
      case "minute":
        this.seconds(0);
      case "second":
        this.milliseconds(0)
    }
    return a === "week" && this.day(0), this
  },endOf: function(a) {
    return this.startOf(a).add(a.replace(/s?$/, "s"), 1).subtract("ms", 1)
  },isAfter: function(a, b) {
    return b = typeof b != "undefined" ? b : "millisecond", +this.clone().startOf(b) > +aL(a).startOf(b)
  },isBefore: function(a, b) {
    return b = typeof b != "undefined" ? b : "millisecond", +this.clone().startOf(b) < +aL(a).startOf(b)
  },isSame: function(a, b) {
    return b = typeof b != "undefined" ? b : "millisecond", +this.clone().startOf(b) === +aL(a).startOf(b)
  },zone: function() {
    return this._isUTC ? 0 : this._d.getTimezoneOffset()
  },daysInMonth: function() {
    return aL.utc([this.year(), this.month() + 1, 0]).date()
  },dayOfYear: function(a) {
    var b = aN((aL(this).startOf("day") - aL(this).startOf("year")) / 86400000) + 1;
    return a == null ? b : this.add("d", a - b)
  },isoWeek: function(b) {
    var a = a2(this, 1, 4);
    return b == null ? a : this.add("d", (b - a) * 7)
  },week: function(b) {
    var a = this.lang().week(this);
    return b == null ? a : this.add("d", (b - a) * 7)
  },lang: function(a) {
    return a === a3 ? this._lang : (this._lang = af(a), this)
  }};
  for (aY = 0; aY < ag.length; aY++) {
    aD(ag[aY].toLowerCase().replace(/s$/, ""), ag[aY])
  }
  aD("year", "FullYear"), aL.fn.days = aL.fn.day, aL.fn.weeks = aL.fn.week, aL.fn.isoWeeks = aL.fn.isoWeek, aL.duration.fn = ak.prototype = {weeks: function() {
    return aA(this.days() / 7)
  },valueOf: function() {
    return this._milliseconds + this._days * 86400000 + this._months * 2592000000
  },humanize: function(b) {
    var a = +this, c = aQ(a, !b, this.lang());
    return b && (c = this.lang().pastFuture(a, c)), this.lang().postformat(c)
  },lang: aL.fn.lang};
  for (aY in am) {
    am.hasOwnProperty(aY) && (au(aY, am[aY]), aC(aY.toLowerCase()))
  }
  au("Weeks", 604800000), aL.lang("en", {ordinal: function(b) {
    var a = b % 10, c = ~~(b % 100 / 10) === 1 ? "th" : a === 1 ? "st" : a === 2 ? "nd" : a === 3 ? "rd" : "th";
    return b + c
  }}), aR && (module.exports = aL), typeof ender == "undefined" && (this.moment = aL), typeof define == "function" && define.amd && define("moment", [], function() {
    return aL
  })
}).call(this);
var pluralRules = [function(a) {
  return ((a % 10 === 1) && (a % 100 !== 11))
}, function(a) {
  return ((a % 10) >= 2 && (a % 10) <= 4 && ((a % 10) % 1) === 0) && ((a % 100) < 12 || (a % 100) > 14)
}, function(a) {
  return ((a % 10) === 0 || ((a % 10) >= 5 && (a % 10) <= 9 && ((a % 10) % 1) === 0) || ((a % 100) >= 11 && (a % 100) <= 14 && ((a % 100) % 1) === 0))
}, function(a) {
  return true
}];
function plural(e, b) {
  var a = e.split("_"), d = Math.min(pluralRules.length, a.length), c = -1;
  while (++c < d) {
    if (pluralRules[c](b)) {
      return a[c]
    }
  }
  return a[d - 1]
}
function relativeTimeWithPlural(c, b, a) {
  var d = {mm: "минута_минуты_минут_минуты",hh: "час_часа_часов_часа",dd: "день_дня_дней_дня",MM: "месяц_месяца_месяцев_месяца",yy: "год_года_лет_года"};
  if (a === "m") {
    return b ? "минута" : "минуту"
  } else {
    return c + " " + plural(d[a], +c)
  }
}
function monthsCaseReplace(b, d) {
  var a = {nominative: "январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),accusative: "января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_")}, c = (/D[oD]? *MMMM?/).test(d) ? "accusative" : "nominative";
  return a[c][b.month()]
}
function weekdaysCaseReplace(a, d) {
  var b = {nominative: "воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),accusative: "воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_")}, c = (/\[ ?[Вв] ?(?:прошлую|следующую)? ?\] ?dddd/).test(d) ? "accusative" : "nominative";
  return b[c][a.day()]
}
moment.lang("ru", {months: monthsCaseReplace,monthsShort: "янв_фев_мар_апр_май_июн_июл_авг_сен_окт_ноя_дек".split("_"),weekdays: weekdaysCaseReplace,weekdaysShort: "вск_пнд_втр_срд_чтв_птн_сбт".split("_"),weekdaysMin: "вс_пн_вт_ср_чт_пт_сб".split("_"),longDateFormat: {LT: "HH:mm",L: "DD.MM.YYYY",LL: "D MMMM YYYY г.",LLL: "D MMMM YYYY г., LT",LLLL: "dddd, D MMMM YYYY г., LT"},calendar: {sameDay: "[Сегодня в] LT",nextDay: "[Завтра в] LT",lastDay: "[Вчера в] LT",nextWeek: function() {
  return this.day() === 2 ? "[Во] dddd [в] LT" : "[В] dddd [в] LT"
},lastWeek: function() {
  switch (this.day()) {
    case 0:
      return "[В прошлое] dddd [в] LT";
    case 1:
    case 2:
    case 4:
      return "[В прошлый] dddd [в] LT";
    case 3:
    case 5:
    case 6:
      return "[В прошлую] dddd [в] LT"
  }
},sameElse: "L"},relativeTime: {future: "через %s",past: "%s назад",s: "несколько секунд",m: relativeTimeWithPlural,mm: relativeTimeWithPlural,h: "час",hh: relativeTimeWithPlural,d: "день",dd: relativeTimeWithPlural,M: "месяц",MM: relativeTimeWithPlural,y: "год",yy: relativeTimeWithPlural},ordinal: "%d.",week: {dow: 1,doy: 7}});
/*
 * MediaElement.js
 * HTML5 <video> and <audio> shim and player
 * http://mediaelementjs.com/
 *
 * Creates a JavaScript object that mimics HTML5 MediaElement API
 * for browsers that don't understand HTML5 or can't play the provided codec
 * Can play MP4 (H.264), Ogg, WebM, FLV, WMV, WMA, ACC, and MP3
 *
 * Copyright 2010-2013, John Dyer (http://j.hn)
 * License: MIT
 *
 */
var mejs = mejs || {};
mejs.version = "2.11.3";
mejs.meIndex = 0;
mejs.plugins = {silverlight: [{version: [3, 0],types: ["video/mp4", "video/m4v", "video/mov", "video/wmv", "audio/wma", "audio/m4a", "audio/mp3", "audio/wav", "audio/mpeg"]}],flash: [{version: [9, 0, 124],types: ["video/mp4", "video/m4v", "video/mov", "video/flv", "video/rtmp", "video/x-flv", "audio/flv", "audio/x-flv", "audio/mp3", "audio/m4a", "audio/mpeg", "video/youtube", "video/x-youtube"]}],youtube: [{version: null,types: ["video/youtube", "video/x-youtube", "audio/youtube", "audio/x-youtube"]}],vimeo: [{version: null,types: ["video/vimeo", "video/x-vimeo"]}]};
mejs.Utility = {encodeUrl: function(a) {
  return encodeURIComponent(a)
},escapeHTML: function(a) {
  return a.toString().split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")
},absolutizeUrl: function(a) {
  var b = document.createElement("div");
  b.innerHTML = '<a href="' + this.escapeHTML(a) + '">x</a>';
  return b.firstChild.href
},getScriptPath: function(o) {
  var l = 0, g, m = "", c = "", h, e, b, a, d, f = document.getElementsByTagName("script"), n = f.length, k = o.length;
  for (; l < n; l++) {
    b = f[l].src;
    h = b.lastIndexOf("/");
    if (h > -1) {
      d = b.substring(h + 1);
      a = b.substring(0, h + 1)
    } else {
      d = b;
      a = ""
    }
    for (g = 0; g < k; g++) {
      c = o[g];
      e = d.indexOf(c);
      if (e > -1) {
        m = a;
        break
      }
    }
    if (m !== "") {
      break
    }
  }
  return m
},secondsToTimeCode: function(c, g, a, b) {
  if (typeof a == "undefined") {
    a = false
  } else {
    if (typeof b == "undefined") {
      b = 25
    }
  }
  var f = Math.floor(c / 3600) % 24, d = Math.floor(c / 60) % 60, h = Math.floor(c % 60), e = Math.floor(((c % 1) * b).toFixed(3)), k = ((g || f > 0) ? (f < 10 ? "0" + f : f) + ":" : "") + (d < 10 ? "0" + d : d) + ":" + (h < 10 ? "0" + h : h) + ((a) ? ":" + (e < 10 ? "0" + e : e) : "");
  return k
},timeCodeToSeconds: function(c, l, d, e) {
  if (typeof d == "undefined") {
    d = false
  } else {
    if (typeof e == "undefined") {
      e = 25
    }
  }
  var f = c.split(":"), a = parseInt(f[0], 10), b = parseInt(f[1], 10), h = parseInt(f[2], 10), k = 0, g = 0;
  if (d) {
    k = parseInt(f[3]) / e
  }
  g = (a * 3600) + (b * 60) + h + k;
  return g
},convertSMPTEtoSeconds: function(a) {
  if (typeof a != "string") {
    return false
  }
  a = a.replace(",", ".");
  var d = 0, b = (a.indexOf(".") != -1) ? a.split(".")[1].length : 0, e = 1;
  a = a.split(":").reverse();
  for (var c = 0; c < a.length; c++) {
    e = 1;
    if (c > 0) {
      e = Math.pow(60, c)
    }
    d += Number(a[c]) * e
  }
  return Number(d.toFixed(b))
},removeSwf: function(b) {
  var a = document.getElementById(b);
  if (a && /object|embed/i.test(a.nodeName)) {
    if (mejs.MediaFeatures.isIE) {
      a.style.display = "none";
      (function() {
        if (a.readyState == 4) {
          mejs.Utility.removeObjectInIE(b)
        } else {
          setTimeout(arguments.callee, 10)
        }
      })()
    } else {
      a.parentNode.removeChild(a)
    }
  }
},removeObjectInIE: function(c) {
  var b = document.getElementById(c);
  if (b) {
    for (var a in b) {
      if (typeof b[a] == "function") {
        b[a] = null
      }
    }
    b.parentNode.removeChild(b)
  }
}};
mejs.PluginDetector = {hasPluginVersion: function(c, a) {
  var b = this.plugins[c];
  a[1] = a[1] || 0;
  a[2] = a[2] || 0;
  return (b[0] > a[0] || (b[0] == a[0] && b[1] > a[1]) || (b[0] == a[0] && b[1] == a[1] && b[2] >= a[2])) ? true : false
},nav: window.navigator,ua: window.navigator.userAgent.toLowerCase(),plugins: [],addPlugin: function(d, c, e, a, b) {
  this.plugins[d] = this.detectPlugin(c, e, a, b)
},detectPlugin: function(g, b, c, l) {
  var h = [0, 0, 0], k, d, a;
  if (typeof (this.nav.plugins) != "undefined" && typeof this.nav.plugins[g] == "object") {
    k = this.nav.plugins[g].description;
    if (k && !(typeof this.nav.mimeTypes != "undefined" && this.nav.mimeTypes[b] && !this.nav.mimeTypes[b].enabledPlugin)) {
      h = k.replace(g, "").replace(/^\s+/, "").replace(/\sr/gi, ".").split(".");
      for (d = 0; d < h.length; d++) {
        h[d] = parseInt(h[d].match(/\d+/), 10)
      }
    }
  } else {
    if (typeof (window.ActiveXObject) != "undefined") {
      try {
        a = new ActiveXObject(c);
        if (a) {
          h = l(a)
        }
      } catch (f) {
      }
    }
  }
  return h
}};
mejs.PluginDetector.addPlugin("flash", "Shockwave Flash", "application/x-shockwave-flash", "ShockwaveFlash.ShockwaveFlash", function(b) {
  var a = [], c = b.GetVariable("$version");
  if (c) {
    c = c.split(" ")[1].split(",");
    a = [parseInt(c[0], 10), parseInt(c[1], 10), parseInt(c[2], 10)]
  }
  return a
});
mejs.PluginDetector.addPlugin("silverlight", "Silverlight Plug-In", "application/x-silverlight-2", "AgControl.AgControl", function(b) {
  var a = [0, 0, 0, 0], c = function(f, d, e, g) {
    while (f.isVersionSupported(d[0] + "." + d[1] + "." + d[2] + "." + d[3])) {
      d[e] += g
    }
    d[e] -= g
  };
  c(b, a, 0, 1);
  c(b, a, 1, 1);
  c(b, a, 2, 10000);
  c(b, a, 2, 1000);
  c(b, a, 2, 100);
  c(b, a, 2, 10);
  c(b, a, 2, 1);
  c(b, a, 3, 1);
  return a
});
mejs.MediaFeatures = {init: function() {
  var e = this, h = document, g = mejs.PluginDetector.nav, c = mejs.PluginDetector.ua.toLowerCase(), b, a, f = ["source", "track", "audio", "video"];
  e.isiPad = (c.match(/ipad/i) !== null);
  e.isiPhone = (c.match(/iphone/i) !== null);
  e.isiOS = e.isiPhone || e.isiPad;
  e.isAndroid = (c.match(/android/i) !== null);
  e.isBustedAndroid = (c.match(/android 2\.[12]/) !== null);
  e.isIE = (g.appName.toLowerCase().indexOf("microsoft") != -1);
  e.isChrome = (c.match(/chrome/gi) !== null);
  e.isFirefox = (c.match(/firefox/gi) !== null);
  e.isWebkit = (c.match(/webkit/gi) !== null);
  e.isGecko = (c.match(/gecko/gi) !== null) && !e.isWebkit;
  e.isOpera = (c.match(/opera/gi) !== null);
  e.hasTouch = ("ontouchstart" in window);
  e.svg = !!document.createElementNS && !!document.createElementNS("http://www.w3.org/2000/svg", "svg").createSVGRect;
  for (b = 0; b < f.length; b++) {
    a = document.createElement(f[b])
  }
  e.supportsMediaTag = (typeof a.canPlayType !== "undefined" || e.isBustedAndroid);
  e.hasSemiNativeFullScreen = (typeof a.webkitEnterFullscreen !== "undefined");
  e.hasWebkitNativeFullScreen = (typeof a.webkitRequestFullScreen !== "undefined");
  e.hasMozNativeFullScreen = (typeof a.mozRequestFullScreen !== "undefined");
  e.hasTrueNativeFullScreen = (e.hasWebkitNativeFullScreen || e.hasMozNativeFullScreen);
  e.nativeFullScreenEnabled = e.hasTrueNativeFullScreen;
  if (e.hasMozNativeFullScreen) {
    e.nativeFullScreenEnabled = a.mozFullScreenEnabled
  }
  if (this.isChrome) {
    e.hasSemiNativeFullScreen = false
  }
  if (e.hasTrueNativeFullScreen) {
    e.fullScreenEventName = (e.hasWebkitNativeFullScreen) ? "webkitfullscreenchange" : "mozfullscreenchange";
    e.isFullScreen = function() {
      if (a.mozRequestFullScreen) {
        return h.mozFullScreen
      } else {
        if (a.webkitRequestFullScreen) {
          return h.webkitIsFullScreen
        }
      }
    };
    e.requestFullScreen = function(d) {
      if (e.hasWebkitNativeFullScreen) {
        d.webkitRequestFullScreen()
      } else {
        if (e.hasMozNativeFullScreen) {
          d.mozRequestFullScreen()
        }
      }
    };
    e.cancelFullScreen = function() {
      if (e.hasWebkitNativeFullScreen) {
        document.webkitCancelFullScreen()
      } else {
        if (e.hasMozNativeFullScreen) {
          document.mozCancelFullScreen()
        }
      }
    }
  }
  if (e.hasSemiNativeFullScreen && c.match(/mac os x 10_5/i)) {
    e.hasNativeFullScreen = false;
    e.hasSemiNativeFullScreen = false
  }
}};
mejs.MediaFeatures.init();
mejs.HtmlMediaElement = {pluginType: "native",isFullScreen: false,setCurrentTime: function(a) {
  this.currentTime = a
},setMuted: function(a) {
  this.muted = a
},setVolume: function(a) {
  this.volume = a
},stop: function() {
  this.pause()
},setSrc: function(a) {
  var c = this.getElementsByTagName("source");
  while (c.length > 0) {
    this.removeChild(c[0])
  }
  if (typeof a == "string") {
    this.src = a
  } else {
    var b, d;
    for (b = 0; b < a.length; b++) {
      d = a[b];
      if (this.canPlayType(d.type)) {
        this.src = d.src;
        break
      }
    }
  }
},setVideoSize: function(b, a) {
  this.width = b;
  this.height = a
}};
mejs.PluginMediaElement = function(b, c, a) {
  this.id = b;
  this.pluginType = c;
  this.src = a;
  this.events = {};
  this.attributes = {}
};
mejs.PluginMediaElement.prototype = {pluginElement: null,pluginType: "",isFullScreen: false,playbackRate: -1,defaultPlaybackRate: -1,seekable: [],played: [],paused: true,ended: false,seeking: false,duration: 0,error: null,tagName: "",muted: false,volume: 1,currentTime: 0,play: function() {
  if (this.pluginApi != null) {
    if (this.pluginType == "youtube") {
      this.pluginApi.playVideo()
    } else {
      this.pluginApi.playMedia()
    }
    this.paused = false
  }
},load: function() {
  if (this.pluginApi != null) {
    if (this.pluginType == "youtube") {
    } else {
      this.pluginApi.loadMedia()
    }
    this.paused = false
  }
},pause: function() {
  if (this.pluginApi != null) {
    if (this.pluginType == "youtube") {
      this.pluginApi.pauseVideo()
    } else {
      this.pluginApi.pauseMedia()
    }
    this.paused = true
  }
},stop: function() {
  if (this.pluginApi != null) {
    if (this.pluginType == "youtube") {
      this.pluginApi.stopVideo()
    } else {
      this.pluginApi.stopMedia()
    }
    this.paused = true
  }
},canPlayType: function(e) {
  var d, c, a, b = mejs.plugins[this.pluginType];
  for (d = 0; d < b.length; d++) {
    a = b[d];
    if (mejs.PluginDetector.hasPluginVersion(this.pluginType, a.version)) {
      for (c = 0; c < a.types.length; c++) {
        if (e == a.types[c]) {
          return "probably"
        }
      }
    }
  }
  return ""
},positionFullscreenButton: function(a, c, b) {
  if (this.pluginApi != null && this.pluginApi.positionFullscreenButton) {
    this.pluginApi.positionFullscreenButton(a, c, b)
  }
},hideFullscreenButton: function() {
  if (this.pluginApi != null && this.pluginApi.hideFullscreenButton) {
    this.pluginApi.hideFullscreenButton()
  }
},setSrc: function(a) {
  if (typeof a == "string") {
    this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(a));
    this.src = mejs.Utility.absolutizeUrl(a)
  } else {
    var b, c;
    for (b = 0; b < a.length; b++) {
      c = a[b];
      if (this.canPlayType(c.type)) {
        this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(c.src));
        this.src = mejs.Utility.absolutizeUrl(a);
        break
      }
    }
  }
},setCurrentTime: function(a) {
  if (this.pluginApi != null) {
    if (this.pluginType == "youtube") {
      this.pluginApi.seekTo(a)
    } else {
      this.pluginApi.setCurrentTime(a)
    }
    this.currentTime = a
  }
},setVolume: function(a) {
  if (this.pluginApi != null) {
    if (this.pluginType == "youtube") {
      this.pluginApi.setVolume(a * 100)
    } else {
      this.pluginApi.setVolume(a)
    }
    this.volume = a
  }
},setMuted: function(a) {
  if (this.pluginApi != null) {
    if (this.pluginType == "youtube") {
      if (a) {
        this.pluginApi.mute()
      } else {
        this.pluginApi.unMute()
      }
      this.muted = a;
      this.dispatchEvent("volumechange")
    } else {
      this.pluginApi.setMuted(a)
    }
    this.muted = a
  }
},setVideoSize: function(b, a) {
  if (this.pluginElement.style) {
    this.pluginElement.style.width = b + "px";
    this.pluginElement.style.height = a + "px"
  }
  if (this.pluginApi != null && this.pluginApi.setVideoSize) {
    this.pluginApi.setVideoSize(b, a)
  }
},setFullscreen: function(a) {
  if (this.pluginApi != null && this.pluginApi.setFullscreen) {
    this.pluginApi.setFullscreen(a)
  }
},enterFullScreen: function() {
  if (this.pluginApi != null && this.pluginApi.setFullscreen) {
    this.setFullscreen(true)
  }
},exitFullScreen: function() {
  if (this.pluginApi != null && this.pluginApi.setFullscreen) {
    this.setFullscreen(false)
  }
},addEventListener: function(b, c, a) {
  this.events[b] = this.events[b] || [];
  this.events[b].push(c)
},removeEventListener: function(a, c) {
  if (!a) {
    this.events = {};
    return true
  }
  var b = this.events[a];
  if (!b) {
    return true
  }
  if (!c) {
    this.events[a] = [];
    return true
  }
  for (i = 0; i < b.length; i++) {
    if (b[i] === c) {
      this.events[a].splice(i, 1);
      return true
    }
  }
  return false
},dispatchEvent: function(a) {
  var c, b, d = this.events[a];
  if (d) {
    b = Array.prototype.slice.call(arguments, 1);
    for (c = 0; c < d.length; c++) {
      d[c].apply(null, b)
    }
  }
},hasAttribute: function(a) {
  return (a in this.attributes)
},removeAttribute: function(a) {
  delete this.attributes[a]
},getAttribute: function(a) {
  if (this.hasAttribute(a)) {
    return this.attributes[a]
  }
  return ""
},setAttribute: function(a, b) {
  this.attributes[a] = b
},remove: function() {
  mejs.Utility.removeSwf(this.pluginElement.id);
  mejs.MediaPluginBridge.unregisterPluginElement(this.pluginElement.id)
}};
mejs.MediaPluginBridge = {pluginMediaElements: {},htmlMediaElements: {},registerPluginElement: function(c, a, b) {
  this.pluginMediaElements[c] = a;
  this.htmlMediaElements[c] = b
},unregisterPluginElement: function(a) {
  delete this.pluginMediaElements[a];
  delete this.htmlMediaElements[a]
},initPlugin: function(c) {
  var a = this.pluginMediaElements[c], b = this.htmlMediaElements[c];
  if (a) {
    switch (a.pluginType) {
      case "flash":
        a.pluginElement = a.pluginApi = document.getElementById(c);
        break;
      case "silverlight":
        a.pluginElement = document.getElementById(a.id);
        a.pluginApi = a.pluginElement.Content.MediaElementJS;
        break
    }
    if (a.pluginApi != null && a.success) {
      a.success(a, b)
    }
  }
},fireEvent: function(h, c, b) {
  var g, f, a, d = this.pluginMediaElements[h];
  g = {type: c,target: d};
  for (f in b) {
    d[f] = b[f];
    g[f] = b[f]
  }
  a = b.bufferedTime || 0;
  g.target.buffered = g.buffered = {start: function(e) {
    return 0
  },end: function(e) {
    return a
  },length: 1};
  d.dispatchEvent(g.type, g)
}};
mejs.MediaElementDefaults = {mode: "auto",plugins: ["flash", "silverlight", "youtube", "vimeo"],enablePluginDebug: false,type: "",pluginPath: mejs.Utility.getScriptPath(["mediaelement.js", "mediaelement.min.js", "mediaelement-and-player.js", "mediaelement-and-player.min.js"]),flashName: "flashmediaelement.swf",flashStreamer: "",enablePluginSmoothing: false,enablePseudoStreaming: false,pseudoStreamingStartQueryParam: "start",silverlightName: "silverlightmediaelement.xap",defaultVideoWidth: 480,defaultVideoHeight: 270,pluginWidth: -1,pluginHeight: -1,pluginVars: [],timerRate: 250,startVolume: 0.8,success: function() {
},error: function() {
}};
mejs.MediaElement = function(a, b) {
  return mejs.HtmlMediaElementShim.create(a, b)
};
mejs.HtmlMediaElementShim = {create: function(e, d) {
  var p = mejs.MediaElementDefaults, l = (typeof (e) == "string") ? document.getElementById(e) : e, h = l.tagName.toLowerCase(), g = (h === "audio" || h === "video"), b = (g) ? l.getAttribute("src") : l.getAttribute("href"), m = l.getAttribute("poster"), f = l.getAttribute("autoplay"), k = l.getAttribute("preload"), n = l.getAttribute("controls"), a, c;
  for (c in d) {
    p[c] = d[c]
  }
  b = (typeof b == "undefined" || b === null || b == "") ? null : b;
  m = (typeof m == "undefined" || m === null) ? "" : m;
  k = (typeof k == "undefined" || k === null || k === "false") ? "none" : k;
  f = !(typeof f == "undefined" || f === null || f === "false");
  n = !(typeof n == "undefined" || n === null || n === "false");
  a = this.determinePlayback(l, p, mejs.MediaFeatures.supportsMediaTag, g, b);
  a.url = (a.url !== null) ? mejs.Utility.absolutizeUrl(a.url) : "";
  if (a.method == "native") {
    if (mejs.MediaFeatures.isBustedAndroid) {
      l.src = a.url;
      l.addEventListener("click", function() {
        l.play()
      }, false)
    }
    return this.updateNative(a, p, f, k)
  } else {
    if (a.method !== "") {
      return this.createPlugin(a, p, m, f, k, n)
    } else {
      this.createErrorMessage(a, p, m);
      return this
    }
  }
},determinePlayback: function(t, c, h, v, f) {
  var o = [], s, r, q, p, m, d, g = {method: "",url: "",htmlMediaElement: t,isVideo: (t.tagName.toLowerCase() != "audio")}, a, b, u, w, e;
  if (typeof c.type != "undefined" && c.type !== "") {
    if (typeof c.type == "string") {
      o.push({type: c.type,url: f})
    } else {
      for (s = 0; s < c.type.length; s++) {
        o.push({type: c.type[s],url: f})
      }
    }
  } else {
    if (f !== null) {
      d = this.formatType(f, t.getAttribute("type"));
      o.push({type: d,url: f})
    } else {
      for (s = 0; s < t.childNodes.length; s++) {
        m = t.childNodes[s];
        if (m.nodeType == 1 && m.tagName.toLowerCase() == "source") {
          f = m.getAttribute("src");
          d = this.formatType(f, m.getAttribute("type"));
          e = m.getAttribute("media");
          if (!e || !window.matchMedia || (window.matchMedia && window.matchMedia(e).matches)) {
            o.push({type: d,url: f})
          }
        }
      }
    }
  }
  if (!v && o.length > 0 && o[0].url !== null && this.getTypeFromFile(o[0].url).indexOf("audio") > -1) {
    g.isVideo = false
  }
  if (mejs.MediaFeatures.isBustedAndroid) {
    t.canPlayType = function(k) {
      return (k.match(/video\/(mp4|m4v)/gi) !== null) ? "maybe" : ""
    }
  }
  if (h && (c.mode === "auto" || c.mode === "auto_plugin" || c.mode === "native")) {
    if (!v) {
      w = document.createElement(g.isVideo ? "video" : "audio");
      t.parentNode.insertBefore(w, t);
      t.style.display = "none";
      g.htmlMediaElement = t = w
    }
    for (s = 0; s < o.length; s++) {
      if (t.canPlayType(o[s].type).replace(/no/, "") !== "" || t.canPlayType(o[s].type.replace(/mp3/, "mpeg")).replace(/no/, "") !== "") {
        g.method = "native";
        g.url = o[s].url;
        break
      }
    }
    if (g.method === "native") {
      if (g.url !== null) {
        t.src = g.url
      }
      if (c.mode !== "auto_plugin") {
        return g
      }
    }
  }
  if (c.mode === "auto" || c.mode === "auto_plugin" || c.mode === "shim") {
    for (s = 0; s < o.length; s++) {
      d = o[s].type;
      for (r = 0; r < c.plugins.length; r++) {
        a = c.plugins[r];
        b = mejs.plugins[a];
        for (q = 0; q < b.length; q++) {
          u = b[q];
          if (u.version == null || mejs.PluginDetector.hasPluginVersion(a, u.version)) {
            for (p = 0; p < u.types.length; p++) {
              if (d == u.types[p]) {
                g.method = a;
                g.url = o[s].url;
                return g
              }
            }
          }
        }
      }
    }
  }
  if (c.mode === "auto_plugin" && g.method === "native") {
    return g
  }
  if (g.method === "" && o.length > 0) {
    g.url = o[0].url
  }
  return g
},formatType: function(a, c) {
  var b;
  if (a && !c) {
    return this.getTypeFromFile(a)
  } else {
    if (c && ~c.indexOf(";")) {
      return c.substr(0, c.indexOf(";"))
    } else {
      return c
    }
  }
},getTypeFromFile: function(a) {
  a = a.split("?")[0];
  var b = a.substring(a.lastIndexOf(".") + 1).toLowerCase();
  return (/(mp4|m4v|ogg|ogv|webm|webmv|flv|wmv|mpeg|mov)/gi.test(b) ? "video" : "audio") + "/" + this.getTypeFromExtension(b)
},getTypeFromExtension: function(a) {
  switch (a) {
    case "mp4":
    case "m4v":
      return "mp4";
    case "webm":
    case "webma":
    case "webmv":
      return "webm";
    case "ogg":
    case "oga":
    case "ogv":
      return "ogg";
    default:
      return a
  }
},createErrorMessage: function(c, b, g) {
  var d = c.htmlMediaElement, a = document.createElement("div");
  a.className = "me-cannotplay";
  try {
    a.style.width = d.width + "px";
    a.style.height = d.height + "px"
  } catch (f) {
  }
  a.innerHTML = (g !== "") ? '<a href="' + c.url + '"><img src="' + g + '" width="100%" height="100%" /></a>' : '<a href="' + c.url + '"><span>' + mejs.i18n.t("Download File") + "</span></a>";
  d.parentNode.insertBefore(a, d);
  d.style.display = "none";
  b.error(d)
},createPlugin: function(o, a, c, e, d, h) {
  var s = o.htmlMediaElement, n = 1, m = 1, t = "me_" + o.method + "_" + (mejs.meIndex++), p = new mejs.PluginMediaElement(t, o.method, o.url), g = document.createElement("div"), b, q, k;
  p.tagName = s.tagName;
  for (var r = 0; r < s.attributes.length; r++) {
    var f = s.attributes[r];
    if (f.specified == true) {
      p.setAttribute(f.name, f.value)
    }
  }
  q = s.parentNode;
  while (q !== null && q.tagName.toLowerCase() != "body") {
    if (q.parentNode.tagName.toLowerCase() == "p") {
      q.parentNode.parentNode.insertBefore(q, q.parentNode);
      break
    }
    q = q.parentNode
  }
  if (o.isVideo) {
    n = (a.videoWidth > 0) ? a.videoWidth : (s.getAttribute("width") !== null) ? s.getAttribute("width") : a.defaultVideoWidth;
    m = (a.videoHeight > 0) ? a.videoHeight : (s.getAttribute("height") !== null) ? s.getAttribute("height") : a.defaultVideoHeight;
    n = mejs.Utility.encodeUrl(n);
    m = mejs.Utility.encodeUrl(m)
  } else {
    if (a.enablePluginDebug) {
      n = 320;
      m = 240
    }
  }
  p.success = a.success;
  mejs.MediaPluginBridge.registerPluginElement(t, p, s);
  g.className = "me-plugin";
  g.id = t + "_container";
  if (o.isVideo) {
    s.parentNode.insertBefore(g, s)
  } else {
    document.body.insertBefore(g, document.body.childNodes[0])
  }
  k = ["id=" + t, "isvideo=" + ((o.isVideo) ? "true" : "false"), "autoplay=" + ((e) ? "true" : "false"), "preload=" + d, "width=" + n, "startvolume=" + a.startVolume, "timerrate=" + a.timerRate, "flashstreamer=" + a.flashStreamer, "height=" + m, "pseudostreamstart=" + a.pseudoStreamingStartQueryParam];
  if (o.url !== null) {
    if (o.method == "flash") {
      k.push("file=" + mejs.Utility.encodeUrl(o.url))
    } else {
      k.push("file=" + o.url)
    }
  }
  if (a.enablePluginDebug) {
    k.push("debug=true")
  }
  if (a.enablePluginSmoothing) {
    k.push("smoothing=true")
  }
  if (a.enablePseudoStreaming) {
    k.push("pseudostreaming=true")
  }
  if (h) {
    k.push("controls=true")
  }
  if (a.pluginVars) {
    k = k.concat(a.pluginVars)
  }
  switch (o.method) {
    case "silverlight":
      g.innerHTML = '<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="' + t + '" name="' + t + '" width="' + n + '" height="' + m + '" class="mejs-shim"><param name="initParams" value="' + k.join(",") + '" /><param name="windowless" value="true" /><param name="background" value="black" /><param name="minRuntimeVersion" value="3.0.0.0" /><param name="autoUpgrade" value="true" /><param name="source" value="' + a.pluginPath + a.silverlightName + '" /></object>';
      break;
    case "flash":
      if (mejs.MediaFeatures.isIE) {
        b = document.createElement("div");
        g.appendChild(b);
        b.outerHTML = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="' + t + '" width="' + n + '" height="' + m + '" class="mejs-shim"><param name="movie" value="' + a.pluginPath + a.flashName + "?x=" + (new Date()) + '" /><param name="flashvars" value="' + k.join("&amp;") + '" /><param name="quality" value="high" /><param name="bgcolor" value="#000000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'
      } else {
        g.innerHTML = '<embed id="' + t + '" name="' + t + '" play="true" loop="false" quality="high" bgcolor="#000000" wmode="transparent" allowScriptAccess="always" allowFullScreen="true" type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer" src="' + a.pluginPath + a.flashName + '" flashvars="' + k.join("&") + '" width="' + n + '" height="' + m + '" class="mejs-shim"></embed>'
      }
      break;
    case "youtube":
      var l = o.url.substr(o.url.lastIndexOf("=") + 1);
      youtubeSettings = {container: g,containerId: g.id,pluginMediaElement: p,pluginId: t,videoId: l,height: m,width: n};
      if (mejs.PluginDetector.hasPluginVersion("flash", [10, 0, 0])) {
        mejs.YouTubeApi.createFlash(youtubeSettings)
      } else {
        mejs.YouTubeApi.enqueueIframe(youtubeSettings)
      }
      break;
    case "vimeo":
      p.vimeoid = o.url.substr(o.url.lastIndexOf("/") + 1);
      g.innerHTML = '<iframe src="http://player.vimeo.com/video/' + p.vimeoid + '?portrait=0&byline=0&title=0" width="' + n + '" height="' + m + '" frameborder="0" class="mejs-shim"></iframe>';
      break
  }
  s.style.display = "none";
  return p
},updateNative: function(d, c, f, b) {
  var e = d.htmlMediaElement, a;
  for (a in mejs.HtmlMediaElement) {
    e[a] = mejs.HtmlMediaElement[a]
  }
  c.success(e, e);
  return e
}};
mejs.YouTubeApi = {isIframeStarted: false,isIframeLoaded: false,loadIframeApi: function() {
  if (!this.isIframeStarted) {
    var a = document.createElement("script");
    a.src = "//www.youtube.com/player_api";
    var b = document.getElementsByTagName("script")[0];
    b.parentNode.insertBefore(a, b);
    this.isIframeStarted = true
  }
},iframeQueue: [],enqueueIframe: function(a) {
  if (this.isLoaded) {
    this.createIframe(a)
  } else {
    this.loadIframeApi();
    this.iframeQueue.push(a)
  }
},createIframe: function(c) {
  var b = c.pluginMediaElement, a = new YT.Player(c.containerId, {height: c.height,width: c.width,videoId: c.videoId,playerVars: {controls: 0},events: {onReady: function() {
    c.pluginMediaElement.pluginApi = a;
    mejs.MediaPluginBridge.initPlugin(c.pluginId);
    setInterval(function() {
      mejs.YouTubeApi.createEvent(a, b, "timeupdate")
    }, 250)
  },onStateChange: function(d) {
    mejs.YouTubeApi.handleStateChange(d.data, a, b)
  }}})
},createEvent: function(d, c, b) {
  var e = {type: b,target: c};
  if (d && d.getDuration) {
    c.currentTime = e.currentTime = d.getCurrentTime();
    c.duration = e.duration = d.getDuration();
    e.paused = c.paused;
    e.ended = c.ended;
    e.muted = d.isMuted();
    e.volume = d.getVolume() / 100;
    e.bytesTotal = d.getVideoBytesTotal();
    e.bufferedBytes = d.getVideoBytesLoaded();
    var a = e.bufferedBytes / e.bytesTotal * e.duration;
    e.target.buffered = e.buffered = {start: function(f) {
      return 0
    },end: function(f) {
      return a
    },length: 1}
  }
  c.dispatchEvent(e.type, e)
},iFrameReady: function() {
  this.isLoaded = true;
  this.isIframeLoaded = true;
  while (this.iframeQueue.length > 0) {
    var a = this.iframeQueue.pop();
    this.createIframe(a)
  }
},flashPlayers: {},createFlash: function(c) {
  this.flashPlayers[c.pluginId] = c;
  var b, a = "//www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid=" + c.pluginId + "&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0";
  if (mejs.MediaFeatures.isIE) {
    b = document.createElement("div");
    c.container.appendChild(b);
    b.outerHTML = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="' + c.pluginId + '" width="' + c.width + '" height="' + c.height + '" class="mejs-shim"><param name="movie" value="' + a + '" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'
  } else {
    c.container.innerHTML = '<object type="application/x-shockwave-flash" id="' + c.pluginId + '" data="' + a + '" width="' + c.width + '" height="' + c.height + '" style="visibility: visible; " class="mejs-shim"><param name="allowScriptAccess" value="always"><param name="wmode" value="transparent"></object>'
  }
},flashReady: function(e) {
  var c = this.flashPlayers[e], b = document.getElementById(e), a = c.pluginMediaElement;
  a.pluginApi = a.pluginElement = b;
  mejs.MediaPluginBridge.initPlugin(e);
  b.cueVideoById(c.videoId);
  var d = c.containerId + "_callback";
  window[d] = function(f) {
    mejs.YouTubeApi.handleStateChange(f, b, a)
  };
  b.addEventListener("onStateChange", d);
  setInterval(function() {
    mejs.YouTubeApi.createEvent(b, a, "timeupdate")
  }, 250)
},handleStateChange: function(c, b, a) {
  switch (c) {
    case -1:
      a.paused = true;
      a.ended = true;
      mejs.YouTubeApi.createEvent(b, a, "loadedmetadata");
      break;
    case 0:
      a.paused = false;
      a.ended = true;
      mejs.YouTubeApi.createEvent(b, a, "ended");
      break;
    case 1:
      a.paused = false;
      a.ended = false;
      mejs.YouTubeApi.createEvent(b, a, "play");
      mejs.YouTubeApi.createEvent(b, a, "playing");
      break;
    case 2:
      a.paused = true;
      a.ended = false;
      mejs.YouTubeApi.createEvent(b, a, "pause");
      break;
    case 3:
      mejs.YouTubeApi.createEvent(b, a, "progress");
      break;
    case 5:
      break
  }
}};
function onYouTubePlayerAPIReady() {
  mejs.YouTubeApi.iFrameReady()
}
function onYouTubePlayerReady(a) {
  mejs.YouTubeApi.flashReady(a)
}
window.mejs = mejs;
window.MediaElement = mejs.MediaElement;
/*
 * Adds Internationalization and localization to objects.
 *
 * What is the concept beyond i18n?
 *   http://en.wikipedia.org/wiki/Internationalization_and_localization
 *
 *
 * This file both i18n methods and locale which is used to translate
 * strings into other languages.
 *
 * Default translations are not available, you have to add them
 * through locale objects which are named exactly as the langcode
 * they stand for. The default language is always english (en).
 *
 *
 * Wrapper built to be able to attach the i18n object to
 * other objects without changing more than one line.
 *
 *
 * LICENSE:
 *
 *   The i18n file uses methods from the Drupal project (drupal.js):
 *     - i18n.methods.t() (modified)
 *     - i18n.methods.checkPlain() (full copy)
 *     - i18n.methods.formatString() (full copy)
 *
 *   The Drupal project is (like mediaelementjs) licensed under GPLv2.
 *    - http://drupal.org/licensing/faq/#q1
 *    - https://github.com/johndyer/mediaelement
 *    - http://www.gnu.org/licenses/old-licenses/gpl-2.0.html
 *
 *
 * @author
 *   Tim Latz (latz.tim@gmail.com)
 *
 * @see
 *   me-i18n-locale.js
 *
 * @params
 *  - context - document, iframe ..
 *  - exports - CommonJS, window ..
 *
 */
(function(b, a, d) {
  var c = {locale: {strings: {}},methods: {}};
  c.locale.getLanguage = function() {
    return {language: navigator.language}
  };
  c.locale.INIT_LANGUAGE = c.locale.getLanguage();
  c.methods.checkPlain = function(h) {
    var g, f, e = {"&": "&amp;",'"': "&quot;","<": "&lt;",">": "&gt;"};
    h = String(h);
    for (g in e) {
      if (e.hasOwnProperty(g)) {
        f = new RegExp(g, "g");
        h = h.replace(f, e[g])
      }
    }
    return h
  };
  c.methods.formatString = function(g, e) {
    for (var f in e) {
      switch (f.charAt(0)) {
        case "@":
          e[f] = c.methods.checkPlain(e[f]);
          break;
        case "!":
          break;
        case "%":
        default:
          e[f] = '<em class="placeholder">' + c.methods.checkPlain(e[f]) + "</em>";
          break
      }
      g = g.replace(f, e[f])
    }
    return g
  };
  c.methods.t = function(g, f, e) {
    if (c.locale.strings && c.locale.strings[e.context] && c.locale.strings[e.context][g]) {
      g = c.locale.strings[e.context][g]
    }
    if (f) {
      g = c.methods.formatString(g, f)
    }
    return g
  };
  c.t = function(h, f, e) {
    if (typeof h === "string" && h.length > 0) {
      var g = c.locale.getLanguage();
      e = e || {context: g.language};
      return c.methods.t(h, f, e)
    } else {
      throw {name: "InvalidArgumentException",message: "First argument is either not a string or empty."}
    }
  };
  a.i18n = c
}(document, mejs));
/*
 * This is a i18n.locale language object.
 *
 *<de> German translation by Tim Latz, latz.tim@gmail.com
 *
 * @author
 *   Tim Latz (latz.tim@gmail.com)
 *
 * @see
 *   me-i18n.js
 *
 * @params
 *  - exports - CommonJS, window ..
 */
(function(a, b) {
  a.de = {Fullscreen: "Vollbild","Go Fullscreen": "Vollbild an","Turn off Fullscreen": "Vollbild aus",Close: "Schließen"}
}(mejs.i18n.locale.strings));
/*
 * This is a i18n.locale language object.
 *
 *<de> Traditional chinese translation by Tim Latz, latz.tim@gmail.com
 *
 * @author
 *   Tim Latz (latz.tim@gmail.com)
 *
 * @see
 *   me-i18n.js
 *
 * @params
 *  - exports - CommonJS, window ..
 */
(function(a, b) {
  a.zh = {Fullscreen: "全螢幕","Go Fullscreen": "全屏模式","Turn off Fullscreen": "退出全屏模式",Close: "關閉"}
}(mejs.i18n.locale.strings));
/*
 * MediaElementPlayer
 * http://mediaelementjs.com/
 *
 * Creates a controller bar for HTML5 <video> add <audio> tags
 * using jQuery and MediaElement.js (HTML5 Flash/Silverlight wrapper)
 *
 * Copyright 2010-2012, John Dyer (http://j.hn/)
 * License: MIT
 *
 */
if (typeof jQuery != "undefined") {
  mejs.$ = jQuery
} else {
  if (typeof ender != "undefined") {
    mejs.$ = ender
  }
}
(function(a) {
  mejs.MepDefaults = {poster: "",defaultVideoWidth: 480,defaultVideoHeight: 270,videoWidth: -1,videoHeight: -1,defaultAudioWidth: 400,defaultAudioHeight: 30,defaultSeekBackwardInterval: function(b) {
    return (b.duration * 0.05)
  },defaultSeekForwardInterval: function(b) {
    return (b.duration * 0.05)
  },audioWidth: -1,audioHeight: -1,startVolume: 0.8,loop: false,autoRewind: true,enableAutosize: true,alwaysShowHours: false,showTimecodeFrameCount: false,framesPerSecond: 25,autosizeProgress: true,alwaysShowControls: false,hideVideoControlsOnLoad: false,clickToPlayPause: true,iPadUseNativeControls: false,iPhoneUseNativeControls: false,AndroidUseNativeControls: false,features: ["playpause", "current", "progress", "duration", "tracks", "volume", "fullscreen"],isVideo: true,enableKeyboard: true,pauseOtherPlayers: true,keyActions: [{keys: [32, 179],action: function(b, c) {
    if (c.paused || c.ended) {
      c.play()
    } else {
      c.pause()
    }
  }}, {keys: [38],action: function(b, d) {
    var c = Math.min(d.volume + 0.1, 1);
    d.setVolume(c)
  }}, {keys: [40],action: function(b, d) {
    var c = Math.max(d.volume - 0.1, 0);
    d.setVolume(c)
  }}, {keys: [37, 227],action: function(b, d) {
    if (!isNaN(d.duration) && d.duration > 0) {
      if (b.isVideo) {
        b.showControls();
        b.startControlsTimer()
      }
      var c = Math.max(d.currentTime - b.options.defaultSeekBackwardInterval(d), 0);
      d.setCurrentTime(c)
    }
  }}, {keys: [39, 228],action: function(b, d) {
    if (!isNaN(d.duration) && d.duration > 0) {
      if (b.isVideo) {
        b.showControls();
        b.startControlsTimer()
      }
      var c = Math.min(d.currentTime + b.options.defaultSeekForwardInterval(d), d.duration);
      d.setCurrentTime(c)
    }
  }}, {keys: [70],action: function(b, c) {
    if (typeof b.enterFullScreen != "undefined") {
      if (b.isFullScreen) {
        b.exitFullScreen()
      } else {
        b.enterFullScreen()
      }
    }
  }}]};
  mejs.mepIndex = 0;
  mejs.players = {};
  mejs.MediaElementPlayer = function(c, d) {
    if (!(this instanceof mejs.MediaElementPlayer)) {
      return new mejs.MediaElementPlayer(c, d)
    }
    var b = this;
    b.$media = b.$node = a(c);
    b.node = b.media = b.$media[0];
    if (typeof b.node.player != "undefined") {
      return b.node.player
    } else {
      b.node.player = b
    }
    if (typeof d == "undefined") {
      d = b.$node.data("mejsoptions")
    }
    b.options = a.extend({}, mejs.MepDefaults, d);
    b.id = "mep_" + mejs.mepIndex++;
    mejs.players[b.id] = b;
    b.init();
    return b
  };
  mejs.MediaElementPlayer.prototype = {hasFocus: false,controlsAreVisible: true,init: function() {
    var d = this, e = mejs.MediaFeatures, h = a.extend(true, {}, d.options, {success: function(l, k) {
      d.meReady(l, k)
    },error: function(k) {
      d.handleError(k)
    }}), c = d.media.tagName.toLowerCase();
    d.isDynamic = (c !== "audio" && c !== "video");
    if (d.isDynamic) {
      d.isVideo = d.options.isVideo
    } else {
      d.isVideo = (c !== "audio" && d.options.isVideo)
    }
    if ((e.isiPad && d.options.iPadUseNativeControls) || (e.isiPhone && d.options.iPhoneUseNativeControls)) {
      d.$media.attr("controls", "controls");
      if (e.isiPad && d.media.getAttribute("autoplay") !== null) {
        d.media.load();
        d.media.play()
      }
    } else {
      if (e.isAndroid && d.options.AndroidUseNativeControls) {
      } else {
        d.$media.removeAttr("controls");
        d.container = a('<div id="' + d.id + '" class="mejs-container ' + (mejs.MediaFeatures.svg ? "svg" : "no-svg") + '"><div class="mejs-inner"><div class="mejs-mediaelement"></div><div class="mejs-layers"></div><div class="mejs-controls"></div><div class="mejs-clear"></div></div></div>').addClass(d.$media[0].className).insertBefore(d.$media);
        d.container.addClass((e.isAndroid ? "mejs-android " : "") + (e.isiOS ? "mejs-ios " : "") + (e.isiPad ? "mejs-ipad " : "") + (e.isiPhone ? "mejs-iphone " : "") + (d.isVideo ? "mejs-video " : "mejs-audio "));
        if (e.isiOS) {
          var g = d.$media.clone();
          d.container.find(".mejs-mediaelement").append(g);
          d.$media.remove();
          d.$node = d.$media = g;
          d.node = d.media = g[0]
        } else {
          d.container.find(".mejs-mediaelement").append(d.$media)
        }
        d.controls = d.container.find(".mejs-controls");
        d.layers = d.container.find(".mejs-layers");
        var f = (d.isVideo ? "video" : "audio"), b = f.substring(0, 1).toUpperCase() + f.substring(1);
        if (d.options[f + "Width"] > 0 || d.options[f + "Width"].toString().indexOf("%") > -1) {
          d.width = d.options[f + "Width"]
        } else {
          if (d.media.style.width !== "" && d.media.style.width !== null) {
            d.width = d.media.style.width
          } else {
            if (d.media.getAttribute("width") !== null) {
              d.width = d.$media.attr("width")
            } else {
              d.width = d.options["default" + b + "Width"]
            }
          }
        }
        if (d.options[f + "Height"] > 0 || d.options[f + "Height"].toString().indexOf("%") > -1) {
          d.height = d.options[f + "Height"]
        } else {
          if (d.media.style.height !== "" && d.media.style.height !== null) {
            d.height = d.media.style.height
          } else {
            if (d.$media[0].getAttribute("height") !== null) {
              d.height = d.$media.attr("height")
            } else {
              d.height = d.options["default" + b + "Height"]
            }
          }
        }
        d.setPlayerSize(d.width, d.height);
        h.pluginWidth = d.height;
        h.pluginHeight = d.width
      }
    }
    mejs.MediaElement(d.$media[0], h);
    if (typeof (d.container) != "undefined") {
      d.container.trigger("controlsshown")
    }
  },showControls: function(b) {
    var c = this;
    b = typeof b == "undefined" || b;
    if (c.controlsAreVisible) {
      return
    }
    if (b) {
      c.controls.css("visibility", "visible").stop(true, true).fadeIn(200, function() {
        c.controlsAreVisible = true;
        c.container.trigger("controlsshown")
      });
      c.container.find(".mejs-control").css("visibility", "visible").stop(true, true).fadeIn(200, function() {
        c.controlsAreVisible = true
      })
    } else {
      c.controls.css("visibility", "visible").css("display", "block");
      c.container.find(".mejs-control").css("visibility", "visible").css("display", "block");
      c.controlsAreVisible = true;
      c.container.trigger("controlsshown")
    }
    c.setControlsSize()
  },hideControls: function(b) {
    var c = this;
    b = typeof b == "undefined" || b;
    if (!c.controlsAreVisible) {
      return
    }
    if (b) {
      c.controls.stop(true, true).fadeOut(200, function() {
        a(this).css("visibility", "hidden").css("display", "block");
        c.controlsAreVisible = false;
        c.container.trigger("controlshidden")
      });
      c.container.find(".mejs-control").stop(true, true).fadeOut(200, function() {
        a(this).css("visibility", "hidden").css("display", "block")
      })
    } else {
      c.controls.css("visibility", "hidden").css("display", "block");
      c.container.find(".mejs-control").css("visibility", "hidden").css("display", "block");
      c.controlsAreVisible = false;
      c.container.trigger("controlshidden")
    }
  },controlsTimer: null,startControlsTimer: function(c) {
    var b = this;
    c = typeof c != "undefined" ? c : 1500;
    b.killControlsTimer("start");
    b.controlsTimer = setTimeout(function() {
      b.hideControls();
      b.killControlsTimer("hide")
    }, c)
  },killControlsTimer: function(c) {
    var b = this;
    if (b.controlsTimer !== null) {
      clearTimeout(b.controlsTimer);
      delete b.controlsTimer;
      b.controlsTimer = null
    }
  },controlsEnabled: true,disableControls: function() {
    var b = this;
    b.killControlsTimer();
    b.hideControls(false);
    this.controlsEnabled = false
  },enableControls: function() {
    var b = this;
    b.showControls(false);
    b.controlsEnabled = true
  },meReady: function(c, f) {
    var l = this, k = mejs.MediaFeatures, g = f.getAttribute("autoplay"), d = !(typeof g == "undefined" || g === null || g === "false"), b, m;
    if (l.created) {
      return
    } else {
      l.created = true
    }
    l.media = c;
    l.domNode = f;
    if (!(k.isAndroid && l.options.AndroidUseNativeControls) && !(k.isiPad && l.options.iPadUseNativeControls) && !(k.isiPhone && l.options.iPhoneUseNativeControls)) {
      l.buildposter(l, l.controls, l.layers, l.media);
      l.buildkeyboard(l, l.controls, l.layers, l.media);
      l.buildoverlays(l, l.controls, l.layers, l.media);
      l.findTracks();
      for (b in l.options.features) {
        m = l.options.features[b];
        if (l["build" + m]) {
          try {
            l["build" + m](l, l.controls, l.layers, l.media)
          } catch (h) {
          }
        }
      }
      l.container.trigger("controlsready");
      l.setPlayerSize(l.width, l.height);
      l.setControlsSize();
      if (l.isVideo) {
        if (mejs.MediaFeatures.hasTouch) {
          l.$media.bind("touchstart", function() {
            if (l.controlsAreVisible) {
              l.hideControls(false)
            } else {
              if (l.controlsEnabled) {
                l.showControls(false)
              }
            }
          })
        } else {
          l.media.addEventListener("click", function() {
            if (l.options.clickToPlayPause) {
              if (l.media.paused) {
                l.media.play()
              } else {
                l.media.pause()
              }
            }
          });
          l.container.bind("mouseenter mouseover", function() {
            if (l.controlsEnabled) {
              if (!l.options.alwaysShowControls) {
                l.killControlsTimer("enter");
                l.showControls();
                l.startControlsTimer(2500)
              }
            }
          }).bind("mousemove", function() {
              if (l.controlsEnabled) {
                if (!l.controlsAreVisible) {
                  l.showControls()
                }
                if (!l.options.alwaysShowControls) {
                  l.startControlsTimer(2500)
                }
              }
            }).bind("mouseleave", function() {
              if (l.controlsEnabled) {
                if (!l.media.paused && !l.options.alwaysShowControls) {
                  l.startControlsTimer(1000)
                }
              }
            })
        }
        if (l.options.hideVideoControlsOnLoad) {
          l.hideControls(false)
        }
        if (d && !l.options.alwaysShowControls) {
          l.hideControls()
        }
        if (l.options.enableAutosize) {
          l.media.addEventListener("loadedmetadata", function(n) {
            if (l.options.videoHeight <= 0 && l.domNode.getAttribute("height") === null && !isNaN(n.target.videoHeight)) {
              l.setPlayerSize(n.target.videoWidth, n.target.videoHeight);
              l.setControlsSize();
              l.media.setVideoSize(n.target.videoWidth, n.target.videoHeight)
            }
          }, false)
        }
      }
      c.addEventListener("play", function() {
        var e;
        for (e in mejs.players) {
          var n = mejs.players[e];
          if (n.id != l.id && l.options.pauseOtherPlayers && !n.paused && !n.ended) {
            n.pause()
          }
          n.hasFocus = false
        }
        l.hasFocus = true
      }, false);
      l.media.addEventListener("ended", function(n) {
        if (l.options.autoRewind) {
          try {
            l.media.setCurrentTime(0)
          } catch (o) {
          }
        }
        l.media.pause();
        if (l.setProgressRail) {
          l.setProgressRail()
        }
        if (l.setCurrentRail) {
          l.setCurrentRail()
        }
        if (l.options.loop) {
          l.media.play()
        } else {
          if (!l.options.alwaysShowControls && l.controlsEnabled) {
            l.showControls()
          }
        }
      }, false);
      l.media.addEventListener("loadedmetadata", function(n) {
        if (l.updateDuration) {
          l.updateDuration()
        }
        if (l.updateCurrent) {
          l.updateCurrent()
        }
        if (!l.isFullScreen) {
          l.setPlayerSize(l.width, l.height);
          l.setControlsSize()
        }
      }, false);
      setTimeout(function() {
        l.setPlayerSize(l.width, l.height);
        l.setControlsSize()
      }, 50);
      l.globalBind("resize", function() {
        if (!(l.isFullScreen || (mejs.MediaFeatures.hasTrueNativeFullScreen && document.webkitIsFullScreen))) {
          l.setPlayerSize(l.width, l.height)
        }
        l.setControlsSize()
      });
      if (l.media.pluginType == "youtube") {
        l.container.find(".mejs-overlay-play").hide()
      }
    }
    if (d && c.pluginType == "native") {
      c.load();
      c.play()
    }
    if (l.options.success) {
      if (typeof l.options.success == "string") {
        window[l.options.success](l.media, l.domNode, l)
      } else {
        l.options.success(l.media, l.domNode, l)
      }
    }
  },handleError: function(c) {
    var b = this;
    b.controls.hide();
    if (b.options.error) {
      b.options.error(c)
    }
  },setPlayerSize: function(g, b) {
    var e = this;
    if (typeof g != "undefined") {
      e.width = g
    }
    if (typeof b != "undefined") {
      e.height = b
    }
    if (e.height.toString().indexOf("%") > 0 || e.$node.css("max-width") === "100%" || (e.$node[0].currentStyle && e.$node[0].currentStyle.maxWidth === "100%")) {
      var h = e.isVideo ? ((e.media.videoWidth && e.media.videoWidth > 0) ? e.media.videoWidth : e.options.defaultVideoWidth) : e.options.defaultAudioWidth, d = e.isVideo ? ((e.media.videoHeight && e.media.videoHeight > 0) ? e.media.videoHeight : e.options.defaultVideoHeight) : e.options.defaultAudioHeight, f = e.container.parent().closest(":visible").width(), c = e.isVideo || !e.options.autosizeProgress ? parseInt(f * d / h, 10) : d;
      if (e.container.parent()[0].tagName.toLowerCase() === "body") {
        f = a(window).width();
        c = a(window).height()
      }
      if (c != 0 && f != 0) {
        e.container.width(f).height(c);
        e.$media.add(e.container.find(".mejs-shim")).width("100%").height("100%");
        if (e.isVideo) {
          if (e.media.setVideoSize) {
            e.media.setVideoSize(f, c)
          }
        }
        e.layers.children(".mejs-layer").width("100%").height("100%")
      }
    } else {
      e.container.width(e.width).height(e.height);
      e.layers.children(".mejs-layer").width(e.width).height(e.height)
    }
  },setControlsSize: function() {
    var c = this, g = 0, k = 0, h = c.controls.find(".mejs-time-rail"), e = c.controls.find(".mejs-time-total"), f = c.controls.find(".mejs-time-current"), b = c.controls.find(".mejs-time-loaded"), d = h.siblings();
    if (c.options && !c.options.autosizeProgress) {
      k = parseInt(h.css("width"))
    }
    if (k === 0 || !k) {
      d.each(function() {
        var l = a(this);
        if (l.css("position") != "absolute" && l.is(":visible")) {
          g += a(this).outerWidth(true)
        }
      });
      k = c.controls.width() - g - (h.outerWidth(true) - h.width())
    }
    h.width(k);
    e.width(k - (e.outerWidth(true) - e.width()));
    if (c.setProgressRail) {
      c.setProgressRail()
    }
    if (c.setCurrentRail) {
      c.setCurrentRail()
    }
  },buildposter: function(e, b, g, f) {
    var d = this, h = a('<div class="mejs-poster mejs-layer"></div>').appendTo(g), c = e.$media.attr("poster");
    if (e.options.poster !== "") {
      c = e.options.poster
    }
    if (c !== "" && c != null) {
      d.setPoster(c)
    } else {
      h.hide()
    }
    f.addEventListener("play", function() {
      h.hide()
    }, false)
  },setPoster: function(c) {
    var d = this, e = d.container.find(".mejs-poster"), b = e.find("img");
    if (b.length == 0) {
      b = a('<img width="100%" height="100%" />').appendTo(e)
    }
    b.attr("src", c)
  },buildoverlays: function(f, b, h, g) {
    var e = this;
    if (!f.isVideo) {
      return
    }
    var k = a('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-loading"><span></span></div></div>').hide().appendTo(h), c = a('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-error"></div></div>').hide().appendTo(h), d = a('<div class="mejs-overlay mejs-layer mejs-overlay-play"><div class="mejs-overlay-button"></div></div>').appendTo(h).click(function() {
      if (e.options.clickToPlayPause) {
        if (g.paused) {
          g.play()
        } else {
          g.pause()
        }
      }
    });
    g.addEventListener("play", function() {
      d.hide();
      k.hide();
      b.find(".mejs-time-buffering").hide();
      c.hide()
    }, false);
    g.addEventListener("playing", function() {
      d.hide();
      k.hide();
      b.find(".mejs-time-buffering").hide();
      c.hide()
    }, false);
    g.addEventListener("seeking", function() {
      k.show();
      b.find(".mejs-time-buffering").show()
    }, false);
    g.addEventListener("seeked", function() {
      k.hide();
      b.find(".mejs-time-buffering").hide()
    }, false);
    g.addEventListener("pause", function() {
      if (!mejs.MediaFeatures.isiPhone) {
        d.show()
      }
    }, false);
    g.addEventListener("waiting", function() {
      k.show();
      b.find(".mejs-time-buffering").show()
    }, false);
    g.addEventListener("loadeddata", function() {
      k.show();
      b.find(".mejs-time-buffering").show()
    }, false);
    g.addEventListener("canplay", function() {
      k.hide();
      b.find(".mejs-time-buffering").hide()
    }, false);
    g.addEventListener("error", function() {
      k.hide();
      b.find(".mejs-time-buffering").hide();
      c.show();
      c.find("mejs-overlay-error").html("Error loading this resource")
    }, false)
  },buildkeyboard: function(d, b, f, e) {
    var c = this;
    c.globalBind("keydown", function(n) {
      if (d.hasFocus && d.options.enableKeyboard) {
        for (var m = 0, g = d.options.keyActions.length; m < g; m++) {
          var l = d.options.keyActions[m];
          for (var h = 0, k = l.keys.length; h < k; h++) {
            if (n.keyCode == l.keys[h]) {
              n.preventDefault();
              l.action(d, e, n.keyCode);
              return false
            }
          }
        }
      }
      return true
    });
    c.globalBind("click", function(g) {
      if (a(g.target).closest(".mejs-container").length == 0) {
        d.hasFocus = false
      }
    })
  },findTracks: function() {
    var b = this, c = b.$media.find("track");
    b.tracks = [];
    c.each(function(e, d) {
      d = a(d);
      b.tracks.push({srclang: (d.attr("srclang")) ? d.attr("srclang").toLowerCase() : "",src: d.attr("src"),kind: d.attr("kind"),label: d.attr("label") || "",entries: [],isLoaded: false})
    })
  },changeSkin: function(b) {
    this.container[0].className = "mejs-container " + b;
    this.setPlayerSize(this.width, this.height);
    this.setControlsSize()
  },play: function() {
    this.media.play()
  },pause: function() {
    this.media.pause()
  },load: function() {
    this.media.load()
  },setMuted: function(b) {
    this.media.setMuted(b)
  },setCurrentTime: function(b) {
    this.media.setCurrentTime(b)
  },getCurrentTime: function() {
    return this.media.currentTime
  },setVolume: function(b) {
    this.media.setVolume(b)
  },getVolume: function() {
    return this.media.volume
  },setSrc: function(b) {
    this.media.setSrc(b)
  },remove: function() {
    var c = this, f, b;
    for (f in c.options.features) {
      b = c.options.features[f];
      if (c["clean" + b]) {
        try {
          c["clean" + b](c)
        } catch (d) {
        }
      }
    }
    if (c.media.pluginType === "native") {
      c.$media.prop("controls", true)
    } else {
      c.media.remove()
    }
    if (!c.isDynamic) {
      if (c.media.pluginType === "native") {
      }
      c.$node.insertBefore(c.container)
    }
    delete mejs.players[c.id];
    c.container.remove();
    c.globalUnbind();
    delete c.node.player
  }};
  (function() {
    var c = /^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/;
    function b(e, f) {
      var d = {d: [],w: []};
      a.each((e || "").split(" "), function(h, g) {
        d[c.test(g) ? "w" : "d"].push(g + "." + f)
      });
      d.d = d.d.join(" ");
      d.w = d.w.join(" ");
      return d
    }
    mejs.MediaElementPlayer.prototype.globalBind = function(e, f, g) {
      var d = this;
      e = b(e, d.id);
      if (e.d) {
        a(document).bind(e.d, f, g)
      }
      if (e.w) {
        a(window).bind(e.w, f, g)
      }
    };
    mejs.MediaElementPlayer.prototype.globalUnbind = function(e, f) {
      var d = this;
      e = b(e, d.id);
      if (e.d) {
        a(document).unbind(e.d, f)
      }
      if (e.w) {
        a(window).unbind(e.w, f)
      }
    }
  })();
  if (typeof jQuery != "undefined") {
    jQuery.fn.mediaelementplayer = function(b) {
      if (b === false) {
        this.each(function() {
          var c = jQuery(this).data("mediaelementplayer");
          if (c) {
            c.remove()
          }
          jQuery(this).removeData("mediaelementplayer")
        })
      } else {
        this.each(function() {
          jQuery(this).data("mediaelementplayer", new mejs.MediaElementPlayer(this, b))
        })
      }
      return this
    }
  }
  a(document).ready(function() {
    a(".mejs-player").mediaelementplayer()
  });
  window.MediaElementPlayer = mejs.MediaElementPlayer
})(mejs.$);
(function(a) {
  a.extend(mejs.MepDefaults, {playpauseText: "Play/Pause"});
  a.extend(MediaElementPlayer.prototype, {buildplaypause: function(d, b, g, f) {
    var c = this, e = a('<div class="mejs-button mejs-playpause-button mejs-play" ><button type="button" aria-controls="' + c.id + '" title="' + c.options.playpauseText + '" aria-label="' + c.options.playpauseText + '"></button></div>').appendTo(b).click(function(h) {
      h.preventDefault();
      if (f.paused) {
        f.play()
      } else {
        f.pause()
      }
      return false
    });
    f.addEventListener("play", function() {
      e.removeClass("mejs-play").addClass("mejs-pause")
    }, false);
    f.addEventListener("playing", function() {
      e.removeClass("mejs-play").addClass("mejs-pause")
    }, false);
    f.addEventListener("pause", function() {
      e.removeClass("mejs-pause").addClass("mejs-play")
    }, false);
    f.addEventListener("paused", function() {
      e.removeClass("mejs-pause").addClass("mejs-play")
    }, false)
  }})
})(mejs.$);
(function(a) {
  a.extend(mejs.MepDefaults, {stopText: "Stop"});
  a.extend(MediaElementPlayer.prototype, {buildstop: function(e, b, g, f) {
    var d = this, c = a('<div class="mejs-button mejs-stop-button mejs-stop"><button type="button" aria-controls="' + d.id + '" title="' + d.options.stopText + '" aria-label="' + d.options.stopText + '"></button></div>').appendTo(b).click(function() {
      if (!f.paused) {
        f.pause()
      }
      if (f.currentTime > 0) {
        f.setCurrentTime(0);
        f.pause();
        b.find(".mejs-time-current").width("0px");
        b.find(".mejs-time-handle").css("left", "0px");
        b.find(".mejs-time-float-current").html(mejs.Utility.secondsToTimeCode(0));
        b.find(".mejs-currenttime").html(mejs.Utility.secondsToTimeCode(0));
        g.find(".mejs-poster").show()
      }
    })
  }})
})(mejs.$);
(function(a) {
  a.extend(MediaElementPlayer.prototype, {buildprogress: function(o, p, f, c) {
    a('<div class="mejs-time-rail"><span class="mejs-time-total"><span class="mejs-time-buffering"></span><span class="mejs-time-loaded"></span><span class="mejs-time-current"></span><span class="mejs-time-handle"></span><span class="mejs-time-float"><span class="mejs-time-float-current">00:00</span><span class="mejs-time-float-corner"></span></span></span></div>').appendTo(p);
    p.find(".mejs-time-buffering").hide();
    var q = this, m = p.find(".mejs-time-total"), g = p.find(".mejs-time-loaded"), l = p.find(".mejs-time-current"), k = p.find(".mejs-time-handle"), n = p.find(".mejs-time-float"), b = p.find(".mejs-time-float-current"), e = function(v) {
      var r = v.pageX, w = m.offset(), t = m.outerWidth(true), s = 0, u = 0, y = 0;
      if (c.duration) {
        if (r < w.left) {
          r = w.left
        } else {
          if (r > t + w.left) {
            r = t + w.left
          }
        }
        y = r - w.left;
        s = (y / t);
        u = (s <= 0.02) ? 0 : s * c.duration;
        if (h && u !== c.currentTime) {
          c.setCurrentTime(u)
        }
        if (!mejs.MediaFeatures.hasTouch) {
          n.css("left", y);
          b.html(mejs.Utility.secondsToTimeCode(u));
          n.show()
        }
      }
    }, h = false, d = false;
    m.bind("mousedown", function(r) {
      if (r.which === 1) {
        h = true;
        e(r);
        q.globalBind("mousemove.dur", function(s) {
          e(s)
        });
        q.globalBind("mouseup.dur", function(s) {
          h = false;
          n.hide();
          q.globalUnbind(".dur")
        });
        return false
      }
    }).bind("mouseenter", function(r) {
        d = true;
        q.globalBind("mousemove.dur", function(s) {
          e(s)
        });
        if (!mejs.MediaFeatures.hasTouch) {
          n.show()
        }
      }).bind("mouseleave", function(r) {
        d = false;
        if (!h) {
          q.globalUnbind(".dur");
          n.hide()
        }
      });
    c.addEventListener("progress", function(r) {
      o.setProgressRail(r);
      o.setCurrentRail(r)
    }, false);
    c.addEventListener("timeupdate", function(r) {
      o.setProgressRail(r);
      o.setCurrentRail(r)
    }, false);
    q.loaded = g;
    q.total = m;
    q.current = l;
    q.handle = k
  },setProgressRail: function(f) {
    var b = this, d = (f != undefined) ? f.target : b.media, c = null;
    if (d && d.buffered && d.buffered.length > 0 && d.buffered.end && d.duration) {
      c = d.buffered.end(0) / d.duration
    } else {
      if (d && d.bytesTotal != undefined && d.bytesTotal > 0 && d.bufferedBytes != undefined) {
        c = d.bufferedBytes / d.bytesTotal
      } else {
        if (f && f.lengthComputable && f.total != 0) {
          c = f.loaded / f.total
        }
      }
    }
    if (c !== null) {
      c = Math.min(1, Math.max(0, c));
      if (b.loaded && b.total) {
        b.loaded.width(b.total.width() * c)
      }
    }
  },setCurrentRail: function() {
    var b = this;
    if (b.media.currentTime != undefined && b.media.duration) {
      if (b.total && b.handle) {
        var d = Math.round(b.total.width() * b.media.currentTime / b.media.duration), c = d - Math.round(b.handle.outerWidth(true) / 2);
        b.current.width(d);
        b.handle.css("left", c)
      }
    }
  }})
})(mejs.$);
(function(a) {
  a.extend(mejs.MepDefaults, {duration: -1,timeAndDurationSeparator: " <span> | </span> "});
  a.extend(MediaElementPlayer.prototype, {buildcurrent: function(d, b, f, e) {
    var c = this;
    a('<div class="mejs-time"><span class="mejs-currenttime">' + (d.options.alwaysShowHours ? "00:" : "") + (d.options.showTimecodeFrameCount ? "00:00:00" : "00:00") + "</span></div>").appendTo(b);
    c.currenttime = c.controls.find(".mejs-currenttime");
    e.addEventListener("timeupdate", function() {
      d.updateCurrent()
    }, false)
  },buildduration: function(d, b, f, e) {
    var c = this;
    if (b.children().last().find(".mejs-currenttime").length > 0) {
      a(c.options.timeAndDurationSeparator + '<span class="mejs-duration">' + (c.options.duration > 0 ? mejs.Utility.secondsToTimeCode(c.options.duration, c.options.alwaysShowHours || c.media.duration > 3600, c.options.showTimecodeFrameCount, c.options.framesPerSecond || 25) : ((d.options.alwaysShowHours ? "00:" : "") + (d.options.showTimecodeFrameCount ? "00:00:00" : "00:00"))) + "</span>").appendTo(b.find(".mejs-time"))
    } else {
      b.find(".mejs-currenttime").parent().addClass("mejs-currenttime-container");
      a('<div class="mejs-time mejs-duration-container"><span class="mejs-duration">' + (c.options.duration > 0 ? mejs.Utility.secondsToTimeCode(c.options.duration, c.options.alwaysShowHours || c.media.duration > 3600, c.options.showTimecodeFrameCount, c.options.framesPerSecond || 25) : ((d.options.alwaysShowHours ? "00:" : "") + (d.options.showTimecodeFrameCount ? "00:00:00" : "00:00"))) + "</span></div>").appendTo(b)
    }
    c.durationD = c.controls.find(".mejs-duration");
    e.addEventListener("timeupdate", function() {
      d.updateDuration()
    }, false)
  },updateCurrent: function() {
    var b = this;
    if (b.currenttime) {
      b.currenttime.html(mejs.Utility.secondsToTimeCode(b.media.currentTime, b.options.alwaysShowHours || b.media.duration > 3600, b.options.showTimecodeFrameCount, b.options.framesPerSecond || 25))
    }
  },updateDuration: function() {
    var b = this;
    b.container.toggleClass("mejs-long-video", b.media.duration > 3600);
    if (b.durationD && (b.options.duration > 0 || b.media.duration)) {
      b.durationD.html(mejs.Utility.secondsToTimeCode(b.options.duration > 0 ? b.options.duration : b.media.duration, b.options.alwaysShowHours, b.options.showTimecodeFrameCount, b.options.framesPerSecond || 25))
    }
  }})
})(mejs.$);
(function(a) {
  a.extend(mejs.MepDefaults, {muteText: "Mute Toggle",hideVolumeOnTouchDevices: true,audioVolume: "horizontal",videoVolume: "vertical"});
  a.extend(MediaElementPlayer.prototype, {buildvolume: function(o, p, k, d) {
    if (mejs.MediaFeatures.hasTouch && this.options.hideVolumeOnTouchDevices) {
      return
    }
    var q = this, m = (q.isVideo) ? q.options.videoVolume : q.options.audioVolume, f = (m == "horizontal") ? a('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="' + q.id + '" title="' + q.options.muteText + '" aria-label="' + q.options.muteText + '"></button></div><div class="mejs-horizontal-volume-slider"><div class="mejs-horizontal-volume-total"></div><div class="mejs-horizontal-volume-current"></div><div class="mejs-horizontal-volume-handle"></div></div>').appendTo(p) : a('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="' + q.id + '" title="' + q.options.muteText + '" aria-label="' + q.options.muteText + '"></button><div class="mejs-volume-slider"><div class="mejs-volume-total"></div><div class="mejs-volume-current"></div><div class="mejs-volume-handle"></div></div></div>').appendTo(p), r = q.container.find(".mejs-volume-slider, .mejs-horizontal-volume-slider"), b = q.container.find(".mejs-volume-total, .mejs-horizontal-volume-total"), h = q.container.find(".mejs-volume-current, .mejs-horizontal-volume-current"), g = q.container.find(".mejs-volume-handle, .mejs-horizontal-volume-handle"), n = function(x, y) {
      if (!r.is(":visible") && typeof y == "undefined") {
        r.show();
        n(x, true);
        r.hide();
        return
      }
      x = Math.max(0, x);
      x = Math.min(x, 1);
      if (x == 0) {
        f.removeClass("mejs-mute").addClass("mejs-unmute")
      } else {
        f.removeClass("mejs-unmute").addClass("mejs-mute")
      }
      if (m == "vertical") {
        var v = b.height(), u = b.position(), t = v - (v * x);
        g.css("top", Math.round(u.top + t - (g.height() / 2)));
        h.height(v - t);
        h.css("top", u.top + t)
      } else {
        var s = b.width(), u = b.position(), w = s * x;
        g.css("left", Math.round(u.left + w - (g.width() / 2)));
        h.width(Math.round(w))
      }
    }, c = function(x) {
      var v = null, t = b.offset();
      if (m == "vertical") {
        var u = b.height(), s = parseInt(b.css("top").replace(/px/, ""), 10), w = x.pageY - t.top;
        v = (u - w) / u;
        if (t.top == 0 || t.left == 0) {
          return
        }
      } else {
        var z = b.width(), y = x.pageX - t.left;
        v = y / z
      }
      v = Math.max(0, v);
      v = Math.min(v, 1);
      n(v);
      if (v == 0) {
        d.setMuted(true)
      } else {
        d.setMuted(false)
      }
      d.setVolume(v)
    }, l = false, e = false;
    f.hover(function() {
      r.show();
      e = true
    }, function() {
      e = false;
      if (!l && m == "vertical") {
        r.hide()
      }
    });
    r.bind("mouseover", function() {
      e = true
    }).bind("mousedown", function(s) {
        c(s);
        q.globalBind("mousemove.vol", function(t) {
          c(t)
        });
        q.globalBind("mouseup.vol", function() {
          l = false;
          q.globalUnbind(".vol");
          if (!e && m == "vertical") {
            r.hide()
          }
        });
        l = true;
        return false
      });
    f.find("button").click(function() {
      d.setMuted(!d.muted)
    });
    d.addEventListener("volumechange", function(s) {
      if (!l) {
        if (d.muted) {
          n(0);
          f.removeClass("mejs-mute").addClass("mejs-unmute")
        } else {
          n(d.volume);
          f.removeClass("mejs-unmute").addClass("mejs-mute")
        }
      }
    }, false);
    if (q.container.is(":visible")) {
      n(o.options.startVolume);
      if (o.options.startVolume === 0) {
        d.setMuted(true)
      }
      if (d.pluginType === "native") {
        d.setVolume(o.options.startVolume)
      }
    }
  }})
})(mejs.$);
(function(a) {
  a.extend(mejs.MepDefaults, {usePluginFullScreen: true,newWindowCallback: function() {
    return ""
  },fullscreenText: mejs.i18n.t("Fullscreen")});
  a.extend(MediaElementPlayer.prototype, {isFullScreen: false,isNativeFullScreen: false,docStyleOverflow: null,isInIframe: false,buildfullscreen: function(q, p, g, f) {
    if (!q.isVideo) {
      return
    }
    q.isInIframe = (window.location != window.parent.location);
    if (mejs.MediaFeatures.hasTrueNativeFullScreen) {
      var e = function(t) {
        if (mejs.MediaFeatures.isFullScreen()) {
          q.isNativeFullScreen = true;
          q.setControlsSize()
        } else {
          q.isNativeFullScreen = false;
          q.exitFullScreen()
        }
      };
      if (mejs.MediaFeatures.hasMozNativeFullScreen) {
        q.globalBind(mejs.MediaFeatures.fullScreenEventName, e)
      } else {
        q.container.bind(mejs.MediaFeatures.fullScreenEventName, e)
      }
    }
    var o = this, d = 0, c = 0, n = q.container, b = a('<div class="mejs-button mejs-fullscreen-button"><button type="button" aria-controls="' + o.id + '" title="' + o.options.fullscreenText + '" aria-label="' + o.options.fullscreenText + '"></button></div>').appendTo(p);
    if (o.media.pluginType === "native" || (!o.options.usePluginFullScreen && !mejs.MediaFeatures.isFirefox)) {
      b.click(function() {
        var t = (mejs.MediaFeatures.hasTrueNativeFullScreen && mejs.MediaFeatures.isFullScreen()) || q.isFullScreen;
        if (t) {
          q.exitFullScreen()
        } else {
          q.enterFullScreen()
        }
      })
    } else {
      var m = null, h = (function() {
        var x = document.createElement("x"), y = document.documentElement, z = window.getComputedStyle, t;
        if (!("pointerEvents" in x.style)) {
          return false
        }
        x.style.pointerEvents = "auto";
        x.style.pointerEvents = "x";
        y.appendChild(x);
        t = z && z(x, "").pointerEvents === "auto";
        y.removeChild(x);
        return !!t
      })();
      if (h && !mejs.MediaFeatures.isOpera) {
        var l = false, s = function() {
          if (l) {
            for (var t in k) {
              k[t].hide()
            }
            b.css("pointer-events", "");
            o.controls.css("pointer-events", "");
            l = false
          }
        }, k = {}, r = ["top", "left", "right", "bottom"], u, v, w = function() {
          var x = b.offset().left - o.container.offset().left, B = b.offset().top - o.container.offset().top, t = b.outerWidth(true), A = b.outerHeight(true), z = o.container.width(), y = o.container.height();
          for (u in k) {
            k[u].css({position: "absolute",top: 0,left: 0})
          }
          k.top.width(z).height(B);
          k.left.width(x).height(A).css({top: B});
          k.right.width(z - x - t).height(A).css({top: B,left: x + t});
          k.bottom.width(z).height(y - A - B).css({top: B + A})
        };
        o.globalBind("resize", function() {
          w()
        });
        for (u = 0, v = r.length; u < v; u += 1) {
          k[r[u]] = a('<div class="mejs-fullscreen-hover" />').appendTo(o.container).mouseover(s).hide()
        }
        b.mouseover(function() {
          if (!o.isFullScreen) {
            var t = b.offset(), x = q.container.offset();
            f.positionFullscreenButton(t.left - x.left, t.top - x.top, false);
            b.css("pointer-events", "none");
            o.controls.css("pointer-events", "none");
            for (u in k) {
              k[u].show()
            }
            w();
            l = true
          }
        });
        f.addEventListener("fullscreenchange", function(t) {
          s()
        })
      } else {
        b.mouseover(function() {
          if (m !== null) {
            clearTimeout(m);
            delete m
          }
          var t = b.offset(), x = q.container.offset();
          f.positionFullscreenButton(t.left - x.left, t.top - x.top, true)
        }).mouseout(function() {
            if (m !== null) {
              clearTimeout(m);
              delete m
            }
            m = setTimeout(function() {
              f.hideFullscreenButton()
            }, 1500)
          })
      }
    }
    q.fullscreenBtn = b;
    o.globalBind("keydown", function(t) {
      if (((mejs.MediaFeatures.hasTrueNativeFullScreen && mejs.MediaFeatures.isFullScreen()) || o.isFullScreen) && t.keyCode == 27) {
        q.exitFullScreen()
      }
    })
  },cleanfullscreen: function(b) {
    b.exitFullScreen()
  },containerSizeTimeout: null,enterFullScreen: function() {
    var c = this;
    if (c.media.pluginType !== "native" && (mejs.MediaFeatures.isFirefox || c.options.usePluginFullScreen)) {
      return
    }
    docStyleOverflow = document.documentElement.style.overflow;
    document.documentElement.style.overflow = "hidden";
    normalHeight = c.container.height();
    normalWidth = c.container.width();
    if (c.media.pluginType === "native") {
      if (mejs.MediaFeatures.hasTrueNativeFullScreen) {
        mejs.MediaFeatures.requestFullScreen(c.container[0]);
        if (c.isInIframe) {
          setTimeout(function d() {
            if (c.isNativeFullScreen) {
              if (a(window).width() !== screen.width) {
                c.exitFullScreen()
              } else {
                setTimeout(d, 500)
              }
            }
          }, 500)
        }
      } else {
        if (mejs.MediaFeatures.hasSemiNativeFullScreen) {
          c.media.webkitEnterFullscreen();
          return
        }
      }
    }
    if (c.isInIframe) {
      var b = c.options.newWindowCallback(this);
      if (b !== "") {
        if (!mejs.MediaFeatures.hasTrueNativeFullScreen) {
          c.pause();
          window.open(b, c.id, "top=0,left=0,width=" + screen.availWidth + ",height=" + screen.availHeight + ",resizable=yes,scrollbars=no,status=no,toolbar=no");
          return
        } else {
          setTimeout(function() {
            if (!c.isNativeFullScreen) {
              c.pause();
              window.open(b, c.id, "top=0,left=0,width=" + screen.availWidth + ",height=" + screen.availHeight + ",resizable=yes,scrollbars=no,status=no,toolbar=no")
            }
          }, 250)
        }
      }
    }
    c.container.addClass("mejs-container-fullscreen").width("100%").height("100%");
    c.containerSizeTimeout = setTimeout(function() {
      c.container.css({width: "100%",height: "100%"});
      c.setControlsSize()
    }, 500);
    if (c.pluginType === "native") {
      c.$media.width("100%").height("100%")
    } else {
      c.container.find(".mejs-shim").width("100%").height("100%");
      c.media.setVideoSize(a(window).width(), a(window).height())
    }
    c.layers.children("div").width("100%").height("100%");
    if (c.fullscreenBtn) {
      c.fullscreenBtn.removeClass("mejs-fullscreen").addClass("mejs-unfullscreen")
    }
    c.setControlsSize();
    c.isFullScreen = true
  },exitFullScreen: function() {
    var b = this;
    clearTimeout(b.containerSizeTimeout);
    if (b.media.pluginType !== "native" && mejs.MediaFeatures.isFirefox) {
      b.media.setFullscreen(false);
      return
    }
    if (mejs.MediaFeatures.hasTrueNativeFullScreen && (mejs.MediaFeatures.isFullScreen() || b.isFullScreen)) {
      mejs.MediaFeatures.cancelFullScreen()
    }
    document.documentElement.style.overflow = docStyleOverflow;
    b.container.removeClass("mejs-container-fullscreen").width(normalWidth).height(normalHeight);
    if (b.pluginType === "native") {
      b.$media.width(normalWidth).height(normalHeight)
    } else {
      b.container.find("object embed").width(normalWidth).height(normalHeight);
      b.media.setVideoSize(normalWidth, normalHeight)
    }
    b.layers.children("div").width(normalWidth).height(normalHeight);
    b.fullscreenBtn.removeClass("mejs-unfullscreen").addClass("mejs-fullscreen");
    b.setControlsSize();
    b.isFullScreen = false
  }})
})(mejs.$);
(function(a) {
  a.extend(mejs.MepDefaults, {startLanguage: "",tracksText: "Captions/Subtitles",hideCaptionsButtonWhenEmpty: true,toggleCaptionsButtonWhenOnlyOne: false,slidesSelector: ""});
  a.extend(MediaElementPlayer.prototype, {hasChapters: false,buildtracks: function(f, b, k, h) {
    if (f.tracks.length == 0) {
      return
    }
    var e = this, d, c = "";
    f.chapters = a('<div class="mejs-chapters mejs-layer"></div>').prependTo(k).hide();
    f.captions = a('<div class="mejs-captions-layer mejs-layer"><div class="mejs-captions-position mejs-captions-position-hover"><span class="mejs-captions-text"></span></div></div>').prependTo(k).hide();
    f.captionsText = f.captions.find(".mejs-captions-text");
    f.captionsButton = a('<div class="mejs-button mejs-captions-button"><button type="button" aria-controls="' + e.id + '" title="' + e.options.tracksText + '" aria-label="' + e.options.tracksText + '"></button><div class="mejs-captions-selector"><ul><li><input type="radio" name="' + f.id + '_captions" id="' + f.id + '_captions_none" value="none" checked="checked" /><label for="' + f.id + '_captions_none">None</label></li></ul></div></div>').appendTo(b);
    var g = 0;
    for (d = 0; d < f.tracks.length; d++) {
      if (f.tracks[d].kind == "subtitles") {
        g++
      }
    }
    if (e.options.toggleCaptionsButtonWhenOnlyOne && g == 1) {
      f.captionsButton.on("click", function() {
        if (f.selectedTrack == null) {
          var l = f.tracks[0].srclang
        } else {
          var l = "none"
        }
        f.setTrack(l)
      })
    } else {
      f.captionsButton.hover(function() {
        a(this).find(".mejs-captions-selector").css("visibility", "visible")
      }, function() {
        a(this).find(".mejs-captions-selector").css("visibility", "hidden")
      }).on("click", "input[type=radio]", function() {
          lang = this.value;
          f.setTrack(lang)
        })
    }
    if (!f.options.alwaysShowControls) {
      f.container.bind("controlsshown", function() {
        f.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover")
      }).bind("controlshidden", function() {
          if (!h.paused) {
            f.container.find(".mejs-captions-position").removeClass("mejs-captions-position-hover")
          }
        })
    } else {
      f.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover")
    }
    f.trackToLoad = -1;
    f.selectedTrack = null;
    f.isLoadingTrack = false;
    for (d = 0; d < f.tracks.length; d++) {
      if (f.tracks[d].kind == "subtitles") {
        f.addTrackButton(f.tracks[d].srclang, f.tracks[d].label)
      }
    }
    f.loadNextTrack();
    h.addEventListener("timeupdate", function(l) {
      f.displayCaptions()
    }, false);
    if (f.options.slidesSelector != "") {
      f.slidesContainer = a(f.options.slidesSelector);
      h.addEventListener("timeupdate", function(l) {
        f.displaySlides()
      }, false)
    }
    h.addEventListener("loadedmetadata", function(l) {
      f.displayChapters()
    }, false);
    f.container.hover(function() {
      if (f.hasChapters) {
        f.chapters.css("visibility", "visible");
        f.chapters.fadeIn(200).height(f.chapters.find(".mejs-chapter").outerHeight())
      }
    }, function() {
      if (f.hasChapters && !h.paused) {
        f.chapters.fadeOut(200, function() {
          a(this).css("visibility", "hidden");
          a(this).css("display", "block")
        })
      }
    });
    if (f.node.getAttribute("autoplay") !== null) {
      f.chapters.css("visibility", "hidden")
    }
  },setTrack: function(d) {
    var c = this, b;
    if (d == "none") {
      c.selectedTrack = null;
      c.captionsButton.removeClass("mejs-captions-enabled")
    } else {
      for (b = 0; b < c.tracks.length; b++) {
        if (c.tracks[b].srclang == d) {
          if (c.selectedTrack == null) {
            c.captionsButton.addClass("mejs-captions-enabled")
          }
          c.selectedTrack = c.tracks[b];
          c.captions.attr("lang", c.selectedTrack.srclang);
          c.displayCaptions();
          break
        }
      }
    }
  },loadNextTrack: function() {
    var b = this;
    b.trackToLoad++;
    if (b.trackToLoad < b.tracks.length) {
      b.isLoadingTrack = true;
      b.loadTrack(b.trackToLoad)
    } else {
      b.isLoadingTrack = false;
      b.checkForTracks()
    }
  },loadTrack: function(c) {
    var d = this, b = d.tracks[c], e = function() {
      b.isLoaded = true;
      d.enableTrackButton(b.srclang, b.label);
      d.loadNextTrack()
    };
    a.ajax({url: b.src,dataType: "text",success: function(f) {
      if (typeof f == "string" && (/<tt\s+xml/ig).exec(f)) {
        b.entries = mejs.TrackFormatParser.dfxp.parse(f)
      } else {
        b.entries = mejs.TrackFormatParser.webvvt.parse(f)
      }
      e();
      if (b.kind == "chapters") {
        d.media.addEventListener("play", function(g) {
          if (d.media.duration > 0) {
            d.displayChapters(b)
          }
        }, false)
      }
      if (b.kind == "slides") {
        d.setupSlides(b)
      }
    },error: function() {
      d.loadNextTrack()
    }})
  },enableTrackButton: function(d, b) {
    var c = this;
    if (b === "") {
      b = mejs.language.codes[d] || d
    }
    c.captionsButton.find("input[value=" + d + "]").prop("disabled", false).siblings("label").html(b);
    if (c.options.startLanguage == d) {
      a("#" + c.id + "_captions_" + d).click()
    }
    c.adjustLanguageBox()
  },addTrackButton: function(d, b) {
    var c = this;
    if (b === "") {
      b = mejs.language.codes[d] || d
    }
    c.captionsButton.find("ul").append(a('<li><input type="radio" name="' + c.id + '_captions" id="' + c.id + "_captions_" + d + '" value="' + d + '" disabled="disabled" /><label for="' + c.id + "_captions_" + d + '">' + b + " (loading)</label></li>"));
    c.adjustLanguageBox();
    c.container.find(".mejs-captions-translations option[value=" + d + "]").remove()
  },adjustLanguageBox: function() {
    var b = this;
    b.captionsButton.find(".mejs-captions-selector").height(b.captionsButton.find(".mejs-captions-selector ul").outerHeight(true) + b.captionsButton.find(".mejs-captions-translations").outerHeight(true))
  },checkForTracks: function() {
    var b = this, c = false;
    if (b.options.hideCaptionsButtonWhenEmpty) {
      for (i = 0; i < b.tracks.length; i++) {
        if (b.tracks[i].kind == "subtitles") {
          c = true;
          break
        }
      }
      if (!c) {
        b.captionsButton.hide();
        b.setControlsSize()
      }
    }
  },displayCaptions: function() {
    if (typeof this.tracks == "undefined") {
      return
    }
    var d = this, c, b = d.selectedTrack;
    if (b != null && b.isLoaded) {
      for (c = 0; c < b.entries.times.length; c++) {
        if (d.media.currentTime >= b.entries.times[c].start && d.media.currentTime <= b.entries.times[c].stop) {
          d.captionsText.html(b.entries.text[c]);
          d.captions.show().height(0);
          return
        }
      }
      d.captions.hide()
    } else {
      d.captions.hide()
    }
  },setupSlides: function(b) {
    var c = this;
    c.slides = b;
    c.slides.entries.imgs = [c.slides.entries.text.length];
    c.showSlide(0)
  },showSlide: function(d) {
    if (typeof this.tracks == "undefined" || typeof this.slidesContainer == "undefined") {
      return
    }
    var e = this, c = e.slides.entries.text[d], b = e.slides.entries.imgs[d];
    if (typeof b == "undefined" || typeof b.fadeIn == "undefined") {
      e.slides.entries.imgs[d] = b = a('<img src="' + c + '">').on("load", function() {
        b.appendTo(e.slidesContainer).hide().fadeIn().siblings(":visible").fadeOut()
      })
    } else {
      if (!b.is(":visible") && !b.is(":animated")) {
        console.log("showing existing slide");
        b.fadeIn().siblings(":visible").fadeOut()
      }
    }
  },displaySlides: function() {
    if (typeof this.slides == "undefined") {
      return
    }
    var c = this, d = c.slides, b;
    for (b = 0; b < d.entries.times.length; b++) {
      if (c.media.currentTime >= d.entries.times[b].start && c.media.currentTime <= d.entries.times[b].stop) {
        c.showSlide(b);
        return
      }
    }
  },displayChapters: function() {
    var c = this, b;
    for (b = 0; b < c.tracks.length; b++) {
      if (c.tracks[b].kind == "chapters" && c.tracks[b].isLoaded) {
        c.drawChapters(c.tracks[b]);
        c.hasChapters = true;
        break
      }
    }
  },drawChapters: function(f) {
    var c = this, b, d, e = 0, g = 0;
    c.chapters.empty();
    for (b = 0; b < f.entries.times.length; b++) {
      d = f.entries.times[b].stop - f.entries.times[b].start;
      e = Math.floor(d / c.media.duration * 100);
      if (e + g > 100 || b == f.entries.times.length - 1 && e + g < 100) {
        e = 100 - g
      }
      c.chapters.append(a('<div class="mejs-chapter" rel="' + f.entries.times[b].start + '" style="left: ' + g.toString() + "%;width: " + e.toString() + '%;"><div class="mejs-chapter-block' + ((b == f.entries.times.length - 1) ? " mejs-chapter-block-last" : "") + '"><span class="ch-title">' + f.entries.text[b] + '</span><span class="ch-time">' + mejs.Utility.secondsToTimeCode(f.entries.times[b].start) + "&ndash;" + mejs.Utility.secondsToTimeCode(f.entries.times[b].stop) + "</span></div></div>"));
      g += e
    }
    c.chapters.find("div.mejs-chapter").click(function() {
      c.media.setCurrentTime(parseFloat(a(this).attr("rel")));
      if (c.media.paused) {
        c.media.play()
      }
    });
    c.chapters.show()
  }});
  mejs.language = {codes: {af: "Afrikaans",sq: "Albanian",ar: "Arabic",be: "Belarusian",bg: "Bulgarian",ca: "Catalan",zh: "Chinese","zh-cn": "Chinese Simplified","zh-tw": "Chinese Traditional",hr: "Croatian",cs: "Czech",da: "Danish",nl: "Dutch",en: "English",et: "Estonian",tl: "Filipino",fi: "Finnish",fr: "French",gl: "Galician",de: "German",el: "Greek",ht: "Haitian Creole",iw: "Hebrew",hi: "Hindi",hu: "Hungarian",is: "Icelandic",id: "Indonesian",ga: "Irish",it: "Italian",ja: "Japanese",ko: "Korean",lv: "Latvian",lt: "Lithuanian",mk: "Macedonian",ms: "Malay",mt: "Maltese",no: "Norwegian",fa: "Persian",pl: "Polish",pt: "Portuguese",ro: "Romanian",ru: "Russian",sr: "Serbian",sk: "Slovak",sl: "Slovenian",es: "Spanish",sw: "Swahili",sv: "Swedish",tl: "Tagalog",th: "Thai",tr: "Turkish",uk: "Ukrainian",vi: "Vietnamese",cy: "Welsh",yi: "Yiddish"}};
  mejs.TrackFormatParser = {webvvt: {pattern_identifier: /^([a-zA-z]+-)?[0-9]+$/,pattern_timecode: /^([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,parse: function(g) {
    var e = 0, d = mejs.TrackFormatParser.split2(g, /\r?\n/), c = {text: [],times: []}, b, f;
    for (; e < d.length; e++) {
      if (this.pattern_identifier.exec(d[e])) {
        e++;
        b = this.pattern_timecode.exec(d[e]);
        if (b && e < d.length) {
          e++;
          f = d[e];
          e++;
          while (d[e] !== "" && e < d.length) {
            f = f + "\n" + d[e];
            e++
          }
          f = a.trim(f).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig, "<a href='$1' target='_blank'>$1</a>");
          c.text.push(f);
          c.times.push({start: (mejs.Utility.convertSMPTEtoSeconds(b[1]) == 0) ? 0.2 : mejs.Utility.convertSMPTEtoSeconds(b[1]),stop: mejs.Utility.convertSMPTEtoSeconds(b[3]),settings: b[5]})
        }
      }
    }
    return c
  }},dfxp: {parse: function(m) {
    m = a(m).filter("tt");
    var k = 0, c = m.children("div").eq(0), q = c.find("p"), h = m.find("#" + c.attr("style")), p, d, f, o, l = {text: [],times: []};
    if (h.length) {
      var g = h.removeAttr("id").get(0).attributes;
      if (g.length) {
        p = {};
        for (k = 0; k < g.length; k++) {
          p[g[k].name.split(":")[1]] = g[k].value
        }
      }
    }
    for (k = 0; k < q.length; k++) {
      var b;
      var n = {start: null,stop: null,style: null};
      if (q.eq(k).attr("begin")) {
        n.start = mejs.Utility.convertSMPTEtoSeconds(q.eq(k).attr("begin"))
      }
      if (!n.start && q.eq(k - 1).attr("end")) {
        n.start = mejs.Utility.convertSMPTEtoSeconds(q.eq(k - 1).attr("end"))
      }
      if (q.eq(k).attr("end")) {
        n.stop = mejs.Utility.convertSMPTEtoSeconds(q.eq(k).attr("end"))
      }
      if (!n.stop && q.eq(k + 1).attr("begin")) {
        n.stop = mejs.Utility.convertSMPTEtoSeconds(q.eq(k + 1).attr("begin"))
      }
      if (p) {
        b = "";
        for (var e in p) {
          b += e + ":" + p[e] + ";"
        }
      }
      if (b) {
        n.style = b
      }
      if (n.start == 0) {
        n.start = 0.2
      }
      l.times.push(n);
      o = a.trim(q.eq(k).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig, "<a href='$1' target='_blank'>$1</a>");
      l.text.push(o);
      if (l.times.start == 0) {
        l.times.start = 2
      }
    }
    return l
  }},split2: function(c, b) {
    return c.split(b)
  }};
  if ("x\n\ny".split(/\n/gi).length != 3) {
    mejs.TrackFormatParser.split2 = function(f, d) {
      var e = [], b = "", c;
      for (c = 0; c < f.length; c++) {
        b += f.substring(c, c + 1);
        if (d.test(b)) {
          e.push(b.replace(d, ""));
          b = ""
        }
      }
      e.push(b);
      return e
    }
  }
})(mejs.$);
(function(a) {
  a.extend(mejs.MepDefaults, {contextMenuItems: [{render: function(b) {
    if (typeof b.enterFullScreen == "undefined") {
      return null
    }
    if (b.isFullScreen) {
      return "Turn off Fullscreen"
    } else {
      return "Go Fullscreen"
    }
  },click: function(b) {
    if (b.isFullScreen) {
      b.exitFullScreen()
    } else {
      b.enterFullScreen()
    }
  }}, {render: function(b) {
    if (b.media.muted) {
      return "Unmute"
    } else {
      return "Mute"
    }
  },click: function(b) {
    if (b.media.muted) {
      b.setMuted(false)
    } else {
      b.setMuted(true)
    }
  }}, {isSeparator: true}, {render: function(b) {
    return "Download Video"
  },click: function(b) {
    window.location.href = b.media.currentSrc
  }}]});
  a.extend(MediaElementPlayer.prototype, {buildcontextmenu: function(c, b, e, d) {
    c.contextMenu = a('<div class="mejs-contextmenu"></div>').appendTo(a("body")).hide();
    c.container.bind("contextmenu", function(f) {
      if (c.isContextMenuEnabled) {
        f.preventDefault();
        c.renderContextMenu(f.clientX - 1, f.clientY - 1);
        return false
      }
    });
    c.container.bind("click", function() {
      c.contextMenu.hide()
    });
    c.contextMenu.bind("mouseleave", function() {
      c.startContextMenuTimer()
    })
  },cleancontextmenu: function(b) {
    b.contextMenu.remove()
  },isContextMenuEnabled: true,enableContextMenu: function() {
    this.isContextMenuEnabled = true
  },disableContextMenu: function() {
    this.isContextMenuEnabled = false
  },contextMenuTimeout: null,startContextMenuTimer: function() {
    var b = this;
    b.killContextMenuTimer();
    b.contextMenuTimer = setTimeout(function() {
      b.hideContextMenu();
      b.killContextMenuTimer()
    }, 750)
  },killContextMenuTimer: function() {
    var b = this.contextMenuTimer;
    if (b != null) {
      clearTimeout(b);
      delete b;
      b = null
    }
  },hideContextMenu: function() {
    this.contextMenu.hide()
  },renderContextMenu: function(b, k) {
    var g = this, f = "", d = g.options.contextMenuItems;
    for (var e = 0, c = d.length; e < c; e++) {
      if (d[e].isSeparator) {
        f += '<div class="mejs-contextmenu-separator"></div>'
      } else {
        var h = d[e].render(g);
        if (h != null) {
          f += '<div class="mejs-contextmenu-item" data-itemindex="' + e + '" id="element-' + (Math.random() * 1000000) + '">' + h + "</div>"
        }
      }
    }
    g.contextMenu.empty().append(a(f)).css({top: k,left: b}).show();
    g.contextMenu.find(".mejs-contextmenu-item").each(function() {
      var l = a(this), m = parseInt(l.data("itemindex"), 10), n = g.options.contextMenuItems[m];
      if (typeof n.show != "undefined") {
        n.show(l, g)
      }
      l.click(function() {
        if (typeof n.click != "undefined") {
          n.click(g)
        }
        g.contextMenu.hide()
      })
    });
    setTimeout(function() {
      g.killControlsTimer("rev3")
    }, 100)
  }})
})(mejs.$);
(function(a) {
  a.extend(mejs.MepDefaults, {postrollCloseText: mejs.i18n.t("Close")});
  a.extend(MediaElementPlayer.prototype, {buildpostroll: function(e, c, g, f) {
    var d = this, b = d.container.find('link[rel="postroll"]').attr("href");
    if (typeof b !== "undefined") {
      e.postroll = a('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="$(this).parent().hide();return false;">' + d.options.postrollCloseText + '</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(g).hide();
      d.media.addEventListener("ended", function(h) {
        a.ajax({dataType: "html",url: b,success: function(k, l) {
          g.find(".mejs-postroll-layer-content").html(k)
        }});
        e.postroll.show()
      }, false)
    }
  }})
})(mejs.$);
(function() {
  var v = 0, q = [], o = {}, s = {}, A = {"<": "lt",">": "gt","&": "amp",'"': "quot","'": "#39"}, p = /[<>&\"\']/g, z, y = window.setTimeout, x = {}, w;
  function t() {
    this.returnValue = false
  }
  function r() {
    this.cancelBubble = true
  }
  (function(e) {
    var d = e.split(/,/), c, a, b;
    for (c = 0; c < d.length; c += 2) {
      b = d[c + 1].split(/ /);
      for (a = 0; a < b.length; a++) {
        s[b[a]] = d[c]
      }
    }
  })("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");
  var u = {VERSION: "1.5.4",STOPPED: 1,STARTED: 2,QUEUED: 1,UPLOADING: 2,FAILED: 4,DONE: 5,GENERIC_ERROR: -100,HTTP_ERROR: -200,IO_ERROR: -300,SECURITY_ERROR: -400,INIT_ERROR: -500,FILE_SIZE_ERROR: -600,FILE_EXTENSION_ERROR: -601,IMAGE_FORMAT_ERROR: -700,IMAGE_MEMORY_ERROR: -701,IMAGE_DIMENSIONS_ERROR: -702,mimeTypes: s,ua: (function() {
    var b = navigator, c = b.userAgent, a = b.vendor, e, f, d;
    e = /WebKit/.test(c);
    d = e && a.indexOf("Apple") !== -1;
    f = window.opera && window.opera.buildNumber;
    return {windows: navigator.platform.indexOf("Win") !== -1,ie: !e && !f && (/MSIE/gi).test(c) && (/Explorer/gi).test(b.appName),webkit: e,gecko: !e && /Gecko/.test(c),safari: d,opera: !!f}
  }()),typeOf: function(a) {
    return ({}).toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()
  },extend: function(a) {
    u.each(arguments, function(c, b) {
      if (b > 0) {
        u.each(c, function(d, e) {
          a[e] = d
        })
      }
    });
    return a
  },cleanName: function(c) {
    var b, a;
    a = [/[\300-\306]/g, "A", /[\340-\346]/g, "a", /\307/g, "C", /\347/g, "c", /[\310-\313]/g, "E", /[\350-\353]/g, "e", /[\314-\317]/g, "I", /[\354-\357]/g, "i", /\321/g, "N", /\361/g, "n", /[\322-\330]/g, "O", /[\362-\370]/g, "o", /[\331-\334]/g, "U", /[\371-\374]/g, "u"];
    for (b = 0; b < a.length; b += 2) {
      c = c.replace(a[b], a[b + 1])
    }
    c = c.replace(/\s+/g, "_");
    c = c.replace(/[^a-z0-9_\-\.]+/gi, "");
    return c
  },addRuntime: function(b, a) {
    a.name = b;
    q[b] = a;
    q.push(a);
    return a
  },guid: function() {
    var b = new Date().getTime().toString(32), a;
    for (a = 0; a < 5; a++) {
      b += Math.floor(Math.random() * 65535).toString(32)
    }
    return (u.guidPrefix || "p") + b + (v++).toString(32)
  },buildUrl: function(b, c) {
    var a = "";
    u.each(c, function(d, e) {
      a += (a ? "&" : "") + encodeURIComponent(e) + "=" + encodeURIComponent(d)
    });
    if (a) {
      b += (b.indexOf("?") > 0 ? "&" : "?") + a
    }
    return b
  },each: function(b, a) {
    var c, d, e;
    if (b) {
      c = b.length;
      if (c === z) {
        for (d in b) {
          if (b.hasOwnProperty(d)) {
            if (a(b[d], d) === false) {
              return
            }
          }
        }
      } else {
        for (e = 0; e < c; e++) {
          if (a(b[e], e) === false) {
            return
          }
        }
      }
    }
  },formatSize: function(a) {
    if (a === z || /\D/.test(a)) {
      return u.translate("N/A")
    }
    if (a > 1073741824) {
      return Math.round(a / 1073741824, 1) + " GB"
    }
    if (a > 1048576) {
      return Math.round(a / 1048576, 1) + " MB"
    }
    if (a > 1024) {
      return Math.round(a / 1024, 1) + " KB"
    }
    return a + " b"
  },getPos: function(c, h) {
    var g = 0, k = 0, e, f = document, b, a;
    c = c;
    h = h || f.body;
    function d(E) {
      var l, F, n = 0, m = 0;
      if (E) {
        F = E.getBoundingClientRect();
        l = f.compatMode === "CSS1Compat" ? f.documentElement : f.body;
        n = F.left + l.scrollLeft;
        m = F.top + l.scrollTop
      }
      return {x: n,y: m}
    }
    if (c && c.getBoundingClientRect && ((navigator.userAgent.indexOf("MSIE") > 0) && (f.documentMode < 8))) {
      b = d(c);
      a = d(h);
      return {x: b.x - a.x,y: b.y - a.y}
    }
    e = c;
    while (e && e != h && e.nodeType) {
      g += e.offsetLeft || 0;
      k += e.offsetTop || 0;
      e = e.offsetParent
    }
    e = c.parentNode;
    while (e && e != h && e.nodeType) {
      g -= e.scrollLeft || 0;
      k -= e.scrollTop || 0;
      e = e.parentNode
    }
    return {x: g,y: k}
  },getSize: function(a) {
    return {w: a.offsetWidth || a.clientWidth,h: a.offsetHeight || a.clientHeight}
  },parseSize: function(b) {
    var a;
    if (typeof (b) == "string") {
      b = /^([0-9]+)([mgk]?)$/.exec(b.toLowerCase().replace(/[^0-9mkg]/g, ""));
      a = b[2];
      b = +b[1];
      if (a == "g") {
        b *= 1073741824
      }
      if (a == "m") {
        b *= 1048576
      }
      if (a == "k") {
        b *= 1024
      }
    }
    return b
  },xmlEncode: function(a) {
    return a ? ("" + a).replace(p, function(b) {
      return A[b] ? "&" + A[b] + ";" : b
    }) : a
  },toArray: function(a) {
    var b, c = [];
    for (b = 0; b < a.length; b++) {
      c[b] = a[b]
    }
    return c
  },inArray: function(b, a) {
    if (a) {
      if (Array.prototype.indexOf) {
        return Array.prototype.indexOf.call(a, b)
      }
      for (var d = 0, c = a.length; d < c; d++) {
        if (a[d] === b) {
          return d
        }
      }
    }
    return -1
  },addI18n: function(a) {
    return u.extend(o, a)
  },translate: function(a) {
    return o[a] || a
  },isEmptyObj: function(b) {
    if (b === z) {
      return true
    }
    for (var a in b) {
      return false
    }
    return true
  },hasClass: function(a, b) {
    var c;
    if (a.className == "") {
      return false
    }
    c = new RegExp("(^|\\s+)" + b + "(\\s+|$)");
    return c.test(a.className)
  },addClass: function(a, b) {
    if (!u.hasClass(a, b)) {
      a.className = a.className == "" ? b : a.className.replace(/\s+$/, "") + " " + b
    }
  },removeClass: function(a, b) {
    var c = new RegExp("(^|\\s+)" + b + "(\\s+|$)");
    a.className = a.className.replace(c, function(e, f, d) {
      return f === " " && d === " " ? " " : ""
    })
  },getStyle: function(a, b) {
    if (a.currentStyle) {
      return a.currentStyle[b]
    } else {
      if (window.getComputedStyle) {
        return window.getComputedStyle(a, null)[b]
      }
    }
  },addEvent: function(b, g, a) {
    var c, d, e, f;
    f = arguments[3];
    g = g.toLowerCase();
    if (w === z) {
      w = "Plupload_" + u.guid()
    }
    if (b.addEventListener) {
      c = a;
      b.addEventListener(g, c, false)
    } else {
      if (b.attachEvent) {
        c = function() {
          var h = window.event;
          if (!h.target) {
            h.target = h.srcElement
          }
          h.preventDefault = t;
          h.stopPropagation = r;
          a(h)
        };
        b.attachEvent("on" + g, c)
      }
    }
    if (b[w] === z) {
      b[w] = u.guid()
    }
    if (!x.hasOwnProperty(b[w])) {
      x[b[w]] = {}
    }
    d = x[b[w]];
    if (!d.hasOwnProperty(g)) {
      d[g] = []
    }
    d[g].push({func: c,orig: a,key: f})
  },removeEvent: function(b, g) {
    var d, a, e;
    if (typeof (arguments[2]) == "function") {
      a = arguments[2]
    } else {
      e = arguments[2]
    }
    g = g.toLowerCase();
    if (b[w] && x[b[w]] && x[b[w]][g]) {
      d = x[b[w]][g]
    } else {
      return
    }
    for (var f = d.length - 1; f >= 0; f--) {
      if (d[f].key === e || d[f].orig === a) {
        if (b.removeEventListener) {
          b.removeEventListener(g, d[f].func, false)
        } else {
          if (b.detachEvent) {
            b.detachEvent("on" + g, d[f].func)
          }
        }
        d[f].orig = null;
        d[f].func = null;
        d.splice(f, 1);
        if (a !== z) {
          break
        }
      }
    }
    if (!d.length) {
      delete x[b[w]][g]
    }
    if (u.isEmptyObj(x[b[w]])) {
      delete x[b[w]];
      try {
        delete b[w]
      } catch (c) {
        b[w] = z
      }
    }
  },removeAllEvents: function(a) {
    var b = arguments[1];
    if (a[w] === z || !a[w]) {
      return
    }
    u.each(x[a[w]], function(c, d) {
      u.removeEvent(a, d, b)
    })
  }};
  u.Uploader = function(d) {
    var g = {}, a, b = [], e, f = false;
    a = new u.QueueProgress();
    d = u.extend({chunk_size: 0,multipart: true,multi_selection: true,file_data_name: "file",filters: []}, d);
    function c() {
      var k, m = 0, l;
      if (this.state == u.STARTED) {
        for (l = 0; l < b.length; l++) {
          if (!k && b[l].status == u.QUEUED) {
            k = b[l];
            k.status = u.UPLOADING;
            if (this.trigger("BeforeUpload", k)) {
              this.trigger("UploadFile", k)
            }
          } else {
            m++
          }
        }
        if (m == b.length) {
          this.stop();
          this.trigger("UploadComplete", b)
        }
      }
    }
    function h() {
      var k, l;
      a.reset();
      for (k = 0; k < b.length; k++) {
        l = b[k];
        if (l.size !== z) {
          a.size += l.size;
          a.loaded += l.loaded
        } else {
          a.size = z
        }
        if (l.status == u.DONE) {
          a.uploaded++
        } else {
          if (l.status == u.FAILED) {
            a.failed++
          } else {
            a.queued++
          }
        }
      }
      if (a.size === z) {
        a.percent = b.length > 0 ? Math.ceil(a.uploaded / b.length * 100) : 0
      } else {
        a.bytesPerSec = Math.ceil(a.loaded / ((+new Date() - e || 1) / 1000));
        a.percent = a.size > 0 ? Math.ceil(a.loaded / a.size * 100) : 0
      }
    }
    u.extend(this, {state: u.STOPPED,runtime: "",features: {},files: b,settings: d,total: a,id: u.guid(),init: function() {
      var F = this, D, E, l, k = 0, n;
      if (typeof (d.preinit) == "function") {
        d.preinit(F)
      } else {
        u.each(d.preinit, function(B, C) {
          F.bind(C, B)
        })
      }
      d.page_url = d.page_url || document.location.pathname.replace(/\/[^\/]+$/g, "/");
      if (!/^(\w+:\/\/|\/)/.test(d.url)) {
        d.url = d.page_url + d.url
      }
      d.chunk_size = u.parseSize(d.chunk_size);
      d.max_file_size = u.parseSize(d.max_file_size);
      F.bind("FilesAdded", function(O, L) {
        var M, N, C = 0, B, K = d.filters;
        if (K && K.length) {
          B = [];
          u.each(K, function(G) {
            u.each(G.extensions.split(/,/), function(H) {
              if (/^\s*\*\s*$/.test(H)) {
                B.push("\\.*")
              } else {
                B.push("\\." + H.replace(new RegExp("[" + ("/^$.*+?|()[]{}\\".replace(/./g, "\\$&")) + "]", "g"), "\\$&"))
              }
            })
          });
          B = new RegExp(B.join("|") + "$", "i")
        }
        for (M = 0; M < L.length; M++) {
          N = L[M];
          N.loaded = 0;
          N.percent = 0;
          N.status = u.QUEUED;
          if (B && !B.test(N.name)) {
            O.trigger("Error", {code: u.FILE_EXTENSION_ERROR,message: u.translate("File extension error."),file: N});
            continue
          }
          if (N.size !== z && N.size > d.max_file_size) {
            O.trigger("Error", {code: u.FILE_SIZE_ERROR,message: u.translate("File size error."),file: N});
            continue
          }
          b.push(N);
          C++
        }
        if (C) {
          y(function() {
            F.trigger("QueueChanged");
            F.refresh()
          }, 1)
        } else {
          return false
        }
      });
      if (d.unique_names) {
        F.bind("UploadFile", function(I, H) {
          var B = H.name.match(/\.([^.]+)$/), C = "tmp";
          if (B) {
            C = B[1]
          }
          H.target_name = H.id + "." + C
        })
      }
      F.bind("UploadProgress", function(C, B) {
        B.percent = B.size > 0 ? Math.ceil(B.loaded / B.size * 100) : 100;
        h()
      });
      F.bind("StateChanged", function(B) {
        if (B.state == u.STARTED) {
          e = (+new Date())
        } else {
          if (B.state == u.STOPPED) {
            for (D = B.files.length - 1; D >= 0; D--) {
              if (B.files[D].status == u.UPLOADING) {
                B.files[D].status = u.QUEUED;
                h()
              }
            }
          }
        }
      });
      F.bind("QueueChanged", h);
      F.bind("Error", function(C, B) {
        if (B.file) {
          B.file.status = u.FAILED;
          h();
          if (C.state == u.STARTED) {
            y(function() {
              c.call(F)
            }, 1)
          }
        }
      });
      F.bind("FileUploaded", function(C, B) {
        B.status = u.DONE;
        B.loaded = B.size;
        C.trigger("UploadProgress", B);
        y(function() {
          c.call(F)
        }, 1)
      });
      if (d.runtimes) {
        E = [];
        n = d.runtimes.split(/\s?,\s?/);
        for (D = 0; D < n.length; D++) {
          if (q[n[D]]) {
            E.push(q[n[D]])
          }
        }
      } else {
        E = q
      }
      function m() {
        var B = E[k++], C, I, H;
        if (B) {
          C = B.getFeatures();
          I = F.settings.required_features;
          if (I) {
            I = I.split(",");
            for (H = 0; H < I.length; H++) {
              if (!C[I[H]]) {
                m();
                return
              }
            }
          }
          B.init(F, function(G) {
            if (G && G.success) {
              F.features = C;
              F.runtime = B.name;
              F.trigger("Init", {runtime: B.name});
              F.trigger("PostInit");
              F.refresh()
            } else {
              m()
            }
          })
        } else {
          F.trigger("Error", {code: u.INIT_ERROR,message: u.translate("Init error.")})
        }
      }
      m();
      if (typeof (d.init) == "function") {
        d.init(F)
      } else {
        u.each(d.init, function(B, C) {
          F.bind(C, B)
        })
      }
    },refresh: function() {
      this.trigger("Refresh")
    },start: function() {
      if (b.length && this.state != u.STARTED) {
        this.state = u.STARTED;
        this.trigger("StateChanged");
        c.call(this)
      }
    },stop: function() {
      if (this.state != u.STOPPED) {
        this.state = u.STOPPED;
        this.trigger("CancelUpload");
        this.trigger("StateChanged")
      }
    },disableBrowse: function() {
      f = arguments[0] !== z ? arguments[0] : true;
      this.trigger("DisableBrowse", f)
    },getFile: function(k) {
      var l;
      for (l = b.length - 1; l >= 0; l--) {
        if (b[l].id === k) {
          return b[l]
        }
      }
    },removeFile: function(k) {
      var l;
      for (l = b.length - 1; l >= 0; l--) {
        if (b[l].id === k.id) {
          return this.splice(l, 1)[0]
        }
      }
    },splice: function(m, l) {
      var k;
      k = b.splice(m === z ? 0 : m, l === z ? b.length : l);
      this.trigger("FilesRemoved", k);
      this.trigger("QueueChanged");
      return k
    },trigger: function(k) {
      var m = g[k.toLowerCase()], n, l;
      if (m) {
        l = Array.prototype.slice.call(arguments);
        l[0] = this;
        for (n = 0; n < m.length; n++) {
          if (m[n].func.apply(m[n].scope, l) === false) {
            return false
          }
        }
      }
      return true
    },hasEventListener: function(k) {
      return !!g[k.toLowerCase()]
    },bind: function(l, n, k) {
      var m;
      l = l.toLowerCase();
      m = g[l] || [];
      m.push({func: n,scope: k || this});
      g[l] = m
    },unbind: function(l) {
      l = l.toLowerCase();
      var m = g[l], k, n = arguments[1];
      if (m) {
        if (n !== z) {
          for (k = m.length - 1; k >= 0; k--) {
            if (m[k].func === n) {
              m.splice(k, 1);
              break
            }
          }
        } else {
          m = []
        }
        if (!m.length) {
          delete g[l]
        }
      }
    },unbindAll: function() {
      var k = this;
      u.each(g, function(m, l) {
        k.unbind(l)
      })
    },destroy: function() {
      this.stop();
      this.trigger("Destroy");
      this.unbindAll()
    }})
  };
  u.File = function(a, c, b) {
    var d = this;
    d.id = a;
    d.name = c;
    d.size = b;
    d.loaded = 0;
    d.percent = 0;
    d.status = 0
  };
  u.Runtime = function() {
    this.getFeatures = function() {
    };
    this.init = function(b, a) {
    }
  };
  u.QueueProgress = function() {
    var a = this;
    a.size = 0;
    a.loaded = 0;
    a.uploaded = 0;
    a.failed = 0;
    a.queued = 0;
    a.percent = 0;
    a.bytesPerSec = 0;
    a.reset = function() {
      a.size = a.loaded = a.uploaded = a.failed = a.queued = a.percent = a.bytesPerSec = 0
    }
  };
  u.runtimes = {};
  window.plupload = u
})();
(function() {
  if (window.google && google.gears) {
    return
  }
  var d = null;
  if (typeof GearsFactory != "undefined") {
    d = new GearsFactory()
  } else {
    try {
      d = new ActiveXObject("Gears.Factory");
      if (d.getBuildInfo().indexOf("ie_mobile") != -1) {
        d.privateSetGlobalObject(this)
      }
    } catch (c) {
      if ((typeof navigator.mimeTypes != "undefined") && navigator.mimeTypes["application/x-googlegears"]) {
        d = document.createElement("object");
        d.style.display = "none";
        d.width = 0;
        d.height = 0;
        d.type = "application/x-googlegears";
        document.documentElement.appendChild(d)
      }
    }
  }
  if (!d) {
    return
  }
  if (!window.google) {
    window.google = {}
  }
  if (!google.gears) {
    google.gears = {factory: d}
  }
})();
(function(l, g, n, m) {
  var k = {};
  function h(e, c, a) {
    var f, d, b, p;
    d = google.gears.factory.create("beta.canvas");
    try {
      d.decode(e);
      if (!c.width) {
        c.width = d.width
      }
      if (!c.height) {
        c.height = d.height
      }
      p = Math.min(width / d.width, height / d.height);
      if (p < 1 || (p === 1 && a === "image/jpeg")) {
        d.resize(Math.round(d.width * p), Math.round(d.height * p));
        if (c.quality) {
          return d.encode(a, {quality: c.quality / 100})
        }
        return d.encode(a)
      }
    } catch (q) {
    }
    return e
  }
  n.runtimes.Gears = n.addRuntime("gears", {getFeatures: function() {
    return {dragdrop: true,jpgresize: true,pngresize: true,chunks: true,progress: true,multipart: true,multi_selection: true}
  },init: function(b, o) {
    var a, e, f = false;
    if (!l.google || !google.gears) {
      return o({success: false})
    }
    try {
      a = google.gears.factory.create("beta.desktop")
    } catch (c) {
      return o({success: false})
    }
    function d(v) {
      var w, x, u = [], t;
      for (x = 0; x < v.length; x++) {
        w = v[x];
        t = n.guid();
        k[t] = w.blob;
        u.push(new n.File(t, w.name, w.blob.length))
      }
      b.trigger("FilesAdded", u)
    }
    b.bind("PostInit", function() {
      var q = b.settings, r = g.getElementById(q.drop_element);
      if (r) {
        n.addEvent(r, "dragover", function(p) {
          a.setDropEffect(p, "copy");
          p.preventDefault()
        }, b.id);
        n.addEvent(r, "drop", function(p) {
          var s = a.getDragData(p, "application/x-gears-files");
          if (s) {
            d(s.files)
          }
          p.preventDefault()
        }, b.id);
        r = 0
      }
      n.addEvent(g.getElementById(q.browse_button), "click", function(p) {
        var v = [], x, y, w;
        p.preventDefault();
        if (f) {
          return
        }
        no_type_restriction: for (x = 0; x < q.filters.length; x++) {
          w = q.filters[x].extensions.split(",");
          for (y = 0; y < w.length; y++) {
            if (w[y] === "*") {
              v = [];
              break no_type_restriction
            }
            v.push("." + w[y])
          }
        }
        a.openFiles(d, {singleFile: !q.multi_selection,filter: v})
      }, b.id)
    });
    b.bind("CancelUpload", function() {
      if (e.abort) {
        e.abort()
      }
    });
    b.bind("UploadFile", function(D, x) {
      var B = 0, C, F, E = 0, y = D.settings.resize, A;
      if (y && /\.(png|jpg|jpeg)$/i.test(x.name)) {
        k[x.id] = h(k[x.id], y, /\.png$/i.test(x.name) ? "image/png" : "image/jpeg")
      }
      x.size = k[x.id].length;
      F = D.settings.chunk_size;
      A = F > 0;
      C = Math.ceil(x.size / F);
      if (!A) {
        F = x.size;
        C = 1
      }
      function z() {
        var s, u = D.settings.multipart, q = 0, t = {name: x.target_name || x.name}, r = D.settings.url;
        function p(N) {
          var O, v = "----pluploadboundary" + n.guid(), L = "--", w = "\r\n", M, K;
          if (u) {
            e.setRequestHeader("Content-Type", "multipart/form-data; boundary=" + v);
            O = google.gears.factory.create("beta.blobbuilder");
            n.each(n.extend(t, D.settings.multipart_params), function(G, H) {
              O.append(L + v + w + 'Content-Disposition: form-data; name="' + H + '"' + w + w);
              O.append(G + w)
            });
            K = n.mimeTypes[x.name.replace(/^.+\.([^.]+)/, "$1").toLowerCase()] || "application/octet-stream";
            O.append(L + v + w + 'Content-Disposition: form-data; name="' + D.settings.file_data_name + '"; filename="' + x.name + '"' + w + "Content-Type: " + K + w + w);
            O.append(N);
            O.append(w + L + v + L + w);
            M = O.getAsBlob();
            q = M.length - N.length;
            N = M
          }
          e.send(N)
        }
        if (x.status == n.DONE || x.status == n.FAILED || D.state == n.STOPPED) {
          return
        }
        if (A) {
          t.chunk = B;
          t.chunks = C
        }
        s = Math.min(F, x.size - (B * F));
        if (!u) {
          r = n.buildUrl(D.settings.url, t)
        }
        e = google.gears.factory.create("beta.httprequest");
        e.open("POST", r);
        if (!u) {
          e.setRequestHeader("Content-Disposition", 'attachment; filename="' + x.name + '"');
          e.setRequestHeader("Content-Type", "application/octet-stream")
        }
        n.each(D.settings.headers, function(v, w) {
          e.setRequestHeader(w, v)
        });
        e.upload.onprogress = function(v) {
          x.loaded = E + v.loaded - q;
          D.trigger("UploadProgress", x)
        };
        e.onreadystatechange = function() {
          var v;
          if (e.readyState == 4 && D.state !== n.STOPPED) {
            if (e.status == 200) {
              v = {chunk: B,chunks: C,response: e.responseText,status: e.status};
              D.trigger("ChunkUploaded", x, v);
              if (v.cancelled) {
                x.status = n.FAILED;
                return
              }
              E += s;
              if (++B >= C) {
                x.status = n.DONE;
                D.trigger("FileUploaded", x, {response: e.responseText,status: e.status})
              } else {
                z()
              }
            } else {
              D.trigger("Error", {code: n.HTTP_ERROR,message: n.translate("HTTP Error."),file: x,chunk: B,chunks: C,status: e.status})
            }
          }
        };
        if (B < C) {
          p(k[x.id].slice(B * F, s))
        }
      }
      z()
    });
    b.bind("DisableBrowse", function(r, q) {
      f = q
    });
    b.bind("Destroy", function(v) {
      var u, t, s = {browseButton: v.settings.browse_button,dropElm: v.settings.drop_element};
      for (u in s) {
        t = g.getElementById(s[u]);
        if (t) {
          n.removeAllEvents(t, v.id)
        }
      }
    });
    o({success: true})
  }})
})(window, document, plupload);
(function(n, k, q, p) {
  var l = {}, m = {};
  function r(e) {
    var f, a = typeof e, d, b, c;
    if (e === p || e === null) {
      return "null"
    }
    if (a === "string") {
      f = "\bb\tt\nn\ff\rr\"\"''\\\\";
      return '"' + e.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g, function(g, h) {
        var s = f.indexOf(h);
        if (s + 1) {
          return "\\" + f.charAt(s + 1)
        }
        g = h.charCodeAt().toString(16);
        return "\\u" + "0000".substring(g.length) + g
      }) + '"'
    }
    if (a == "object") {
      d = e.length !== p;
      f = "";
      if (d) {
        for (b = 0; b < e.length; b++) {
          if (f) {
            f += ","
          }
          f += r(e[b])
        }
        f = "[" + f + "]"
      } else {
        for (c in e) {
          if (e.hasOwnProperty(c)) {
            if (f) {
              f += ","
            }
            f += r(c) + ":" + r(e[c])
          }
        }
        f = "{" + f + "}"
      }
      return f
    }
    return "" + e
  }
  function o(A) {
    var x = false, w = null, d = null, h, g, f, y, e, b = 0;
    try {
      try {
        d = new ActiveXObject("AgControl.AgControl");
        if (d.IsVersionSupported(A)) {
          x = true
        }
        d = null
      } catch (a) {
        var c = navigator.plugins["Silverlight Plug-In"];
        if (c) {
          h = c.description;
          if (h === "1.0.30226.2") {
            h = "2.0.30226.2"
          }
          g = h.split(".");
          while (g.length > 3) {
            g.pop()
          }
          while (g.length < 4) {
            g.push(0)
          }
          f = A.split(".");
          while (f.length > 4) {
            f.pop()
          }
          do {
            y = parseInt(f[b], 10);
            e = parseInt(g[b], 10);
            b++
          } while (b < f.length && y === e);
          if (y <= e && !isNaN(y)) {
            x = true
          }
        }
      }
    } catch (z) {
      x = false
    }
    return x
  }
  q.silverlight = {trigger: function(e, c) {
    var a = l[e], b, d;
    if (a) {
      d = q.toArray(arguments).slice(1);
      d[0] = "Silverlight:" + c;
      setTimeout(function() {
        a.trigger.apply(a, d)
      }, 0)
    }
  }};
  q.runtimes.Silverlight = q.addRuntime("silverlight", {getFeatures: function() {
    return {jpgresize: true,pngresize: true,chunks: true,progress: true,multipart: true,multi_selection: true}
  },init: function(f, e) {
    var g, a = "", h = f.settings.filters, b, c = k.body;
    if (!o("2.0.31005.0") || (n.opera && n.opera.buildNumber)) {
      e({success: false});
      return
    }
    m[f.id] = false;
    l[f.id] = f;
    g = k.createElement("div");
    g.id = f.id + "_silverlight_container";
    q.extend(g.style, {position: "absolute",top: "0px",background: f.settings.shim_bgcolor || "transparent",zIndex: 99999,width: "100px",height: "100px",overflow: "hidden",opacity: f.settings.shim_bgcolor || k.documentMode > 8 ? "" : 0.01});
    g.className = "plupload silverlight";
    if (f.settings.container) {
      c = k.getElementById(f.settings.container);
      if (q.getStyle(c, "position") === "static") {
        c.style.position = "relative"
      }
    }
    c.appendChild(g);
    for (b = 0; b < h.length; b++) {
      a += (a != "" ? "|" : "") + h[b].title + " | *." + h[b].extensions.replace(/,/g, ";*.")
    }
    g.innerHTML = '<object id="' + f.id + '_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="' + f.settings.silverlight_xap_url + '"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="id=' + f.id + ",filter=" + a + ",multiselect=" + f.settings.multi_selection + '"/></object>';
    function d() {
      return k.getElementById(f.id + "_silverlight").content.Upload
    }
    f.bind("Silverlight:Init", function() {
      var u, t = {};
      if (m[f.id]) {
        return
      }
      m[f.id] = true;
      f.bind("Silverlight:StartSelectFiles", function(s) {
        u = []
      });
      f.bind("Silverlight:SelectFile", function(B, y, A, z) {
        var s;
        s = q.guid();
        t[s] = y;
        t[y] = s;
        u.push(new q.File(s, A, z))
      });
      f.bind("Silverlight:SelectSuccessful", function() {
        if (u.length) {
          f.trigger("FilesAdded", u)
        }
      });
      f.bind("Silverlight:UploadChunkError", function(B, y, A, s, z) {
        f.trigger("Error", {code: q.IO_ERROR,message: "IO Error.",details: z,file: B.getFile(t[y])})
      });
      f.bind("Silverlight:UploadFileProgress", function(B, s, A, y) {
        var z = B.getFile(t[s]);
        if (z.status != q.FAILED) {
          z.size = y;
          z.loaded = A;
          B.trigger("UploadProgress", z)
        }
      });
      f.bind("Refresh", function(z) {
        var y, x, s;
        y = k.getElementById(z.settings.browse_button);
        if (y) {
          x = q.getPos(y, k.getElementById(z.settings.container));
          s = q.getSize(y);
          q.extend(k.getElementById(z.id + "_silverlight_container").style, {top: x.y + "px",left: x.x + "px",width: s.w + "px",height: s.h + "px"})
        }
      });
      f.bind("Silverlight:UploadChunkSuccessful", function(D, A, C, E, F) {
        var s, B = D.getFile(t[A]);
        s = {chunk: C,chunks: E,response: F};
        D.trigger("ChunkUploaded", B, s);
        if (B.status != q.FAILED && D.state !== q.STOPPED) {
          d().UploadNextChunk()
        }
        if (C == E - 1) {
          B.status = q.DONE;
          D.trigger("FileUploaded", B, {response: F})
        }
      });
      f.bind("Silverlight:UploadSuccessful", function(z, s, y) {
        var x = z.getFile(t[s]);
        x.status = q.DONE;
        z.trigger("FileUploaded", x, {response: y})
      });
      f.bind("FilesRemoved", function(x, s) {
        var w;
        for (w = 0; w < s.length; w++) {
          d().RemoveFile(t[s[w].id])
        }
      });
      f.bind("UploadFile", function(z, x) {
        var s = z.settings, y = s.resize || {};
        d().UploadFile(t[x.id], z.settings.url, r({name: x.target_name || x.name,mime: q.mimeTypes[x.name.replace(/^.+\.([^.]+)/, "$1").toLowerCase()] || "application/octet-stream",chunk_size: s.chunk_size,image_width: y.width,image_height: y.height,image_quality: y.quality || 90,multipart: !!s.multipart,multipart_params: s.multipart_params || {},file_data_name: s.file_data_name,headers: s.headers}))
      });
      f.bind("CancelUpload", function() {
        d().CancelUpload()
      });
      f.bind("Silverlight:MouseEnter", function(x) {
        var w, s;
        w = k.getElementById(f.settings.browse_button);
        s = x.settings.browse_button_hover;
        if (w && s) {
          q.addClass(w, s)
        }
      });
      f.bind("Silverlight:MouseLeave", function(x) {
        var w, s;
        w = k.getElementById(f.settings.browse_button);
        s = x.settings.browse_button_hover;
        if (w && s) {
          q.removeClass(w, s)
        }
      });
      f.bind("Silverlight:MouseLeftButtonDown", function(x) {
        var w, s;
        w = k.getElementById(f.settings.browse_button);
        s = x.settings.browse_button_active;
        if (w && s) {
          q.addClass(w, s);
          q.addEvent(k.body, "mouseup", function() {
            q.removeClass(w, s)
          })
        }
      });
      f.bind("Sliverlight:StartSelectFiles", function(x) {
        var w, s;
        w = k.getElementById(f.settings.browse_button);
        s = x.settings.browse_button_active;
        if (w && s) {
          q.removeClass(w, s)
        }
      });
      f.bind("DisableBrowse", function(v, s) {
        d().DisableBrowse(s)
      });
      f.bind("Destroy", function(v) {
        var s;
        q.removeAllEvents(k.body, v.id);
        delete m[v.id];
        delete l[v.id];
        s = k.getElementById(v.id + "_silverlight_container");
        if (s) {
          c.removeChild(s)
        }
      });
      e({success: true})
    })
  }})
})(window, document, plupload);
(function(m, h, o, n) {
  var k = {}, l = {};
  function p() {
    var c;
    try {
      c = navigator.plugins["Shockwave Flash"];
      c = c.description
    } catch (a) {
      try {
        c = new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")
      } catch (b) {
        c = "0.0"
      }
    }
    c = c.match(/\d+/g);
    return parseFloat(c[0] + "." + c[1])
  }
  o.flash = {trigger: function(a, c, b) {
    setTimeout(function() {
      var f = k[a], d, e;
      if (f) {
        f.trigger("Flash:" + c, b)
      }
    }, 0)
  }};
  o.runtimes.Flash = o.addRuntime("flash", {getFeatures: function() {
    return {jpgresize: true,pngresize: true,maxWidth: 8091,maxHeight: 8091,chunks: true,progress: true,multipart: true,multi_selection: true}
  },init: function(q, f) {
    var b, a, e = 0, d = h.body;
    if (p() < 10) {
      f({success: false});
      return
    }
    l[q.id] = false;
    k[q.id] = q;
    b = h.getElementById(q.settings.browse_button);
    a = h.createElement("div");
    a.id = q.id + "_flash_container";
    o.extend(a.style, {position: "absolute",top: "0px",background: q.settings.shim_bgcolor || "transparent",zIndex: 99999,width: "100%",height: "100%"});
    a.className = "plupload flash";
    if (q.settings.container) {
      d = h.getElementById(q.settings.container);
      if (o.getStyle(d, "position") === "static") {
        d.style.position = "relative"
      }
    }
    d.appendChild(a);
    (function() {
      var t, s;
      t = '<object id="' + q.id + '_flash" type="application/x-shockwave-flash" data="' + q.settings.flash_swf_url + '" ';
      if (o.ua.ie) {
        t += 'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '
      }
      t += 'width="100%" height="100%" style="outline:0"><param name="movie" value="' + q.settings.flash_swf_url + '" /><param name="flashvars" value="id=' + escape(q.id) + '" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';
      if (o.ua.ie) {
        s = h.createElement("div");
        a.appendChild(s);
        s.outerHTML = t;
        s = null
      } else {
        a.innerHTML = t
      }
    }());
    function g() {
      return h.getElementById(q.id + "_flash")
    }
    function c() {
      if (e++ > 5000) {
        f({success: false});
        return
      }
      if (l[q.id] === false) {
        setTimeout(c, 1)
      }
    }
    c();
    b = a = null;
    q.bind("Destroy", function(t) {
      var s;
      o.removeAllEvents(h.body, t.id);
      delete l[t.id];
      delete k[t.id];
      s = h.getElementById(t.id + "_flash_container");
      if (s) {
        d.removeChild(s)
      }
    });
    q.bind("Flash:Init", function() {
      var t = {}, u;
      try {
        g().setFileFilters(q.settings.filters, q.settings.multi_selection)
      } catch (v) {
        f({success: false});
        return
      }
      if (l[q.id]) {
        return
      }
      l[q.id] = true;
      q.bind("UploadFile", function(y, s) {
        var r = y.settings, x = q.settings.resize || {};
        g().uploadFile(t[s.id], r.url, {name: s.target_name || s.name,mime: o.mimeTypes[s.name.replace(/^.+\.([^.]+)/, "$1").toLowerCase()] || "application/octet-stream",chunk_size: r.chunk_size,width: x.width,height: x.height,quality: x.quality,multipart: r.multipart,multipart_params: r.multipart_params || {},file_data_name: r.file_data_name,format: /\.(jpg|jpeg)$/i.test(s.name) ? "jpg" : "png",headers: r.headers,urlstream_upload: r.urlstream_upload})
      });
      q.bind("CancelUpload", function() {
        g().cancelUpload()
      });
      q.bind("Flash:UploadProcess", function(s, w) {
        var r = s.getFile(t[w.id]);
        if (r.status != o.FAILED) {
          r.loaded = w.loaded;
          r.size = w.size;
          s.trigger("UploadProgress", r)
        }
      });
      q.bind("Flash:UploadChunkComplete", function(y, s) {
        var r, x = y.getFile(t[s.id]);
        r = {chunk: s.chunk,chunks: s.chunks,response: s.text};
        y.trigger("ChunkUploaded", x, r);
        if (x.status !== o.FAILED && y.state !== o.STOPPED) {
          g().uploadNextChunk()
        }
        if (s.chunk == s.chunks - 1) {
          x.status = o.DONE;
          y.trigger("FileUploaded", x, {response: s.text})
        }
      });
      q.bind("Flash:SelectFiles", function(B, s) {
        var z, A, r = [], C;
        for (A = 0; A < s.length; A++) {
          z = s[A];
          C = o.guid();
          t[C] = z.id;
          t[z.id] = C;
          r.push(new o.File(C, z.name, z.size))
        }
        if (r.length) {
          q.trigger("FilesAdded", r)
        }
      });
      q.bind("Flash:SecurityError", function(s, r) {
        q.trigger("Error", {code: o.SECURITY_ERROR,message: o.translate("Security error."),details: r.message,file: q.getFile(t[r.id])})
      });
      q.bind("Flash:GenericError", function(s, r) {
        q.trigger("Error", {code: o.GENERIC_ERROR,message: o.translate("Generic error."),details: r.message,file: q.getFile(t[r.id])})
      });
      q.bind("Flash:IOError", function(s, r) {
        q.trigger("Error", {code: o.IO_ERROR,message: o.translate("IO error."),details: r.message,file: q.getFile(t[r.id])})
      });
      q.bind("Flash:ImageError", function(s, r) {
        q.trigger("Error", {code: parseInt(r.code, 10),message: o.translate("Image error."),file: q.getFile(t[r.id])})
      });
      q.bind("Flash:StageEvent:rollOver", function(w) {
        var s, r;
        s = h.getElementById(q.settings.browse_button);
        r = w.settings.browse_button_hover;
        if (s && r) {
          o.addClass(s, r)
        }
      });
      q.bind("Flash:StageEvent:rollOut", function(w) {
        var s, r;
        s = h.getElementById(q.settings.browse_button);
        r = w.settings.browse_button_hover;
        if (s && r) {
          o.removeClass(s, r)
        }
      });
      q.bind("Flash:StageEvent:mouseDown", function(w) {
        var s, r;
        s = h.getElementById(q.settings.browse_button);
        r = w.settings.browse_button_active;
        if (s && r) {
          o.addClass(s, r);
          o.addEvent(h.body, "mouseup", function() {
            o.removeClass(s, r)
          }, w.id)
        }
      });
      q.bind("Flash:StageEvent:mouseUp", function(w) {
        var s, r;
        s = h.getElementById(q.settings.browse_button);
        r = w.settings.browse_button_active;
        if (s && r) {
          o.removeClass(s, r)
        }
      });
      q.bind("Flash:ExifData", function(s, r) {
        q.trigger("ExifData", q.getFile(t[r.id]), r.data)
      });
      q.bind("Flash:GpsData", function(s, r) {
        q.trigger("GpsData", q.getFile(t[r.id]), r.data)
      });
      q.bind("QueueChanged", function(r) {
        q.refresh()
      });
      q.bind("FilesRemoved", function(w, r) {
        var s;
        for (s = 0; s < r.length; s++) {
          g().removeFile(t[r[s].id])
        }
      });
      q.bind("StateChanged", function(r) {
        q.refresh()
      });
      q.bind("Refresh", function(y) {
        var x, s, r;
        g().setFileFilters(q.settings.filters, q.settings.multi_selection);
        x = h.getElementById(y.settings.browse_button);
        if (x) {
          s = o.getPos(x, h.getElementById(y.settings.container));
          r = o.getSize(x);
          o.extend(h.getElementById(y.id + "_flash_container").style, {top: s.y + "px",left: s.x + "px",width: r.w + "px",height: r.h + "px"})
        }
      });
      q.bind("DisableBrowse", function(s, r) {
        g().disableBrowse(r)
      });
      f({success: true})
    })
  }})
})(window, document, plupload);
(function(b) {
  b.runtimes.BrowserPlus = b.addRuntime("browserplus", {getFeatures: function() {
    return {dragdrop: true,jpgresize: true,pngresize: true,chunks: true,progress: true,multipart: true,multi_selection: true}
  },init: function(m, k) {
    var o = window.BrowserPlus, l = {}, p = m.settings, q = p.resize;
    function n(g) {
      var h, c, e = [], d, f;
      for (c = 0; c < g.length; c++) {
        d = g[c];
        f = b.guid();
        l[f] = d;
        e.push(new b.File(f, d.name, d.size))
      }
      if (c) {
        m.trigger("FilesAdded", e)
      }
    }
    function a() {
      var c = false;
      m.bind("PostInit", function() {
        var s, d = p.drop_element, g = m.id + "_droptarget", e = document.getElementById(d), t;
        function f(r, u) {
          o.DragAndDrop.AddDropTarget({id: r}, function(v) {
            o.DragAndDrop.AttachCallbacks({id: r,hover: function(w) {
              if (!w && u) {
                u()
              }
            },drop: function(w) {
              if (u) {
                u()
              }
              n(w)
            }}, function() {
            })
          })
        }
        function h() {
          document.getElementById(g).style.top = "-1000px"
        }
        if (e) {
          if (document.attachEvent && (/MSIE/gi).test(navigator.userAgent)) {
            s = document.createElement("div");
            s.setAttribute("id", g);
            b.extend(s.style, {position: "absolute",top: "-1000px",background: "red",filter: "alpha(opacity=0)",opacity: 0});
            document.body.appendChild(s);
            b.addEvent(e, "dragenter", function(v) {
              var w, r;
              w = document.getElementById(d);
              r = b.getPos(w);
              b.extend(document.getElementById(g).style, {top: r.y + "px",left: r.x + "px",width: w.offsetWidth + "px",height: w.offsetHeight + "px"})
            });
            f(g, h)
          } else {
            f(d)
          }
        }
        b.addEvent(document.getElementById(p.browse_button), "click", function(E) {
          var D = [], B, C, r = p.filters, z, A;
          E.preventDefault();
          if (c) {
            return
          }
          no_type_restriction: for (B = 0; B < r.length; B++) {
            z = r[B].extensions.split(",");
            for (C = 0; C < z.length; C++) {
              if (z[C] === "*") {
                D = [];
                break no_type_restriction
              }
              A = b.mimeTypes[z[C]];
              if (A && b.inArray(A, D) === -1) {
                D.push(b.mimeTypes[z[C]])
              }
            }
          }
          o.FileBrowse.OpenBrowseDialog({mimeTypes: D}, function(u) {
            if (u.success) {
              n(u.value)
            }
          })
        });
        e = s = null
      });
      m.bind("CancelUpload", function() {
        o.Uploader.cancel({}, function() {
        })
      });
      m.bind("DisableBrowse", function(e, d) {
        c = d
      });
      m.bind("UploadFile", function(g, v) {
        var h = l[v.id], w = {}, u = g.settings.chunk_size, f, e = [];
        function x(t, r) {
          var s;
          if (v.status == b.FAILED) {
            return
          }
          w.name = v.target_name || v.name;
          if (u) {
            w.chunk = "" + t;
            w.chunks = "" + r
          }
          s = e.shift();
          o.Uploader.upload({url: g.settings.url,files: {file: s},cookies: document.cookies,postvars: b.extend(w, g.settings.multipart_params),progressCallback: function(B) {
            var C, A = 0;
            f[t] = parseInt(B.filePercent * s.size / 100, 10);
            for (C = 0; C < f.length; C++) {
              A += f[C]
            }
            v.loaded = A;
            g.trigger("UploadProgress", v)
          }}, function(C) {
            var A, B;
            if (C.success) {
              A = C.value.statusCode;
              if (u) {
                g.trigger("ChunkUploaded", v, {chunk: t,chunks: r,response: C.value.body,status: A})
              }
              if (e.length > 0) {
                x(++t, r)
              } else {
                v.status = b.DONE;
                g.trigger("FileUploaded", v, {response: C.value.body,status: A});
                if (A >= 400) {
                  g.trigger("Error", {code: b.HTTP_ERROR,message: b.translate("HTTP Error."),file: v,status: A})
                }
              }
            } else {
              g.trigger("Error", {code: b.GENERIC_ERROR,message: b.translate("Generic Error."),file: v,details: C.error})
            }
          })
        }
        function d(r) {
          v.size = r.size;
          if (u) {
            o.FileAccess.chunk({file: r,chunkSize: u}, function(s) {
              if (s.success) {
                var A = s.value, z = A.length;
                f = Array(z);
                for (var t = 0; t < z; t++) {
                  f[t] = 0;
                  e.push(A[t])
                }
                x(0, z)
              }
            })
          } else {
            f = Array(1);
            e.push(r);
            x(0, 1)
          }
        }
        if (q && /\.(png|jpg|jpeg)$/i.test(v.name)) {
          BrowserPlus.ImageAlter.transform({file: h,quality: q.quality || 90,actions: [{scale: {maxwidth: q.width,maxheight: q.height}}]}, function(r) {
            if (r.success) {
              d(r.value.file)
            }
          })
        } else {
          d(h)
        }
      });
      k({success: true})
    }
    if (o) {
      o.init(function(c) {
        var d = [{service: "Uploader",version: "3"}, {service: "DragAndDrop",version: "1"}, {service: "FileBrowse",version: "1"}, {service: "FileAccess",version: "2"}];
        if (q) {
          d.push({service: "ImageAlter",version: "4"})
        }
        if (c.success) {
          o.require({services: d}, function(e) {
            if (e.success) {
              a()
            } else {
              k()
            }
          })
        } else {
          k()
        }
      })
    } else {
      k()
    }
  }})
})(plupload);
(function(r, p, q, u) {
  var w = {}, s;
  function n(b, a) {
    var c;
    if ("FileReader" in r) {
      c = new FileReader();
      c.readAsDataURL(b);
      c.onload = function() {
        a(c.result)
      }
    } else {
      return a(b.getAsDataURL())
    }
  }
  function o(b, a) {
    var c;
    if ("FileReader" in r) {
      c = new FileReader();
      c.readAsBinaryString(b);
      c.onload = function() {
        a(c.result)
      }
    } else {
      return a(b.getAsBinary())
    }
  }
  function v(a, c, e, f) {
    var b, d, g, k, h = this;
    n(w[a.id], function(l) {
      b = p.createElement("canvas");
      b.style.display = "none";
      p.body.appendChild(b);
      d = b.getContext("2d");
      g = new Image();
      g.onerror = g.onabort = function() {
        f({success: false})
      };
      g.onload = function() {
        var H, D, F, G, m;
        if (!c.width) {
          c.width = g.width
        }
        if (!c.height) {
          c.height = g.height
        }
        k = Math.min(c.width / g.width, c.height / g.height);
        if (k < 1 || (k === 1 && e === "image/jpeg")) {
          H = Math.round(g.width * k);
          D = Math.round(g.height * k);
          b.width = H;
          b.height = D;
          d.drawImage(g, 0, 0, H, D);
          if (e === "image/jpeg") {
            G = new t(atob(l.substring(l.indexOf("base64,") + 7)));
            if (G.headers && G.headers.length) {
              m = new y();
              if (m.init(G.get("exif")[0])) {
                m.setExif("PixelXDimension", H);
                m.setExif("PixelYDimension", D);
                G.set("exif", m.getBinary());
                if (h.hasEventListener("ExifData")) {
                  h.trigger("ExifData", a, m.EXIF())
                }
                if (h.hasEventListener("GpsData")) {
                  h.trigger("GpsData", a, m.GPS())
                }
              }
            }
            if (c.quality) {
              try {
                l = b.toDataURL(e, c.quality / 100)
              } catch (E) {
                l = b.toDataURL(e)
              }
            }
          } else {
            l = b.toDataURL(e)
          }
          l = l.substring(l.indexOf("base64,") + 7);
          l = atob(l);
          if (G && G.headers && G.headers.length) {
            l = G.restore(l);
            G.purge()
          }
          b.parentNode.removeChild(b);
          f({success: true,data: l})
        } else {
          f({success: false})
        }
      };
      g.src = l
    })
  }
  q.runtimes.Html5 = q.addRuntime("html5", {getFeatures: function() {
    var a, e, b, c, d, f;
    e = b = d = f = false;
    if (r.XMLHttpRequest) {
      a = new XMLHttpRequest();
      b = !!a.upload;
      e = !!(a.sendAsBinary || a.upload)
    }
    if (e) {
      c = !!(a.sendAsBinary || (r.Uint8Array && r.ArrayBuffer));
      d = !!(File && (File.prototype.getAsDataURL || r.FileReader) && c);
      f = !!(File && (File.prototype.mozSlice || File.prototype.webkitSlice || File.prototype.slice))
    }
    s = q.ua.safari && q.ua.windows;
    return {html5: e,dragdrop: (function() {
      var g = p.createElement("div");
      return ("draggable" in g) || ("ondragstart" in g && "ondrop" in g)
    }()),jpgresize: d,pngresize: d,multipart: d || !!r.FileReader || !!r.FormData,canSendBinary: c,cantSendBlobInFormData: !!(q.ua.gecko && r.FormData && r.FileReader && !FileReader.prototype.readAsArrayBuffer),progress: b,chunks: f,multi_selection: !(q.ua.safari && q.ua.windows),triggerDialog: (q.ua.gecko && r.FormData || q.ua.webkit)}
  },init: function(c, a) {
    var e, b;
    function d(g) {
      var k, l, h = [], f, m = {};
      for (l = 0; l < g.length; l++) {
        k = g[l];
        if (m[k.name]) {
          continue
        }
        m[k.name] = true;
        f = q.guid();
        w[f] = k;
        h.push(new q.File(f, k.fileName || k.name, k.fileSize || k.size))
      }
      if (h.length) {
        c.trigger("FilesAdded", h)
      }
    }
    e = this.getFeatures();
    if (!e.html5) {
      a({success: false});
      return
    }
    c.bind("Init", function(H) {
      var J, L, g = [], I, f, M = H.settings.filters, K, h, O = p.body, N;
      J = p.createElement("div");
      J.id = H.id + "_html5_container";
      q.extend(J.style, {position: "absolute",background: c.settings.shim_bgcolor || "transparent",width: "100px",height: "100px",overflow: "hidden",zIndex: 99999,opacity: c.settings.shim_bgcolor ? "" : 0});
      J.className = "plupload html5";
      if (c.settings.container) {
        O = p.getElementById(c.settings.container);
        if (q.getStyle(O, "position") === "static") {
          O.style.position = "relative"
        }
      }
      O.appendChild(J);
      no_type_restriction: for (I = 0; I < M.length; I++) {
        K = M[I].extensions.split(/,/);
        for (f = 0; f < K.length; f++) {
          if (K[f] === "*") {
            g = [];
            break no_type_restriction
          }
          h = q.mimeTypes[K[f]];
          if (h && q.inArray(h, g) === -1) {
            g.push(h)
          }
        }
      }
      J.innerHTML = '<input id="' + c.id + '_html5"  style="font-size:999px" type="file" accept="' + g.join(",") + '" ' + (c.settings.multi_selection && c.features.multi_selection ? 'multiple="multiple"' : "") + " />";
      J.scrollTop = 100;
      N = p.getElementById(c.id + "_html5");
      if (H.features.triggerDialog) {
        q.extend(N.style, {position: "absolute",width: "100%",height: "100%"})
      } else {
        q.extend(N.style, {cssFloat: "right",styleFloat: "right"})
      }
      N.onchange = function() {
        d(this.files);
        this.value = ""
      };
      L = p.getElementById(H.settings.browse_button);
      if (L) {
        var l = H.settings.browse_button_hover, k = H.settings.browse_button_active, m = H.features.triggerDialog ? L : J;
        if (l) {
          q.addEvent(m, "mouseover", function() {
            q.addClass(L, l)
          }, H.id);
          q.addEvent(m, "mouseout", function() {
            q.removeClass(L, l)
          }, H.id)
        }
        if (k) {
          q.addEvent(m, "mousedown", function() {
            q.addClass(L, k)
          }, H.id);
          q.addEvent(p.body, "mouseup", function() {
            q.removeClass(L, k)
          }, H.id)
        }
        if (H.features.triggerDialog) {
          q.addEvent(L, "click", function(z) {
            var A = p.getElementById(H.id + "_html5");
            if (A && !A.disabled) {
              A.click()
            }
            z.preventDefault()
          }, H.id)
        }
      }
    });
    c.bind("PostInit", function() {
      var f = p.getElementById(c.settings.drop_element);
      if (f) {
        if (s) {
          q.addEvent(f, "dragenter", function(g) {
            var h, l, k;
            h = p.getElementById(c.id + "_drop");
            if (!h) {
              h = p.createElement("input");
              h.setAttribute("type", "file");
              h.setAttribute("id", c.id + "_drop");
              h.setAttribute("multiple", "multiple");
              q.addEvent(h, "change", function() {
                d(this.files);
                q.removeEvent(h, "change", c.id);
                h.parentNode.removeChild(h)
              }, c.id);
              f.appendChild(h)
            }
            l = q.getPos(f, p.getElementById(c.settings.container));
            k = q.getSize(f);
            if (q.getStyle(f, "position") === "static") {
              q.extend(f.style, {position: "relative"})
            }
            q.extend(h.style, {position: "absolute",display: "block",top: 0,left: 0,width: k.w + "px",height: k.h + "px",opacity: 0})
          }, c.id);
          return
        }
        q.addEvent(f, "dragover", function(g) {
          g.preventDefault()
        }, c.id);
        q.addEvent(f, "drop", function(g) {
          var h = g.dataTransfer;
          if (h && h.files) {
            d(h.files)
          }
          g.preventDefault()
        }, c.id)
      }
    });
    c.bind("Refresh", function(m) {
      var l, k, h, f, g;
      l = p.getElementById(c.settings.browse_button);
      if (l) {
        k = q.getPos(l, p.getElementById(m.settings.container));
        h = q.getSize(l);
        f = p.getElementById(c.id + "_html5_container");
        q.extend(f.style, {top: k.y + "px",left: k.x + "px",width: h.w + "px",height: h.h + "px"});
        if (c.features.triggerDialog) {
          if (q.getStyle(l, "position") === "static") {
            q.extend(l.style, {position: "relative"})
          }
          g = parseInt(q.getStyle(l, "z-index"), 10);
          if (isNaN(g)) {
            g = 0
          }
          q.extend(l.style, {zIndex: g});
          q.extend(f.style, {zIndex: g - 1})
        }
      }
    });
    c.bind("DisableBrowse", function(h, f) {
      var g = p.getElementById(h.id + "_html5");
      if (g) {
        g.disabled = f
      }
    });
    c.bind("CancelUpload", function() {
      if (b && b.abort) {
        b.abort()
      }
    });
    c.bind("UploadFile", function(m, k) {
      var h = m.settings, z, l;
      function f(E, F, H) {
        var I;
        if (File.prototype.slice) {
          try {
            E.slice();
            return E.slice(F, H)
          } catch (G) {
            return E.slice(F, H - F)
          }
        } else {
          if (I = File.prototype.webkitSlice || File.prototype.mozSlice) {
            return I.call(E, F, H)
          } else {
            return null
          }
        }
      }
      function g(E) {
        var F = 0, H = 0, G = ("FileReader" in r) ? new FileReader : null;
        function I() {
          var N, A, C, B, O, D, Q, R = m.settings.url;
          function P(J) {
            var L = 0, aa = "----pluploadboundary" + q.guid(), Z, Y = "--", K = "\r\n", W = "";
            b = new XMLHttpRequest;
            if (b.upload) {
              b.upload.onprogress = function(S) {
                k.loaded = Math.min(k.size, H + S.loaded - L);
                m.trigger("UploadProgress", k)
              }
            }
            b.onreadystatechange = function() {
              var S, T;
              if (b.readyState == 4 && m.state !== q.STOPPED) {
                try {
                  S = b.status
                } catch (U) {
                  S = 0
                }
                if (S >= 400) {
                  m.trigger("Error", {code: q.HTTP_ERROR,message: q.translate("HTTP Error."),file: k,status: S})
                } else {
                  if (C) {
                    T = {chunk: F,chunks: C,response: b.responseText,status: S};
                    m.trigger("ChunkUploaded", k, T);
                    H += D;
                    if (T.cancelled) {
                      k.status = q.FAILED;
                      return
                    }
                    k.loaded = Math.min(k.size, (F + 1) * O)
                  } else {
                    k.loaded = k.size
                  }
                  m.trigger("UploadProgress", k);
                  J = N = Z = W = null;
                  if (!C || ++F >= C) {
                    k.status = q.DONE;
                    m.trigger("FileUploaded", k, {response: b.responseText,status: S})
                  } else {
                    I()
                  }
                }
              }
            };
            if (m.settings.multipart && e.multipart) {
              B.name = k.target_name || k.name;
              b.open("post", R, true);
              q.each(m.settings.headers, function(T, S) {
                b.setRequestHeader(S, T)
              });
              if (typeof (J) !== "string" && !!r.FormData) {
                Z = new FormData();
                q.each(q.extend(B, m.settings.multipart_params), function(T, S) {
                  Z.append(S, T)
                });
                Z.append(m.settings.file_data_name, J);
                b.send(Z);
                return
              }
              if (typeof (J) === "string") {
                b.setRequestHeader("Content-Type", "multipart/form-data; boundary=" + aa);
                q.each(q.extend(B, m.settings.multipart_params), function(T, S) {
                  W += Y + aa + K + 'Content-Disposition: form-data; name="' + S + '"' + K + K;
                  W += unescape(encodeURIComponent(T)) + K
                });
                Q = q.mimeTypes[k.name.replace(/^.+\.([^.]+)/, "$1").toLowerCase()] || "application/octet-stream";
                W += Y + aa + K + 'Content-Disposition: form-data; name="' + m.settings.file_data_name + '"; filename="' + unescape(encodeURIComponent(k.name)) + '"' + K + "Content-Type: " + Q + K + K + J + K + Y + aa + Y + K;
                L = W.length - J.length;
                J = W;
                if (b.sendAsBinary) {
                  b.sendAsBinary(J)
                } else {
                  if (e.canSendBinary) {
                    var M = new Uint8Array(J.length);
                    for (var X = 0; X < J.length; X++) {
                      M[X] = (J.charCodeAt(X) & 255)
                    }
                    b.send(M.buffer)
                  }
                }
                return
              }
            }
            R = q.buildUrl(m.settings.url, q.extend(B, m.settings.multipart_params));
            b.open("post", R, true);
            b.setRequestHeader("Content-Type", "application/octet-stream");
            q.each(m.settings.headers, function(T, S) {
              b.setRequestHeader(S, T)
            });
            b.send(J)
          }
          if (k.status == q.DONE || k.status == q.FAILED || m.state == q.STOPPED) {
            return
          }
          B = {name: k.target_name || k.name};
          if (h.chunk_size && k.size > h.chunk_size && (e.chunks || typeof (E) == "string")) {
            O = h.chunk_size;
            C = Math.ceil(k.size / O);
            D = Math.min(O, k.size - (F * O));
            if (typeof (E) == "string") {
              N = E.substring(F * O, F * O + D)
            } else {
              N = f(E, F * O, F * O + D)
            }
            B.chunk = F;
            B.chunks = C
          } else {
            D = k.size;
            N = E
          }
          if (m.settings.multipart && e.multipart && typeof (N) !== "string" && G && e.cantSendBlobInFormData && e.chunks && m.settings.chunk_size) {
            G.onload = function() {
              P(G.result)
            };
            G.readAsBinaryString(N)
          } else {
            P(N)
          }
        }
        I()
      }
      z = w[k.id];
      if (e.jpgresize && m.settings.resize && /\.(png|jpg|jpeg)$/i.test(k.name)) {
        v.call(m, k, m.settings.resize, /\.png$/i.test(k.name) ? "image/png" : "image/jpeg", function(A) {
          if (A.success) {
            k.size = A.data.length;
            g(A.data)
          } else {
            if (e.chunks) {
              g(z)
            } else {
              o(z, g)
            }
          }
        })
      } else {
        if (!e.chunks && e.jpgresize) {
          o(z, g)
        } else {
          g(z)
        }
      }
    });
    c.bind("Destroy", function(l) {
      var h, g, k = p.body, f = {inputContainer: l.id + "_html5_container",inputFile: l.id + "_html5",browseButton: l.settings.browse_button,dropElm: l.settings.drop_element};
      for (h in f) {
        g = p.getElementById(f[h]);
        if (g) {
          q.removeAllEvents(g, l.id)
        }
      }
      q.removeAllEvents(p.body, l.id);
      if (l.settings.container) {
        k = p.getElementById(l.settings.container)
      }
      k.removeChild(p.getElementById(f.inputContainer))
    });
    a({success: true})
  }});
  function x() {
    var b = false, d;
    function a(k, g) {
      var l = b ? 0 : -8 * (g - 1), f = 0, h;
      for (h = 0; h < g; h++) {
        f |= (d.charCodeAt(k + h) << Math.abs(l + h * 8))
      }
      return f
    }
    function e(f, h, g) {
      var g = arguments.length === 3 ? g : d.length - h - 1;
      d = d.substr(0, h) + f + d.substr(g + h)
    }
    function c(l, k, g) {
      var f = "", m = b ? 0 : -8 * (g - 1), h;
      for (h = 0; h < g; h++) {
        f += String.fromCharCode((k >> Math.abs(m + h * 8)) & 255)
      }
      e(f, l, g)
    }
    return {II: function(f) {
      if (f === u) {
        return b
      } else {
        b = f
      }
    },init: function(f) {
      b = false;
      d = f
    },SEGMENT: function(h, f, g) {
      switch (arguments.length) {
        case 1:
          return d.substr(h, d.length - h - 1);
        case 2:
          return d.substr(h, f);
        case 3:
          e(g, h, f);
          break;
        default:
          return d
      }
    },BYTE: function(f) {
      return a(f, 1)
    },SHORT: function(f) {
      return a(f, 2)
    },LONG: function(g, f) {
      if (f === u) {
        return a(g, 4)
      } else {
        c(g, f, 4)
      }
    },SLONG: function(g) {
      var f = a(g, 4);
      return (f > 2147483647 ? f - 4294967296 : f)
    },STRING: function(h, g) {
      var f = "";
      for (g += h; h < g; h++) {
        f += String.fromCharCode(a(h, 1))
      }
      return f
    }}
  }
  function t(c) {
    var a = {65505: {app: "EXIF",name: "APP1",signature: "Exif\0"},65506: {app: "ICC",name: "APP2",signature: "ICC_PROFILE\0"},65517: {app: "IPTC",name: "APP13",signature: "Photoshop 3.0\0"}}, b = [], d, h, f = u, e = 0, g;
    d = new x();
    d.init(c);
    if (d.SHORT(0) !== 65496) {
      return
    }
    h = 2;
    g = Math.min(1048576, c.length);
    while (h <= g) {
      f = d.SHORT(h);
      if (f >= 65488 && f <= 65495) {
        h += 2;
        continue
      }
      if (f === 65498 || f === 65497) {
        break
      }
      e = d.SHORT(h + 2) + 2;
      if (a[f] && d.STRING(h + 4, a[f].signature.length) === a[f].signature) {
        b.push({hex: f,app: a[f].app.toUpperCase(),name: a[f].name.toUpperCase(),start: h,length: e,segment: d.SEGMENT(h, e)})
      }
      h += e
    }
    d.init(null);
    return {headers: b,restore: function(B) {
      d.init(B);
      var l = new t(B);
      if (!l.headers) {
        return false
      }
      for (var k = l.headers.length; k > 0; k--) {
        var A = l.headers[k - 1];
        d.SEGMENT(A.start, A.length, "")
      }
      l.purge();
      h = d.SHORT(2) == 65504 ? 4 + d.SHORT(4) : 2;
      for (var k = 0, m = b.length; k < m; k++) {
        d.SEGMENT(h, 0, b[k].segment);
        h += b[k].length
      }
      return d.SEGMENT()
    },get: function(k) {
      var z = [];
      for (var l = 0, m = b.length; l < m; l++) {
        if (b[l].app === k.toUpperCase()) {
          z.push(b[l].segment)
        }
      }
      return z
    },set: function(B, k) {
      var A = [];
      if (typeof (k) === "string") {
        A.push(k)
      } else {
        A = k
      }
      for (var l = ii = 0, m = b.length; l < m; l++) {
        if (b[l].app === B.toUpperCase()) {
          b[l].segment = A[ii];
          b[l].length = A[ii].length;
          ii++
        }
        if (ii >= A.length) {
          break
        }
      }
    },purge: function() {
      b = [];
      d.init(null)
    }}
  }
  function y() {
    var d, g, f = {}, a;
    d = new x();
    g = {tiff: {274: "Orientation",34665: "ExifIFDPointer",34853: "GPSInfoIFDPointer"},exif: {36864: "ExifVersion",40961: "ColorSpace",40962: "PixelXDimension",40963: "PixelYDimension",36867: "DateTimeOriginal",33434: "ExposureTime",33437: "FNumber",34855: "ISOSpeedRatings",37377: "ShutterSpeedValue",37378: "ApertureValue",37383: "MeteringMode",37384: "LightSource",37385: "Flash",41986: "ExposureMode",41987: "WhiteBalance",41990: "SceneCaptureType",41988: "DigitalZoomRatio",41992: "Contrast",41993: "Saturation",41994: "Sharpness"},gps: {0: "GPSVersionID",1: "GPSLatitudeRef",2: "GPSLatitude",3: "GPSLongitudeRef",4: "GPSLongitude"}};
    a = {ColorSpace: {1: "sRGB",0: "Uncalibrated"},MeteringMode: {0: "Unknown",1: "Average",2: "CenterWeightedAverage",3: "Spot",4: "MultiSpot",5: "Pattern",6: "Partial",255: "Other"},LightSource: {1: "Daylight",2: "Fliorescent",3: "Tungsten",4: "Flash",9: "Fine weather",10: "Cloudy weather",11: "Shade",12: "Daylight fluorescent (D 5700 - 7100K)",13: "Day white fluorescent (N 4600 -5400K)",14: "Cool white fluorescent (W 3900 - 4500K)",15: "White fluorescent (WW 3200 - 3700K)",17: "Standard light A",18: "Standard light B",19: "Standard light C",20: "D55",21: "D65",22: "D75",23: "D50",24: "ISO studio tungsten",255: "Other"},Flash: {0: "Flash did not fire.",1: "Flash fired.",5: "Strobe return light not detected.",7: "Strobe return light detected.",9: "Flash fired, compulsory flash mode",13: "Flash fired, compulsory flash mode, return light not detected",15: "Flash fired, compulsory flash mode, return light detected",16: "Flash did not fire, compulsory flash mode",24: "Flash did not fire, auto mode",25: "Flash fired, auto mode",29: "Flash fired, auto mode, return light not detected",31: "Flash fired, auto mode, return light detected",32: "No flash function",65: "Flash fired, red-eye reduction mode",69: "Flash fired, red-eye reduction mode, return light not detected",71: "Flash fired, red-eye reduction mode, return light detected",73: "Flash fired, compulsory flash mode, red-eye reduction mode",77: "Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79: "Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89: "Flash fired, auto mode, red-eye reduction mode",93: "Flash fired, auto mode, return light not detected, red-eye reduction mode",95: "Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode: {0: "Auto exposure",1: "Manual exposure",2: "Auto bracket"},WhiteBalance: {0: "Auto white balance",1: "Manual white balance"},SceneCaptureType: {0: "Standard",1: "Landscape",2: "Portrait",3: "Night scene"},Contrast: {0: "Normal",1: "Soft",2: "Hard"},Saturation: {0: "Normal",1: "Low saturation",2: "High saturation"},Sharpness: {0: "Normal",1: "Soft",2: "Hard"},GPSLatitudeRef: {N: "North latitude",S: "South latitude"},GPSLongitudeRef: {E: "East longitude",W: "West longitude"}};
    function e(N, k) {
      var K = d.SHORT(N), H, O, M, l, m, L, J, h, P = [], I = {};
      for (H = 0; H < K; H++) {
        J = L = N + 12 * H + 2;
        M = k[d.SHORT(J)];
        if (M === u) {
          continue
        }
        l = d.SHORT(J += 2);
        m = d.LONG(J += 2);
        J += 4;
        P = [];
        switch (l) {
          case 1:
          case 7:
            if (m > 4) {
              J = d.LONG(J) + f.tiffHeader
            }
            for (O = 0; O < m; O++) {
              P[O] = d.BYTE(J + O)
            }
            break;
          case 2:
            if (m > 4) {
              J = d.LONG(J) + f.tiffHeader
            }
            I[M] = d.STRING(J, m - 1);
            continue;
          case 3:
            if (m > 2) {
              J = d.LONG(J) + f.tiffHeader
            }
            for (O = 0; O < m; O++) {
              P[O] = d.SHORT(J + O * 2)
            }
            break;
          case 4:
            if (m > 1) {
              J = d.LONG(J) + f.tiffHeader
            }
            for (O = 0; O < m; O++) {
              P[O] = d.LONG(J + O * 4)
            }
            break;
          case 5:
            J = d.LONG(J) + f.tiffHeader;
            for (O = 0; O < m; O++) {
              P[O] = d.LONG(J + O * 4) / d.LONG(J + O * 4 + 4)
            }
            break;
          case 9:
            J = d.LONG(J) + f.tiffHeader;
            for (O = 0; O < m; O++) {
              P[O] = d.SLONG(J + O * 4)
            }
            break;
          case 10:
            J = d.LONG(J) + f.tiffHeader;
            for (O = 0; O < m; O++) {
              P[O] = d.SLONG(J + O * 4) / d.SLONG(J + O * 4 + 4)
            }
            break;
          default:
            continue
        }
        h = (m == 1 ? P[0] : P);
        if (a.hasOwnProperty(M) && typeof h != "object") {
          I[M] = a[M][h]
        } else {
          I[M] = h
        }
      }
      return I
    }
    function b() {
      var h = u, k = f.tiffHeader;
      d.II(d.SHORT(k) == 18761);
      if (d.SHORT(k += 2) !== 42) {
        return false
      }
      f.IFD0 = f.tiffHeader + d.LONG(k += 2);
      h = e(f.IFD0, g.tiff);
      f.exifIFD = ("ExifIFDPointer" in h ? f.tiffHeader + h.ExifIFDPointer : u);
      f.gpsIFD = ("GPSInfoIFDPointer" in h ? f.tiffHeader + h.GPSInfoIFDPointer : u);
      return true
    }
    function c(l, C, D) {
      var F, E, k, h = 0;
      if (typeof (C) === "string") {
        var m = g[l.toLowerCase()];
        for (hex in m) {
          if (m[hex] === C) {
            C = hex;
            break
          }
        }
      }
      F = f[l.toLowerCase() + "IFD"];
      E = d.SHORT(F);
      for (i = 0; i < E; i++) {
        k = F + 12 * i + 2;
        if (d.SHORT(k) == C) {
          h = k + 8;
          break
        }
      }
      if (!h) {
        return false
      }
      d.LONG(h, D);
      return true
    }
    return {init: function(h) {
      f = {tiffHeader: 10};
      if (h === u || !h.length) {
        return false
      }
      d.init(h);
      if (d.SHORT(0) === 65505 && d.STRING(4, 5).toUpperCase() === "EXIF\0") {
        return b()
      }
      return false
    },EXIF: function() {
      var k;
      k = e(f.exifIFD, g.exif);
      if (k.ExifVersion && q.typeOf(k.ExifVersion) === "array") {
        for (var h = 0, l = ""; h < k.ExifVersion.length; h++) {
          l += String.fromCharCode(k.ExifVersion[h])
        }
        k.ExifVersion = l
      }
      return k
    },GPS: function() {
      var h;
      h = e(f.gpsIFD, g.gps);
      if (h.GPSVersionID) {
        h.GPSVersionID = h.GPSVersionID.join(".")
      }
      return h
    },setExif: function(k, h) {
      if (k !== "PixelXDimension" && k !== "PixelYDimension") {
        return false
      }
      return c("exif", k, h)
    },getBinary: function() {
      return d.SEGMENT()
    }}
  }
})(window, document, plupload);
(function(k, g, f, l) {
  function h(a) {
    return g.getElementById(a)
  }
  f.runtimes.Html4 = f.addRuntime("html4", {getFeatures: function() {
    return {multipart: true,triggerDialog: (f.ua.gecko && k.FormData || f.ua.webkit)}
  },init: function(b, a) {
    b.bind("Init", function(e) {
      var E = g.body, A, F = "javascript", D, H, d, G = [], c = /MSIE/.test(navigator.userAgent), L = [], B = e.settings.filters, y, C, M, I;
      no_type_restriction: for (y = 0; y < B.length; y++) {
        C = B[y].extensions.split(/,/);
        for (I = 0; I < C.length; I++) {
          if (C[I] === "*") {
            L = [];
            break no_type_restriction
          }
          M = f.mimeTypes[C[I]];
          if (M && f.inArray(M, L) === -1) {
            L.push(M)
          }
        }
      }
      L = L.join(",");
      function J() {
        var n, m, p, o;
        d = f.guid();
        G.push(d);
        n = g.createElement("form");
        n.setAttribute("id", "form_" + d);
        n.setAttribute("method", "post");
        n.setAttribute("enctype", "multipart/form-data");
        n.setAttribute("encoding", "multipart/form-data");
        n.setAttribute("target", e.id + "_iframe");
        n.style.position = "absolute";
        m = g.createElement("input");
        m.setAttribute("id", "input_" + d);
        m.setAttribute("type", "file");
        m.setAttribute("accept", L);
        m.setAttribute("size", 1);
        o = h(e.settings.browse_button);
        if (e.features.triggerDialog && o) {
          f.addEvent(h(e.settings.browse_button), "click", function(q) {
            if (!m.disabled) {
              m.click()
            }
            q.preventDefault()
          }, e.id)
        }
        f.extend(m.style, {width: "100%",height: "100%",opacity: 0,fontSize: "99px",cursor: "pointer"});
        f.extend(n.style, {overflow: "hidden"});
        p = e.settings.shim_bgcolor;
        if (p) {
          n.style.background = p
        }
        if (c) {
          f.extend(m.style, {filter: "alpha(opacity=0)"})
        }
        f.addEvent(m, "change", function(r) {
          var t = r.target, u, s = [], q;
          if (t.value) {
            h("form_" + d).style.top = -1048575 + "px";
            u = t.value.replace(/\\/g, "/");
            u = u.substring(u.length, u.lastIndexOf("/") + 1);
            s.push(new f.File(d, u));
            if (!e.features.triggerDialog) {
              f.removeAllEvents(n, e.id)
            } else {
              f.removeEvent(o, "click", e.id)
            }
            f.removeEvent(m, "change", e.id);
            J();
            if (s.length) {
              b.trigger("FilesAdded", s)
            }
          }
        }, e.id);
        n.appendChild(m);
        E.appendChild(n);
        e.refresh()
      }
      function K() {
        var m = g.createElement("div");
        m.innerHTML = '<iframe id="' + e.id + '_iframe" name="' + e.id + '_iframe" src="' + F + ':&quot;&quot;" style="display:none"></iframe>';
        A = m.firstChild;
        E.appendChild(A);
        f.addEvent(A, "load", function(p) {
          var o = p.target, q, n;
          if (!D) {
            return
          }
          try {
            q = o.contentWindow.document || o.contentDocument || k.frames[o.id].document
          } catch (r) {
            e.trigger("Error", {code: f.SECURITY_ERROR,message: f.translate("Security error."),file: D});
            return
          }
          n = q.body.innerHTML;
          if (n) {
            D.status = f.DONE;
            D.loaded = 1025;
            D.percent = 100;
            e.trigger("UploadProgress", D);
            e.trigger("FileUploaded", D, {response: n})
          }
        }, e.id)
      }
      if (e.settings.container) {
        E = h(e.settings.container);
        if (f.getStyle(E, "position") === "static") {
          E.style.position = "relative"
        }
      }
      e.bind("UploadFile", function(p, o) {
        var n, m;
        if (o.status == f.DONE || o.status == f.FAILED || p.state == f.STOPPED) {
          return
        }
        n = h("form_" + o.id);
        m = h("input_" + o.id);
        m.setAttribute("name", p.settings.file_data_name);
        n.setAttribute("action", p.settings.url);
        f.each(f.extend({name: o.target_name || o.name}, p.settings.multipart_params), function(q, s) {
          var r = g.createElement("input");
          f.extend(r, {type: "hidden",name: s,value: q});
          n.insertBefore(r, n.firstChild)
        });
        D = o;
        h("form_" + d).style.top = -1048575 + "px";
        n.submit()
      });
      e.bind("FileUploaded", function(m) {
        m.refresh()
      });
      e.bind("StateChanged", function(m) {
        if (m.state == f.STARTED) {
          K()
        } else {
          if (m.state == f.STOPPED) {
            k.setTimeout(function() {
              f.removeEvent(A, "load", m.id);
              if (A.parentNode) {
                A.parentNode.removeChild(A)
              }
            }, 0)
          }
        }
        f.each(m.files, function(p, n) {
          if (p.status === f.DONE || p.status === f.FAILED) {
            var o = h("form_" + p.id);
            if (o) {
              o.parentNode.removeChild(o)
            }
          }
        })
      });
      e.bind("Refresh", function(p) {
        var t, o, n, m, q, s, r, u, v;
        t = h(p.settings.browse_button);
        if (t) {
          q = f.getPos(t, h(p.settings.container));
          s = f.getSize(t);
          r = h("form_" + d);
          u = h("input_" + d);
          f.extend(r.style, {top: q.y + "px",left: q.x + "px",width: s.w + "px",height: s.h + "px"});
          if (p.features.triggerDialog) {
            if (f.getStyle(t, "position") === "static") {
              f.extend(t.style, {position: "relative"})
            }
            v = parseInt(t.style.zIndex, 10);
            if (isNaN(v)) {
              v = 0
            }
            f.extend(t.style, {zIndex: v});
            f.extend(r.style, {zIndex: v - 1})
          }
          n = p.settings.browse_button_hover;
          m = p.settings.browse_button_active;
          o = p.features.triggerDialog ? t : r;
          if (n) {
            f.addEvent(o, "mouseover", function() {
              f.addClass(t, n)
            }, p.id);
            f.addEvent(o, "mouseout", function() {
              f.removeClass(t, n)
            }, p.id)
          }
          if (m) {
            f.addEvent(o, "mousedown", function() {
              f.addClass(t, m)
            }, p.id);
            f.addEvent(g.body, "mouseup", function() {
              f.removeClass(t, m)
            }, p.id)
          }
        }
      });
      b.bind("FilesRemoved", function(p, o) {
        var m, n;
        for (m = 0; m < o.length; m++) {
          n = h("form_" + o[m].id);
          if (n) {
            n.parentNode.removeChild(n)
          }
        }
      });
      b.bind("DisableBrowse", function(o, n) {
        var m = g.getElementById("input_" + d);
        if (m) {
          m.disabled = n
        }
      });
      b.bind("Destroy", function(q) {
        var m, p, o, n = {inputContainer: "form_" + d,inputFile: "input_" + d,browseButton: q.settings.browse_button};
        for (m in n) {
          p = h(n[m]);
          if (p) {
            f.removeAllEvents(p, q.id)
          }
        }
        f.removeAllEvents(g.body, q.id);
        f.each(G, function(r, s) {
          o = h("form_" + r);
          if (o) {
            E.removeChild(o)
          }
        })
      });
      J()
    });
    a({success: true})
  }})
})(window, document, plupload);
function LastFM(k) {
  var f = k.apiKey || "";
  var b = k.apiSecret || "";
  var g = k.apiUrl || "http://ws.audioscrobbler.com/2.0/";
  var a = k.cache || undefined;
  this.setApiKey = function(l) {
    f = l
  };
  this.setApiSecret = function(l) {
    b = l
  };
  this.setApiUrl = function(l) {
    g = l
  };
  this.setCache = function(l) {
    a = l
  };
  var d = function(m, s, q) {
    $("iframe").filter(function() {
      return $(this).attr("name") == "last.fm"
    }).first().remove();
    if (q == "POST") {
      var p = document.getElementsByTagName("html")[0];
      var n = document.createElement("iframe");
      var w;
      n.width = 1;
      n.height = 1;
      n.style.border = "none";
      n.name = "last.fm";
      n.onload = function() {
        if (typeof (s.success) != "undefined") {
          s.success()
        }
      };
      p.appendChild(n);
      if (typeof (n.contentWindow) != "undefined") {
        w = n.contentWindow.document
      } else {
        if (typeof (n.contentDocument.document) != "undefined") {
          w = n.contentDocument.document.document
        } else {
          w = n.contentDocument.document
        }
      }
      w.open();
      w.clear();
      w.write('<form method="post" action="' + g + '" id="form">');
      for (var l in m) {
        w.write('<input type="text" name="' + l + '" value="' + m[l] + '">')
      }
      w.write("</form>");
      w.write('<script type="application/x-javascript">');
      w.write('document.getElementById("form").submit();');
      w.write("<\/script>");
      w.close()
    } else {
      var v = "jsonp" + new Date().getTime() + "" + Math.round(1000000 * Math.random());
      var o = c.getApiSignature(m);
      if (typeof (a) != "undefined" && a.contains(o) && !a.isExpired(o)) {
        if (typeof (s.success) != "undefined") {
          s.success(a.load(o))
        }
        return
      }
      m.callback = v;
      m.format = "json";
      window[v] = function(y) {
        if (typeof (a) != "undefined") {
          var x = a.getExpirationTime(m);
          if (x > 0) {
            a.store(o, y, x)
          }
        }
        if (typeof (y.error) != "undefined") {
          if (typeof (s.error) != "undefined") {
            s.error(y.error, y.message)
          }
        } else {
          if (typeof (s.success) != "undefined") {
            s.success(y)
          }
        }
        window[v] = undefined;
        try {
          delete window[v]
        } catch (z) {
        }
        if (u) {
          u.removeChild(t)
        }
      };
      var u = document.getElementsByTagName("head")[0];
      var t = document.createElement("script");
      var r = [];
      for (var l in m) {
        r.push(encodeURIComponent(l) + "=" + encodeURIComponent(m[l]))
      }
      t.src = g + "?" + r.join("&").replace(/%20/g, "+");
      u.appendChild(t)
    }
  };
  var h = function(o, n, l, m) {
    n = n || {};
    l = l || {};
    m = m || "GET";
    n.method = o;
    n.api_key = f;
    d(n, l, m)
  };
  var e = function(p, o, n, l, m) {
    o = o || {};
    l = l || {};
    m = m || "GET";
    o.method = p;
    o.api_key = f;
    if (n && typeof (n.key) != "undefined") {
      o.sk = n.key
    }
    o.api_sig = c.getApiSignature(o);
    d(o, l, m)
  };
  this.album = {addTags: function(n, m, l) {
    if (typeof (n.tags) == "object") {
      n.tags = n.tags.join(",")
    }
    e("album.addTags", n, m, l, "POST")
  },getBuylinks: function(m, l) {
    h("album.getBuylinks", m, l)
  },getInfo: function(m, l) {
    h("album.getInfo", m, l)
  },getTags: function(n, m, l) {
    e("album.getTags", n, m, l)
  },removeTag: function(n, m, l) {
    e("album.removeTag", n, m, l, "POST")
  },search: function(m, l) {
    h("album.search", m, l)
  },share: function(n, m, l) {
    if (typeof (n.recipient) == "object") {
      n.recipient = n.recipient.join(",")
    }
    e("album.share", n, l)
  }};
  this.artist = {addTags: function(n, m, l) {
    if (typeof (n.tags) == "object") {
      n.tags = n.tags.join(",")
    }
    e("artist.addTags", n, m, l, "POST")
  },getCorrection: function(m, l) {
    h("artist.getCorrection", m, l)
  },getEvents: function(m, l) {
    h("artist.getEvents", m, l)
  },getImages: function(m, l) {
    h("artist.getImages", m, l)
  },getInfo: function(m, l) {
    h("artist.getInfo", m, l)
  },getPastEvents: function(m, l) {
    h("artist.getPastEvents", m, l)
  },getPodcast: function(m, l) {
    h("artist.getPodcast", m, l)
  },getShouts: function(m, l) {
    h("artist.getShouts", m, l)
  },getSimilar: function(m, l) {
    h("artist.getSimilar", m, l)
  },getTags: function(n, m, l) {
    e("artist.getTags", n, m, l)
  },getTopAlbums: function(m, l) {
    h("artist.getTopAlbums", m, l)
  },getTopFans: function(m, l) {
    h("artist.getTopFans", m, l)
  },getTopTags: function(m, l) {
    h("artist.getTopTags", m, l)
  },getTopTracks: function(m, l) {
    h("artist.getTopTracks", m, l)
  },removeTag: function(n, m, l) {
    e("artist.removeTag", n, m, l, "POST")
  },search: function(m, l) {
    h("artist.search", m, l)
  },share: function(n, m, l) {
    if (typeof (n.recipient) == "object") {
      n.recipient = n.recipient.join(",")
    }
    e("artist.share", n, m, l, "POST")
  },shout: function(n, m, l) {
    e("artist.shout", n, m, l, "POST")
  }};
  this.auth = {getMobileSession: function(m, l) {
    m = {username: m.username,authToken: md5(m.username + md5(m.password))};
    e("auth.getMobileSession", m, null, l)
  },getSession: function(m, l) {
    e("auth.getSession", m, null, l)
  },getToken: function(l) {
    e("auth.getToken", null, null, l)
  },getWebSession: function(m) {
    var l = g;
    g = "http://ext.last.fm/2.0/";
    e("auth.getWebSession", null, null, m);
    g = l
  }};
  this.chart = {getHypedArtists: function(n, m, l) {
    h("chart.getHypedArtists", n, l)
  },getHypedTracks: function(n, m, l) {
    h("chart.getHypedTracks", n, l)
  },getLovedTracks: function(n, m, l) {
    h("chart.getLovedTracks", n, l)
  },getTopArtists: function(n, m, l) {
    h("chart.getTopArtists", n, l)
  },getTopTags: function(n, m, l) {
    h("chart.getTopTags", n, l)
  },getTopTracks: function(n, m, l) {
    h("chart.getTopTracks", n, l)
  }};
  this.event = {attend: function(n, m, l) {
    e("event.attend", n, m, l, "POST")
  },getAttendees: function(n, m, l) {
    h("event.getAttendees", n, l)
  },getInfo: function(m, l) {
    h("event.getInfo", m, l)
  },getShouts: function(m, l) {
    h("event.getShouts", m, l)
  },share: function(n, m, l) {
    if (typeof (n.recipient) == "object") {
      n.recipient = n.recipient.join(",")
    }
    e("event.share", n, m, l, "POST")
  },shout: function(n, m, l) {
    e("event.shout", n, m, l, "POST")
  }};
  this.geo = {getEvents: function(m, l) {
    h("geo.getEvents", m, l)
  },getMetroArtistChart: function(m, l) {
    h("geo.getMetroArtistChart", m, l)
  },getMetroHypeArtistChart: function(m, l) {
    h("geo.getMetroHypeArtistChart", m, l)
  },getMetroHypeTrackChart: function(m, l) {
    h("geo.getMetroHypeTrackChart", m, l)
  },getMetroTrackChart: function(m, l) {
    h("geo.getMetroTrackChart", m, l)
  },getMetroUniqueArtistChart: function(m, l) {
    h("geo.getMetroUniqueArtistChart", m, l)
  },getMetroUniqueTrackChart: function(m, l) {
    h("geo.getMetroUniqueTrackChart", m, l)
  },getMetroWeeklyChartlist: function(m, l) {
    h("geo.getMetroWeeklyChartlist", m, l)
  },getMetros: function(m, l) {
    h("geo.getMetros", m, l)
  },getTopArtists: function(m, l) {
    h("geo.getTopArtists", m, l)
  },getTopTracks: function(m, l) {
    h("geo.getTopTracks", m, l)
  }};
  this.group = {getHype: function(m, l) {
    h("group.getHype", m, l)
  },getMembers: function(m, l) {
    h("group.getMembers", m, l)
  },getWeeklyAlbumChart: function(m, l) {
    h("group.getWeeklyAlbumChart", m, l)
  },getWeeklyArtistChart: function(m, l) {
    h("group.getWeeklyArtistChart", m, l)
  },getWeeklyChartList: function(m, l) {
    h("group.getWeeklyChartList", m, l)
  },getWeeklyTrackChart: function(m, l) {
    h("group.getWeeklyTrackChart", m, l)
  }};
  this.library = {addAlbum: function(n, m, l) {
    e("library.addAlbum", n, m, l, "POST")
  },addArtist: function(n, m, l) {
    e("library.addArtist", n, m, l, "POST")
  },addTrack: function(n, m, l) {
    e("library.addTrack", n, m, l, "POST")
  },getAlbums: function(m, l) {
    h("library.getAlbums", m, l)
  },getArtists: function(m, l) {
    h("library.getArtists", m, l)
  },getTracks: function(m, l) {
    h("library.getTracks", m, l)
  }};
  this.playlist = {addTrack: function(n, m, l) {
    e("playlist.addTrack", n, m, l, "POST")
  },create: function(n, m, l) {
    e("playlist.create", n, m, l, "POST")
  },fetch: function(m, l) {
    h("playlist.fetch", m, l)
  }};
  this.radio = {getPlaylist: function(n, m, l) {
    e("radio.getPlaylist", n, m, l)
  },search: function(n, m, l) {
    e("radio.search", n, m, l)
  },tune: function(n, m, l) {
    e("radio.tune", n, m, l)
  }};
  this.tag = {getInfo: function(m, l) {
    h("tag.getInfo", m, l)
  },getSimilar: function(m, l) {
    h("tag.getSimilar", m, l)
  },getTopAlbums: function(m, l) {
    h("tag.getTopAlbums", m, l)
  },getTopArtists: function(m, l) {
    h("tag.getTopArtists", m, l)
  },getTopTags: function(l) {
    h("tag.getTopTags", null, l)
  },getTopTracks: function(m, l) {
    h("tag.getTopTracks", m, l)
  },getWeeklyArtistChart: function(m, l) {
    h("tag.getWeeklyArtistChart", m, l)
  },getWeeklyChartList: function(m, l) {
    h("tag.getWeeklyChartList", m, l)
  },search: function(m, l) {
    h("tag.search", m, l)
  }};
  this.tasteometer = {compare: function(m, l) {
    h("tasteometer.compare", m, l)
  },compareGroup: function(m, l) {
    h("tasteometer.compareGroup", m, l)
  }};
  this.track = {addTags: function(n, m, l) {
    e("track.addTags", n, m, l, "POST")
  },ban: function(n, m, l) {
    e("track.ban", n, m, l, "POST")
  },getBuylinks: function(m, l) {
    h("track.getBuylinks", m, l)
  },getCorrection: function(m, l) {
    h("track.getCorrection", m, l)
  },getFingerprintMetadata: function(m, l) {
    h("track.getFingerprintMetadata", m, l)
  },getInfo: function(m, l) {
    h("track.getInfo", m, l)
  },getShouts: function(m, l) {
    h("track.getShouts", m, l)
  },getSimilar: function(m, l) {
    h("track.getSimilar", m, l)
  },getTags: function(n, m, l) {
    e("track.getTags", n, m, l)
  },getTopFans: function(m, l) {
    h("track.getTopFans", m, l)
  },getTopTags: function(m, l) {
    h("track.getTopTags", m, l)
  },love: function(n, m, l) {
    e("track.love", n, m, l, "POST")
  },removeTag: function(n, m, l) {
    e("track.removeTag", n, m, l, "POST")
  },scrobble: function(o, n, l) {
    if (o.constructor.toString().indexOf("Array") != -1) {
      var m = {};
      for (i in o) {
        for (j in o[i]) {
          m[j + "[" + i + "]"] = o[i][j]
        }
      }
      o = m
    }
    e("track.scrobble", o, n, l, "POST")
  },search: function(m, l) {
    h("track.search", m, l)
  },share: function(n, m, l) {
    if (typeof (n.recipient) == "object") {
      n.recipient = n.recipient.join(",")
    }
    e("track.share", n, m, l, "POST")
  },unban: function(n, m, l) {
    e("track.unban", n, m, l, "POST")
  },unlove: function(n, m, l) {
    e("track.unlove", n, m, l, "POST")
  },updateNowPlaying: function(n, m, l) {
    e("track.updateNowPlaying", n, m, l, "POST")
  }};
  this.user = {getArtistTracks: function(m, l) {
    h("user.getArtistTracks", m, l)
  },getBannedTracks: function(m, l) {
    h("user.getBannedTracks", m, l)
  },getEvents: function(m, l) {
    h("user.getEvents", m, l)
  },getFriends: function(m, l) {
    h("user.getFriends", m, l)
  },getInfo: function(m, l) {
    h("user.getInfo", m, l)
  },getLovedTracks: function(m, l) {
    h("user.getLovedTracks", m, l)
  },getNeighbours: function(m, l) {
    h("user.getNeighbours", m, l)
  },getNewReleases: function(m, l) {
    h("user.getNewReleases", m, l)
  },getPastEvents: function(m, l) {
    h("user.getPastEvents", m, l)
  },getPersonalTracks: function(m, l) {
    h("user.getPersonalTracks", m, l)
  },getPlaylists: function(m, l) {
    h("user.getPlaylists", m, l)
  },getRecentStations: function(n, m, l) {
    e("user.getRecentStations", n, m, l)
  },getRecentTracks: function(m, l) {
    h("user.getRecentTracks", m, l)
  },getRecommendedArtists: function(n, m, l) {
    e("user.getRecommendedArtists", n, m, l)
  },getRecommendedEvents: function(n, m, l) {
    e("user.getRecommendedEvents", n, m, l)
  },getShouts: function(m, l) {
    h("user.getShouts", m, l)
  },getTopAlbums: function(m, l) {
    h("user.getTopAlbums", m, l)
  },getTopArtists: function(m, l) {
    h("user.getTopArtists", m, l)
  },getTopTags: function(m, l) {
    h("user.getTopTags", m, l)
  },getTopTracks: function(m, l) {
    h("user.getTopTracks", m, l)
  },getWeeklyAlbumChart: function(m, l) {
    h("user.getWeeklyAlbumChart", m, l)
  },getWeeklyArtistChart: function(m, l) {
    h("user.getWeeklyArtistChart", m, l)
  },getWeeklyChartList: function(m, l) {
    h("user.getWeeklyChartList", m, l)
  },getWeeklyTrackChart: function(m, l) {
    h("user.getWeeklyTrackChart", m, l)
  },shout: function(n, m, l) {
    e("user.shout", n, m, l, "POST")
  }};
  this.venue = {getEvents: function(m, l) {
    h("venue.getEvents", m, l)
  },getPastEvents: function(m, l) {
    h("venue.getPastEvents", m, l)
  },search: function(m, l) {
    h("venue.search", m, l)
  }};
  var c = {getApiSignature: function(p) {
    var o = [];
    var m = "";
    for (var n in p) {
      o.push(n)
    }
    o.sort();
    for (var l in o) {
      var n = o[l];
      m += n + p[n]
    }
    m += b;
    return md5(m)
  }}
}
(function(a) {
  a.fn.resizecrop = function(b) {
    var c = {width: 50,height: 50,vertical: "center",horizontal: "center",wrapper: "span",moveClass: true,moveId: true,className: "resizecrop",zoom: true,hideImage: false,wrapperCSS: {}};
    var b = a.extend(c, b);
    return this.each(function() {
      var k = a(this);
      k.css("display", "none");
      k.removeAttr("width").removeAttr("height");
      var h = a(document.createElement(b.wrapper)).css({width: b.width,height: b.height,overflow: "hidden",display: "inline-block","vertical-align": "middle",position: "relative"}).css(b.wrapperCSS);
      if (b.moveClass) {
        var e = k.attr("class");
        if (typeof e !== "undefined" && e !== false && e !== "") {
          var g = e.split(/\s+/);
          a.each(g, function(l, m) {
            h.addClass(m)
          });
          k.removeAttr("class");
          k.addClass(b.className)
        }
      }
      if (b.moveId) {
        var d = k.attr("id");
        if (typeof d !== "undefined" && d !== false && d !== "") {
          k.removeAttr("id");
          h.attr("id", d)
        }
      }
      k.wrap(h);
      function f(l) {
        width_ratio = b.width / l.width();
        height_ratio = b.height / l.height();
        if (width_ratio > height_ratio) {
          if (b.zoom || width_ratio < 1) {
            l.width(b.width)
          }
          switch (b.vertical) {
            case "top":
              l.css("top", 0);
              break;
            case "bottom":
              l.css("bottom", 0);
              break;
            case "center":
            default:
              l.css("top", ((l.height() - b.height) / -2) + "px")
          }
          if (b.zoom || width_ratio < 1) {
            l.css("left", 0)
          } else {
            l.css("left", ((l.width() - b.width) / -2) + "px")
          }
        } else {
          if (b.zoom || height_ratio < 1) {
            l.height(b.height)
          }
          switch (b.horizontal) {
            case "left":
              l.css("left", 0);
              break;
            case "right":
              l.css("right", 0);
              break;
            case "center":
            default:
              l.css("left", ((l.width() - b.width) / -2) + "px")
          }
          if (b.zoom || height_ratio < 1) {
            l.css("top", 0)
          } else {
            l.css("top", ((l.height() - b.height) / -2) + "px")
          }
        }
        (b.hideImage) ? l.css({position: "relative"}) : l.css({position: "relative",display: "block"})
      }
      if (this.complete) {
        f(k)
      } else {
        k.load(function() {
          f(a(this))
        })
      }
    })
  };
  a.fn.cropresize = a.fn.resizecrop
})(jQuery);
/* Socket.IO.js build:0.9.11, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */
var io = ("undefined" === typeof module ? {} : module.exports);
(function() {
  (function(exports, global) {
    var io = exports;
    io.version = "0.9.11";
    io.protocol = 1;
    io.transports = [];
    io.j = [];
    io.sockets = {};
    io.connect = function(host, details) {
      var uri = io.util.parseUri(host), uuri, socket;
      if (global && global.location) {
        uri.protocol = uri.protocol || global.location.protocol.slice(0, -1);
        uri.host = uri.host || (global.document ? global.document.domain : global.location.hostname);
        uri.port = uri.port || global.location.port
      }
      uuri = io.util.uniqueUri(uri);
      var options = {host: uri.host,secure: "https" == uri.protocol,port: uri.port || ("https" == uri.protocol ? 443 : 80),query: uri.query || ""};
      io.util.merge(options, details);
      if (options["force new connection"] || !io.sockets[uuri]) {
        socket = new io.Socket(options)
      }
      if (!options["force new connection"] && socket) {
        io.sockets[uuri] = socket
      }
      socket = socket || io.sockets[uuri];
      return socket.of(uri.path.length > 1 ? uri.path : "")
    }
  })("object" === typeof module ? module.exports : (this.io = {}), this);
  (function(exports, global) {
    var util = exports.util = {};
    var re = /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;
    var parts = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"];
    util.parseUri = function(str) {
      var m = re.exec(str || ""), uri = {}, i = 14;
      while (i--) {
        uri[parts[i]] = m[i] || ""
      }
      return uri
    };
    util.uniqueUri = function(uri) {
      var protocol = uri.protocol, host = uri.host, port = uri.port;
      if ("document" in global) {
        host = host || document.domain;
        port = port || (protocol == "https" && document.location.protocol !== "https:" ? 443 : document.location.port)
      } else {
        host = host || "localhost";
        if (!port && protocol == "https") {
          port = 443
        }
      }
      return (protocol || "http") + "://" + host + ":" + (port || 80)
    };
    util.query = function(base, addition) {
      var query = util.chunkQuery(base || ""), components = [];
      util.merge(query, util.chunkQuery(addition || ""));
      for (var part in query) {
        if (query.hasOwnProperty(part)) {
          components.push(part + "=" + query[part])
        }
      }
      return components.length ? "?" + components.join("&") : ""
    };
    util.chunkQuery = function(qs) {
      var query = {}, params = qs.split("&"), i = 0, l = params.length, kv;
      for (; i < l; ++i) {
        kv = params[i].split("=");
        if (kv[0]) {
          query[kv[0]] = kv[1]
        }
      }
      return query
    };
    var pageLoaded = false;
    util.load = function(fn) {
      if ("document" in global && document.readyState === "complete" || pageLoaded) {
        return fn()
      }
      util.on(global, "load", fn, false)
    };
    util.on = function(element, event, fn, capture) {
      if (element.attachEvent) {
        element.attachEvent("on" + event, fn)
      } else {
        if (element.addEventListener) {
          element.addEventListener(event, fn, capture)
        }
      }
    };
    util.request = function(xdomain) {
      if (xdomain && "undefined" != typeof XDomainRequest && !util.ua.hasCORS) {
        return new XDomainRequest()
      }
      if ("undefined" != typeof XMLHttpRequest && (!xdomain || util.ua.hasCORS)) {
        return new XMLHttpRequest()
      }
      if (!xdomain) {
        try {
          return new window[(["Active"].concat("Object").join("X"))]("Microsoft.XMLHTTP")
        } catch (e) {
        }
      }
      return null
    };
    if ("undefined" != typeof window) {
      util.load(function() {
        pageLoaded = true
      })
    }
    util.defer = function(fn) {
      if (!util.ua.webkit || "undefined" != typeof importScripts) {
        return fn()
      }
      util.load(function() {
        setTimeout(fn, 100)
      })
    };
    util.merge = function merge(target, additional, deep, lastseen) {
      var seen = lastseen || [], depth = typeof deep == "undefined" ? 2 : deep, prop;
      for (prop in additional) {
        if (additional.hasOwnProperty(prop) && util.indexOf(seen, prop) < 0) {
          if (typeof target[prop] !== "object" || !depth) {
            target[prop] = additional[prop];
            seen.push(additional[prop])
          } else {
            util.merge(target[prop], additional[prop], depth - 1, seen)
          }
        }
      }
      return target
    };
    util.mixin = function(ctor, ctor2) {
      util.merge(ctor.prototype, ctor2.prototype)
    };
    util.inherit = function(ctor, ctor2) {
      function f() {
      }
      f.prototype = ctor2.prototype;
      ctor.prototype = new f
    };
    util.isArray = Array.isArray || function(obj) {
      return Object.prototype.toString.call(obj) === "[object Array]"
    };
    util.intersect = function(arr, arr2) {
      var ret = [], longest = arr.length > arr2.length ? arr : arr2, shortest = arr.length > arr2.length ? arr2 : arr;
      for (var i = 0, l = shortest.length; i < l; i++) {
        if (~util.indexOf(longest, shortest[i])) {
          ret.push(shortest[i])
        }
      }
      return ret
    };
    util.indexOf = function(arr, o, i) {
      for (var j = arr.length, i = i < 0 ? i + j < 0 ? 0 : i + j : i || 0; i < j && arr[i] !== o; i++) {
      }
      return j <= i ? -1 : i
    };
    util.toArray = function(enu) {
      var arr = [];
      for (var i = 0, l = enu.length; i < l; i++) {
        arr.push(enu[i])
      }
      return arr
    };
    util.ua = {};
    util.ua.hasCORS = "undefined" != typeof XMLHttpRequest && (function() {
      try {
        var a = new XMLHttpRequest()
      } catch (e) {
        return false
      }
      return a.withCredentials != undefined
    })();
    util.ua.webkit = "undefined" != typeof navigator && /webkit/i.test(navigator.userAgent);
    util.ua.iDevice = "undefined" != typeof navigator && /iPad|iPhone|iPod/i.test(navigator.userAgent)
  })("undefined" != typeof io ? io : module.exports, this);
  (function(exports, io) {
    exports.EventEmitter = EventEmitter;
    function EventEmitter() {
    }
    EventEmitter.prototype.on = function(name, fn) {
      if (!this.$events) {
        this.$events = {}
      }
      if (!this.$events[name]) {
        this.$events[name] = fn
      } else {
        if (io.util.isArray(this.$events[name])) {
          this.$events[name].push(fn)
        } else {
          this.$events[name] = [this.$events[name], fn]
        }
      }
      return this
    };
    EventEmitter.prototype.addListener = EventEmitter.prototype.on;
    EventEmitter.prototype.once = function(name, fn) {
      var self = this;
      function on() {
        self.removeListener(name, on);
        fn.apply(this, arguments)
      }
      on.listener = fn;
      this.on(name, on);
      return this
    };
    EventEmitter.prototype.removeListener = function(name, fn) {
      if (this.$events && this.$events[name]) {
        var list = this.$events[name];
        if (io.util.isArray(list)) {
          var pos = -1;
          for (var i = 0, l = list.length; i < l; i++) {
            if (list[i] === fn || (list[i].listener && list[i].listener === fn)) {
              pos = i;
              break
            }
          }
          if (pos < 0) {
            return this
          }
          list.splice(pos, 1);
          if (!list.length) {
            delete this.$events[name]
          }
        } else {
          if (list === fn || (list.listener && list.listener === fn)) {
            delete this.$events[name]
          }
        }
      }
      return this
    };
    EventEmitter.prototype.removeAllListeners = function(name) {
      if (name === undefined) {
        this.$events = {};
        return this
      }
      if (this.$events && this.$events[name]) {
        this.$events[name] = null
      }
      return this
    };
    EventEmitter.prototype.listeners = function(name) {
      if (!this.$events) {
        this.$events = {}
      }
      if (!this.$events[name]) {
        this.$events[name] = []
      }
      if (!io.util.isArray(this.$events[name])) {
        this.$events[name] = [this.$events[name]]
      }
      return this.$events[name]
    };
    EventEmitter.prototype.emit = function(name) {
      if (!this.$events) {
        return false
      }
      var handler = this.$events[name];
      if (!handler) {
        return false
      }
      var args = Array.prototype.slice.call(arguments, 1);
      if ("function" == typeof handler) {
        handler.apply(this, args)
      } else {
        if (io.util.isArray(handler)) {
          var listeners = handler.slice();
          for (var i = 0, l = listeners.length; i < l; i++) {
            listeners[i].apply(this, args)
          }
        } else {
          return false
        }
      }
      return true
    }
  })("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports);
  (function(exports, nativeJSON) {
    if (nativeJSON && nativeJSON.parse) {
      return exports.JSON = {parse: nativeJSON.parse,stringify: nativeJSON.stringify}
    }
    var JSON = exports.JSON = {};
    function f(n) {
      return n < 10 ? "0" + n : n
    }
    function date(d, key) {
      return isFinite(d.valueOf()) ? d.getUTCFullYear() + "-" + f(d.getUTCMonth() + 1) + "-" + f(d.getUTCDate()) + "T" + f(d.getUTCHours()) + ":" + f(d.getUTCMinutes()) + ":" + f(d.getUTCSeconds()) + "Z" : null
    }
    var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = {"\b": "\\b","\t": "\\t","\n": "\\n","\f": "\\f","\r": "\\r",'"': '\\"',"\\": "\\\\"}, rep;
    function quote(string) {
      escapable.lastIndex = 0;
      return escapable.test(string) ? '"' + string.replace(escapable, function(a) {
        var c = meta[a];
        return typeof c === "string" ? c : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4)
      }) + '"' : '"' + string + '"'
    }
    function str(key, holder) {
      var i, k, v, length, mind = gap, partial, value = holder[key];
      if (value instanceof Date) {
        value = date(key)
      }
      if (typeof rep === "function") {
        value = rep.call(holder, key, value)
      }
      switch (typeof value) {
        case "string":
          return quote(value);
        case "number":
          return isFinite(value) ? String(value) : "null";
        case "boolean":
        case "null":
          return String(value);
        case "object":
          if (!value) {
            return "null"
          }
          gap += indent;
          partial = [];
          if (Object.prototype.toString.apply(value) === "[object Array]") {
            length = value.length;
            for (i = 0; i < length; i += 1) {
              partial[i] = str(i, value) || "null"
            }
            v = partial.length === 0 ? "[]" : gap ? "[\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "]" : "[" + partial.join(",") + "]";
            gap = mind;
            return v
          }
          if (rep && typeof rep === "object") {
            length = rep.length;
            for (i = 0; i < length; i += 1) {
              if (typeof rep[i] === "string") {
                k = rep[i];
                v = str(k, value);
                if (v) {
                  partial.push(quote(k) + (gap ? ": " : ":") + v)
                }
              }
            }
          } else {
            for (k in value) {
              if (Object.prototype.hasOwnProperty.call(value, k)) {
                v = str(k, value);
                if (v) {
                  partial.push(quote(k) + (gap ? ": " : ":") + v)
                }
              }
            }
          }
          v = partial.length === 0 ? "{}" : gap ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}" : "{" + partial.join(",") + "}";
          gap = mind;
          return v
      }
    }
    JSON.stringify = function(value, replacer, space) {
      var i;
      gap = "";
      indent = "";
      if (typeof space === "number") {
        for (i = 0; i < space; i += 1) {
          indent += " "
        }
      } else {
        if (typeof space === "string") {
          indent = space
        }
      }
      rep = replacer;
      if (replacer && typeof replacer !== "function" && (typeof replacer !== "object" || typeof replacer.length !== "number")) {
        throw new Error("JSON.stringify")
      }
      return str("", {"": value})
    };
    JSON.parse = function(text, reviver) {
      var j;
      function walk(holder, key) {
        var k, v, value = holder[key];
        if (value && typeof value === "object") {
          for (k in value) {
            if (Object.prototype.hasOwnProperty.call(value, k)) {
              v = walk(value, k);
              if (v !== undefined) {
                value[k] = v
              } else {
                delete value[k]
              }
            }
          }
        }
        return reviver.call(holder, key, value)
      }
      text = String(text);
      cx.lastIndex = 0;
      if (cx.test(text)) {
        text = text.replace(cx, function(a) {
          return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4)
        })
      }
      if (/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) {
        j = eval("(" + text + ")");
        return typeof reviver === "function" ? walk({"": j}, "") : j
      }
      throw new SyntaxError("JSON.parse")
    }
  })("undefined" != typeof io ? io : module.exports, typeof JSON !== "undefined" ? JSON : undefined);
  (function(exports, io) {
    var parser = exports.parser = {};
    var packets = parser.packets = ["disconnect", "connect", "heartbeat", "message", "json", "event", "ack", "error", "noop"];
    var reasons = parser.reasons = ["transport not supported", "client not handshaken", "unauthorized"];
    var advice = parser.advice = ["reconnect"];
    var JSON = io.JSON, indexOf = io.util.indexOf;
    parser.encodePacket = function(packet) {
      var type = indexOf(packets, packet.type), id = packet.id || "", endpoint = packet.endpoint || "", ack = packet.ack, data = null;
      switch (packet.type) {
        case "error":
          var reason = packet.reason ? indexOf(reasons, packet.reason) : "", adv = packet.advice ? indexOf(advice, packet.advice) : "";
          if (reason !== "" || adv !== "") {
            data = reason + (adv !== "" ? ("+" + adv) : "")
          }
          break;
        case "message":
          if (packet.data !== "") {
            data = packet.data
          }
          break;
        case "event":
          var ev = {name: packet.name};
          if (packet.args && packet.args.length) {
            ev.args = packet.args
          }
          data = JSON.stringify(ev);
          break;
        case "json":
          data = JSON.stringify(packet.data);
          break;
        case "connect":
          if (packet.qs) {
            data = packet.qs
          }
          break;
        case "ack":
          data = packet.ackId + (packet.args && packet.args.length ? "+" + JSON.stringify(packet.args) : "");
          break
      }
      var encoded = [type, id + (ack == "data" ? "+" : ""), endpoint];
      if (data !== null && data !== undefined) {
        encoded.push(data)
      }
      return encoded.join(":")
    };
    parser.encodePayload = function(packets) {
      var decoded = "";
      if (packets.length == 1) {
        return packets[0]
      }
      for (var i = 0, l = packets.length; i < l; i++) {
        var packet = packets[i];
        decoded += "\ufffd" + packet.length + "\ufffd" + packets[i]
      }
      return decoded
    };
    var regexp = /([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;
    parser.decodePacket = function(data) {
      var pieces = data.match(regexp);
      if (!pieces) {
        return {}
      }
      var id = pieces[2] || "", data = pieces[5] || "", packet = {type: packets[pieces[1]],endpoint: pieces[4] || ""};
      if (id) {
        packet.id = id;
        if (pieces[3]) {
          packet.ack = "data"
        } else {
          packet.ack = true
        }
      }
      switch (packet.type) {
        case "error":
          var pieces = data.split("+");
          packet.reason = reasons[pieces[0]] || "";
          packet.advice = advice[pieces[1]] || "";
          break;
        case "message":
          packet.data = data || "";
          break;
        case "event":
          try {
            var opts = JSON.parse(data);
            packet.name = opts.name;
            packet.args = opts.args
          } catch (e) {
          }
          packet.args = packet.args || [];
          break;
        case "json":
          try {
            packet.data = JSON.parse(data)
          } catch (e) {
          }
          break;
        case "connect":
          packet.qs = data || "";
          break;
        case "ack":
          var pieces = data.match(/^([0-9]+)(\+)?(.*)/);
          if (pieces) {
            packet.ackId = pieces[1];
            packet.args = [];
            if (pieces[3]) {
              try {
                packet.args = pieces[3] ? JSON.parse(pieces[3]) : []
              } catch (e) {
              }
            }
          }
          break;
        case "disconnect":
        case "heartbeat":
          break
      }
      return packet
    };
    parser.decodePayload = function(data) {
      if (data.charAt(0) == "\ufffd") {
        var ret = [];
        for (var i = 1, length = ""; i < data.length; i++) {
          if (data.charAt(i) == "\ufffd") {
            ret.push(parser.decodePacket(data.substr(i + 1).substr(0, length)));
            i += Number(length) + 1;
            length = ""
          } else {
            length += data.charAt(i)
          }
        }
        return ret
      } else {
        return [parser.decodePacket(data)]
      }
    }
  })("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports);
  (function(exports, io) {
    exports.Transport = Transport;
    function Transport(socket, sessid) {
      this.socket = socket;
      this.sessid = sessid
    }
    io.util.mixin(Transport, io.EventEmitter);
    Transport.prototype.heartbeats = function() {
      return true
    };
    Transport.prototype.onData = function(data) {
      this.clearCloseTimeout();
      if (this.socket.connected || this.socket.connecting || this.socket.reconnecting) {
        this.setCloseTimeout()
      }
      if (data !== "") {
        var msgs = io.parser.decodePayload(data);
        if (msgs && msgs.length) {
          for (var i = 0, l = msgs.length; i < l; i++) {
            this.onPacket(msgs[i])
          }
        }
      }
      return this
    };
    Transport.prototype.onPacket = function(packet) {
      this.socket.setHeartbeatTimeout();
      if (packet.type == "heartbeat") {
        return this.onHeartbeat()
      }
      if (packet.type == "connect" && packet.endpoint == "") {
        this.onConnect()
      }
      if (packet.type == "error" && packet.advice == "reconnect") {
        this.isOpen = false
      }
      this.socket.onPacket(packet);
      return this
    };
    Transport.prototype.setCloseTimeout = function() {
      if (!this.closeTimeout) {
        var self = this;
        this.closeTimeout = setTimeout(function() {
          self.onDisconnect()
        }, this.socket.closeTimeout)
      }
    };
    Transport.prototype.onDisconnect = function() {
      if (this.isOpen) {
        this.close()
      }
      this.clearTimeouts();
      this.socket.onDisconnect();
      return this
    };
    Transport.prototype.onConnect = function() {
      this.socket.onConnect();
      return this
    };
    Transport.prototype.clearCloseTimeout = function() {
      if (this.closeTimeout) {
        clearTimeout(this.closeTimeout);
        this.closeTimeout = null
      }
    };
    Transport.prototype.clearTimeouts = function() {
      this.clearCloseTimeout();
      if (this.reopenTimeout) {
        clearTimeout(this.reopenTimeout)
      }
    };
    Transport.prototype.packet = function(packet) {
      this.send(io.parser.encodePacket(packet))
    };
    Transport.prototype.onHeartbeat = function(heartbeat) {
      this.packet({type: "heartbeat"})
    };
    Transport.prototype.onOpen = function() {
      this.isOpen = true;
      this.clearCloseTimeout();
      this.socket.onOpen()
    };
    Transport.prototype.onClose = function() {
      var self = this;
      this.isOpen = false;
      this.socket.onClose();
      this.onDisconnect()
    };
    Transport.prototype.prepareUrl = function() {
      var options = this.socket.options;
      return this.scheme() + "://" + options.host + ":" + options.port + "/" + options.resource + "/" + io.protocol + "/" + this.name + "/" + this.sessid
    };
    Transport.prototype.ready = function(socket, fn) {
      fn.call(this)
    }
  })("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports);
  (function(exports, io, global) {
    exports.Socket = Socket;
    function Socket(options) {
      this.options = {port: 80,secure: false,document: "document" in global ? document : false,resource: "socket.io",transports: io.transports,"connect timeout": 10000,"try multiple transports": true,reconnect: true,"reconnection delay": 500,"reconnection limit": Infinity,"reopen delay": 3000,"max reconnection attempts": 10,"sync disconnect on unload": false,"auto connect": true,"flash policy port": 10843,manualFlush: false};
      io.util.merge(this.options, options);
      this.connected = false;
      this.open = false;
      this.connecting = false;
      this.reconnecting = false;
      this.namespaces = {};
      this.buffer = [];
      this.doBuffer = false;
      if (this.options["sync disconnect on unload"] && (!this.isXDomain() || io.util.ua.hasCORS)) {
        var self = this;
        io.util.on(global, "beforeunload", function() {
          self.disconnectSync()
        }, false)
      }
      if (this.options["auto connect"]) {
        this.connect()
      }
    }
    io.util.mixin(Socket, io.EventEmitter);
    Socket.prototype.of = function(name) {
      if (!this.namespaces[name]) {
        this.namespaces[name] = new io.SocketNamespace(this, name);
        if (name !== "") {
          this.namespaces[name].packet({type: "connect"})
        }
      }
      return this.namespaces[name]
    };
    Socket.prototype.publish = function() {
      this.emit.apply(this, arguments);
      var nsp;
      for (var i in this.namespaces) {
        if (this.namespaces.hasOwnProperty(i)) {
          nsp = this.of(i);
          nsp.$emit.apply(nsp, arguments)
        }
      }
    };
    function empty() {
    }
    Socket.prototype.handshake = function(fn) {
      var self = this, options = this.options;
      function complete(data) {
        if (data instanceof Error) {
          self.connecting = false;
          self.onError(data.message)
        } else {
          fn.apply(null, data.split(":"))
        }
      }
      var url = ["http" + (options.secure ? "s" : "") + ":/", options.host + ":" + options.port, options.resource, io.protocol, io.util.query(this.options.query, "t=" + +new Date)].join("/");
      if (this.isXDomain() && !io.util.ua.hasCORS) {
        var insertAt = document.getElementsByTagName("script")[0], script = document.createElement("script");
        script.src = url + "&jsonp=" + io.j.length;
        insertAt.parentNode.insertBefore(script, insertAt);
        io.j.push(function(data) {
          complete(data);
          script.parentNode.removeChild(script)
        })
      } else {
        var xhr = io.util.request();
        xhr.open("GET", url, true);
        if (this.isXDomain()) {
          xhr.withCredentials = true
        }
        xhr.onreadystatechange = function() {
          if (xhr.readyState == 4) {
            xhr.onreadystatechange = empty;
            if (xhr.status == 200) {
              complete(xhr.responseText)
            } else {
              if (xhr.status == 403) {
                self.onError(xhr.responseText)
              } else {
                self.connecting = false;
                !self.reconnecting && self.onError(xhr.responseText)
              }
            }
          }
        };
        xhr.send(null)
      }
    };
    Socket.prototype.getTransport = function(override) {
      var transports = override || this.transports, match;
      for (var i = 0, transport; transport = transports[i]; i++) {
        if (io.Transport[transport] && io.Transport[transport].check(this) && (!this.isXDomain() || io.Transport[transport].xdomainCheck(this))) {
          return new io.Transport[transport](this, this.sessionid)
        }
      }
      return null
    };
    Socket.prototype.connect = function(fn) {
      if (this.connecting) {
        return this
      }
      var self = this;
      self.connecting = true;
      this.handshake(function(sid, heartbeat, close, transports) {
        self.sessionid = sid;
        self.closeTimeout = close * 1000;
        self.heartbeatTimeout = heartbeat * 1000;
        if (!self.transports) {
          self.transports = self.origTransports = (transports ? io.util.intersect(transports.split(","), self.options.transports) : self.options.transports)
        }
        self.setHeartbeatTimeout();
        function connect(transports) {
          if (self.transport) {
            self.transport.clearTimeouts()
          }
          self.transport = self.getTransport(transports);
          if (!self.transport) {
            return self.publish("connect_failed")
          }
          self.transport.ready(self, function() {
            self.connecting = true;
            self.publish("connecting", self.transport.name);
            self.transport.open();
            if (self.options["connect timeout"]) {
              self.connectTimeoutTimer = setTimeout(function() {
                if (!self.connected) {
                  self.connecting = false;
                  if (self.options["try multiple transports"]) {
                    var remaining = self.transports;
                    while (remaining.length > 0 && remaining.splice(0, 1)[0] != self.transport.name) {
                    }
                    if (remaining.length) {
                      connect(remaining)
                    } else {
                      self.publish("connect_failed")
                    }
                  }
                }
              }, self.options["connect timeout"])
            }
          })
        }
        connect(self.transports);
        self.once("connect", function() {
          clearTimeout(self.connectTimeoutTimer);
          fn && typeof fn == "function" && fn()
        })
      });
      return this
    };
    Socket.prototype.setHeartbeatTimeout = function() {
      clearTimeout(this.heartbeatTimeoutTimer);
      if (this.transport && !this.transport.heartbeats()) {
        return
      }
      var self = this;
      this.heartbeatTimeoutTimer = setTimeout(function() {
        self.transport.onClose()
      }, this.heartbeatTimeout)
    };
    Socket.prototype.packet = function(data) {
      if (this.connected && !this.doBuffer) {
        this.transport.packet(data)
      } else {
        this.buffer.push(data)
      }
      return this
    };
    Socket.prototype.setBuffer = function(v) {
      this.doBuffer = v;
      if (!v && this.connected && this.buffer.length) {
        if (!this.options.manualFlush) {
          this.flushBuffer()
        }
      }
    };
    Socket.prototype.flushBuffer = function() {
      this.transport.payload(this.buffer);
      this.buffer = []
    };
    Socket.prototype.disconnect = function() {
      if (this.connected || this.connecting) {
        if (this.open) {
          this.of("").packet({type: "disconnect"})
        }
        this.onDisconnect("booted")
      }
      return this
    };
    Socket.prototype.disconnectSync = function() {
      var xhr = io.util.request();
      var uri = ["http" + (this.options.secure ? "s" : "") + ":/", this.options.host + ":" + this.options.port, this.options.resource, io.protocol, "", this.sessionid].join("/") + "/?disconnect=1";
      xhr.open("GET", uri, false);
      xhr.send(null);
      this.onDisconnect("booted")
    };
    Socket.prototype.isXDomain = function() {
      var port = global.location.port || ("https:" == global.location.protocol ? 443 : 80);
      return this.options.host !== global.location.hostname || this.options.port != port
    };
    Socket.prototype.onConnect = function() {
      if (!this.connected) {
        this.connected = true;
        this.connecting = false;
        if (!this.doBuffer) {
          this.setBuffer(false)
        }
        this.emit("connect")
      }
    };
    Socket.prototype.onOpen = function() {
      this.open = true
    };
    Socket.prototype.onClose = function() {
      this.open = false;
      clearTimeout(this.heartbeatTimeoutTimer)
    };
    Socket.prototype.onPacket = function(packet) {
      this.of(packet.endpoint).onPacket(packet)
    };
    Socket.prototype.onError = function(err) {
      if (err && err.advice) {
        if (err.advice === "reconnect" && (this.connected || this.connecting)) {
          this.disconnect();
          if (this.options.reconnect) {
            this.reconnect()
          }
        }
      }
      this.publish("error", err && err.reason ? err.reason : err)
    };
    Socket.prototype.onDisconnect = function(reason) {
      var wasConnected = this.connected, wasConnecting = this.connecting;
      this.connected = false;
      this.connecting = false;
      this.open = false;
      if (wasConnected || wasConnecting) {
        this.transport.close();
        this.transport.clearTimeouts();
        if (wasConnected) {
          this.publish("disconnect", reason);
          if ("booted" != reason && this.options.reconnect && !this.reconnecting) {
            this.reconnect()
          }
        }
      }
    };
    Socket.prototype.reconnect = function() {
      this.reconnecting = true;
      this.reconnectionAttempts = 0;
      this.reconnectionDelay = this.options["reconnection delay"];
      var self = this, maxAttempts = this.options["max reconnection attempts"], tryMultiple = this.options["try multiple transports"], limit = this.options["reconnection limit"];
      function reset() {
        if (self.connected) {
          for (var i in self.namespaces) {
            if (self.namespaces.hasOwnProperty(i) && "" !== i) {
              self.namespaces[i].packet({type: "connect"})
            }
          }
          self.publish("reconnect", self.transport.name, self.reconnectionAttempts)
        }
        clearTimeout(self.reconnectionTimer);
        self.removeListener("connect_failed", maybeReconnect);
        self.removeListener("connect", maybeReconnect);
        self.reconnecting = false;
        delete self.reconnectionAttempts;
        delete self.reconnectionDelay;
        delete self.reconnectionTimer;
        delete self.redoTransports;
        self.options["try multiple transports"] = tryMultiple
      }
      function maybeReconnect() {
        if (!self.reconnecting) {
          return
        }
        if (self.connected) {
          return reset()
        }
        if (self.connecting && self.reconnecting) {
          return self.reconnectionTimer = setTimeout(maybeReconnect, 1000)
        }
        if (self.reconnectionAttempts++ >= maxAttempts) {
          if (!self.redoTransports) {
            self.on("connect_failed", maybeReconnect);
            self.options["try multiple transports"] = true;
            self.transports = self.origTransports;
            self.transport = self.getTransport();
            self.redoTransports = true;
            self.connect()
          } else {
            self.publish("reconnect_failed");
            reset()
          }
        } else {
          if (self.reconnectionDelay < limit) {
            self.reconnectionDelay *= 2
          }
          self.connect();
          self.publish("reconnecting", self.reconnectionDelay, self.reconnectionAttempts);
          self.reconnectionTimer = setTimeout(maybeReconnect, self.reconnectionDelay)
        }
      }
      this.options["try multiple transports"] = false;
      this.reconnectionTimer = setTimeout(maybeReconnect, this.reconnectionDelay);
      this.on("connect", maybeReconnect)
    }
  })("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports, this);
  (function(exports, io) {
    exports.SocketNamespace = SocketNamespace;
    function SocketNamespace(socket, name) {
      this.socket = socket;
      this.name = name || "";
      this.flags = {};
      this.json = new Flag(this, "json");
      this.ackPackets = 0;
      this.acks = {}
    }
    io.util.mixin(SocketNamespace, io.EventEmitter);
    SocketNamespace.prototype.$emit = io.EventEmitter.prototype.emit;
    SocketNamespace.prototype.of = function() {
      return this.socket.of.apply(this.socket, arguments)
    };
    SocketNamespace.prototype.packet = function(packet) {
      packet.endpoint = this.name;
      this.socket.packet(packet);
      this.flags = {};
      return this
    };
    SocketNamespace.prototype.send = function(data, fn) {
      var packet = {type: this.flags.json ? "json" : "message",data: data};
      if ("function" == typeof fn) {
        packet.id = ++this.ackPackets;
        packet.ack = true;
        this.acks[packet.id] = fn
      }
      return this.packet(packet)
    };
    SocketNamespace.prototype.emit = function(name) {
      var args = Array.prototype.slice.call(arguments, 1), lastArg = args[args.length - 1], packet = {type: "event",name: name};
      if ("function" == typeof lastArg) {
        packet.id = ++this.ackPackets;
        packet.ack = "data";
        this.acks[packet.id] = lastArg;
        args = args.slice(0, args.length - 1)
      }
      packet.args = args;
      return this.packet(packet)
    };
    SocketNamespace.prototype.disconnect = function() {
      if (this.name === "") {
        this.socket.disconnect()
      } else {
        this.packet({type: "disconnect"});
        this.$emit("disconnect")
      }
      return this
    };
    SocketNamespace.prototype.onPacket = function(packet) {
      var self = this;
      function ack() {
        self.packet({type: "ack",args: io.util.toArray(arguments),ackId: packet.id})
      }
      switch (packet.type) {
        case "connect":
          this.$emit("connect");
          break;
        case "disconnect":
          if (this.name === "") {
            this.socket.onDisconnect(packet.reason || "booted")
          } else {
            this.$emit("disconnect", packet.reason)
          }
          break;
        case "message":
        case "json":
          var params = ["message", packet.data];
          if (packet.ack == "data") {
            params.push(ack)
          } else {
            if (packet.ack) {
              this.packet({type: "ack",ackId: packet.id})
            }
          }
          this.$emit.apply(this, params);
          break;
        case "event":
          var params = [packet.name].concat(packet.args);
          if (packet.ack == "data") {
            params.push(ack)
          }
          this.$emit.apply(this, params);
          break;
        case "ack":
          if (this.acks[packet.ackId]) {
            this.acks[packet.ackId].apply(this, packet.args);
            delete this.acks[packet.ackId]
          }
          break;
        case "error":
          if (packet.advice) {
            this.socket.onError(packet)
          } else {
            if (packet.reason == "unauthorized") {
              this.$emit("connect_failed", packet.reason)
            } else {
              this.$emit("error", packet.reason)
            }
          }
          break
      }
    };
    function Flag(nsp, name) {
      this.namespace = nsp;
      this.name = name
    }
    Flag.prototype.send = function() {
      this.namespace.flags[this.name] = true;
      this.namespace.send.apply(this.namespace, arguments)
    };
    Flag.prototype.emit = function() {
      this.namespace.flags[this.name] = true;
      this.namespace.emit.apply(this.namespace, arguments)
    }
  })("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports);
  (function(exports, io, global) {
    exports.websocket = WS;
    function WS(socket) {
      io.Transport.apply(this, arguments)
    }
    io.util.inherit(WS, io.Transport);
    WS.prototype.name = "websocket";
    WS.prototype.open = function() {
      var query = io.util.query(this.socket.options.query), self = this, Socket;
      if (!Socket) {
        Socket = global.MozWebSocket || global.WebSocket
      }
      this.websocket = new Socket(this.prepareUrl() + query);
      this.websocket.onopen = function() {
        self.onOpen();
        self.socket.setBuffer(false)
      };
      this.websocket.onmessage = function(ev) {
        self.onData(ev.data)
      };
      this.websocket.onclose = function() {
        self.onClose();
        self.socket.setBuffer(true)
      };
      this.websocket.onerror = function(e) {
        self.onError(e)
      };
      return this
    };
    if (io.util.ua.iDevice) {
      WS.prototype.send = function(data) {
        var self = this;
        setTimeout(function() {
          self.websocket.send(data)
        }, 0);
        return this
      }
    } else {
      WS.prototype.send = function(data) {
        this.websocket.send(data);
        return this
      }
    }
    WS.prototype.payload = function(arr) {
      for (var i = 0, l = arr.length; i < l; i++) {
        this.packet(arr[i])
      }
      return this
    };
    WS.prototype.close = function() {
      this.websocket.close();
      return this
    };
    WS.prototype.onError = function(e) {
      this.socket.onError(e)
    };
    WS.prototype.scheme = function() {
      return this.socket.options.secure ? "wss" : "ws"
    };
    WS.check = function() {
      return ("WebSocket" in global && !("__addTask" in WebSocket)) || "MozWebSocket" in global
    };
    WS.xdomainCheck = function() {
      return true
    };
    io.transports.push("websocket")
  })("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports, this);
  if (typeof define === "function" && define.amd) {
    define([], function() {
      return io
    })
  }
})();
(function(e, b) {
  var a = e.parse, d = [1, 4, 5, 6, 7, 10, 11];
  e.parse = function(h) {
    var g, l, c = 0;
    if (l = /^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(h)) {
      for (var f = 0, k; k = d[f]; ++f) {
        l[k] = +l[k] || 0
      }
      l[2] = (+l[2] || 1) - 1, l[3] = +l[3] || 1, l[8] !== "Z" && l[9] !== b && (c = l[10] * 60 + l[11], l[9] === "+" && (c = 0 - c)), g = e.UTC(l[1], l[2], l[3], l[4], l[5] + c, l[6], l[7])
    } else {
      g = a ? a(h) : NaN
    }
    return g
  }
})(Date);
window.Modernizr = function(aj, ai, ah) {
  function H(b) {
    aa.cssText = b
  }
  function G(d, c) {
    return H(prefixes.join(d + ";") + (c || ""))
  }
  function F(d, c) {
    return typeof d === c
  }
  function U(d, c) {
    return !!~("" + d).indexOf(c)
  }
  function S(f, c) {
    for (var h in f) {
      var g = f[h];
      if (!U(g, "-") && aa[g] !== ah) {
        return c == "pfx" ? g : !0
      }
    }
    return !1
  }
  function Q(g, c, l) {
    for (var k in g) {
      var h = c[g[k]];
      if (h !== ah) {
        return l === !1 ? g[k] : F(h, "function") ? h.bind(l || c) : h
      }
    }
    return !1
  }
  function O(g, f, l) {
    var k = g.charAt(0).toUpperCase() + g.slice(1), h = (g + " " + W.join(k + " ") + k).split(" ");
    return F(f, "string") || F(f, "undefined") ? S(h, f) : (h = (g + " " + V.join(k + " ") + k).split(" "), Q(h, f, l))
  }
  var ag = "2.6.2", af = {}, ae = !0, ad = ai.documentElement, ac = "modernizr", ab = ai.createElement(ac), aa = ab.style, Z, Y = {}.toString, X = "Webkit Moz O ms", W = X.split(" "), V = X.toLowerCase().split(" "), T = {}, R = {}, P = {}, N = [], M = N.slice, K, J = {}.hasOwnProperty, I;
  !F(J, "undefined") && !F(J.call, "undefined") ? I = function(d, c) {
    return J.call(d, c)
  } : I = function(d, c) {
    return c in d && F(d.constructor.prototype[c], "undefined")
  }, Function.prototype.bind || (Function.prototype.bind = function(a) {
    var h = this;
    if (typeof h != "function") {
      throw new TypeError
    }
    var g = M.call(arguments, 1), f = function() {
      if (this instanceof f) {
        var b = function() {
        };
        b.prototype = h.prototype;
        var d = new b, c = h.apply(d, g.concat(M.call(arguments)));
        return Object(c) === c ? c : d
      }
      return h.apply(a, g.concat(M.call(arguments)))
    };
    return f
  }), T.cssanimations = function() {
    return O("animationName")
  }, T.csstransitions = function() {
    return O("transition")
  };
  for (var L in T) {
    I(T, L) && (K = L.toLowerCase(), af[K] = T[L](), N.push((af[K] ? "" : "no-") + K))
  }
  return af.addTest = function(e, c) {
    if (typeof e == "object") {
      for (var f in e) {
        I(e, f) && af.addTest(f, e[f])
      }
    } else {
      e = e.toLowerCase();
      if (af[e] !== ah) {
        return af
      }
      c = typeof c == "function" ? c() : c, typeof ae != "undefined" && ae && (ad.className += " " + (c ? "" : "no-") + e), af[e] = c
    }
    return af
  }, H(""), ab = Z = null, function(ao, an) {
    function z(f, e) {
      var h = f.createElement("p"), g = f.getElementsByTagName("head")[0] || f.documentElement;
      return h.innerHTML = "x<style>" + e + "</style>", g.insertBefore(h.lastChild, g.firstChild)
    }
    function y() {
      var b = s.elements;
      return typeof b == "string" ? b.split(" ") : b
    }
    function x(d) {
      var c = B[d[D]];
      return c || (c = {}, C++, d[D] = C, B[C] = c), c
    }
    function w(b, h, e) {
      h || (h = an);
      if (A) {
        return h.createElement(b)
      }
      e || (e = x(h));
      var d;
      return e.cache[b] ? d = e.cache[b].cloneNode() : ak.test(b) ? d = (e.cache[b] = e.createElem(b)).cloneNode() : d = e.createElem(b), d.canHaveChildren && !al.test(b) ? e.frag.appendChild(d) : d
    }
    function v(b, n) {
      b || (b = an);
      if (A) {
        return b.createDocumentFragment()
      }
      n = n || x(b);
      var m = n.frag.cloneNode(), l = 0, k = y(), h = k.length;
      for (; l < h; l++) {
        m.createElement(k[l])
      }
      return m
    }
    function u(d, c) {
      c.cache || (c.cache = {}, c.createElem = d.createElement, c.createFrag = d.createDocumentFragment, c.frag = c.createFrag()), d.createElement = function(a) {
        return s.shivMethods ? w(a, d, c) : c.createElem(a)
      }, d.createDocumentFragment = Function("h,f", "return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&(" + y().join().replace(/\w+/g, function(b) {
        return c.createElem(b), c.frag.createElement(b), 'c("' + b + '")'
      }) + ");return n}")(s, c.frag)
    }
    function t(b) {
      b || (b = an);
      var d = x(b);
      return s.shivCSS && !E && !d.hasCSS && (d.hasCSS = !!z(b, "article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")), A || u(b, d), b
    }
    var am = ao.html5 || {}, al = /^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i, ak = /^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i, E, D = "_html5shiv", C = 0, B = {}, A;
    (function() {
      try {
        var b = an.createElement("a");
        b.innerHTML = "<xyz></xyz>", E = "hidden" in b, A = b.childNodes.length == 1 || function() {
          an.createElement("a");
          var c = an.createDocumentFragment();
          return typeof c.cloneNode == "undefined" || typeof c.createDocumentFragment == "undefined" || typeof c.createElement == "undefined"
        }()
      } catch (d) {
        E = !0, A = !0
      }
    })();
    var s = {elements: am.elements || "abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS: am.shivCSS !== !1,supportsUnknownElements: A,shivMethods: am.shivMethods !== !1,type: "default",shivDocument: t,createElement: w,createDocumentFragment: v};
    ao.html5 = s, t(an)
  }(this, ai), af._version = ag, af._domPrefixes = V, af._cssomPrefixes = W, af.testProp = function(b) {
    return S([b])
  }, af.testAllProps = O, ad.className = ad.className.replace(/(^|\s)no-js(\s|$)/, "$1$2") + (ae ? " js " + N.join(" ") : ""), af
}(this, this.document), function(ad, ac, ab) {
  function aa(b) {
    return "[object Function]" == P.call(b)
  }
  function Z(b) {
    return "string" == typeof b
  }
  function Y() {
  }
  function X(b) {
    return !b || "loaded" == b || "complete" == b || "uninitialized" == b
  }
  function W() {
    var b = O.shift();
    M = 1, b ? b.t ? R(function() {
      ("c" == b.t ? L.injectCss : L.injectJs)(b.s, 0, b.a, b.x, b.e, 1)
    }, 0) : (b(), W()) : M = 0
  }
  function V(w, v, t, s, q, p, n) {
    function m(a) {
      if (!g && X(h.readyState) && (x.r = g = 1, !M && W(), h.onload = h.onreadystatechange = null, a)) {
        "img" != w && R(function() {
          I.removeChild(h)
        }, 50);
        for (var c in D[v]) {
          D[v].hasOwnProperty(c) && D[v][c].onload()
        }
      }
    }
    var n = n || L.errorTimeout, h = ac.createElement(w), g = 0, b = 0, x = {t: t,s: v,e: q,a: p,x: n};
    1 === D[v] && (b = 1, D[v] = []), "object" == w ? h.data = v : (h.src = v, h.type = w), h.width = h.height = "0", h.onerror = h.onload = h.onreadystatechange = function() {
      m.call(this, b)
    }, O.splice(s, 0, x), "img" != w && (b || 2 === D[v] ? (I.insertBefore(h, J ? null : Q), R(m, n)) : D[v].push(h))
  }
  function U(g, e, l, k, h) {
    return M = 0, e = e || "j", Z(g) ? V("c" == e ? G : H, g, e, this.i++, l, k, h) : (O.splice(this.i++, 0, g), 1 == O.length && W()), this
  }
  function T() {
    var b = L;
    return b.loader = {load: U,i: 0}, b
  }
  var S = ac.documentElement, R = ad.setTimeout, Q = ac.getElementsByTagName("script")[0], P = {}.toString, O = [], M = 0, K = "MozAppearance" in S.style, J = K && !!ac.createRange().compareNode, I = J ? S : Q.parentNode, S = ad.opera && "[object Opera]" == P.call(ad.opera), S = !!ac.attachEvent && !S, H = K ? "object" : S ? "script" : "img", G = S ? "script" : H, F = Array.isArray || function(b) {
    return "[object Array]" == P.call(b)
  }, E = [], D = {}, C = {timeout: function(d, c) {
    return c.length && (d.timeout = c[0]), d
  }}, N, L;
  L = function(e) {
    function c(l) {
      var l = l.split("!"), h = E.length, s = l.pop(), r = l.length, s = {url: s,origUrl: s,prefixes: l}, q, p, o;
      for (p = 0; p < r; p++) {
        o = l[p].split("="), (q = C[o.shift()]) && (s = q(s, o))
      }
      for (p = 0; p < h; p++) {
        s = E[p](s)
      }
      return s
    }
    function n(b, s, r, q, p) {
      var o = c(b), l = o.autoCallback;
      o.url.split(".").pop().split("?").shift(), o.bypass || (s && (s = aa(s) ? s : s[b] || s[q] || s[b.split("/").pop().split("?")[0]]), o.instead ? o.instead(b, s, r, q, p) : (D[o.url] ? o.noexec = !0 : D[o.url] = 1, r.load(o.url, o.forceCSS || !o.forceJS && "css" == o.url.split(".").pop().split("?").shift() ? "c" : ab, o.noexec, o.attrs, o.timeout), (aa(s) || aa(l)) && r.load(function() {
        T(), s && s(o.origUrl, p, q), l && l(o.origUrl, p, q), D[o.url] = 2
      })))
    }
    function m(w, v) {
      function u(b, h) {
        if (b) {
          if (Z(b)) {
            h || (r = function() {
              var l = [].slice.call(arguments);
              q.apply(this, l), p()
            }), n(b, r, v, 0, t)
          } else {
            if (Object(b) === b) {
              for (g in o = function() {
                var a = 0, l;
                for (l in b) {
                  b.hasOwnProperty(l) && a++
                }
                return a
              }(), b) {
                b.hasOwnProperty(g) && (!h && !--o && (aa(r) ? r = function() {
                  var l = [].slice.call(arguments);
                  q.apply(this, l), p()
                } : r[g] = function(l) {
                  return function() {
                    var a = [].slice.call(arguments);
                    l && l.apply(this, a), p()
                  }
                }(q[g])), n(b[g], r, v, g, t))
              }
            }
          }
        } else {
          !h && p()
        }
      }
      var t = !!w.test, s = w.load || w.both, r = w.callback || Y, q = r, p = w.complete || Y, o, g;
      u(t ? w.yep : w.nope, !!s), s && u(s)
    }
    var k, f, d = this.yepnope.loader;
    if (Z(e)) {
      n(e, 0, d, 0)
    } else {
      if (F(e)) {
        for (k = 0; k < e.length; k++) {
          f = e[k], Z(f) ? n(f, 0, d, 0) : F(f) ? L(f) : Object(f) === f && m(f, d)
        }
      } else {
        Object(e) === e && m(e, d)
      }
    }
  }, L.addPrefix = function(d, c) {
    C[d] = c
  }, L.addFilter = function(b) {
    E.push(b)
  }, L.errorTimeout = 10000, null == ac.readyState && ac.addEventListener && (ac.readyState = "loading", ac.addEventListener("DOMContentLoaded", N = function() {
    ac.removeEventListener("DOMContentLoaded", N, 0), ac.readyState = "complete"
  }, 0)), ad.yepnope = T(), ad.yepnope.executeStack = W, ad.yepnope.injectJs = function(r, q, p, n, m, h) {
    var g = ac.createElement("script"), f, b, n = n || L.errorTimeout;
    g.src = r;
    for (b in p) {
      g.setAttribute(b, p[b])
    }
    q = h ? W : q || Y, g.onreadystatechange = g.onload = function() {
      !f && X(g.readyState) && (f = 1, q(), g.onload = g.onreadystatechange = null)
    }, R(function() {
      f || (f = 1, q(1))
    }, n), m ? g.onload() : Q.parentNode.insertBefore(g, Q)
  }, ad.yepnope.injectCss = function(b, n, m, l, k, h) {
    var l = ac.createElement("link"), f, n = h ? W : n || Y;
    l.href = b, l.rel = "stylesheet", l.type = "text/css";
    for (f in m) {
      l.setAttribute(f, m[f])
    }
    k || (Q.parentNode.insertBefore(l, Q), R(n, 0))
  }
}(this, document), Modernizr.load = function() {
  yepnope.apply(window, [].slice.call(arguments, 0))
};
(function(a) {
  a.fn.mask = function(c) {
    this.unmask();
    if (this.css("position") == "static") {
      this.addClass("masked-relative")
    }
    this.addClass("masked");
    var f = a('<div class="loadmask"></div>');
    var d = navigator.userAgent.toLowerCase();
    var h = document.compatMode == "CSS1Compat";
    var e = d.indexOf("msie") > -1;
    var g = d.indexOf("msie 7");
    if (e && !(g && h) && this.css("height") == "auto") {
      f.height(this.height());
      f.width(this.width())
    }
    this.append(f);
    if (typeof c == "string") {
      var b = a('<div class="loadmask-msg" style="display:none;"></div>');
      b.append("<div>" + c + "</div>");
      this.append(b);
      b.css("top", Math.round(this.height() / 2 - b.height() / 2) + "px");
      b.css("left", Math.round(this.width() / 2 - b.width() / 2) + "px");
      b.show()
    }
  };
  a.fn.unmask = function(b) {
    this.find(".loadmask-msg,.loadmask").remove();
    this.removeClass("masked");
    this.removeClass("masked-relative")
  }
})(jQuery);
(function(b) {
  var a = {};
  var c = {mode: "horizontal",slideSelector: "",infiniteLoop: true,hideControlOnEnd: false,speed: 500,easing: null,slideMargin: 0,startSlide: 0,randomStart: false,captions: false,ticker: false,tickerHover: false,adaptiveHeight: false,adaptiveHeightSpeed: 500,video: false,useCSS: true,preloadImages: "visible",touchEnabled: true,swipeThreshold: 50,oneToOneTouch: true,preventDefaultSwipeX: true,preventDefaultSwipeY: false,pager: true,pagerType: "full",pagerShortSeparator: " / ",pagerSelector: null,buildPager: null,pagerCustom: null,controls: true,nextText: "Next",prevText: "Prev",nextSelector: null,prevSelector: null,autoControls: false,startText: "Start",stopText: "Stop",autoControlsCombine: false,autoControlsSelector: null,auto: false,pause: 4000,autoStart: true,autoDirection: "next",autoHover: false,autoDelay: 0,minSlides: 1,maxSlides: 1,moveSlides: 0,slideWidth: 0,onSliderLoad: function() {
  },onSlideBefore: function() {
  },onSlideAfter: function() {
  },onSlideNext: function() {
  },onSlidePrev: function() {
  }};
  b.fn.bxSlider = function(s) {
    if (this.length == 0) {
      return
    }
    if (this.length > 1) {
      this.each(function() {
        b(this).bxSlider(s)
      });
      return this
    }
    var h = {};
    var H = this;
    a.el = this;
    var J = b(window).width();
    var M = b(window).height();
    var C = function() {
      h.settings = b.extend({}, c, s);
      h.settings.slideWidth = parseInt(h.settings.slideWidth);
      h.children = H.children(h.settings.slideSelector);
      if (h.children.length < h.settings.minSlides) {
        h.settings.minSlides = h.children.length
      }
      if (h.children.length < h.settings.maxSlides) {
        h.settings.maxSlides = h.children.length
      }
      if (h.settings.randomStart) {
        h.settings.startSlide = Math.floor(Math.random() * h.children.length)
      }
      h.active = {index: h.settings.startSlide};
      h.carousel = h.settings.minSlides > 1 || h.settings.maxSlides > 1;
      if (h.carousel) {
        h.settings.preloadImages = "all"
      }
      h.minThreshold = (h.settings.minSlides * h.settings.slideWidth) + ((h.settings.minSlides - 1) * h.settings.slideMargin);
      h.maxThreshold = (h.settings.maxSlides * h.settings.slideWidth) + ((h.settings.maxSlides - 1) * h.settings.slideMargin);
      h.working = false;
      h.controls = {};
      h.interval = null;
      h.animProp = h.settings.mode == "vertical" ? "top" : "left";
      h.usingCSS = h.settings.useCSS && h.settings.mode != "fade" && (function() {
        var T = document.createElement("div");
        var S = ["WebkitPerspective", "MozPerspective", "OPerspective", "msPerspective"];
        for (var R in S) {
          if (T.style[S[R]] !== undefined) {
            h.cssPrefix = S[R].replace("Perspective", "").toLowerCase();
            h.animProp = "-" + h.cssPrefix + "-transform";
            return true
          }
        }
        return false
      }());
      if (h.settings.mode == "vertical") {
        h.settings.maxSlides = h.settings.minSlides
      }
      m()
    };
    var m = function() {
      H.wrap('<div class="bx-wrapper"><div class="bx-viewport"></div></div>');
      h.viewport = H.parent();
      h.loader = b('<div class="bx-loading" />');
      h.viewport.prepend(h.loader);
      H.css({width: h.settings.mode == "horizontal" ? h.children.length * 215 + "%" : "auto",position: "relative"});
      if (h.usingCSS && h.settings.easing) {
        H.css("-" + h.cssPrefix + "-transition-timing-function", h.settings.easing)
      } else {
        if (!h.settings.easing) {
          h.settings.easing = "swing"
        }
      }
      var S = A();
      h.viewport.css({width: "100%",overflow: "hidden",position: "relative"});
      h.viewport.parent().css({maxWidth: L()});
      h.children.css({"float": h.settings.mode == "horizontal" ? "left" : "none",listStyle: "none",position: "relative"});
      h.children.width(D());
      if (h.settings.mode == "horizontal" && h.settings.slideMargin > 0) {
        h.children.css("marginRight", h.settings.slideMargin)
      }
      if (h.settings.mode == "vertical" && h.settings.slideMargin > 0) {
        h.children.css("marginBottom", h.settings.slideMargin)
      }
      if (h.settings.mode == "fade") {
        h.children.css({position: "absolute",zIndex: 0,display: "none"});
        h.children.eq(h.settings.startSlide).css({zIndex: 50,display: "block"})
      }
      h.controls.el = b('<div class="bx-controls" />');
      if (h.settings.captions) {
        z()
      }
      if (h.settings.infiniteLoop && h.settings.mode != "fade" && !h.settings.ticker) {
        var V = h.settings.mode == "vertical" ? h.settings.minSlides : h.settings.maxSlides;
        var U = h.children.slice(0, V).clone().addClass("bx-clone");
        var R = h.children.slice(-V).clone().addClass("bx-clone");
        H.append(U).prepend(R)
      }
      h.active.last = h.settings.startSlide == v() - 1;
      if (h.settings.video) {
        H.fitVids()
      }
      var T = h.children.eq(h.settings.startSlide);
      if (h.settings.preloadImages == "all") {
        T = H.children()
      }
      if (!h.settings.ticker) {
        if (h.settings.pager) {
          O()
        }
        if (h.settings.controls) {
          k()
        }
        if (h.settings.auto && h.settings.autoControls) {
          K()
        }
        if (h.settings.controls || h.settings.autoControls || h.settings.pager) {
          h.viewport.after(h.controls.el)
        }
      }
      T.imagesLoaded(t)
    };
    var t = function() {
      h.loader.remove();
      g();
      if (h.settings.mode == "vertical") {
        h.settings.adaptiveHeight = true
      }
      h.viewport.height(o());
      H.redrawSlider();
      h.settings.onSliderLoad(h.active.index);
      h.initialized = true;
      b(window).bind("resize", n);
      if (h.settings.auto && h.settings.autoStart) {
        d()
      }
      if (h.settings.ticker) {
        E()
      }
      if (h.settings.pager) {
        Q(h.settings.startSlide)
      }
      if (h.settings.controls) {
        l()
      }
      if (h.settings.touchEnabled && !h.settings.ticker) {
        e()
      }
    };
    var o = function() {
      var R = 0;
      var T = b();
      if (h.settings.mode != "vertical" && !h.settings.adaptiveHeight) {
        T = h.children
      } else {
        if (!h.carousel) {
          T = h.children.eq(h.active.index)
        } else {
          var S = h.settings.moveSlides == 1 ? h.active.index : h.active.index * q();
          T = h.children.eq(S);
          for (i = 1; i <= h.settings.maxSlides - 1; i++) {
            if (S + i >= h.children.length) {
              T = T.add(h.children.eq(i - 1))
            } else {
              T = T.add(h.children.eq(S + i))
            }
          }
        }
      }
      if (h.settings.mode == "vertical") {
        T.each(function(U) {
          R += b(this).outerHeight()
        });
        if (h.settings.slideMargin > 0) {
          R += h.settings.slideMargin * (h.settings.minSlides - 1)
        }
      } else {
        R = Math.max.apply(Math, T.map(function() {
          return b(this).outerHeight(false)
        }).get())
      }
      return R
    };
    var L = function() {
      var R = "100%";
      if (h.settings.slideWidth > 0) {
        if (h.settings.mode == "horizontal") {
          R = (h.settings.maxSlides * h.settings.slideWidth) + ((h.settings.maxSlides - 1) * h.settings.slideMargin)
        } else {
          R = h.settings.slideWidth
        }
      }
      return R
    };
    var D = function() {
      var S = h.settings.slideWidth;
      var R = h.viewport.width();
      if (h.settings.slideWidth == 0 || (h.settings.slideWidth > R && !h.carousel) || h.settings.mode == "vertical") {
        S = R
      } else {
        if (h.settings.maxSlides > 1 && h.settings.mode == "horizontal") {
          if (R > h.maxThreshold) {
          } else {
            if (R < h.minThreshold) {
              S = (R - (h.settings.slideMargin * (h.settings.minSlides - 1))) / h.settings.minSlides
            }
          }
        }
      }
      return S
    };
    var A = function() {
      var S = 1;
      if (h.settings.mode == "horizontal" && h.settings.slideWidth > 0) {
        if (h.viewport.width() < h.minThreshold) {
          S = h.settings.minSlides
        } else {
          if (h.viewport.width() > h.maxThreshold) {
            S = h.settings.maxSlides
          } else {
            var R = h.children.first().width();
            S = Math.floor(h.viewport.width() / R)
          }
        }
      } else {
        if (h.settings.mode == "vertical") {
          S = h.settings.minSlides
        }
      }
      return S
    };
    var v = function() {
      var S = 0;
      if (h.settings.moveSlides > 0) {
        if (h.settings.infiniteLoop) {
          S = h.children.length / q()
        } else {
          var T = 0;
          var R = 0;
          while (T < h.children.length) {
            ++S;
            T = R + A();
            R += h.settings.moveSlides <= A() ? h.settings.moveSlides : A()
          }
        }
      } else {
        S = Math.ceil(h.children.length / A())
      }
      return S
    };
    var q = function() {
      if (h.settings.moveSlides > 0 && h.settings.moveSlides <= A()) {
        return h.settings.moveSlides
      }
      return A()
    };
    var g = function() {
      if (h.children.length > h.settings.maxSlides && h.active.last && !h.settings.infiniteLoop) {
        if (h.settings.mode == "horizontal") {
          var T = h.children.last();
          var R = T.position();
          B(-(R.left - (h.viewport.width() - T.width())), "reset", 0)
        } else {
          if (h.settings.mode == "vertical") {
            var S = h.children.length - h.settings.minSlides;
            var R = h.children.eq(S).position();
            B(-R.top, "reset", 0)
          }
        }
      } else {
        var R = h.children.eq(h.active.index * q()).position();
        if (h.active.index == v() - 1) {
          h.active.last = true
        }
        if (R != undefined) {
          if (h.settings.mode == "horizontal") {
            B(-R.left, "reset", 0)
          } else {
            if (h.settings.mode == "vertical") {
              B(-R.top, "reset", 0)
            }
          }
        }
      }
    };
    var B = function(T, S, U, W) {
      if (h.usingCSS) {
        var V = h.settings.mode == "vertical" ? "translate3d(0, " + T + "px, 0)" : "translate3d(" + T + "px, 0, 0)";
        H.css("-" + h.cssPrefix + "-transition-duration", U / 1000 + "s");
        if (S == "slide") {
          H.css(h.animProp, V);
          H.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd", function() {
            H.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");
            p()
          })
        } else {
          if (S == "reset") {
            H.css(h.animProp, V)
          } else {
            if (S == "ticker") {
              H.css("-" + h.cssPrefix + "-transition-timing-function", "linear");
              H.css(h.animProp, V);
              H.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd", function() {
                H.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");
                B(W.resetValue, "reset", 0);
                u()
              })
            }
          }
        }
      } else {
        var R = {};
        R[h.animProp] = T;
        if (S == "slide") {
          H.animate(R, U, h.settings.easing, function() {
            p()
          })
        } else {
          if (S == "reset") {
            H.css(h.animProp, T)
          } else {
            if (S == "ticker") {
              H.animate(R, speed, "linear", function() {
                B(W.resetValue, "reset", 0);
                u()
              })
            }
          }
        }
      }
    };
    var r = function() {
      var T = "";
      pagerQty = v();
      for (var S = 0; S < pagerQty; S++) {
        var R = "";
        if (h.settings.buildPager && b.isFunction(h.settings.buildPager)) {
          R = h.settings.buildPager(S);
          h.pagerEl.addClass("bx-custom-pager")
        } else {
          R = S + 1;
          h.pagerEl.addClass("bx-default-pager")
        }
        T += '<div class="bx-pager-item"><a href="" data-slide-index="' + S + '" class="bx-pager-link">' + R + "</a></div>"
      }
      h.pagerEl.html(T)
    };
    var O = function() {
      if (!h.settings.pagerCustom) {
        h.pagerEl = b('<div class="bx-pager" />');
        if (h.settings.pagerSelector) {
          b(h.settings.pagerSelector).html(h.pagerEl)
        } else {
          h.controls.el.addClass("bx-has-pager").append(h.pagerEl)
        }
        r()
      } else {
        h.pagerEl = b(h.settings.pagerCustom)
      }
      h.pagerEl.delegate("a", "click", x)
    };
    var k = function() {
      h.controls.next = b(h.settings.nextSelector + "");
      h.controls.prev = b(h.settings.prevSelector + "");
      h.controls.next.bind("click", f);
      h.controls.prev.bind("click", N);
      if (!h.settings.nextSelector && !h.settings.prevSelector) {
        h.controls.directionEl = b('<div class="bx-controls-direction" />');
        h.controls.directionEl.append(h.controls.prev).append(h.controls.next);
        h.controls.el.addClass("bx-has-controls-direction").append(h.controls.directionEl)
      }
    };
    var K = function() {
      h.controls.start = b('<div class="bx-controls-auto-item"><a class="bx-start" href="">' + h.settings.startText + "</a></div>");
      h.controls.stop = b('<div class="bx-controls-auto-item"><a class="bx-stop" href="">' + h.settings.stopText + "</a></div>");
      h.controls.autoEl = b('<div class="bx-controls-auto" />');
      h.controls.autoEl.delegate(".bx-start", "click", w);
      h.controls.autoEl.delegate(".bx-stop", "click", P);
      if (h.settings.autoControlsCombine) {
        h.controls.autoEl.append(h.controls.start)
      } else {
        h.controls.autoEl.append(h.controls.start).append(h.controls.stop)
      }
      if (h.settings.autoControlsSelector) {
        b(h.settings.autoControlsSelector).html(h.controls.autoEl)
      } else {
        h.controls.el.addClass("bx-has-controls-auto").append(h.controls.autoEl)
      }
      G(h.settings.autoStart ? "stop" : "start")
    };
    var z = function() {
      h.children.each(function(R) {
        var S = b(this).find("img:first").attr("title");
        if (S != undefined) {
          b(this).append('<div class="bx-caption"><span>' + S + "</span></div>")
        }
      })
    };
    var f = function(R) {
      if (h.settings.auto) {
        H.stopAuto()
      }
      H.goToNextSlide();
      R.preventDefault()
    };
    var N = function(R) {
      if (h.settings.auto) {
        H.stopAuto()
      }
      H.goToPrevSlide();
      R.preventDefault()
    };
    var w = function(R) {
      H.startAuto();
      R.preventDefault()
    };
    var P = function(R) {
      H.stopAuto();
      R.preventDefault()
    };
    var x = function(T) {
      if (h.settings.auto) {
        H.stopAuto()
      }
      var S = b(T.currentTarget);
      var R = parseInt(S.attr("data-slide-index"));
      if (R != h.active.index) {
        H.goToSlide(R)
      }
      T.preventDefault()
    };
    var Q = function(R) {
      if (h.settings.pagerType == "short") {
        h.pagerEl.html((R + 1) + h.settings.pagerShortSeparator + h.children.length);
        return
      }
      h.pagerEl.find("a").removeClass("active");
      h.pagerEl.each(function(S, T) {
        b(T).find("a").eq(R).addClass("active")
      })
    };
    var p = function() {
      if (h.settings.infiniteLoop) {
        var R = "";
        if (h.active.index == 0) {
          R = h.children.eq(0).position()
        } else {
          if (h.active.index == v() - 1 && h.carousel) {
            R = h.children.eq((v() - 1) * q()).position()
          } else {
            if (h.active.index == h.children.length - 1) {
              R = h.children.eq(h.children.length - 1).position()
            }
          }
        }
        if (h.settings.mode == "horizontal") {
          B(-R.left, "reset", 0)
        } else {
          if (h.settings.mode == "vertical") {
            B(-R.top, "reset", 0)
          }
        }
      }
      h.working = false;
      h.settings.onSlideAfter(h.children.eq(h.active.index), h.oldIndex, h.active.index)
    };
    var G = function(R) {
      if (h.settings.autoControlsCombine) {
        h.controls.autoEl.html(h.controls[R])
      } else {
        h.controls.autoEl.find("a").removeClass("active");
        h.controls.autoEl.find("a:not(.bx-" + R + ")").addClass("active")
      }
    };
    var l = function() {
      if (!h.settings.infiniteLoop && h.settings.hideControlOnEnd) {
        if (h.active.index == 0) {
          h.controls.prev.addClass("disabled");
          h.controls.next.removeClass("disabled")
        } else {
          if (h.active.index == v() - 1) {
            h.controls.next.addClass("disabled");
            h.controls.prev.removeClass("disabled")
          } else {
            h.controls.prev.removeClass("disabled");
            h.controls.next.removeClass("disabled")
          }
        }
      } else {
        if (v() == 1) {
          h.controls.prev.addClass("disabled");
          h.controls.next.addClass("disabled")
        }
      }
    };
    var d = function() {
      if (h.settings.autoDelay > 0) {
        var R = setTimeout(H.startAuto, h.settings.autoDelay)
      } else {
        H.startAuto()
      }
      if (h.settings.autoHover) {
        H.hover(function() {
          if (h.interval) {
            H.stopAuto(true);
            h.autoPaused = true
          }
        }, function() {
          if (h.autoPaused) {
            H.startAuto(true);
            h.autoPaused = null
          }
        })
      }
    };
    var E = function() {
      var S = 0;
      if (h.settings.autoDirection == "next") {
        H.append(h.children.clone().addClass("bx-clone"))
      } else {
        H.prepend(h.children.clone().addClass("bx-clone"));
        var R = h.children.first().position();
        S = h.settings.mode == "horizontal" ? -R.left : -R.top
      }
      B(S, "reset", 0);
      h.settings.pager = false;
      h.settings.controls = false;
      h.settings.autoControls = false;
      if (h.settings.tickerHover && !h.usingCSS) {
        h.viewport.hover(function() {
          H.stop()
        }, function() {
          var W = 0;
          h.children.each(function(X) {
            W += h.settings.mode == "horizontal" ? b(this).outerWidth(true) : b(this).outerHeight(true)
          });
          var T = h.settings.speed / W;
          var U = h.settings.mode == "horizontal" ? "left" : "top";
          var V = T * (W - (Math.abs(parseInt(H.css(U)))));
          u(V)
        })
      }
      u()
    };
    var u = function(W) {
      speed = W ? W : h.settings.speed;
      var R = {left: 0,top: 0};
      var U = {left: 0,top: 0};
      if (h.settings.autoDirection == "next") {
        R = H.find(".bx-clone").first().position()
      } else {
        U = h.children.first().position()
      }
      var T = h.settings.mode == "horizontal" ? -R.left : -R.top;
      var S = h.settings.mode == "horizontal" ? -U.left : -U.top;
      var V = {resetValue: S};
      B(T, "ticker", speed, V)
    };
    var e = function() {
      h.touch = {start: {x: 0,y: 0},end: {x: 0,y: 0}};
      h.viewport.bind("touchstart", F)
    };
    var F = function(R) {
      if (h.working) {
        R.preventDefault()
      } else {
        h.touch.originalPos = H.position();
        var S = R.originalEvent;
        h.touch.start.x = S.changedTouches[0].pageX;
        h.touch.start.y = S.changedTouches[0].pageY;
        h.viewport.bind("touchmove", I);
        h.viewport.bind("touchend", y)
      }
    };
    var I = function(S) {
      var W = S.originalEvent;
      var T = Math.abs(W.changedTouches[0].pageX - h.touch.start.x);
      var V = Math.abs(W.changedTouches[0].pageY - h.touch.start.y);
      if ((T * 3) > V && h.settings.preventDefaultSwipeX) {
        S.preventDefault()
      } else {
        if ((V * 3) > T && h.settings.preventDefaultSwipeY) {
          S.preventDefault()
        }
      }
      if (h.settings.mode != "fade" && h.settings.oneToOneTouch) {
        var R = 0;
        if (h.settings.mode == "horizontal") {
          var U = W.changedTouches[0].pageX - h.touch.start.x;
          R = h.touch.originalPos.left + U
        } else {
          var U = W.changedTouches[0].pageY - h.touch.start.y;
          R = h.touch.originalPos.top + U
        }
        B(R, "reset", 0)
      }
    };
    var y = function(S) {
      h.viewport.unbind("touchmove", I);
      var U = S.originalEvent;
      var R = 0;
      h.touch.end.x = U.changedTouches[0].pageX;
      h.touch.end.y = U.changedTouches[0].pageY;
      if (h.settings.mode == "fade") {
        var T = Math.abs(h.touch.start.x - h.touch.end.x);
        if (T >= h.settings.swipeThreshold) {
          h.touch.start.x > h.touch.end.x ? H.goToNextSlide() : H.goToPrevSlide();
          H.stopAuto()
        }
      } else {
        var T = 0;
        if (h.settings.mode == "horizontal") {
          T = h.touch.end.x - h.touch.start.x;
          R = h.touch.originalPos.left
        } else {
          T = h.touch.end.y - h.touch.start.y;
          R = h.touch.originalPos.top
        }
        if (!h.settings.infiniteLoop && ((h.active.index == 0 && T > 0) || (h.active.last && T < 0))) {
          B(R, "reset", 200)
        } else {
          if (Math.abs(T) >= h.settings.swipeThreshold) {
            T < 0 ? H.goToNextSlide() : H.goToPrevSlide();
            H.stopAuto()
          } else {
            B(R, "reset", 200)
          }
        }
      }
      h.viewport.unbind("touchend", y)
    };
    var n = function(S) {
      var R = b(window).width();
      var T = b(window).height();
      if (J != R || M != T) {
        J = R;
        M = T;
        H.redrawSlider()
      }
    };
    H.goToSlide = function(V, X) {
      if (h.working || h.active.index == V) {
        return
      }
      h.working = true;
      h.oldIndex = h.active.index;
      if (V < 0) {
        h.active.index = v() - 1
      } else {
        if (V >= v()) {
          h.active.index = 0
        } else {
          h.active.index = V
        }
      }
      h.settings.onSlideBefore(h.children.eq(h.active.index), h.oldIndex, h.active.index);
      if (X == "next") {
        h.settings.onSlideNext(h.children.eq(h.active.index), h.oldIndex, h.active.index)
      } else {
        if (X == "prev") {
          h.settings.onSlidePrev(h.children.eq(h.active.index), h.oldIndex, h.active.index)
        }
      }
      h.active.last = h.active.index >= v() - 1;
      if (h.settings.pager) {
        Q(h.active.index)
      }
      if (h.settings.controls) {
        l()
      }
      if (h.settings.mode == "fade") {
        if (h.settings.adaptiveHeight && h.viewport.height() != o()) {
          h.viewport.animate({height: o()}, h.settings.adaptiveHeightSpeed)
        }
        h.children.filter(":visible").fadeOut(h.settings.speed).css({zIndex: 0});
        h.children.eq(h.active.index).css("zIndex", 51).fadeIn(h.settings.speed, function() {
          b(this).css("zIndex", 50);
          p()
        })
      } else {
        if (h.settings.adaptiveHeight && h.viewport.height() != o()) {
          h.viewport.animate({height: o()}, h.settings.adaptiveHeightSpeed)
        }
        var W = 0;
        var U = {left: 0,top: 0};
        if (!h.settings.infiniteLoop && h.carousel && h.active.last) {
          if (h.settings.mode == "horizontal") {
            var R = h.children.eq(h.children.length - 1);
            U = R.position();
            W = h.viewport.width() - R.width()
          } else {
            var T = h.children.length - h.settings.minSlides;
            U = h.children.eq(T).position()
          }
        } else {
          if (h.carousel && h.active.last && X == "prev") {
            var Z = h.settings.moveSlides == 1 ? h.settings.maxSlides - q() : ((v() - 1) * q()) - (h.children.length - h.settings.maxSlides);
            var R = H.children(".bx-clone").eq(Z);
            U = R.position()
          } else {
            if (X == "next" && h.active.index == 0) {
              U = H.find(".bx-clone").eq(h.settings.maxSlides).position();
              h.active.last = false
            } else {
              if (V >= 0) {
                var S = V * q();
                U = h.children.eq(S).position()
              }
            }
          }
        }
        var Y = h.settings.mode == "horizontal" ? -(U.left - W) : -U.top;
        B(Y, "slide", h.settings.speed)
      }
    };
    H.goToNextSlide = function() {
      if (!h.settings.infiniteLoop && h.active.last) {
        return
      }
      var R = parseInt(h.active.index) + 1;
      H.goToSlide(R, "next")
    };
    H.goToPrevSlide = function() {
      if (!h.settings.infiniteLoop && h.active.index == 0) {
        return
      }
      var R = parseInt(h.active.index) - 1;
      H.goToSlide(R, "prev")
    };
    H.startAuto = function(R) {
      if (h.interval) {
        return
      }
      h.interval = setInterval(function() {
        h.settings.autoDirection == "next" ? H.goToNextSlide() : H.goToPrevSlide()
      }, h.settings.pause);
      if (h.settings.autoControls && R != true) {
        G("stop")
      }
    };
    H.stopAuto = function(R) {
      if (!h.interval) {
        return
      }
      clearInterval(h.interval);
      h.interval = null;
      if (h.settings.autoControls && R != true) {
        G("start")
      }
    };
    H.getCurrentSlide = function() {
      return h.active.index
    };
    H.getSlideCount = function() {
      return h.children.length
    };
    H.redrawSlider = function() {
      h.children.add(H.find(".bx-clone")).width(D());
      h.viewport.css("height", o());
      if (!h.settings.ticker) {
        g()
      }
      if (h.active.last) {
        h.active.index = v() - 1
      }
      if (h.active.index >= v()) {
        h.active.last = true
      }
      if (h.settings.pager && !h.settings.pagerCustom) {
        r();
        Q(h.active.index)
      }
    };
    H.destroySlider = function() {
      if (!h.initialized) {
        return
      }
      h.initialized = false;
      b(".bx-clone", this).remove();
      h.children.removeAttr("style");
      this.removeAttr("style").unwrap().unwrap();
      if (h.controls.el) {
        h.controls.el.remove()
      }
      if (h.pagerEl) {
        h.pagerEl.remove()
      }
      b(".bx-caption", this).remove();
      if (h.controls.autoEl) {
        h.controls.autoEl.remove()
      }
      clearInterval(h.interval);
      b(window).unbind("resize", n)
    };
    H.reloadSlider = function(R) {
      if (R != undefined) {
        s = R
      }
      H.destroySlider();
      C()
    };
    C();
    return this
  }
})(jQuery);
/*
 * jQuery imagesLoaded plugin v2.1.0
 * http://github.com/desandro/imagesloaded
 *
 * MIT License. by Paul Irish et al.
 */
(function(d, b) {
  var a = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";
  d.fn.imagesLoaded = function(t) {
    function l() {
      var e = d(q), f = d(r);
      v && (r.length ? v.reject(u, e, f) : v.resolve(u));
      d.isFunction(t) && t.call(s, u, e, f)
    }
    function p(e, f) {
      e.src === a || -1 !== d.inArray(e, n) || (n.push(e), f ? r.push(e) : q.push(e), d.data(e, "imagesLoaded", {isBroken: f,src: e.src}), c && v.notifyWith(d(e), [f, u, d(q), d(r)]), u.length === n.length && (setTimeout(l), u.unbind(".imagesLoaded")))
    }
    var s = this, v = d.isFunction(d.Deferred) ? d.Deferred() : 0, c = d.isFunction(v.notify), u = s.find("img").add(s.filter("img")), n = [], q = [], r = [];
    d.isPlainObject(t) && d.each(t, function(e, f) {
      if ("callback" === e) {
        t = f
      } else {
        if (v) {
          v[e](f)
        }
      }
    });
    u.length ? u.bind("load.imagesLoaded error.imagesLoaded", function(e) {
      p(e.target, "error" === e.type)
    }).each(function(f, g) {
        var k = g.src, h = d.data(g, "imagesLoaded");
        if (h && h.src === k) {
          p(g, h.isBroken)
        } else {
          if (g.complete && g.naturalWidth !== b) {
            p(g, 0 === g.naturalWidth || 0 === g.naturalHeight)
          } else {
            if (g.readyState || g.complete) {
              g.src = a, g.src = k
            }
          }
        }
      }) : l();
    return v ? v.promise(s) : s
  }
})(jQuery);
(function(n, p, u) {
  var w = n([]), s = n.resize = n.extend(n.resize, {}), o, l = "setTimeout", m = "resize", t = m + "-special-event", v = "delay", r = "throttleWindow";
  s[v] = 250;
  s[r] = true;
  n.event.special[m] = {setup: function() {
    if (!s[r] && this[l]) {
      return false
    }
    var a = n(this);
    w = w.add(a);
    n.data(this, t, {w: a.width(),h: a.height()});
    if (w.length === 1) {
      q()
    }
  },teardown: function() {
    if (!s[r] && this[l]) {
      return false
    }
    var a = n(this);
    w = w.not(a);
    a.removeData(t);
    if (!w.length) {
      clearTimeout(o)
    }
  },add: function(b) {
    if (!s[r] && this[l]) {
      return false
    }
    var c;
    function a(d, h, g) {
      var f = n(this), e = n.data(this, t);
      e.w = h !== u ? h : f.width();
      e.h = g !== u ? g : f.height();
      c.apply(this, arguments)
    }
    if (n.isFunction(b)) {
      c = b;
      return a
    } else {
      c = b.handler;
      b.handler = a
    }
  }};
  function q() {
    o = p[l](function() {
      w.each(function() {
        var d = n(this), a = d.width(), b = d.height(), c = n.data(this, t);
        if (a !== c.w || b !== c.h) {
          d.trigger(m, [c.w = a, c.h = b])
        }
      });
      q()
    }, s[v])
  }
})(jQuery, this);
/*
 jQuery Autosize v1.16.7
 (c) 2013 Jack Moore - jacklmoore.com
 updated: 2013-03-20
 license: http://www.opensource.org/licenses/mit-license.php
 */
(function(d) {
  var c = {className: "autosizejs",append: "",callback: false}, f = "hidden", b = "border-box", n = "lineHeight", h, a = '<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden;"/>', g = ["fontFamily", "fontSize", "fontWeight", "fontStyle", "letterSpacing", "textTransform", "wordSpacing", "textIndent"], l = "oninput", e = "onpropertychange", m, k = d(a).data("autosize", true)[0];
  k.style.lineHeight = "99px";
  if (d(k).css(n) === "99px") {
    g.push(n)
  }
  k.style.lineHeight = "";
  d.fn.autogrow = function(o) {
    o = d.extend({}, c, o || {});
    if (k.parentNode !== document.body) {
      d(document.body).append(k);
      k.value = "\n\n\n";
      k.scrollTop = 90000;
      h = k.scrollHeight === k.scrollTop + k.clientHeight
    }
    return this.each(function() {
      var t = this, r = d(t), x, s, q, p = 0, w = d.isFunction(o.callback);
      if (r.data("autosize")) {
        return
      }
      if (r.css("box-sizing") === b || r.css("-moz-box-sizing") === b || r.css("-webkit-box-sizing") === b) {
        p = r.outerHeight() - r.height()
      }
      x = Math.max(parseInt(r.css("minHeight"), 10) - p, r.height());
      q = (r.css("resize") === "none" || r.css("resize") === "vertical") ? "none" : "horizontal";
      r.css({overflow: f,overflowY: f,wordWrap: "break-word",resize: q}).data("autosize", true);
      function v() {
        m = t;
        k.className = o.className;
        d.each(g, function(y, z) {
          k.style[z] = r.css(z)
        })
      }
      function u() {
        var y, B, z;
        if (m !== t) {
          v()
        }
        if (!s) {
          s = true;
          k.value = t.value + o.append;
          k.style.overflowY = t.style.overflowY;
          z = parseInt(t.style.height, 10);
          k.style.width = Math.max(r.width(), 462) + "px";
          if (h) {
            y = k.scrollHeight
          } else {
            k.scrollTop = 0;
            k.scrollTop = 90000;
            y = k.scrollTop
          }
          var A = parseInt(r.css("maxHeight"), 10);
          A = A && A > 0 ? A : 90000;
          if (y > A) {
            y = A;
            B = "scroll"
          } else {
            if (y < x) {
              y = x
            }
          }
          y += p;
          t.style.overflowY = B || f;
          if (z !== y) {
            t.style.height = y + "px";
            if (w) {
              o.callback.call(t)
            }
          }
          setTimeout(function() {
            s = false
          }, 1)
        }
      }
      if (e in t) {
        if (l in t) {
          t[l] = t.onkeyup = u
        } else {
          t[e] = u
        }
      } else {
        t[l] = u
      }
      d(window).on("resize", function() {
        s = false;
        u()
      });
      r.on("autosize", function() {
        s = false;
        u()
      });
      u()
    })
  }
}(window.jQuery || window.Zepto));
(function() {
  window.tracksflow.h.dropPosition = function(a) {
    this.a = {tryPositionCount: 0,ARR_OFFSET: 15,st: {position: "best",preferredPositions: null,positionPriority: ["bottom-left", "top-left", "top", "bottom", "left", "top-left", "top-right", "bottom-left", "bottom-right"],offset: 10},init: function(b) {
      this.extendDefaults(b);
      this.st.preferredPositions && this.fillPreferredPositions();
      this.calcElementCenter();
      return this.calcPosition(this.st.position)
    },calcPosition: function(b) {
      if (b === "best") {
        return (this.tryPositionCount < this.st.positionPriority.length + 1) && this.calcPosition(this.tryPosition(this.st.positionPriority[this.tryPositionCount++ % this.st.positionPriority.length]))
      } else {
        return b
      }
    },tryPosition: function(c) {
      var h, f, b, g, e, d;
      d = this.tryPositionCount === this.st.positionPriority.length + 1;
      switch (c) {
        case "top":
          g = this.$w.scrollTop() < this.pTop;
          f = this.$w.scrollLeft() < this.elemCenter.x - this.pCenter.x + this.st.offset;
          b = this.$w.scrollLeft() + this.$w.outerWidth() > this.elemCenter.x + this.pCenter.x + this.st.offset;
          e = {top: this.pTop,left: this.elemCenter.x - this.pCenter.x,currentPosition: "top"};
          if ((g && f && b) || d) {
            return e
          } else {
            return "best"
          }
          break;
        case "bottom":
          h = this.$w.scrollTop() + this.$w.outerHeight() > this.pBot + this.$p.outerHeight();
          f = this.$w.scrollLeft() < this.elemCenter.x - this.pCenter.x + this.st.offset;
          b = this.$w.scrollLeft() + this.$w.outerWidth() > this.elemCenter.x + this.pCenter.x + this.st.offset;
          e = {top: this.pBot,left: this.elemCenter.x - this.pCenter.x,arrowPos: "is-top",currentPosition: "bottom"};
          if ((h && f && b) || d) {
            return e
          } else {
            return "best"
          }
          break;
        case "left":
          g = this.$w.scrollTop() < this.elemCenter.y - this.pCenter.y;
          f = this.$w.scrollLeft() < this.pLeft;
          h = this.$w.scrollTop() + this.$w.outerHeight() > this.elemCenter.y + this.pCenter.y;
          e = {top: this.elemCenter.y - this.pCenter.y,left: this.pLeft,arrowPos: "is-right is-middle",currentPosition: "left"};
          if ((g && f && h) || d) {
            return e
          } else {
            return "best"
          }
          break;
        case "right":
          g = this.$w.scrollTop() < this.elemCenter.y - this.pCenter.y;
          b = this.$w.scrollLeft() + this.$w.outerWidth() > this.pRight + this.$p.outerWidth();
          h = this.$w.scrollTop() + this.$w.outerHeight() > this.elemCenter.y + this.pCenter.y;
          e = {top: this.elemCenter.y - this.pCenter.y,left: this.pRight,arrowPos: "is-left is-middle",currentPosition: "right"};
          if ((g && b && h) || d) {
            return e
          } else {
            return "best"
          }
          break;
        case "top-right":
          g = this.$w.scrollTop() < this.pTop;
          b = this.$w.scrollLeft() + this.$w.outerWidth() > this.pRight + this.$p.outerWidth() - this.ARR_OFFSET;
          e = {top: this.pTop,left: this.elemCenter.x - this.ARR_OFFSET,arrowPos: "is-left",currentPosition: "top-right"};
          if ((g && b) || d) {
            return e
          } else {
            return "best"
          }
          break;
        case "top-left":
          g = this.$w.scrollTop() < this.pTop;
          f = this.$w.scrollLeft() < this.pLeft + this.ARR_OFFSET;
          e = {top: this.pTop,left: this.elemCenter.x - this.$p.outerWidth() + this.ARR_OFFSET,arrowPos: "is-right",currentPosition: "top-left"};
          if ((g && f) || d) {
            return e
          } else {
            return "best"
          }
          break;
        case "bottom-right":
          h = this.$w.scrollTop() + this.$w.outerHeight() > this.pBot + this.$p.outerHeight();
          b = this.$w.scrollLeft() + this.$w.outerWidth() > this.pRight + this.$p.outerWidth() - this.ARR_OFFSET;
          e = {top: this.pBot,left: this.elemCenter.x - this.ARR_OFFSET,arrowPos: "is-top is-left",currentPosition: "bottom-right"};
          if ((h && b) || d) {
            return e
          } else {
            return "best"
          }
          break;
        case "bottom-left":
          h = this.$w.scrollTop() + this.$w.outerHeight() > this.pBot + this.$p.outerHeight();
          f = this.elemCenter.x - this.$p.outerWidth() + this.ARR_OFFSET;
          e = {top: this.pBot,left: this.elemCenter.x - this.$p.outerWidth() + this.ARR_OFFSET,arrowPos: "is-top is-right",currentPosition: "bottom-left"};
          if ((h && f) || d) {
            return e
          } else {
            return "best"
          }
      }
    },calcElementCenter: function() {
      this.$el = this.st.target;
      this.$p = this.st.popup;
      this.$w = $(window);
      this.elemCenter = {};
      this.pCenter = {};
      this.elemCenter.x = this.$el.offset().left + (this.$el.outerWidth() / 2);
      this.elemCenter.y = this.$el.offset().top + (this.$el.outerHeight() / 2);
      this.pCenter.x = this.$p.outerWidth() / 2;
      this.pCenter.y = this.$p.outerHeight() / 2;
      this.pTop = this.$el.offset().top - this.$p.outerHeight() - this.st.offset;
      this.pBot = this.$el.offset().top + this.$el.outerHeight() + this.st.offset;
      this.pLeft = this.$el.offset().left - this.$p.outerWidth() - this.st.offset;
      return this.pRight = this.$el.offset().left + this.$el.outerWidth() + this.st.offset
    },fillPreferredPositions: function() {
      var b = this;
      return _.each(this.st.preferredPositions, function(d, c) {
        return b.st.positionPriority[c] = d
      })
    },extendDefaults: function(b) {
      return this.st = $.extend({}, this.st, b || {})
    }};
    return this.a.init(a)
  }
}).call(this);
(function() {
  var b, a;
  window.__ = window.resources.__ = function(c) {
    if (window.resources.dic[c]) {
      return window.resources.dic[c]
    } else {
      return c
    }
  };
  window.resources.langMap = {en: "en",ua: "ru",uz: "ru",kz: "ru",by: "ru",ru: "ru",ge: "ru",kg: "ru",am: "ru",az: "ru",tj: "ru",tm: "ru",lv: "ru",lt: "ru",ee: "ru"};
  window.resources.useBrowserLanguage = function() {
    var c;
    c = window.navigator.language && window.navigator.language.substr(0, 2);
    c = c || "en";
    window.resources.LANG = window.resources.langMap[c] || "en";
    return window.resources.LANG
  };
  window.resources.LANG = $.cookie("lang") || window.resources.useBrowserLanguage();
  window.resources.LANG = window.resources.langMap[window.resources.LANG] ? window.resources.langMap[window.resources.LANG] : "en";
  $("#resourcesScript").replaceWith('<script id="lang-dic" type="text/javascript" src="/i18n/js/all-' + window.resources.LANG + ".js?v=" + window.tfVersion + '"><\/script>');
  moment.lang(window.resources.LANG);
  window.resources.HISTORY_LENGTH = 50;
  window.resources.storage = (function() {
    var c;
    c = null;
    if (localStorage !== void 0) {
      c = {get: function(d) {
        if (localStorage.getItem(d)) {
          return JSON.parse(localStorage.getItem(d))
        } else {
          return ""
        }
      },set: function(d, e) {
        return localStorage.setItem(d, JSON.stringify(e))
      }}
    }
    return c
  })();
  if (window.resources.storage) {
    if (!window.resources.storage.get("tracksHistory")) {
      window.resources.storage.set("tracksHistory", [])
    }
  }
  b = window.location.host === "2.tracksflow.com";
  a = window.location.host === "tracksflow.com";
  window.resources.GridCellPixelSize = 8;
  window.resources.FB = {APP_ID: a ? "435953799751075" : (b ? "169124303181424" : "472411796144283")};
  window.resources.VK = {APP_ID: a ? "3506157" : (b ? "2880209" : "3506174")};
  window.resources.LastFM = {API_KEY: "ba5259fc36b7d1b4fc2ec96215115089"}
}).call(this);
(function() {
  window.helpers = (function() {
    var e, c, a, b, d;
    d = function(f) {
      var g;
      g = {url: window.location.protocol + "//" + window.location.host + f.getLink(),code: f.get("code")};
      return g
    };
    c = function(f) {
      return decodeURIComponent(f.replace(/_/g, " "))
    };
    a = function(f) {
      f = encodeURIComponent(f);
      return f.replace(/_/g, "%5f").replace(/%20/g, "_")
    };
    e = function(f, h) {
      var k, g;
      f = f.toLowerCase();
      k = Base64.encode(f.toLowerCase()).replace(/\+/g, "~").replace(/\//g, ".").replace(/\=/g, "-");
      if (h) {
        h = h.toLowerCase();
        g = Base64.encode(h.toLowerCase()).replace(/\+/g, "~").replace(/\//g, ".").replace(/\=/g, "-");
        k = k + "_" + g
      }
      return k
    };
    b = function(n) {
      var m, k, h, g, f, l;
      f = null;
      if (n.indexOf("_") > 0) {
        l = n.split("_"), h = l[0], m = l[1];
        g = Base64.decode(h.replace(/\~/g, "+").replace(/\./g, "/").replace(/\-/g, "="));
        k = Base64.decode(m.replace(/\~/g, "+").replace(/\./g, "/").replace(/\-/g, "="));
        f = [g, k]
      } else {
        f = Base64.decode(n.replace(/\~/g, "+").replace(/\./g, "/").replace(/\-/g, "="))
      }
      return f
    };
    return {toSocialButtonsModel: d,getId: e,parseId: b,paramDecode: c,paramEncode: a}
  })()
}).call(this);
(function() {
  var l, u, x, m, s, o, n, v, c, d, e, z, a, r, y, b, g, q, k, w, f, p, h, t = this;
  h = window.resources.__;
  jQuery.fn.reverse = [].reverse;
  l = ["Января", "Февраля", "Марта", "Апреля", "Мая", "Июня", "Июля", "Августа", "Сентября", "Октября", "Ноября", "Декабря"];
  f = function(A) {
    return A.replace(/(<([^>]+)>)/g, "")
  };
  $.prototype.fadeInAll = function(A) {
    if (A == null) {
      A = 800
    }
    return $(this).each(function() {
      return $(this).on("load", function() {
        return $(this).fadeIn(A)
      })
    })
  };
  c = function(B, A) {
    A = A || 300;
    c = window.utils.stripTags(B);
    if (c.length > A) {
      c = c.substr(0, A)
    }
    return c
  };
  z = function(B) {
    var A;
    A = document.createElement("a");
    A.href = B;
    return A
  };
  e = function(B) {
    var C, A;
    A = z(B);
    C = A.hostname.match(/\.?([^.]+\.[^.]+.?)$/)[1];
    return C
  };
  r = function(B) {
    var A;
    if (!B) {
      return
    }
    B = B.replace(/\//g, "%2f");
    A = false;
    if (B.indexOf("+") !== -1) {
      A = true
    }
    B = B.replace(/\+/g, "%2B");
    if (!B.match(/(\+)|(')|(")/)) {
      B = B.replace(/\s/g, "+");
      if (A) {
        B = encodeURIComponent(B)
      }
    } else {
      B = encodeURIComponent(B)
    }
    return B
  };
  d = function(A) {
    return A = A.replace("http://", "")
  };
  String.prototype.shorten = function(B) {
    var A;
    A = $.trim(this.slice(0, B));
    if (A.length < this.length) {
      A = A.slice(0, -3);
      A += "..."
    }
    return A
  };
  n = function(A) {
    A = decodeURIComponent(A);
    if (A.indexOf(" ") === -1) {
      A = A.replace(/\+/g, " ")
    }
    A = A.replace(/%2f/g, "/");
    return A
  };
  b = function(D) {
    var B, A, C;
    C = new RegExp("@([A-Za-z0-9_.]+)", "g");
    B = '<a class="userLink link" href="/user/$1">$&</a>';
    A = D.replace(C, B);
    return A
  };
  a = function() {
    var B, C, A;
    A = window.location.search;
    if (A) {
      C = A.substr(1);
      C = C.split("&");
      B = {};
      _.each(C, function(D) {
        return B[D.split("=")[0]] = D.split("=")[1]
      })
    }
    return B
  };
  g = (function() {
    var C, D, A, B;
    B = {notify: ui.notify,warn: ui.warn,error: ui.error,socketNotification: ui.notify};
    A = {fast: 2500,normal: 5000,slow: 10000,lifetime: 1000 * 60 * 24 * 7};
    D = function(F, G, H, E) {
      var I;
      H = H || "normal";
      E = E || "fade";
      if (!window.debug && F === "error") {
        return
      }
      I = B[F](G).effect(E).hide(A[H]);
      if (F === "notify") {
        I.el.addClass("ok")
      } else {
        if (F === "socketNotification") {
          I.el.addClass("socketNotification")
        }
      }
      return I
    };
    C = function(G, E, H, F) {
      g = D(G, "", H, F);
      g.el.find("p").html(E);
      return g
    };
    return {notify: function(E, F) {
      return D("notify", E, F)
    },warn: function(E, F) {
      return D("warn", E, F, "scale")
    },error: function(E, F) {
      return D("error", E, F, "scale")
    },html: function(E, F) {
      return C("socketNotification", E, F)
    },showHtmlMessage: C,trackVKWarn: function(F) {
      var E;
      E = h("Трек не найден.") + " ";
      return VK.Auth.getLoginStatus(function(G) {
        if (window.warnWithVK && window.warnWithVK.el.is(":visible")) {
          return
        }
        if (!G || !G.status || G.status !== "connected") {
          E += h("Попробуйте подключить аккаунт Вконтакте") + '<span><button class="connect connectVK">' + h("Подключить") + "</button></span>";
          window.warnWithVK = C("warn", E, F, "scale");
          return window.warnWithVK.el.find("p").one("click", function() {
            var H, I;
            H = {success: function() {
              if (window.models.currentUser.socialNetworks[I]) {
                window.utils.msg.notify(I + " " + h("подключен"));
                return window.models.currentUser.importInfo(I)
              }
            },error: function() {
              return window.utils.msg.warn(h("Не удалось подключить") + " " + I)
            }};
            I = "vkontakte";
            return window.models.currentUser.addSocialNetwork(I, H)
          })
        } else {
          return window.warnWithVK = D("warn", E, F, "scale")
        }
      })
    }}
  })();
  s = function() {
    return window.open("https://oauth.vk.com/authorize?client_id=" + window.resources.VK.APP_ID + "&scope=offline,audio,friends,status&redirect_uri=" + encodeURIComponent(window.location.protocol + "//" + window.location.host + "/settings?type=vk") + "&response_type=code", "TF auth from vk")
  };
  $.ajaxPrefilter(function(A, E, C) {
    var D, B;
    if (!A.data) {
      return
    }
    if (typeof E.data === "string") {
      return
    }
    D = E.data;
    for (B in E.data) {
      if (E.data[B] === null || E.data[B] === undefined) {
        delete D[B]
      }
    }
    A.data = $.param(D, true)
  });
  $(document).bind("drop dragover", function(A) {
    return A.preventDefault()
  });
  y = function(A) {
    return linkify(A)
  };
  x = function(A, B) {
    if (B && B.escape) {
      A = _.escape(A)
    }
    A = b(A);
    A = y(A);
    return A
  };
  q = function(B) {
    var A;
    return A = B.replace(/\n/g, "<br>")
  };
  m = function(A, B) {
    return '<span class="link userLink" data-link="' + A + '">' + B + "</span>"
  };
  o = function(D, B, A, F) {
    var C, E;
    if (window.resources.LANG === "ru") {
      E = [B, A, F];
      C = D % 100;
      if (C >= 11 && C <= 14) {
        C = 0
      } else {
        C = ((C %= 10) < 5 ? (C > 2 ? 2 : C) : 0)
      }
      return E[C]
    } else {
      if (D > 1) {
        return B
      } else {
        return A
      }
    }
  };
  v = function(B, C, A) {
    if (B % 10 === 1) {
      return C
    }
    return A
  };
  u = function(B) {
    var A;
    if (!B) {
      return
    }
    A = /\((.*?)\)/g;
    if (B.match(A)) {
      B = B.replace(A, "<brackets>($1)</brackets>")
    }
    return B
  };
  w = function(D, G, B, C, F, A) {
    var E = this;
    if (A == null) {
      A = {}
    }
    clearTimeout(G);
    G = setTimeout(function() {
      var H;
      H = B.model || B.collection;
      return H.fetch(C).then(function() {
        if (H.length) {
          B.render();
          A.content = B.$el;
          return $(D.target).closest(F).tf_popup(A)
        }
      })
    }, 400);
    return G
  };
  p = p = function(A) {
    return $("<div/>").html(A).text()
  };
  jQuery.fn.redraw = function(A) {
    return this.hide(0, function() {
      return $(this).show(0, function() {
        return A && A()
      })
    })
  };
  k = k = function(D) {
    var E, A, B, C, F, G;
    B = Math.floor(D / (60 * 60));
    E = D % (60 * 60);
    C = Math.floor(E / 60);
    A = E % 60;
    G = Math.ceil(A);
    F = {h: B,m: C,s: G};
    return F
  };
  window.utils = {};
  window.utils.MONTH_NAMES = l;
  window.utils.stripTags = f;
  window.utils.excerpt = c;
  window.utils.getLocation = z;
  window.utils.getHost = e;
  window.utils.linkBeautify = r;
  window.utils.decodeBeautyLink = n;
  window.utils.getURLParameters = a;
  window.utils.validateEmailRegExp = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
  window.utils.validateUrlRegExp = /[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/i;
  window.utils.msg = g;
  window.utils.clickableSpan = m;
  window.utils.makeUserLinks = b;
  window.utils.makeUrlsClickable = y;
  window.utils.clickableFormatting = x;
  window.utils.nl2br = q;
  window.utils.unescape = p;
  window.utils.declination = o;
  window.tracksflow.h.endings = v;
  window.utils.plural = o;
  window.utils.checkBrackets = u;
  window.utils.secondsToTime = k;
  window.utils.showPopupWithDelay = w;
  window.utils.foreignLink = d;
  window.utils.connectVk = s;
  $.fn.setCursorPosition = function(A) {
    if (this.length === 0) {
      return this
    }
    return $(this).setSelection(A, A)
  };
  $.fn.setSelection = function(C, D) {
    var B, A;
    if (this.length === 0) {
      return this
    }
    B = this[0];
    if (B.createTextRange) {
      A = B.createTextRange();
      A.collapse(true);
      A.moveEnd("character", D);
      A.moveStart("character", C);
      A.select()
    } else {
      if (B.setSelectionRange) {
        B.focus();
        B.setSelectionRange(C, D)
      }
    }
    return this
  };
  $.fn.focusEnd = function() {
    this.setCursorPosition(this.val().length);
    return this
  }
}).call(this);
(function() {
  var a;
  a = (function() {
    function b() {
    }
    return b
  })();
  window.models.syncManager = new a();
  _.extend(window.models.syncManager, Backbone.Events)
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.fetch = function(f) {
      if (f == null) {
        f = {}
      }
      f.reset = f.reset || true;
      f.error = function(h, g) {
        if (g.status === 404) {
          return window.router._errorView.render(404)
        }
      };
      return d.__super__.fetch.call(this, f)
    };
    d.prototype.save = function(n, g, f, m) {
      var k, h, l;
      if (n == null) {
        n = []
      }
      if (n.length) {
        _.each(n, function(o) {
          var p;
          p = {};
          p[o] = this[o];
          return this.set(p, {silent: true})
        }, this)
      }
      if (typeof this.url === "function") {
        k = this.url();
        h = _.bind(this.url, this)
      } else {
        k = h = this.url
      }
      if (m) {
        this.url = k + "?" + $.param(m)
      } else {
        this.url = k
      }
      l = d.__super__.save.call(this, g, f);
      this.url = h;
      if (n.length) {
        _.each(n, function(o) {
          return this.unset(o, {silent: true})
        }, this)
      }
      return l
    };
    d.prototype.destroy = function(f, h) {
      var g;
      if (typeof this.url === "function") {
        g = this.url()
      } else {
        g = this.url
      }
      if (h) {
        this.url = g + "?" + $.param(h)
      } else {
        this.url = g
      }
      return d.__super__.destroy.call(this, f)
    };
    d.prototype.getShareText = function() {
      return this.getName()
    };
    return d
  })(Backbone.Model);
  window.classes.model.BaseModel = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.urlRoot = window.api_url_2 + "/artists";
    d.prototype.parse = function(f) {
      var g;
      if (!f) {
        return f
      }
      if (f.admin) {
        this.admin = new window.classes.model.adminModel(f.admin);
        this.admin.url = this.url() + this.admin.url().substr(4) + "?";
        delete f.admin
      }
      if (f.compilations && f.compilations.length > 0) {
        this.compilations = new window.classes.collection.releasesCollection(f.compilations);
        this.compilations.url = this.url() + this.compilations.url().substr(4) + "?type=compilations";
        delete f.compilations
      }
      if (f.tracks) {
        this.tracks = new window.classes.collection.tracksCollection(f.tracks, {data: {"for": this.id,"in": "artists"}});
        this.tracks.pageNum = 1;
        this.tracks.pageSize = 10;
        delete f.tracks
      }
      if (f.similar && f.similar.length > 0) {
        this.similar = new window.classes.collection.artistsCollection(f.similar);
        this.similar.url = this.url() + this.similar.url().substr(4) + "?";
        delete f.similar
      }
      if (f.singles && f.singles.length > 0) {
        this.singles = new window.classes.collection.releasesCollection(f.singles);
        this.singles.url = this.url() + this.singles.url().substr(4) + "?type=singles";
        delete f.singles
      }
      if (f.albums) {
        this.albums = new window.classes.collection.releasesCollection(f.albums);
        this.albums.url = this.url() + this.albums.url().substr(4) + "?type=albums";
        delete f.albums
      }
      if (f.followers) {
        this.followers = new window.classes.collection.usersCollection(f.followers);
        this.followers.url = this.url() + this.followers.url().substr(4) + "?";
        delete f.followers
      }
      if (f.tags) {
        this.tags = new window.classes.collection.tagsCollection(f.tags);
        this.tags.url = this.url() + this.tags.url().substr(4) + "?";
        delete f.tags
      }
      g = f.comments ? f.comments : [];
      this.comments = new window.classes.collection.commentsCollection(g, {parse: true});
      this.comments.params = {"for": this.id,"in": "artists"};
      delete f.comments;
      return f
    };
    d.prototype.getFollowersCount = function() {
      return this.get("likesCount")
    };
    d.prototype.toggleFollow = function() {
      var f;
      f = (this.get("liked") ? -1 : 1);
      window.models.currentUser.set("artistLikeCount", window.models.currentUser.get("artistLikeCount") + f);
      this.set({liked: !this.get("liked"),silent: true});
      return this.save()
    };
    d.prototype.toggleIsMore = function() {
      return this.set("isMore", !this.get("isMore"))
    };
    d.prototype.getShortBio = function() {
      var f, g;
      g = "";
      if (this.has("bio")) {
        f = this.get("bio").replace(/\n/g, "<br/>");
        g = window.utils.excerpt(f, 300);
        g + "..."
      }
      return g
    };
    d.prototype.getBio = function() {
      return this.get("bio")
    };
    d.prototype.getLink = function() {
      var f;
      return f = "/artist/" + encodeURIComponent(this.get("artistName"))
    };
    d.prototype.getReleaseDate = function() {
      return ""
    };
    d.prototype.getState = function() {
      return ""
    };
    d.prototype.getName = function() {
      return this.get("artistName")
    };
    d.prototype.getAuthor = function() {
      return null
    };
    d.prototype.getAuthorLink = function() {
      return null
    };
    d.prototype.getReleaseDate = function() {
      return null
    };
    d.prototype.getImage = function(g) {
      var f;
      g = g || "medium";
      f = this.get("images") && this.get("images")[g];
      return f
    };
    d.prototype.lazyLoadTracks = function(f) {
      if (this.tracks) {
        return f(this.tracks)
      }
      this.tracks = new window.classes.collection.tracksCollection;
      return this.tracks.fetch({data: $.param({"for": this.id,"in": "artists",type: "top"}),success: _.bind(function() {
        return f(this.tracks)
      }, this),error: function() {
        return console.error("Error load tracks for " + this.getName())
      }})
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.artistModel = a
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.idAttribute = "commentId";
    d.prototype.parse = function(f) {
      this.user = new window.classes.model.userModel(f.user);
      this.track = f.track && new window.classes.model.trackModel(f.track);
      delete f.track;
      delete f.user;
      return f
    };
    d.prototype.getMessage = function() {
      var f;
      if (this.has("message")) {
        f = this.get("message");
        f = f.replace(/(\r\n)|(\n)/g, "<br/>");
        f = window.utils.clickableFormatting(f);
        return f
      }
    };
    d.prototype.canDelete = function() {
      var f;
      return ((f = this.collection) != null ? f.isDeletable : void 0) || this.user.isMe()
    };
    d.prototype.canEdit = function() {
      return this.user.isMe()
    };
    d.prototype.isMine = function() {
      return this.user.id === window.models.currentUser.id
    };
    d.prototype.getPublished = function() {
      return moment(this.get("createDate")).fromNow()
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.commentModel = b
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.urlRoot = window.api_url_2 + "/playlists";
    d.prototype.idAttribute = "playlistId";
    d.prototype.defaults = {images: {small: "/i/album/album_no-img_30.png",medium: "/i/album/album_no-img_300.png",large: "/i/album/album_no-img_600.png"}};
    d.prototype.parse = function(g) {
      var f;
      if (g.user) {
        this.user = new window.classes.model.userModel(g.user);
        delete g.user
      }
      if (g.tags) {
        this.tags = new window.classes.collection.tagsCollection(g.tags);
        this.tags.url = this.url() + this.tags.url().substr(4) + "?";
        delete g.tags
      }
      if (g.followers) {
        this.followers = new window.classes.collection.usersCollection(g.followers);
        this.followers.url = this.url() + this.followers.url().substr(4) + "?";
        delete g.followers
      }
      if (g.tracks) {
        this.tracks = new window.classes.collection.PlaylistItemsCollection(g.tracks, {data: {"for": this.get("playlistId")}});
        this.tracks.pageSize = 200;
        this.tracks.pageNum = 0;
        this.tracks.nowPlayingTarget = this.getLink();
        this.tracks.isEditable = this.get("isEditable");
        delete g.tracks;
        this.tracks.url = window.api_url_2 + "/playlistitems"
      }
      if (g.comments) {
        this.comments = new window.classes.collection.commentsCollection(g.comments, {parse: true});
        this.comments.isDeletable = (f = this.user) != null ? f.isMe() : void 0;
        delete g.comments
      } else {
        this.comments = new window.classes.collection.commentsCollection()
      }
      this.comments.params = {"for": this.get("playlistId"),"in": "playlists"};
      return g
    };
    d.prototype.getId = function() {
      return this.id
    };
    d.prototype.getLink = function() {
      return "/playlist/" + this.getId()
    };
    d.prototype.getFollowersCount = function() {
      return this.get("subscribersCount")
    };
    d.prototype.getImage = function(f) {
      if (f == null) {
        f = "medium"
      }
      return this.get("images")[f]
    };
    d.prototype.getUser = function() {
      return this.user
    };
    d.prototype.getUsername = function() {
      return this.user.get("name")
    };
    d.prototype.getUserLink = function() {
      return this.user.getLink()
    };
    d.prototype.getUserImage = function(f) {
      return this.user.getImage(f)
    };
    d.prototype.toggleFollow = function() {
      var f;
      f = (this.get("liked") ? -1 : 1);
      window.models.currentUser.set("totalPlaylistCount", window.models.currentUser.get("totalPlaylistCount") + f);
      this.set("liked", !this.get("liked"), {silent: true});
      return this.save()
    };
    d.prototype.getDuration = function() {
      var l, f, g, k;
      g = 0;
      this.tracks.each(function(h) {
        return g += h.track.get("durationSec")
      });
      l = Math.floor(g / 3600);
      f = Math.floor((g % 3600) / 60);
      k = (g % 3600) % 60;
      if (l < 10) {
        l = "0" + l
      }
      if (f < 10) {
        f = "0" + f
      }
      if (k < 10) {
        k = "0" + k
      }
      return "" + l + ":" + f + ":" + k
    };
    d.prototype.getName = function() {
      return this.get("name")
    };
    d.prototype.getAuthor = function() {
      return this.getUsername()
    };
    d.prototype.getAuthorLink = function() {
      return this.getUserLink()
    };
    d.prototype.isMine = function() {
      return this.user.isMe()
    };
    d.prototype.getReleaseDate = function() {
      return null
    };
    d.prototype.isEditable = function() {
      return this.user.isMe()
    };
    d.prototype.isAddable = function() {
      return this.isEditable() || this.get("isShared") === true
    };
    d.prototype.lazyLoadTracks = function(f) {
      if (this.tracks) {
        f(this.tracks);
        return
      }
      this.tracks = new window.classes.collection.PlaylistItemsCollection;
      this.tracks.isEditable = false;
      this.tracks.url = window.api_url_2 + "/playlistitems?for=" + this.get("playlistId");
      this.tracks.pageNum = 0;
      this.tracks.pageSize = 10;
      return this.tracks.fetch({data: {pageNum: 0,pageSize: 10},success: _.bind(function() {
        return f(this.tracks)
      }, this),error: function() {
        return console.error("Error load tracks for " + this.get("name"))
      }})
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.playlistModel = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.idAttribute = "wallMessageId";
    d.prototype.urlRoot = window.api_url_2 + "/flow";
    d.prototype.initialize = function(f) {
      if (!this.tracks) {
        this.tracks = new window.classes.collection.tracksCollection([])
      }
      if (!this.comments) {
        this.comments = new window.classes.collection.commentsCollection()
      }
      if (!this.user) {
        this.user = new window.classes.model.userModel()
      }
      if (f && f.autoSave) {
        this.tracks.on("add", function() {
          return this.save(["tracks"])
        }, this);
        return this.tracks.on("remove", function() {
          return this.save(["tracks"])
        }, this)
      }
    };
    d.prototype.getContentType = function() {
      if (this.has("images")) {
        return "image"
      } else {
        if (this.content instanceof window.classes.model.playlistModel) {
          return "playlist"
        } else {
          if (this.content instanceof window.classes.model.releaseModel) {
            return "album"
          } else {
            if (this.content instanceof window.classes.model.artistModel) {
              return "artist"
            } else {
              if (this.content instanceof window.classes.model.embedVideoModel) {
                return "video"
              }
            }
          }
        }
      }
      return ""
    };
    d.prototype.getName = function() {
      if (this.get("message")) {
        return this.get("message")
      } else {
        return __("Запись")
      }
    };
    d.prototype.parse = function(g) {
      var f;
      if (!g) {
        return
      }
      if (g.tracks) {
        if (!this.tracks) {
          this.tracks = new window.classes.collection.tracksCollection(g.tracks, {isEditable: this.isEditable,parentId: g.wallMessageId})
        } else {
          this.tracks.reset(g.tracks);
          this.tracks.isEditable = this.isEditable
        }
        this.tracks.flow = this.collection;
        this.tracks.nowPlayingTarget = "/post/" + g.wallMessageId;
        delete g.tracks
      }
      if (g.user) {
        if (!this.user) {
          this.user = new window.classes.model.userModel(g.user)
        } else {
          this.user.set(g.user);
          this.user.parse(g.user)
        }
        delete g.user
      }
      if (g.comments) {
        if (!this.comments) {
          this.comments = new window.classes.collection.commentsCollection(g.comments, {parse: true})
        } else {
          this.comments.reset(g.comments, {parse: true})
        }
        this.comments.url += "?for=" + g.wallMessageId;
        this.comments.isDeletable = (f = this.user) != null ? f.isMe() : void 0;
        delete g.comments
      }
      if (g.repostedBy) {
        if (!this.repostedBy) {
          this.repostedBy = new window.classes.model.userModel(g.repostedBy)
        } else {
          this.repostedBy.set(g.user);
          this.repostedBy.parse(g.user)
        }
        delete g.repostedBy
      }
      if (g.playlist) {
        this.content = new window.classes.model.playlistModel(g.playlist, {parse: true});
        if (!this.content.tracks) {
          this.content.tracks = new window.classes.collection.PlaylistItemsCollection();
          this.content.tracks.url = window.api_url_2 + "/playlistitems?for=" + this.content.id
        }
        delete g.playlist
      }
      if (g.album) {
        this.content = new window.classes.model.releaseModel(g.album, {parse: true});
        if (!this.content.tracks) {
          this.content.tracks = new window.classes.collection.tracksCollection()
        }
        this.content.tracks.url = window.api_url_2 + "/tracks?for=" + this.content.id + "&in=albums";
        delete g.album
      }
      if (g.artist) {
        this.content = new window.classes.model.artistModel(g.artist);
        delete g.artist
      }
      if (g.video) {
        this.content = new window.classes.model.embedVideoModel(g.video);
        delete g.video
      }
      return g
    };
    d.prototype.save = function(k, g, f, h) {
      if (k == null) {
        k = []
      }
      console.log("SAVESAVESAVESAVESAVE", this.id);
      this.trigger("saving");
      switch (this.getContentType()) {
        case "playlist":
          this.playlist = this.content.toJSON();
          return d.__super__.save.call(this, _.extend(["tracks", "playlist"], k), g, f, h);
        case "album":
          this.album = this.content.toJSON();
          return d.__super__.save.call(this, _.extend(["tracks", "album"], k), g, f, h);
        case "artist":
          this.artist = this.content.toJSON();
          return d.__super__.save.call(this, _.extend(["tracks", "artist"], k), g, f, h);
        case "video":
          this.video = this.content.toJSON();
          return d.__super__.save.call(this, _.extend(["tracks", "video"], k), g, f, h);
        default:
          return d.__super__.save.call(this, _.extend(["tracks"], k), g, f, h)
      }
    };
    d.prototype.getLink = function() {
      return "/post/" + this.id
    };
    d.prototype.getPublished = function() {
      return $.elapsed(this.get("createDate"))
    };
    d.prototype.getUsers = function(k, f) {
      var g, h = this;
      g = new $.Deferred();
      k.fetch({data: {"for": this.id,"in": "flow",pageSize: f || ""}}).then(function() {
        return g.resolve()
      });
      return g.promise()
    };
    d.prototype.getLikeActionText = function() {
      var f;
      if (this.get("liked")) {
        f = __("Больше не нравится")
      } else {
        f = __("Мне нравится")
      }
      return f
    };
    d.prototype.fillNewPostData = function(f) {
      this.id = "hidden";
      this.isEditable = true;
      return this.fetch({success: f})
    };
    d.prototype.deleteContent = function(g) {
      var f;
      if (this.has("images")) {
        f = new XMLHttpRequest();
        f.open("DELETE", window.api_url_2 + "/files?for=" + this.id + "&in=flow", true);
        f.onreadystatechange = _.bind(function() {
          this.unset("images", {silent: true});
          return g()
        }, this);
        return f.send()
      } else {
        this.content = null;
        return this.save()
      }
    };
    d.prototype.canPublish = function() {
      return !((!this.has("message") || this.get("message") === "") && !this.content && (!this.tracks || this.tracks.length === 0) && !this.has("images"))
    };
    d.prototype.publishNewPost = function(f) {
      this.id = null;
      this.set("isHidden", false);
      return this.save({}, {success: f && f.success})
    };
    d.prototype.addTrack = function(f) {
      if (this.tracks.length >= 3) {
        this.tracks.shift
      }
      return this.tracks.push(f)
    };
    d.prototype.getImage = function(f) {
      if (!f) {
        f = "large"
      }
      return this.get("images")[f]
    };
    d.prototype.getMessage = function() {
      var f;
      f = window.utils.clickableFormatting(this.get("message"));
      return window.utils.nl2br(f)
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.postModel = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.urlRoot = window.api_url_2 + "/albums";
    d.prototype.validate = function(g, f) {
      if (!g.albumName) {
        return {attr: "albumName",msg: "Имя альбома обязательно для заполнения"}
      }
    };
    d.prototype.parse = function(f) {
      var g;
      if (!f) {
        return
      }
      this.followers;
      if (f.albums) {
        this.albums = new window.classes.collection.releasesCollection(f.albums);
        this.albums.url = _.result(this, "url") + _.result(this.albums, "url").substr(4) + "?type=albums";
        delete f.albums
      }
      if (f.singles) {
        this.singles = new window.classes.collection.releasesCollection(f.singles);
        this.singles.url = _.result(this, "url") + _.result(this.singles, "url").substr(4) + "?type=singles";
        delete f.singles
      }
      if (f.compilations) {
        this.compilations = new window.classes.collection.releasesCollection(f.compilations);
        this.compilations.url = _.result(this, "url") + _.result(this.compilations, "url").substr(4) + "?type=compilations";
        delete f.compilations
      }
      if (f.tags) {
        this.tags = new window.classes.collection.tagsCollection(f.tags);
        this.tags.url = _.result(this, "url") + _.result(this.tags, "url").substr(4) + "?";
        delete f.tags
      }
      if (f.tracks) {
        this.tracks = new window.classes.collection.tracksCollection(f.tracks, {parse: true});
        this.tracks.url = window.api_url_2 + "/tracks?for=" + this.get("albumId") + "&in=albums";
        delete f.tracks
      }
      if (f.followers) {
        this.followers = new window.classes.collection.usersCollection(f.followers);
        this.followers.url = _.result(this, "url") + _.result(this.followers, "url").substr(4) + "?";
        delete f.followers
      }
      g = f.comments ? f.comments : [];
      this.comments = new window.classes.collection.commentsCollection(g, {parse: true});
      this.comments.params = {"for": this.id,"in": "albums"};
      delete f.comments;
      return f
    };
    d.prototype.toggleFollow = function() {
      var f;
      f = (this.get("liked") ? -1 : 1);
      window.models.currentUser.set("albumLikeCount", window.models.currentUser.get("albumLikeCount") + f);
      this.set("liked", !this.get("liked"), {silent: true});
      return this.save()
    };
    d.prototype.getFollowersCount = function() {
      return this.get("likesCount")
    };
    d.prototype.getTagsInline = function() {
      var f, g;
      if (!((g = this.tags) != null ? g.length : void 0)) {
        return ""
      }
      f = this.tags.pluck("name");
      return f.join(", ")
    };
    d.prototype.getReleaseDate = function(g) {
      var f;
      if ((g === "year" || g === "full") && this.has("year") && !this.has("releaseDate")) {
        return this.get("year")
      }
      if (!this.has("releaseDate")) {
        return
      }
      g = g || "main";
      f = moment(this.get("releaseDate"));
      if (g === "year") {
        return f.format("YYYY")
      }
      if (g === "full") {
        return f.format("LL")
      } else {
        return f.format("YYYY-MM-DD")
      }
    };
    d.prototype.getDayMonthYear = function() {
      if (!this.get("releaseDate")) {
        return [-1, -1, this.get("year")]
      }
      return [moment(this.get("releaseDate")).format("DD"), moment(this.get("releaseDate")).month(), moment(this.get("releaseDate")).year()]
    };
    d.prototype.getLink = function() {
      var f;
      return f = this.getArtistLink() + "/album/" + encodeURIComponent(this.get("albumName"))
    };
    d.prototype.getArtistLink = function() {
      var f;
      return f = "/artist/" + encodeURIComponent(this.get("artistName"))
    };
    d.prototype.getImage = function(f) {
      if (f == null) {
        f = "medium"
      }
      if (this.get("images")) {
        return this.get("images")[f]
      }
    };
    d.prototype.getArtistName = function() {
      return this.get("artistName")
    };
    d.prototype.getName = function() {
      return this.get("albumName")
    };
    d.prototype.getAuthor = function() {
      return this.getArtistName()
    };
    d.prototype.getAuthorLink = function() {
      return this.getArtistLink()
    };
    d.prototype.lazyLoadTracks = function(f) {
      this.tracks = new window.classes.collection.tracksCollection;
      return this.tracks.fetch({data: $.param({"for": this.id,"in": "albums"}),success: _.bind(function() {
        return f(this.tracks)
      }, this),error: function() {
        return console.error("Error load tracks for " + this.getName())
      }})
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.releaseModel = a
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.urlRoot = window.api_url_2 + "/search";
    d.prototype.idAttribute = "query";
    d.prototype.parse = function(f) {
      if (f.tags) {
        this.tags = new window.classes.collection.tagsCollection(f.tags);
        delete f.tags
      }
      if (f.albums) {
        this.albums = new window.classes.collection.releasesCollection(f.albums);
        delete f.albums
      }
      if (f.tracks) {
        this.tracks = new window.classes.collection.tracksCollection(f.tracks);
        this.tracks.url = window.api_url_2 + "/tracks?for=" + this.id + "&in=search";
        delete f.tracks
      }
      if (f.mixes) {
        this.mixes = new window.classes.collection.tracksCollection(f.mixes);
        delete f.mixes
      }
      if (f.users) {
        this.users = new window.classes.collection.usersCollection(f.users);
        delete f.users
      }
      if (f.artists) {
        this.artists = new window.classes.collection.artistsCollection(f.artists);
        this.artists.url = window.api_url_2 + "/artists?for=" + this.id + "&in=search";
        delete f.artists
      }
      if (f.playlists) {
        this.playlists = new window.classes.collection.playlistsCollection(f.playlists, {parse: true});
        delete f.playlists
      }
      return f
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.searchModel = b
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.urlRoot = window.api_url_2 + "/tags";
    d.prototype.idAttribute = "name";
    d.prototype.getLink = function() {
      var f;
      return f = "/tag/" + this.get("name")
    };
    d.prototype.parse = function(f) {
      if (f.similar && f.similar.length) {
        this.similar = new window.classes.collection.tagsCollection(f.similar);
        this.similar.url = this.url() + this.similar.url().substr(4) + "?";
        delete f.similar
      }
      if (f.tracks && f.tracks.length) {
        this.tracks = new window.classes.collection.tracksCollection(f.tracks);
        this.tracks.url = window.api_url_2 + "/tracks?for=" + this.id + "&in=tags";
        delete f.tracks
      }
      if (f.artists && f.artists.length) {
        this.artists = new window.classes.collection.artistsCollection(f.artists);
        this.artists.url = this.url() + this.artists.url().substr(4) + "?";
        delete f.artists
      }
      if (f.albums && f.albums.length) {
        this.albums = new window.classes.collection.releasesCollection(f.albums);
        this.albums.url = this.url() + this.albums.url().substr(4) + "?";
        delete f.albums
      }
      if (f.playlists && f.playlists.length) {
        this.playlists = new window.classes.collection.playlistsCollection(f.playlists, {parse: true});
        this.playlists.url = this.url() + this.playlists.url().substr(4) + "?";
        delete f.playlists
      }
      return f
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.tagModel = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.urlRoot = window.api_url_2 + "/tracks";
    e.prototype.defaults = {syncLocalId: null,syncGlobalId: null,hiddenByFilter: false,state: 0,ordersCount: 0,images: {small: "/path/to/track/small.jpg",medium: "/path/to/track/medium.jpg",large: "/path/to/track/large.jpg"}};
    e.prototype.initialize = function(g, f) {
      if (f == null) {
        f = {}
      }
      e.__super__.initialize.call(this, g, f);
      this.options = f;
      this.trySubscribe();
      this.checkLocalSync();
      this.on("change:state", this.checkState, this);
      this.on("change:trackName change:parentId", this.trySubscribe, this);
      return this
    };
    e.prototype.subscribe = function(g, f) {
      window.models.syncManager.on(this.getSyncGlobalId(), this.syncChanges, this);
      return window.models.syncManager.on(this.getSyncLocalId(), this.syncChanges, this)
    };
    e.prototype.checkLocalSync = function() {
      if (window.player && window.player.getCurrentTrack()) {
        if (window.player.getCurrentTrack().getSyncLocalId() === this.getSyncLocalId()) {
          return window.models.syncManager.trigger(window.player.getCurrentTrack().getSyncLocalId(), {state: window.models.state.get("player").state,debug: "onCheckState"})
        }
      }
    };
    e.prototype.setSyncId = function() {
      this.set("syncGlobalId", this.getSyncGlobalId());
      return this.set("syncLocalId", this.get("parentId") + "_" + this.getSyncGlobalId())
    };
    e.prototype.trySubscribe = function() {
      this.setSyncId();
      if (!this.getSyncGlobalId()) {
        return
      }
      if (!this.getSyncLocalId()) {
        return
      }
      return this.subscribe(this.syncLocalId, this.getSyncGlobalId)
    };
    e.prototype.getSyncLocalId = function() {
      return this.get("syncLocalId")
    };
    e.prototype.syncChanges = function(f) {
      return this.set(f)
    };
    e.prototype.getState = function() {
      return this.get("state")
    };
    e.prototype.getId = function() {
      return this.id
    };
    e.prototype.getSyncGlobalId = function() {
      var f, g;
      if (!this.has("trackName")) {
        return
      }
      f = this.getArtist().replace(/\s+/g, "");
      g = this.getName().replace(/\s+/g, "");
      return f + g
    };
    e.prototype.getTime = function() {
      var g, f;
      g = this.get("durationSec");
      if (!g) {
        return ""
      }
      f = (g % 60) < 10 ? "0" + (g % 60) : g % 60;
      return Math.floor(g / 60) + ":" + f
    };
    e.prototype.isPlaying = function() {
      if (this.get("state") === 0) {
        return false
      }
      return true
    };
    e.prototype.getNum = function() {
      var f, g;
      f = ((g = this.collection) != null ? g.indexOf(this) : void 0) + 1;
      return f
    };
    e.prototype.isLiked = function() {
      return this.get("liked")
    };
    e.prototype.getShareText = function() {
      return this.getName() + " - " + this.getArtist()
    };
    e.prototype.getName = function() {
      return this.get("trackName")
    };
    e.prototype.getArtist = function() {
      return this.get("artistName")
    };
    e.prototype.getImage = function(f) {
      if (f == null) {
        f = "medium"
      }
      if (!this.get("images")) {
        return
      }
      return this.get("images")[f]
    };
    e.prototype.checkLink = function() {
      return window.player.getLink(this, {success: function(f) {
      },error: function(f) {
      }})
    };
    e.prototype.getLink = function() {
      var f, g, h;
      f = encodeURIComponent(this.get("artistName"));
      h = encodeURIComponent(this.get("trackName"));
      g = "/artist/" + f + "/track/" + h;
      return g
    };
    e.prototype.getUrl = function() {
      var f;
      f = this.get("userLink") || this.get("link");
      return f
    };
    e.prototype.getArtistLink = function() {
      var f;
      return f = "/artist/" + encodeURIComponent(this.get("artistName"))
    };
    e.prototype.getAlbum = function() {
      return this.get("albumName")
    };
    e.prototype.getAlbumLink = function() {
      var h, f, g;
      if (!this.get("albumName")) {
        return
      }
      f = encodeURIComponent(this.get("artistName"));
      h = encodeURIComponent(this.get("albumName"));
      g = "/artist/" + f + "/album/" + h;
      return g
    };
    e.prototype.getLikesCount = function() {
      return this.get("likesCount")
    };
    e.prototype.toggleLike = function() {
      var f;
      f = (this.get("liked") ? -1 : 1);
      window.models.currentUser.set("trackLikeCount", window.models.currentUser.get("trackLikeCount") + f);
      this.save(null, {likesCount: this.get("likesCount") + f,liked: !this.get("liked")});
      return window.models.syncManager.trigger(this.getSyncGlobalId(), this.changed)
    };
    e.prototype.getSourceLink = function() {
      var g, k, h, f;
      h = {};
      k = encodeURIComponent(this.get("artistName") + " " + this.get("trackName"));
      if (this.getUrl()) {
        f = this.getUrl()
      } else {
        if (window.player.getCurrentTrack()) {
          f = window.player.getCurrentTrack().getUrl()
        }
      }
      g = window.utils.getHost(f);
      switch (this.get("source")) {
        case "vkontakte":
          h.domain = g;
          h.link = "http://vk.com/audio?q=" + k;
          break;
        case "soundcloud":
          h.domain = g;
          h.link = this.get("sourceLink");
          break;
        case "exfm":
          h.domain = g;
          h.link = this.get("sourceLink") || "http://ex.fm/search/" + k;
          break;
        default:
          h.domain = g;
          h.link = "http://" + g
      }
      return h
    };
    e.prototype.sendNowPlaying = function() {
      if (!window.models.currentUser.get("login")) {
        return
      }
      window.models.syncManager.trigger("document:title:change", {title: "▶ " + this.getName() + " - " + this.getArtist(),force: true});
      this.store();
      this.nowPlaying();
      return _.defer(_.bind(this.startScrobbleTimer, this))
    };
    e.prototype.checkState = function() {
      if (this.get("state") === window.player.trackStates.PLAYING) {
        window.models.state.set("playingTabId", window.models.state.get("tabId"))
      }
      if (this.get("state") === window.player.trackStates.PAUSED) {
        return this.stopScrobbleTimer()
      }
    };
    e.prototype.startScrobbleTimer = function() {
      var f, h, g;
      g = (this.get("durationSec") * 1000) / 2;
      f = 4 * 1000 * 60;
      h = f < g ? f : g;
      if (!h) {
        return
      }
      return this.scrobbleTimer = setTimeout(_.bind(function() {
        var k, l;
        l = this.toJSON();
        k = $.ajax(window.api_url_2 + "/nowplaying/scrobble", {type: "POST",dataType: "json",contentType: "application/json",data: JSON.stringify(l)});
        return k.done(function(m) {
          if (m.friendsPopup === true) {
            if (window.views.popupShare) {
              return
            }
            return window.views.popupShare = new window.classes.view.PopupShareProfile({el: "#modal-popups"})
          }
        })
      }, this), h)
    };
    e.prototype.stopScrobbleTimer = function() {
      return clearTimeout(this.scrobbleTimer)
    };
    e.prototype.nowPlaying = function() {
      var f, h, k, g;
      if (!window.router._currentView) {
        return
      }
      if (window.router._currentView.type === "Playlist" && (window.router._currentView.id === "vk" || window.router._currentView.id === "lastfm")) {
        return
      }
      if (this.get("parentId") === "FriendRadio" || window.router._currentView.type === "FriendRadio") {
        g = "FriendRadio";
        k = window.models.currentUser.get("login")
      } else {
        g = window.router._currentView.type;
        k = window.router._currentView.type === "Flow" ? window.models.currentUser.id : window.router._currentView.id
      }
      h = {track: this.toJSON(),user: window.models.currentUser,type: g,sourceId: k};
      f = new window.classes.model.NowPlaying(h);
      return f.save()
    };
    e.prototype.isLiked = function() {
      return !!this.get("liked")
    };
    e.prototype.removeSelf = function() {
      return this.collection.remove(this)
    };
    e.prototype.store = function() {
      var g, f;
      if (!window.resources.storage) {
        return
      }
      f = window.resources.storage.get("tracksHistory");
      if (!_.find(f, function(h) {
        return h.id === this.id
      }, this)) {
        if (f.length >= window.resources.HISTORY_LENGTH) {
          f.pop()
        }
        g = this.toJSON();
        g.state = 0;
        f.unshift(g);
        return window.resources.storage.set("tracksHistory", f)
      }
    };
    e.prototype.showMenu = function(f) {
      var h, g, k = this;
      h = new $.Deferred;
      g = new window.classes.collection.playlistsCollection();
      g.fetch({data: {type: "editable",contentId: this.get("id")}}).then(function() {
        var l;
        l = new window.classes.view.TrackRowActionsAddToPlaylists({collection: g,trackModel: k});
        return h.resolve(l)
      });
      return h.promise()
    };
    e.prototype.getUsers = function(k, f) {
      var g, h = this;
      g = new $.Deferred();
      k.fetch({data: {"for": this.getArtist().toLowerCase() + "_" + this.getName().toLowerCase(),"in": "tracks",pageSize: f || ""}}).then(function() {
        return g.resolve()
      });
      return g.promise()
    };
    e.prototype.parse = function(f) {
      if (!f) {
        return
      }
      if (f.playlists) {
        this.playlists = new window.classes.collection.playlistsCollection(f.playlists, {parse: true});
        this.playlists.url = this.url() + this.playlists.url().substr(4) + "?";
        delete f.playlists
      }
      if (f.similar) {
        this.similar = new window.classes.collection.tracksCollection(f.similar);
        delete f.similar
      }
      if (f.tags) {
        this.tags = new window.classes.collection.tagsCollection(f.tags);
        this.tags.url = this.url() + this.tags.url().substr(4) + "?";
        delete f.tags
      }
      if (f.likeUsers) {
        this.likeUsers = new window.classes.collection.usersCollection(f.likeUsers);
        this.likeUsers.url = this.url() + this.likeUsers.url().substr(4) + "?";
        delete f.likeUsers
      }
      if (f.followers) {
        this.followers = new window.classes.collection.usersCollection(f.followers);
        delete f.followers
      }
      return f
    };
    return e
  })(window.classes.model.BaseModel);
  window.classes.model.trackModel = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.setPlayerCollection = function() {
      var f;
      f = new window.classes.collection.tracksCollection(this.similar.toJSON());
      return f.unshift(this)
    };
    d.prototype.getLyrics = function(f) {
      return window.VK.Api.call("audio.search", {q: "" + (this.getArtist()) + " " + (this.getName())}, function(g) {
        var h;
        if (g.error) {
          console.error("vk search error", g)
        }
        if ((h = g.response[1]) != null ? h.lyrics_id : void 0) {
          return window.VK.Api.call("audio.getLyrics", {lyrics_id: g.response[1].lyrics_id}, function(l) {
            var k;
            return f(l != null ? (k = l.response) != null ? k.text : void 0 : void 0)
          })
        } else {
          return f("")
        }
      })
    };
    d.prototype.parse = function(f) {
      if (!f) {
        return
      }
      if (f.playlists) {
        this.playlists = new window.classes.collection.playlistsCollection(f.playlists, {parse: true});
        this.playlists.url = this.url() + this.playlists.url().substr(4) + "?";
        delete f.playlists
      }
      if (f.similar) {
        this.similar = new window.classes.collection.tracksCollection(f.similar);
        this.similar.each(function(g) {
          if (this.similar.indexOf(g) >= 10) {
            return g.set("hiddenByFilter", true)
          }
        }, this);
        delete f.similar
      }
      if (f.tags) {
        this.tags = new window.classes.collection.tagsCollection(f.tags);
        this.tags.url = this.url() + this.tags.url().substr(4) + "?";
        delete f.tags
      }
      if (f.likeUsers) {
        this.likeUsers = new window.classes.collection.usersCollection(f.likeUsers);
        this.likeUsers.url = this.url() + this.likeUsers.url().substr(4) + "?";
        delete f.likeUsers
      }
      if (f.followers) {
        this.followers = new window.classes.collection.usersCollection(f.followers);
        delete f.followers
      }
      return f
    };
    return d
  })(window.classes.model.trackModel);
  window.classes.model.trackFullModel = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.urlRoot = window.api_url_2 + "/users";
    d.prototype.idAttribute = "userId";
    d.prototype.initialize = function(f) {
      if (!f) {
        return
      }
      _.defaults(f, this.defaults());
      return d.__super__.initialize.call(this, f)
    };
    d.prototype.defaults = function() {
      return {images: {small: "/i/user/small.jpg",medium: "/i/user/medium.jpg",large: "/i/user/large.jpg"}}
    };
    d.prototype.getImage = function(f) {
      var g;
      if (f == null) {
        f = "medium"
      }
      return (g = this.get("images")) != null ? g[f] : void 0
    };
    d.prototype.getImageWithFallback = function(g) {
      var h, f;
      if (g == null) {
        g = "medium"
      }
      if ((h = this.get("images")) != null ? h[g] : void 0) {
        return (f = this.get("images")) != null ? f[g] : void 0
      } else {
        return this.defaults().images[g]
      }
    };
    d.prototype.getName = function() {
      return this.get("name") || this.get("login")
    };
    d.prototype.toggleFollow = function() {
      this.set("ifollow", !this.get("ifollow"));
      return this.save()
    };
    d.prototype.parse = function(f) {
      if (f.nowPlaying) {
        this.nowPlaying = new window.classes.model.NowPlaying(f.nowPlaying, {parse: true});
        delete f.nowPlaying
      }
      return f
    };
    d.prototype.hasNowPlaying = function() {
      if (_.isEmpty(this.nowPlaying)) {
        return false
      }
      return true
    };
    d.prototype.getLink = function() {
      return "/user/" + this.get("login")
    };
    d.prototype.isMe = function() {
      var g, f;
      g = this.id === window.models.currentUser.id;
      f = this.id === window.models.currentUser.get("login");
      return g || f
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.userModel = c
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.urlRoot = window.api_url + "/admin";
    d.prototype.idAttribute = "userId";
    return d
  })(window.classes.model.userModel);
  window.classes.model.adminModel = b
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.urlRoot = window.api_url_2 + "/likes";
    d.prototype.getNum = function(h) {
      var g, f;
      g = h || this.collection.commonLength || this.collection.length;
      f = Math.abs(this.collection.indexOf(this) - g);
      return f
    };
    d.prototype.getTime = function() {
      return this.track.getTime()
    };
    d.prototype.getArtistLink = function() {
      return this.track.getArtistLink()
    };
    d.prototype.getLink = function() {
      return this.track.getLink()
    };
    d.prototype.getName = function() {
      return this.track.getName()
    };
    d.prototype.getShareText = function() {
      return this.track.getShareText()
    };
    d.prototype.getArtist = function() {
      return this.track.getArtist()
    };
    d.prototype.isLiked = function() {
      return this.track.isLiked()
    };
    d.prototype.getLikesCount = function() {
      return this.track.getLikesCount()
    };
    d.prototype.getState = function() {
      return this.track.getState()
    };
    d.prototype.toggleLike = function() {
      this.track.toggleLike();
      return this.trigger("render")
    };
    d.prototype.isPlaying = function() {
      return this.track.isPlaying()
    };
    d.prototype.showMenu = function() {
      return this.track.showMenu()
    };
    d.prototype.getSyncLocalId = function() {
      return this.track.getSyncLocalId()
    };
    d.prototype.getUsers = function(g, f) {
      return this.track.getUsers(g, f)
    };
    d.prototype.initialize = function() {
      return d.__super__.initialize.call(this)
    };
    d.prototype.parse = function(f) {
      if (f.track) {
        this.track = new window.classes.model.trackModel(f.track);
        delete f.track
      }
      if (f.user) {
        this.user = new window.classes.model.userModel(f.user);
        delete f.user
      }
      return f
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.LikeTrackModel = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.urlRoot = window.api_url_2 + "/likes";
    e.prototype.parse = function(f) {
      if (f.album) {
        this.album = new window.classes.model.releaseModel(f.album);
        delete f.album
      }
      if (f.user) {
        this.user = new window.classes.model.userModel(f.user);
        delete f.user
      }
      return f
    };
    return e
  })(window.classes.model.BaseModel);
  window.classes.model.LikeAlbum = c
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.urlRoot = window.api_url_2 + "/likes";
    d.prototype.toggleFollow = function() {
      return this.artist.toggleFollow()
    };
    d.prototype.getArtistLink = function() {
      return this.artist.getArtistLink()
    };
    d.prototype.getImage = function(f) {
      return this.artist.getImage()
    };
    d.prototype.getName = function() {
      return this.artist.getName()
    };
    d.prototype.getLink = function() {
      return this.artist.getLink()
    };
    d.prototype.getFollowersCount = function() {
      return this.artist.getFollowersCount()
    };
    d.prototype.parse = function(f) {
      if (f.artist) {
        this.artist = new window.classes.model.artistModel(f.artist);
        delete f.artist
      }
      if (f.user) {
        this.user = new window.classes.model.userModel(f.user);
        delete f.user
      }
      return f
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.LikeArtist = b
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.url = window.api_url_2 + "/nowplaying";
    d.prototype.defaults = {sourceLink: null};
    d.prototype.initialize = function() {
      return d.__super__.initialize.apply(this, arguments)
    };
    d.prototype.parse = function(f) {
      if (!f) {
        return
      }
      if (f.track) {
        this.track = new window.classes.model.trackModel(f.track);
        delete f.track
      }
      if (f.user) {
        this.user = new window.classes.model.userModel(f.user);
        delete f.user
      }
      return f
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.NowPlaying = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.urlRoot = window.api_url_2 + "/selections";
    d.prototype.idAttribute = "selectionId";
    d.prototype.getImage = function() {
      var f;
      return (f = this.get("images")) != null ? f.original : void 0
    };
    d.prototype.parse = function(f) {
      if (f.tracks && f.tracks.length) {
        this.tracks = new window.classes.collection.tracksCollection(f.tracks);
        delete f.tracks
      }
      if (f.artists && f.artists.length) {
        this.artists = new window.classes.collection.artistsCollection(f.artists);
        delete f.artists
      }
      if (f.albums && f.albums.length) {
        this.albums = new window.classes.collection.releasesCollection(f.albums);
        delete f.albums
      }
      if (f.playlists && f.playlists.length) {
        this.playlists = new window.classes.collection.playlistsCollection(f.playlists, {parse: true});
        delete f.playlists
      }
      return f
    };
    return d
  })(window.classes.model.BaseModel);
  window.classes.model.selectionModel = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.idAttribute = "itemId";
    e.prototype.initialize = function(f) {
      e.__super__.initialize.call(this);
      this.track = new window.classes.model.trackModel(f.track);
      return this.track.set({parentId: this.id})
    };
    e.prototype.getHash = function() {
      return md5("track" + this.track.get("artistName") + this.track.get("trackName"))
    };
    e.prototype.getId = function() {
      return this.track.getHash()
    };
    e.prototype.getTime = function() {
      return this.track.getTime()
    };
    e.prototype.getNum = function() {
      var f;
      f = this.collection.indexOf(this) + 1;
      return f
    };
    e.prototype.getName = function() {
      return this.track.getName()
    };
    e.prototype.getShareText = function() {
      return this.track.getShareText()
    };
    e.prototype.getArtist = function() {
      return this.track.getArtist()
    };
    e.prototype.getImage = function(f) {
      return this.track.getImage(f)
    };
    e.prototype.getLink = function() {
      return this.track.getLink()
    };
    e.prototype.getArtistLink = function() {
      return this.track.getArtistLink()
    };
    e.prototype.getAlbum = function() {
      return this.track.getAlbum()
    };
    e.prototype.getAlbumLink = function() {
      return this.track.getAlbumLink()
    };
    e.prototype.getLikesCount = function() {
      return this.track.get("likesCount")
    };
    e.prototype.getState = function() {
      return this.track.getState()
    };
    e.prototype.toggleLike = function() {
      this.track.toggleLike();
      return this.track.trigger("change")
    };
    e.prototype.getSourceLink = function() {
      return this.track.getSourceLink()
    };
    e.prototype.checkState = function() {
      return this.track.chackState()
    };
    e.prototype.nowPlaying = function() {
      return this.track.nowPlaying()
    };
    e.prototype.isPlaying = function() {
      return this.track.isPlaying()
    };
    e.prototype.isLiked = function() {
      return this.track.isLiked()
    };
    e.prototype.getSyncLocalId = function() {
      return this.track.getSyncLocalId()
    };
    e.prototype.playOrPause = function() {
      return window.player.tryPlay(this)
    };
    e.prototype.removeSelf = function() {
      return this.destroy()
    };
    e.prototype.store = function() {
      return this.track.store()
    };
    e.prototype.getLyrics = function(f) {
      return this.track.getLyrics(f)
    };
    e.prototype.getUsers = function(g, f) {
      return this.track.getUsers(g, f)
    };
    e.prototype.showMenu = function(f) {
      var h, g, k = this;
      h = new $.Deferred;
      g = new window.classes.collection.playlistsCollection();
      g.fetch({data: {type: "editable",contentId: this.track.id}}).then(function() {
        var l;
        l = new window.classes.view.TrackRowActionsAddToPlaylists({collection: g,trackModel: k.track});
        return h.resolve(l)
      });
      return h.promise()
    };
    return e
  })(window.classes.model.BaseModel);
  window.classes.model.PlaylistItem = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.urlRoot = window.api_url_2 + "/mainPage";
    e.prototype.initialize = function() {
      this.selections = new window.classes.collection.selectionsCollection();
      this.artists = new window.classes.collection.artistsCollection();
      this.albums = new window.classes.collection.releasesCollection();
      this.playlists = new window.classes.collection.playlistsCollection();
      this.tracks = new window.classes.collection.tracksCollection();
      return this.post = new window.classes.model.postModel()
    };
    e.prototype.parse = function(f) {
      if (f.selections) {
        if (!this.selections) {
          this.selections = new window.classes.collection.selectionsCollection(f.selections, {parse: true})
        } else {
          this.selections.reset(f.selections, {parse: true})
        }
        delete f.selections
      }
      if (f.topArtists) {
        if (!this.artists) {
          this.artists = new window.classes.collection.artistsCollection(f.topArtists, {parse: true})
        } else {
          this.artists.reset(f.topArtists, {parse: true})
        }
        delete f.topArtists
      }
      if (f.topAlbums) {
        if (!this.albums) {
          this.albums = new window.classes.collection.releasesCollection(f.topAlbums, {parse: true})
        } else {
          this.albums.reset(f.topAlbums, {parse: true})
        }
        delete f.topAlbums
      }
      if (f.topPlaylists) {
        if (!this.playlists) {
          this.playlists = new window.classes.collection.playlistsCollection(f.topPlaylists, {parse: true})
        } else {
          this.playlists.reset(f.topPlaylists, {parse: true})
        }
        delete f.topPlaylists
      }
      if (f.topTracks) {
        if (!this.tracks) {
          this.tracks = new window.classes.collection.tracksCollection(f.topTracks, {parse: true})
        } else {
          this.tracks.reset(f.topTracks, {parse: true})
        }
        delete f.topTracks
      }
      if (f.flowPost) {
        if (!this.post) {
          this.post = new window.classes.model.postModel(f.flowPost, {parse: true})
        } else {
          this.post.set(f.flowPost);
          this.post.parse(f.flowPost)
        }
        delete f.flowPost
      }
      return f
    };
    return e
  })(window.classes.model.BaseModel);
  window.classes.model.mainPageModel = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.idAttribute = "link";
    e.prototype.url = function() {
      return window.api_url_2 + "/embedvideo"
    };
    e.prototype.initialize = function(g, f) {
      return e.__super__.initialize.call(this, g, f)
    };
    return e
  })(window.classes.model.BaseModel);
  window.classes.model.embedVideoModel = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.pageNum = -1;
    d.prototype.allowPageLoading = true;
    d.prototype.initialize = function(g, f) {
      this.options = f;
      return d.__super__.initialize.call(this, g, f)
    };
    d.prototype.move = function(f, h) {
      var g;
      g = this.indexOf(f);
      if (g === -1) {
        throw new Error("Can't move a model that's not in the collection")
      }
      if (g !== h) {
        return this.models.splice(h, 0, this.models.splice(g, 1)[0])
      }
    };
    d.prototype.fetch = function(f) {
      if (f == null) {
        f = {}
      }
      f.reset = f.reset || _.isUndefined(f.reset);
      if (f.reset === true) {
        this.pageNum = -1
      }
      if (_.isEmpty(f.data)) {
        f.data = {}
      }
      if (this.options && this.options.data) {
        f.data = _.extend(this.options.data, f.data)
      }
      return d.__super__.fetch.call(this, f)
    };
    d.prototype.loadNextPage = function(f) {
      var g;
      if (this.allowPageLoading === true) {
        this.pageNum = this.pageNum + 1;
        g = this.fetch({reset: false,remove: false,merge: false,data: {pageNum: this.pageNum,pageSize: this.pageSize},success: _.bind(function(h) {
          this.allowPageLoading = !_.isEmpty(h);
          if (f) {
            return f(h)
          }
        }, this)});
        this.allowPageLoading = false;
        return g
      }
    };
    d.prototype.isMore = function() {
      var f, g;
      f = this.pageSize || ((g = this.options) != null ? g.data.pageSize : void 0);
      return this.length >= f
    };
    return d
  })(Backbone.Collection);
  window.classes.collection.BaseCollection = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.model = window.classes.model.artistModel;
    e.prototype.url = function() {
      return window.api_url_2 + "/artists"
    };
    return e
  })(window.classes.collection.BaseCollection);
  window.classes.collection.artistsCollection = c
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.model = window.classes.model.commentModel;
    d.prototype.url = window.api_url_2 + "/comments";
    return d
  })(window.classes.collection.BaseCollection);
  window.classes.collection.commentsCollection = b
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.url = function() {
      return window.api_url_2 + "/flow"
    };
    e.prototype.model = window.classes.model.postModel;
    return e
  })(window.classes.collection.BaseCollection);
  window.classes.collection.flowCollection = c
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.model = window.classes.model.playlistModel;
    d.prototype.url = function() {
      return window.api_url_2 + "/playlists"
    };
    return d
  })(window.classes.collection.BaseCollection);
  window.classes.collection.playlistsCollection = b
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.model = window.classes.model.releaseModel;
    e.prototype.url = function() {
      return window.api_url_2 + "/albums"
    };
    return e
  })(window.classes.collection.BaseCollection);
  window.classes.collection.releasesCollection = c
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.model = window.classes.model.tagModel;
    d.prototype.url = function() {
      return window.api_url + "/tags"
    };
    return d
  })(window.classes.collection.BaseCollection);
  window.classes.collection.tagsCollection = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.model = window.classes.model.trackModel;
    e.prototype.initialize = function(g, f) {
      e.__super__.initialize.call(this, g, f);
      this.target = f && f.target;
      return this.isEditable = f && f.isEditable
    };
    e.prototype.url = function() {
      return window.api_url_2 + "/tracks"
    };
    e.prototype.findTrackByLocalId = function(g) {
      var f;
      f = this.find(function(h) {
        return h.get("syncLocalId") === g
      });
      return f
    };
    e.prototype.moveTrackAtStart = function(g) {
      var f;
      f = this.findTrackByLocalId(g);
      this.reject(function(h) {
        return h.syncLocalId === f.syncLocalId
      });
      this.unshift(f);
      return this
    };
    e.prototype.getIndexByLocalId = function(g) {
      var f;
      f = this.find(function(h) {
        return h.get("syncLocalId") === g
      });
      return this.indexOf(f)
    };
    e.prototype.setFilter = function(f) {
      console.clear();
      return this.each(_.bind(function(g) {
        if (g.get("trackName").match(new RegExp(f, "gi")) || g.get("artistName").match(new RegExp(f, "gi"))) {
          return g.set("hiddenByFilter", false)
        } else {
          return g.set("hiddenByFilter", true)
        }
      }, this))
    };
    return e
  })(window.classes.collection.BaseCollection);
  window.classes.collection.tracksCollection = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.model = window.classes.model.userModel;
    d.prototype.url = function() {
      return window.api_url_2 + "/users"
    };
    return d
  })(window.classes.collection.BaseCollection);
  window.classes.collection.usersCollection = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.model = window.classes.model.PlaylistItem;
    d.prototype.url = function() {
      return window.api_url_2 + "/playlistitems"
    };
    return d
  })(window.classes.collection.BaseCollection);
  window.classes.collection.PlaylistItemsCollection = c
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.model = window.classes.model.LikeTrackModel;
    d.prototype.url = function() {
      return window.api_url_2 + "/likes"
    };
    return d
  })(window.classes.collection.BaseCollection);
  window.classes.collection.LikeList = b
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.model = window.classes.model.NowPlaying;
    e.prototype.pushOnline = function(f) {
      var g;
      g = this.find(function(h) {
        return h.user.id === f.user.id
      });
      if (g) {
        this.remove(g);
        g.destroy()
      }
      return this.add(f)
    };
    e.prototype.removeByUserId = function(g) {
      var f;
      f = this.find(function(h) {
        return g === h.user.id
      });
      return f.destroy()
    };
    e.prototype.url = function() {
      return window.api_url_2 + "/nowplaying"
    };
    return e
  })(window.classes.collection.BaseCollection);
  window.classes.collection.NowPlayingList = c
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.model = window.classes.model.selectionModel;
    d.prototype.url = function() {
      return window.api_url_2 + "/selections"
    };
    return d
  })(window.classes.collection.BaseCollection);
  window.classes.collection.selectionsCollection = b
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.initialize = function() {
      return this.$el.on("click", "a", function(k) {
        var h, f, g;
        h = $(this);
        if (h.attr("navigate") === "false") {
          return false
        }
        if (h.attr("target") === "_blank") {
          return
        }
        if (k.metaKey) {
          return
        }
        if (h.attr("href").match(/http:\/\//ig)) {
          return
        }
        f = h.attr("href");
        g = h.attr("navigate");
        if (f === window.location.pathname) {
          return false
        }
        if (f && (g !== "false")) {
          _.defer(function() {
            return window.router.navigate(f, true)
          })
        }
        return false
      })
    };
    return d
  })(Backbone.View);
  $(function() {
    return new b({el: document.body})
  })
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.events = {"click .js-close, .js-no": "fail","click .js-yes": "confirm"};
    e.prototype.defaults = {title: __("Подтвердите"),text: __("Вы уверенны?")};
    e.prototype.initialize = function(f) {
      if (f == null) {
        f = {}
      }
      this.o = $.extend({}, this.defaults, f);
      return this.render()
    };
    e.prototype.render = function() {
      var f = this;
      this.template = _.template($("#popup-modal-template").html());
      this.$el.html(this.template({options: this.o}));
      this.popup = new window.tracksflow.h.popup({content: this.$el,mode: "modal"});
      return $(document.body).on("keyup", this.$el, function(g) {
        if (g.keyCode === 13) {
          return f.confirm()
        } else {
          return false
        }
      })
    };
    e.prototype.fail = function() {
      var f;
      if (typeof (f = this.o).fail === "function") {
        f.fail()
      }
      return this.close()
    };
    e.prototype.confirm = function() {
      var f;
      if (typeof (f = this.o).success === "function") {
        f.success()
      }
      return this.close()
    };
    e.prototype.tryToConfirm = function(f) {
      alert("lalal");
      if (f.keyCode === 13) {
        return this.confirm
      } else {
        return false
      }
    };
    e.prototype.close = function() {
      $(document.body).off("keyup");
      return this.popup.removeIt()
    };
    return e
  })(Backbone.View);
  window.classes.ConfirmModal = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.events = {"click .js-close, .js-no": "close","click .js-yes": "confirm"};
    d.prototype.initialize = function(f) {
      this.o = f;
      return this.render()
    };
    d.prototype.render = function() {
      this.template = _.template($("#popup-modal-template").html());
      return this.$el.append(this.template({options: this.options}))
    };
    d.prototype.close = function() {
      return this.$(".js_confirm_modal").remove()
    };
    d.prototype.confirm = function() {
      var f;
      if (typeof (f = this.o).cb === "function") {
        f.cb()
      }
      return this.close()
    };
    return d
  })(Backbone.View);
  window.classes.PopupView = c;
  window.utils.confirm = function(f, e, d) {
    f = f || __("Подтвердите");
    e = e || __("Вы уверены?");
    return this.popup = new window.classes.PopupView({el: "#modal-popups",title: f,text: e,cb: d})
  }
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "popup-mdl is-widget";
    e.prototype.initialize = function(f) {
      this.o = f;
      this.$w = $(window);
      if (!f.target && this.o.mode === !"modal") {
        console.error("Sorry! There is no target node to show popup on.");
        return
      }
      this.render();
      $(".blinded-e").data().popup = this;
      $(".blinded-e").trigger("popup");
      this.positOrCenter();
      this.o.mode === "modal" && this.colorBlinded();
      this.o.mode !== "modal" && this.transparentBlinded();
      if (!this.o.mode || (this.o.mode === "modal") || this.o.type === "show-now") {
        this.showDelayed()
      }
      this.listenEvents();
      return this.listenToWResize()
    };
    e.prototype.render = function() {
      this.$el.append(this.o.content);
      this.o.content.data().popup = this;
      this.$el.addClass(this.o["class"]);
      this.o.mode === "modal" && this.$el.addClass("is-no-arrow");
      $(document.body).append(this.$el);
      return this
    };
    e.prototype.posit = function(f) {
      var g;
      g = f != null ? f.current : void 0;
      if (g) {
        this.o.preferredPositions.unshift(this.position.currentPosition || this.o.preferredPositions[0])
      }
      this.o.popup = this.$el;
      if (f != null ? f.target : void 0) {
        this.o.target = target
      }
      this.position = window.tracksflow.h.dropPosition(this.o);
      this.o.positionFixed && (this.position.top -= this.$w.scrollTop());
      this.o.positionFixed && (this.position.left -= this.$w.scrollLeft());
      this.$el.css(this.position);
      this.$el.attr("class", "" + this.className + " " + this.o["class"]);
      this.$el.addClass(this.position.arrowPos);
      this.o.positionFixed && this.$el.css("position", "fixed");
      return this
    };
    e.prototype.positOrCenter = function() {
      this.o.mode === "modal" && this.positCenter();
      this.o.mode === "click" && this.posit();
      return !this.o.mode && this.posit()
    };
    e.prototype.listenToWResize = function() {
      var f = this;
      return this.$w.smartresize(function() {
        return f.positOrCenter()
      })
    };
    e.prototype.positCenter = function() {
      var g, f;
      g = (this.$w.outerWidth() / 2) - (this.$el.outerWidth() / 2);
      f = (this.$w.outerHeight() / 2) - (this.$el.outerHeight() / 2);
      this.$el.css({position: "fixed",left: g,top: f});
      return this
    };
    e.prototype.listenEvents = function() {
      this.o.mode === "hover" && this.listenToHover();
      if ((this.o.mode === "click") || (this.o.mode === "modal") && (this.o.type !== "no-click")) {
        return this.listenToClick("self")
      }
    };
    e.prototype.listenToHover = function() {
      var f = this;
      this.$el.on("mouseenter", function() {
        return f.hoverMouseenter()
      });
      this.$el.on("mouseleave", function() {
        return f.hoverMouseleave()
      });
      this.o.target.on("mouseenter", function() {
        return f.hoverMouseenter()
      });
      return this.o.target.on("mouseleave", function() {
        return f.hoverMouseleave()
      })
    };
    e.prototype.hoverMouseenter = function() {
      this.stopHidingDelay();
      return this.showDelayed()
    };
    e.prototype.hoverMouseleave = function() {
      this.startHidingDelay();
      return this.stopShowingDelay()
    };
    e.prototype.listenToClick = function(f) {
      var g, h = this;
      this.o.listenToClick = true;
      if ((g = this.o.target) != null) {
        g.on("click", function() {
          return h.showDelayed()
        })
      }
      f !== "self" && $(".blinded-e").show();
      $(".blinded-e").on("click", function() {
        $(".blinded-e").hide();
        h.hide();
        return h.o.type === "remove-on-click" && h.removeIt()
      });
      return this
    };
    e.prototype.showDelayed = function() {
      var f = this;
      this.o.mode !== "modal" && this.posit();
      return this.showTimer = setTimeout(function() {
        return f.show()
      }, this.o.showDelay || 0)
    };
    e.prototype.startHidingDelay = function() {
      var f = this;
      return this.hideTimer = setTimeout(function() {
        return f.hide()
      }, this.o.hideDelay || 0)
    };
    e.prototype.stopHidingDelay = function() {
      return clearTimeout(this.hideTimer)
    };
    e.prototype.stopShowingDelay = function() {
      return clearTimeout(this.showTimer)
    };
    e.prototype.colorBlinded = function() {
      return $(".blinded-e").css({"background-color": "rgba(0,0,0,0.5)"})
    };
    e.prototype.transparentBlinded = function() {
      return $(".blinded-e").css({"background-color": "transparent"})
    };
    e.prototype.show = function() {
      var f;
      this.o.targetClass && this.o.target.addClass(this.o.targetClass);
      if (this.o.mode === "click" || this.o.mode === "modal" && "type" !== "no-click") {
        $(".blinded-e").show()
      }
      this.$el.stop().fadeIn(this.o.fadeInSpeed || 0);
      if (typeof (f = this.o).onShow === "function") {
        f.onShow()
      }
      this.trigger("show");
      return this
    };
    e.prototype.hide = function() {
      var f;
      if (this.o.mode === "click" || this.o.mode === "modal" || this.o.listenToClick && "type" !== "no-click") {
        $(".blinded-e").hide()
      }
      this.$el.stop().fadeOut(this.o.fadeInSpeed || 0);
      this.o.targetClass && this.o.target.removeClass(this.o.targetClass);
      this.o.mode === "modal" && this.remove();
      if (typeof (f = this.o).onHide === "function") {
        f.onHide()
      }
      this.trigger("hide");
      return this
    };
    e.prototype.removeIt = function() {
      this.hide();
      this.o.mode === "hover" && this.o.target.off("mouseenter");
      this.o.mode === "hover" && this.o.target.off("mouseleave");
      this.o.mode === "click" && this.o.target.off("click");
      this.o.mode === "click" || this.o.mode === "modal" && $(".blinded-e").off("click");
      this.o.content.unbind();
      this.o.content.remove();
      this.$el.remove();
      this.remove();
      this.unbind();
      return delete this
    };
    return e
  })(Backbone.View);
  window.tracksflow.h.popup = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.isChecked = false;
    e.prototype.events = function() {
      return _.extend({}, window.classes.view.BaseInfo.prototype.events, {"click .js-fb": "shareFb","click .js-tw": "shareTw","click .js-vk": "shareVk","click .js-close": "close","click .mask-b": "tryClose"})
    };
    e.prototype.shareVk = function(f) {
      this.checkBtn(f);
      return this.social.vkClick()
    };
    e.prototype.shareTw = function(f) {
      this.checkBtn(f);
      return this.social.twClick({txt: __("Моя музыка на Tracks Flow")})
    };
    e.prototype.shareFb = function(f) {
      this.checkBtn(f);
      return this.social.fbClick()
    };
    e.prototype.checkBtn = function(g) {
      var f;
      this.isChecked = true;
      f = $(g.target).parents(".flat-btn");
      if (!f.length) {
        f = $(g.target)
      }
      f.find(".js-btn-text").addClass("hidden-gm");
      return f.find(".js-btn-check").removeClass("hidden-gm")
    };
    e.prototype.tryClose = function() {
      if (this.isChecked) {
        return this.close()
      }
    };
    e.prototype.close = function() {
      window.models.currentUser.save([], {friendsPopup: true}, {silent: true});
      return e.__super__.close.apply(this, arguments)
    };
    e.prototype.render = function() {
      this.template = _.template($("#popup-share-profile-template").html());
      this.social = new window.classes.view.socialButtonsView({model: window.models.currentUser});
      return this.$el.append(this.template({model: window.models.currentUser}))
    };
    return e
  })(window.classes.PopupView);
  window.classes.view.PopupShareProfile = c
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.events = {"click .js-follow-btn": "onClickFollow","click .js-share-btn": "onClickShare","mouseleave .checked-mdll": "removeHelperClass"};
    d.prototype.removeHelperClass = function() {
      return this.$(".js-follow-btn").removeClass("cancel-hover")
    };
    d.prototype.onClickFollow = function() {
      if (!window.models.currentUser.id) {
        new window.classes.view.noAuthModal;
        return
      }
      this.model.toggleFollow();
      this.render();
      return this.$(".js-follow-btn").addClass("cancel-hover")
    };
    d.prototype.onClickShare = function(g) {
      var f;
      f = new window.classes.view.socialButtonsView({model: this.model});
      if (!(this.popupAction != null)) {
        return this.popupAction = new window.tracksflow.h.popup({content: f.render().$el,target: this.$(".js-share-btn"),mode: "click",type: "show-now",preferredPositions: ["bottom"]})
      }
    };
    return d
  })(Backbone.View);
  window.classes.view.BaseInfo = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({events: {"click .js-play": "OnClickPlay","click .js-share": "OnClickShare","click .js-plus": "OnClickPlus"},OnClickPlay: function(b) {
    this.clearEvent(b);
    return this.model.lazyLoadTracks(function(c) {
      return window.player.tryPlay(c.at(0))
    })
  },OnClickShare: function(c) {
    var b, d = this;
    this.clearEvent(c);
    b = new window.classes.view.socialButtonsView({model: this.model});
    return this.popupShare = new window.tracksflow.h.popup({target: $(c.target).closest(".js-share"),content: b.render().$el,mode: "click",type: "show-now",preferredPositions: ["bottom"],onShow: function() {
      return d.lockCover()
    },onHide: function() {
      return d.unlockCover()
    }})
  },lockCover: function() {
    this.$imgW = this.$(".flat-card-img-w");
    return this.$imgW.addClass("is-check")
  },unlockCover: function() {
    return this.$imgW.removeClass("is-check")
  },OnClickPlus: function(b) {
    this.clearEvent(b);
    if (window.models.currentUser.id) {
      return this.model.toggleFollow()
    } else {
      return new window.classes.view.noAuthModal
    }
  },clearEvent: function(b) {
    b.stopPropagation();
    return b.preventDefault()
  }});
  window.classes.view.CommonCard = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "flat-card-t flat-card-type-album-gm";
    d.prototype.initialize = function(f) {
      this.model && this.model.on("reset", this.render, this);
      this.model && this.model.on("change", this.render, this);
      return this._subModels = []
    };
    d.prototype.render = function() {
      this.template = _.template($("#albumCard-template").html());
      this.$el.html(this.template({model: this.model}));
      this.$("img").fadeInAll();
      return this
    };
    d.prototype.teardown = function() {
      var g, k, f, h;
      h = this._subModels;
      for (k = 0, f = h.length; k < f; k++) {
        g = h[k];
        window.models.syncManager.remove([g])
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.view.CommonCard);
  window.classes.view.albumCardView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "",events: {"click btn.plus": "voteAdminPlus","click btn.minus": "voteAdminMinus"},initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    return this._subModels = []
  },render: function() {
    this.template = _.template($("#artistAdmin-template").html());
    this.$el.html(this.template({model: this.model}));
    return this
  },voteAdminPlus: function() {
    return console.error("TODO:")
  },voteAdminMinus: function() {
    return console.error("TODO:")
  },teardown: function() {
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.artistAdminView = a
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.initialize = function(f) {
      this.model && this.model.on("reset", this.render, this);
      this._subModels = [];
      this.tagList = new window.classes.view.tagListView({collection: this.model.tags});
      if (this.tagList.model) {
        this._subModels.push(this.tagList.model)
      }
      this.followers = new window.classes.view.userCardsView({collection: this.model.followers});
      if (this.followers.model) {
        return this._subModels.push(this.followers.model)
      }
    };
    d.prototype.render = function() {
      this.template = _.template($("#albumInfo-template").html());
      this.$el.html(this.template({model: this.model}));
      this.tagList.render();
      this.$(".js_tagList").html(this.tagList.el);
      this.followers.render();
      this.$(".js_followers").html(this.followers.el);
      return this
    };
    d.prototype.teardown = function() {
      var g, f;
      if ((g = this.tagList) != null) {
        g.teardown()
      }
      if ((f = this.followers) != null) {
        f.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.view.BaseInfo);
  window.classes.view.albumInfoView = b
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({events: {"click .js-follow-button": "toggleSubscribe","blur .js-album-name": "onBlurName","blur .js-tags": "onBlurTags","blur .year-input-mdlm": "onBlurYear","change .js-month-release": "updateMonth","change .js-type-album": "onChangeType"},initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change:albumName", this.updateName, this);
    this.model && this.model.on("change:uploadImage", this.updateImg, this);
    this.model.on("invalid", this.render, this);
    return $("#js-album-image").live("change", _.bind(this.readImage, this))
  },readImage: function(f) {
    var c, d, b;
    d = f.target.files;
    c = d[0];
    if (!c.type.match("image.*")) {
      this.model.validationError = {attr: "image",msg: "Файл не походит (Не является изображением)"};
      this.model.trigger("invalid");
      return false
    }
    if (c.size > 2 * 1000 * 1000) {
      this.model.validationError = {attr: "image",msg: "Файл не походит (Должен быть не более 2 МБ)"};
      this.model.trigger("invalid");
      return false
    }
    b = new FileReader();
    b.onload = _.bind(function(h) {
      var g;
      g = h.target.result;
      return this.getImage(g, _.bind(function(e) {
        if (e.width < 640 || e.height < 640) {
          this.model.validationError = {attr: "image",msg: "Файл не походит (Ширина или высота меньше 640 точек)"};
          this.model.trigger("invalid");
          return false
        }
        this.model.validationError = {};
        return this.model.set("uploadImage", g)
      }, this))
    }, this);
    b.onerror = function(g) {
      window.utils.msg.warn(__("Не удалось загрузить изображение"));
      return console.error("File could not be read. Code " + g.target.error.code)
    };
    return b.readAsDataURL(c)
  },getImage: function(d, b) {
    var c;
    c = new Image;
    c.onload = function() {
      if (b) {
        return b(this)
      }
    };
    return c.src = d
  },onChangeType: function() {
    var b;
    b = this.$(".js-type-album:checked").val();
    return this.model.set("releaseType", b)
  },onBlurTags: function() {
    var c, b, d;
    c = this.$(".js-tags").val();
    b = c.split(", ");
    d = _.map(b, function(e) {
      return {name: e.trim()}
    });
    return this.model.set("tags", d)
  },onBlurYear: function() {
    this.$(".year-exp-valid-mdlm").addClass("hidden");
    return this.$(".year-input-mdlm").removeClass("is-error")
  },updateImg: function() {
    this.$(".js-image").hide();
    this.$(".img-in-a-b").css("background-image", "url(" + (this.model.get("uploadImage")) + ")");
    this.$(".js-moke-img").addClass("hidden");
    if (this.model.validationError.attr !== "image") {
      return $(".side-block-mdlm .c-red").addClass("hidden")
    }
  },updateName: function() {
    this.$(".name-valid-mdlm").removeClass("is-error");
    if (this.model.validationError && this.model.validationError.attr !== "albumName") {
      return this.$(".name-valid-mdlm").addClass("is-error")
    }
  },updateMonth: function() {
    var b;
    this.$(".month-input-mdlm").removeClass("is-check");
    b = this.$(".js-month-release").val();
    if (b >= 0) {
      this.$(".month-input-mdlm").addClass("is-check");
      return this.$(".select-input-labels-mdlmdl").attr("data-label", this.$(".js-month-release").find(":selected").text())
    } else {
      return this.$(".select-input-labels-mdlmdl").attr("data-label", __("Месяц"))
    }
  },onBlurName: function() {
    var b;
    b = this.$(".js-album-name").val();
    return this.model.set({albumName: b}, {validate: true})
  },render: function() {
    this.template = _.template($("#album-edit-info-template").html());
    this.$el.html(this.template({model: this.model}));
    this.updateMonth();
    return this
  },toggleSubscribe: function(b) {
    return this.model.toggleFollow()
  },teardown: function() {
    this.remove();
    return this
  }});
  window.classes.view.AlbumInfoEdit = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "flat-card-t flat-card-type-artist-gm";
    e.prototype.initialize = function(f) {
      this.model && this.model.on("reset", this.render, this);
      this.model && this.model.on("change", this.render, this);
      return this._subModels = []
    };
    e.prototype.render = function() {
      this.template = _.template($("#artistCard-template").html());
      this.$el.html(this.template({model: this.model}));
      return this
    };
    e.prototype.teardown = function() {
      var g, k, f, h;
      h = this._subModels;
      for (k = 0, f = h.length; k < f; k++) {
        g = h[k];
        window.models.syncManager.remove([g])
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return e
  })(window.classes.view.CommonCard);
  window.classes.view.artistCardView = c
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "";
    d.prototype.events = function() {
      return _.extend({}, window.classes.view.BaseInfo.prototype.events, {"click .js-edit-btn, .js-cancel-btn": "toggleEdit","click .js-show-more": "onClickMore","click .js-save-btn": "onClickSave"})
    };
    d.prototype.initialize = function(f) {
      this.template = _.template($("#artistInfo-template").html());
      this._subModels = [];
      this.tagList = new window.classes.view.tagListView({collection: this.model.tags});
      if (this.tagList.model) {
        return this._subModels.push(this.tagList.model)
      }
    };
    d.prototype.render = function() {
      this.$el.html(this.template({model: this.model}));
      this.tagList.render();
      this.$(".js_tagList").html(this.tagList.el);
      return this
    };
    d.prototype.teardown = function() {
      var f;
      if ((f = this.tagList) != null) {
        f.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    d.prototype.toggleEdit = function() {
      return this.$(".pile").toggleClass("edit")
    };
    d.prototype.onClickMore = function(f) {
      f.preventDefault();
      this.model.toggleIsMore();
      return this.render()
    };
    d.prototype.onClickSave = function() {
      var g, f;
      g = $.trim(this.$(".js-bio").val());
      if (g) {
        this.model.set("bio", g)
      }
      f = this.$(".js-tags").data().tags.map(function(h) {
        return {name: h}
      });
      if (f) {
        this.tagList.collection.reset(f)
      }
      this.render();
      return this.model.save({success: function() {
        return window.utils.msg.notify(__("Данные успешно сохранены"))
      },error: function() {
        return window.utils.msg.error(__("Не удалось сохранить"))
      }})
    };
    return d
  })(window.classes.view.BaseInfo);
  window.classes.view.artistInfoView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "post-comment cf border-box",events: {"click .js-reply": "toReply","click .js-delete": "deleteComment","click .js-edit": "editComment"},initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    return this._subModels = []
  },render: function() {
    this.template = _.template($("#comment-template").html());
    this.$el.html(this.template({model: this.model}));
    return this
  },toReply: function(f) {
    var c, b, d;
    b = "@";
    d = $.trim(this.model.collection.view.$el.find("textarea").val());
    if (d) {
      b = ", " + b
    }
    c = d + b + this.model.user.get("login") + ", ";
    return this.model.collection.commentFormView.replyTo(c)
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.syncManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  },deleteComment: function() {
    var b = this;
    this.model.url = window.api_url_2 + "/comments/" + this.model.id + "?in=flow";
    return new window.classes.ConfirmModal({text: "" + (__("Вы уверенны, что хотите удалить Ваш комментрарий")) + " «" + (this.model.get("message").shorten(20)) + "» ?",success: function() {
      return b.model.destroy()
    }})
  },editComment: function(b) {
    b.stopPropagation();
    return this.model.collection.commentFormView.edit(this.model)
  }});
  window.classes.view.commentView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "comment-large-mdl",events: {"click .reply-comment-icon": "replyComment","click .edit-comment-icon": "editComment","click .delete-icon": "deleteComment"},initialize: function() {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    this.template = this.model.get("actionType") ? _.template($("#comment-large-system-template").html()) : _.template($("#comment-large-template").html());
    this.model.get("actionType") && this.$el.addClass("is-system");
    return this._subModels = []
  },render: function() {
    this.$el.html(this.template({model: this.model}));
    if (this.model.track) {
      this.track = new window.classes.view.trackRowView({model: this.model.track});
      this.track.collection = new window.classes.collection.tracksCollection([this.model.track]);
      this.track.setElement(this.$(".js-track"));
      this.track.render();
      this.track.$el.addClass(this.track.className())
    }
    return this
  },replyComment: function() {
    var c, b, d;
    if (!window.models.currentUser.id) {
      new window.classes.view.noAuthModal
    }
    b = "@";
    d = $.trim(window.classes.model.currentCommentModel.get("message"));
    if (d) {
      b = ", " + b
    }
    c = b + this.model.user.get("login") + ", ";
    window.classes.model.currentCommentModel.set("message", d + c);
    return window.classes.view.currentCommentview.$el.find("textarea").focusEnd()
  },editComment: function() {
    window.classes.model.currentCommentModel.commentTrack.add(this.model.track);
    window.classes.model.currentCommentModel.set(this.model.toJSON());
    window.classes.model.currentCommentModel.set("isEdit", true);
    return window.classes.view.currentCommentview.$el.find("textarea").focusEnd()
  },deleteComment: function() {
    var b = this;
    return new window.classes.ConfirmModal({text: "" + (__("Вы уверенны, что хотите удалить Ваш комментрарий")) + " «" + (this.model.get("message").shorten(20)) + "» ?",success: function() {
      var c;
      b.model.url = window.api_url_2 + "/comments/" + b.model.id;
      return b.model.destroy({data: $.param((c = b.model.collection) != null ? c.params : void 0)})
    }})
  }});
  window.classes.view.commentLargeView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "",events: {"click .__comment-message": "showBig","click #comment-button-with-text-wrapper": "addComment","keydown textarea": "keyDown","click .comment-add-track": "addTrack"},initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    return this._subModels = []
  },replyTo: function(b) {
    this.model = new window.classes.model.commentModel({message: b});
    this.model.user = models.currentUser;
    this.model.on("change", this.render, this);
    return this.renderAndFocus()
  },edit: function(b) {
    var c;
    this.model = b;
    this.model.on("change", this.render, this);
    this.render();
    this.$("textarea").focus().prop("selectionStart", this.$("textarea").val().length);
    c = function() {
      this.$("textarea").val("");
      return this.showSmall()
    };
    return $(window).one("click", _.bind(c, this))
  },render: function() {
    this.template = _.template($("#commentForm-template").html());
    this.$el.html(this.template({model: this.model}));
    return this
  },renderAndFocus: function() {
    this.render();
    this.$("textarea").focus().prop("selectionStart", this.$("textarea").val().length);
    $(window).one("click", _.bind(this.onBlur, this));
    return this
  },showBig: function(b) {
    b && b.stopPropagation();
    $(".comment-form").removeClass("small-version");
    return $(window).one("click", _.bind(this.onBlur, this))
  },showSmall: function(b) {
    return this.$(".comment-form").addClass("small-version")
  },onBlur: function(b) {
    b.stopPropagation();
    return this.model.unset("message")
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.syncManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  },resetModel: function() {
    this.model = new window.classes.model.commentModel();
    this.model.user = models.currentUser;
    this.model && this.model.on("change", this.render, this);
    return this.model.trigger("change")
  },addComment: function() {
    var b;
    b = this.$(".__comment-message").val();
    if (!b) {
      return
    }
    this.collection.add(this.model);
    this.model.set("message", b);
    this.model.save(null, null, null, this.model.id ? null : this.collection.params);
    this.resetModel();
    return this.showSmall()
  },keyDown: function(b) {
    if (b.keyCode === 13 && b.ctrlKey) {
      return this.addComment()
    }
  },addTrack: function(b) {
  }});
  window.classes.view.commentFormView = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "flat-card-t";
    e.prototype.initialize = function(f) {
      this.model && this.model.on("reset", this.render, this);
      this.model && this.model.on("change", this.render, this);
      return this._subModels = []
    };
    e.prototype.render = function() {
      this.template = _.template($("#playlist-card-template").html());
      this.$el.html(this.template({model: this.model}));
      if (this.model.get("isBig")) {
        this.$el.addClass("flat-card-type-large-gm")
      }
      if (this.model.get("isHidden")) {
        this.$el.addClass("flat-card-type-hidden-gm")
      }
      if (this.model.get("isShared")) {
        this.$el.addClass("flat-card-type-collective-gm")
      }
      this.$("img").fadeInAll();
      return this
    };
    e.prototype.teardown = function() {
      this.off();
      this.undelegateEvents();
      return this
    };
    return e
  })(window.classes.view.CommonCard);
  window.classes.view.playlistCardView = c
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "";
    d.prototype.events = function() {
      return _.extend({}, window.classes.view.BaseInfo.prototype.events, {"click .showMore": "showMore","click .js-edit-button": "editMode","click .js-save-btn": "save","click .js-delete-btn": "destroy","click .js-cancel-btn": "readMode"})
    };
    d.prototype.initialize = function(f) {
      this.model && this.model.on("reset", this.render, this);
      this.model && this.model.on("change:images", this.render, this);
      this._subModels = [];
      this.socialButtons = new window.classes.view.socialButtonsView({model: this.model});
      if (this.socialButtons.model) {
        this._subModels.push(this.socialButtons.model)
      }
      this.tagList = new window.classes.view.tagListView({collection: this.model.tags});
      if (this.tagList.model) {
        return this._subModels.push(this.tagList.model)
      }
    };
    d.prototype.render = function() {
      var f = this;
      this.template = _.template($("#playlistInfo-template").html());
      this.$el.html(this.template({model: this.model}));
      this.textareaName = new window.classes.view.TextareaWithCounterView;
      this.textareaName.setElement(this.$(".js-textarea-name-place"));
      this.textareaName.render({text: this.model.get("name"),maxCount: 80,addClass: "textarea-type-c-comments-bg-gm name-m js-name"});
      this.textareaAbout = new window.classes.view.TextareaWithCounterView;
      this.textareaAbout.setElement(this.$(".js-textarea-about-place"));
      this.textareaAbout.render({text: this.model.get("description"),maxCount: 160,addClass: "textarea-type-c-comments-bg-gm about-m decription-m js-description"});
      this.textareaAbout = new window.classes.view.TextareaWithCounterView;
      this.textareaAbout.setElement(this.$(".js-textarea-tags-place"));
      this.textareaAbout.render({text: this.model.tags.toJSON().map(function(g) {
        return g.name
      }).join(", "),maxCount: 30,countChar: ",",addClass: "tags-m textarea-type-c-comments-bg-gm js-tags js-tags"});
      setTimeout(function() {
        return f.prepareUploader()
      }, 1);
      this.socialButtons.render();
      this.$(".js_socialButtons").html(this.socialButtons.el);
      this.tagList.render();
      this.$(".js_tagList").html(this.tagList.el);
      if (this.model.editMode) {
        this.editMode()
      }
      return this
    };
    d.prototype.teardown = function() {
      if (this.socialButtons) {
        this.socialButtons.teardown()
      }
      if (this.tagList) {
        this.tagList.teardown()
      }
      if (this.uploader) {
        this.uploader.destroy()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    d.prototype.showMore = function(f) {
      if (!this.model.followers) {
        return
      }
      this.followers.render();
      this.followers.$el.addClass("height-auto_i");
      $(f.target).hide();
      return false
    };
    d.prototype.editMode = function(f) {
      this.model.editMode = true;
      this.$(".left-panel").addClass("edit");
      return this.$("[class^=edit]").show()
    };
    d.prototype.readMode = function() {
      this.model.editMode = false;
      this.$(".left-panel").removeClass("edit");
      return this.$("[class^=edit]").hide()
    };
    d.prototype.save = function() {
      var h, g, f;
      g = $.trim(this.$(".js-name").val());
      if (g) {
        this.model.set("name", g)
      }
      h = $.trim(this.$(".js-description").val());
      if (h) {
        this.model.set("description", h)
      }
      f = this.$(".js-tags").data().tags.map(function(k) {
        return {name: k}
      });
      if (f) {
        this.model.tags.reset(f)
      }
      this.model.set("isShared", !!this.$(".js-is-friendly-checkbox").attr("checked"));
      this.model.set("isHidden", !!this.$(".js-is-hidden-checkbox").attr("checked"));
      this.model.save(["tags"]);
      this.readMode();
      return this.render()
    };
    d.prototype.destroy = function(g) {
      var f;
      g.stopPropagation();
      f = new window.classes.view.Modal({headtext: __("Удаление плейлиста"),text: _.template(__("Плейлист <%=name%> и все его содержимое будет удалено"), {name: this.model.get("name")}),type: "red",button: {ok: __("Удалить"),cancel: __("Отмена")},classes: "width-x46_i",success: _.bind(this._destroy, this)});
      return $("#modal-popups").html(f.render().el)
    };
    d.prototype._destroy = function() {
      return this.model.destroy({success: function() {
        return history.back()
      },error: function() {
        return window.utils.msg.warn(__("Не удалось удалить плейлист"))
      }})
    };
    d.prototype.prepareUploader = function() {
      var f;
      this.uploader = new plupload.Uploader({runtimes: "html5,flash",file_data_name: "image",browse_button: "plUpload",drop_element: "plUpload",max_file_size: "10mb",url: window.api_url_2 + "/files?for=" + this.model.id + "&in=playlists",flash_swf_url: "/js/lib/plupload/plupload.flash.swf",filters: [{title: "Image files",extensions: "jpeg,jpg,gif,png"}]});
      this.uploader.init();
      f = this;
      this.uploader.bind("FilesAdded", function(g) {
        f.$(".js-image-edit").addClass("is-load");
        return f.uploader.start()
      });
      this.uploader.bind("Error", function(g, h) {
        f.$(".js-image-edit").removeClass("is-load");
        window.utils.msg.warn(__("Не удалось загрузить обложку плейлиста"));
        return console.error("Error", h.code, h.message)
      });
      return this.uploader.bind("FileUploaded", function(h, l, k) {
        var g;
        g = JSON.parse(k.response);
        f.model.set("images", g);
        f.$(".js-image-edit").removeClass("is-load");
        window.utils.msg.notify(__("Обложка плейлиста загружена"));
        return f.render()
      })
    };
    return d
  })(window.classes.view.BaseInfo);
  window.classes.view.playlistInfoView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "",initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    this._subModels = [];
    return this.template = _.template($("#playlist-template").html())
  },render: function() {
    this.$el.html(this.template({model: this.model}));
    return this
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.eventManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.playlistView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "flow-post-mdl flow-post-section-l cf",events: {"click .js-delete-post": "deletePost","click .js-like": "toggleLike","click .js-share-post": "sharePost","click .js-comment-link": "writeComment","click .js-show-all-comments": "showAllComments","mouseenter .js-users-who-like": "showUsersWhoLike","click .js-action-menu": "showShare","click .js-share-track": "showShare","mouseenter .js-post-card": "loadContentTracks"},initialize: function(b) {
    this.contentWidth = 512;
    if (!this.model) {
      this.model = new window.classes.model.postModel()
    }
    this.model.on("reset", this.render, this);
    this.model.on("change", this.render, this);
    this.model.content && this.model.content.on("change", this.render, this);
    this._subModels = [];
    this.trackList = new window.classes.view.trackListView({collection: this.model.tracks});
    return this.commentList = new window.classes.view.commentsView({collection: this.model.comments,url: window.api_url_2 + "/comments?for=" + this.model.id + "&in=flow"})
  },render: function() {
    var b;
    this.template = _.template($("#postInfo-template").html());
    this.$el.html(this.template({model: this.model}));
    if (this.model.getContentType() === "video") {
      this.$(".js-post-card").html(this.getVideoHtmlCode())
    } else {
      if (this.model.content) {
        this.model.content.contentType = this.model.getContentType();
        b = new window.classes.view.postCard({model: this.model.content});
        b.setElement(this.$(".js-post-card").addClass(b.className()));
        b.render()
      }
    }
    if (this.model.repostedBy || this.model.has("artistImage")) {
      this.$el.addClass("is-repost")
    }
    if (this.model.getContentType() === "artist") {
      this.$(".js-artist-name-cover").show()
    }
    if (this.contentTracks) {
      this.contentTracks.setElement(this.$(".js-content-tracks"));
      this.contentTracks.render()
    }
    this.trackList.setElement(this.$(".js-tracklist").addClass(this.trackList.className));
    this.trackList.render();
    this.$(".js-show-all-comments").hide();
    if (this.model.get("commentsCount") > 0) {
      this.showComments()
    } else {
      this.$(".js-comment-link").show()
    }
    this.$imgW = this.$(".flat-card-img-w");
    this.$blinded = $(".blinded-e");
    return this
  },showShare: function(b) {
    b.stopPropagation();
    b.preventDefault();
    this.lockIcons(b);
    return this.listenToClick()
  },listenToClick: function() {
    var b = this;
    this.$blinded.show();
    return this.$blinded.one("popup", function() {
      return b.$blinded.data().popup.on("hide", function() {
        return b.unlockIcons()
      })
    })
  },lockIcons: function(d) {
    var c, b;
    this.$iconText = $(d.target).parents(".icon-with-text");
    this.$iconFork = $(d.target).parents(".icons-fork");
    if ((c = this.$imgW) != null) {
      c.addClass("is-check")
    }
    this.$iconFork.addClass("width-x8-gm-i");
    this.isHidden = (b = this.$iconText.attr("class")) != null ? b.indexOf("hidden") : void 0;
    if (this.isHidden > -1) {
      return this.$iconText.removeClass("hidden")
    }
  },unlockIcons: function() {
    var c, b;
    if ((c = this.$imgW) != null) {
      c.removeClass("is-check")
    }
    if ((b = this.$iconFork) != null) {
      b.removeClass("width-x8-gm-i")
    }
    if (this.isHidden > -1) {
      return this.$iconText.addClass("hidden")
    }
  },writeComment: function() {
    var b = this;
    if (!window.models.currentUser.id) {
      new window.classes.view.noAuthModal;
      return
    }
    this.showComments();
    this.$(".flow-post-controls-mdl").addClass("is-with-comments");
    return setTimeout(function() {
      return b.$(".js-new-comment").focus()
    }, 100)
  },showUsersWhoLike: function(c) {
    var b, d = this;
    b = {data: {"for": this.model.id,"in": "flow",pageSize: 5}};
    this.followers = new window.classes.collection.usersCollection();
    this.usersViewWithTitle = new window.classes.view.UserCardsWithTitle({track: this.model,title: __("Этот пост нравится"),type: "show-now",count: this.model.get("likesCount") + " " + window.tracksflow.h.endings(this.model.get("likesCount"), __("человеку"), __("людям")),collection: this.followers,pageSize: 5});
    this.showPopup(this.usersViewWithTitle.$el, c);
    return this.usersViewWithTitle.collection.fetch(b).then(function() {
      var e;
      return (e = d.popup) != null ? e.posit() : void 0
    })
  },showPopup: function(b, c) {
    this.removePopup();
    return this.popup = new window.tracksflow.h.popup({content: b,target: this.$(".js-users-who-like"),mode: "hover",type: "show-now","class": "is-with-shadow",showDelay: 400,hideDelay: 400,preferredPositions: ["top", "left", "right"]})
  },removePopup: function() {
    var b;
    if ((b = this.popup) != null) {
      b.removeIt()
    }
    return delete this.popup
  },showComments: function() {
    this.commentList.setElement(this.$(".js-comments"));
    this.commentList.render();
    if (this.model.get("commentsCount") > 3 && this.model.comments.length !== this.model.get("commentsCount")) {
      this.$(".js-show-all-comments").addClass("is-check")
    }
    this.$(".js-comment-link").hide();
    return this.$(".js-show-all-comments").show()
  },showAllComments: function(b) {
    this.$(".js-show-all-comments").hide();
    this.$(".js-show-all-comments").removeClass("is-check");
    return this.commentList.showAllComments(b, true)
  },loadContentTracks: function() {
    var d, b, e, c;
    if (!this.contentTracks && _.indexOf(["playlist", "album"], this.model.getContentType()) >= 0) {
      e = {};
      d = {};
      b = new window.classes.view.actionRowView({model: d,action: _.bind(function() {
        return window.router.navigate(this.model.content.getLink(), {trigger: true})
      }, this)});
      if (this.model.getContentType() === "playlist") {
        c = this.model.content.get("itemsCount");
        this.contentTracks = new window.classes.view.PlaylistTrackListView({collection: this.model.content.tracks,actionRowView: b,tracksLimit: 9})
      }
      if (this.model.getContentType() === "album") {
        c = this.model.content.get("tracksCount");
        this.contentTracks = new window.classes.view.trackListView({collection: this.model.content.tracks,actionRowView: b,tracksLimit: 9});
        e["in"] = "albums"
      }
      this.contentTracks.setElement(this.$(".js-content-tracks"));
      return this.model.content.tracks.fetch({success: _.bind(function(f) {
        c = c || f.length;
        d.text = __("Все") + " " + c + " " + window.utils.plural(c, __("трек"), __("треков"), __("трека"));
        return this.contentTracks.render()
      }, this),silent: true})
    }
  },deletePost: function() {
    var b;
    b = this;
    return window.utils.confirm("", "", function() {
      return b.model.destroy()
    })
  },sharePost: function() {
    var b;
    console.log("share");
    b = new window.classes.view.socialButtonsView({model: this.model});
    if (this.popupAction != null) {
      this.popupAction.removeIt();
      delete this.popupAction
    }
    this.popupAction = new window.tracksflow.h.popup({content: b.render().$el,target: this.$(".js-share-post"),preferredPositions: ["bottom"]});
    return this.popupAction.listenToClick()
  },toggleLike: function() {
    var b;
    if ((b = this.popup) != null) {
      b.hide()
    }
    if (!window.models.currentUser.id) {
      new window.classes.view.noAuthModal;
      return
    }
    if (this.model.get("liked") === true) {
      this.model.set({liked: false,likesCount: this.model.get("likesCount") - 1})
    } else {
      this.model.set({liked: true,likesCount: this.model.get("likesCount") + 1})
    }
    return this.model.save()
  },getVideoHtmlCode: function() {
    var c, d, e, b;
    c = this.model.content.get("html");
    e = this.model.content.get("width");
    d = this.model.content.get("height");
    b = this.contentWidth * d / e;
    c = $(c);
    c.attr("width", this.contentWidth);
    c.attr("height", b);
    return c
  },teardown: function() {
    var c, b;
    if ((c = this.trackList) != null) {
      c.teardown()
    }
    if ((b = this.commentList) != null) {
      b.teardown()
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.postInfoView = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.ENTER_CODE = 13;
    d.prototype.id = "sidebar";
    d.prototype.allowSections = ["artists", "albums", "tracks", "playlists", "users"];
    d.prototype.events = {"keyup .js-search": "onKeySearch","click .js-add": "showAdd","click .js-share": "showShare","click .js-log-in": "initLogInModal","click .js-create-account": "initCreateAccountModal","click .js-logout": "logOut"};
    d.prototype.initialize = function() {
      return Backbone.history.bind("all", _.bind(this.checkActiveLink, this))
    };
    d.prototype.checkActiveLink = function(g, f) {
      this.$(".js-nav-item").removeClass("check");
      switch (window.location.pathname) {
        case window.models.currentUser.getLink() + "/tracks":
          return this.$(".js-cur-tracks").addClass("check");
        case window.models.currentUser.getLink() + "/playlists":
          return this.$(".js-cur-playlists").addClass("check");
        case window.models.currentUser.getLink() + "/albums":
          return this.$(".js-cur-albums").addClass("check");
        case window.models.currentUser.getLink() + "/artists":
          return this.$(".js-cur-artists").addClass("check");
        case "/trends":
          return this.$(".js-nav-trends").addClass("check");
        case "/flow":
          return this.$(".js-nav-flow").addClass("check")
      }
    };
    d.prototype.onKeySearch = function(m) {
      var h, l, g, k, f;
      if (m.keyCode === this.ENTER_CODE) {
        l = window.location.pathname.split("/");
        h = _.any(this.allowSections, function(n) {
          return l[3] === n && l[1] === "search"
        });
        k = h ? l[3] : "";
        f = k.length ? "/" + k : "";
        g = this.$(".js-search").val();
        return window.router.navigate("search/" + window.utils.linkBeautify(g) + f, {trigger: true})
      }
    };
    d.prototype.render = function() {
      var f;
      this.template = _.template($("#sidebar-template").html());
      $("#js-sidebar-placeholder").replaceWith(this.$el.html(this.template()).css("position", "fixed"));
      if (window.models.currentUser.id) {
        f = new window.classes.SocketListener;
        f.listen()
      }
      if (window.models.currentUser.id) {
        window.views.sidebarUser = new window.classes.view.CurrentUser({$el: $(".js_current-user-placeholder"),model: window.models.currentUser});
        this.$(".js_current-user-placeholder").replaceWith(window.views.sidebarUser.render().el)
      }
      window.views.audioPlayerView = new window.classes.view.Player({el: ".player",model: window.player});
      return this
    };
    d.prototype.logOut = function() {
      return window.models.currentUser.logout()
    };
    d.prototype.initCreateAccountModal = function() {
      return new window.classes.view.CreateAccoutModal
    };
    d.prototype.initLogInModal = function() {
      var f = this;
      return new window.classes.view.LogInModal({success: function() {
        window.router._nextView = window.router._currentView;
        return window.router.startView()
      }})
    };
    d.prototype.showAdd = function(g) {
      var f, h = this;
      if (!window.models.currentUser.id) {
        new window.classes.view.noAuthModal;
        return
      }
      window.player.get("current").showMenu().then(function(k) {
        k.render();
        if (!(h.popupAction != null)) {
          return h.popupAction = new window.tracksflow.h.popup({content: k.$el,target: h.$(".cross-icon"),mode: "click",type: "show-now",positionFixed: true,preferredPositions: ["bottom", "left", "right"]})
        }
      });
      return f = $(g.target).closest(".js-add")
    };
    d.prototype.showShare = function(g) {
      var h, f;
      f = new window.classes.view.socialButtonsView({model: window.player.get("current")});
      h = {content: f.render().$el};
      return $(g.target).closest(".js-share").tf_popup(h)
    };
    d.prototype.teardown = function() {
      var g, k, f, h;
      h = this._subModels;
      for (k = 0, f = h.length; k < f; k++) {
        g = h[k];
        window.models.syncManager.remove([g])
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(Backbone.View);
  window.classes.view.Sidebar = c
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({WN_HEIGHT: 436,WN_WIDTH: 626,tagName: "ul",className: "share-menu-mdl margin-x1-omit-i-gm",events: {"click .js-facebook": "fbClick","click .js-vk": "vkClick","click .js-twitter": "twClick","click .js-share-flow": "shareFlowClick"},render: function() {
    this.template = _.template($("#socialButtons-template").html());
    this.$el.html(this.template({model: this.model}));
    if (this.model && this.model instanceof window.classes.model.postModel && this.model.user.isMe()) {
      this.$(".js-share-flow").hide()
    }
    if (this.model && this.model instanceof window.classes.model.postModel && this.model.get("reposted") === true) {
      this.$(".js-share-flow").hide()
    }
    if (this.model && this.model instanceof window.classes.model.userModel) {
      this.$(".js-share-flow").hide()
    }
    return this
  },teardown: function() {
    this.remove();
    return this
  },shareFlowClick: function() {
    var b = this;
    if (!window.models.currentUser.id) {
      new window.classes.view.noAuthModal;
      return
    }
    if (this.model instanceof window.classes.model.postModel) {
      if (!this.model.repostedBy) {
        this.model.repostedBy = new window.classes.model.userModel(window.models.currentUser.toJSON())
      } else {
        this.model.repostedBy.set(window.models.currentUser.toJSON())
      }
      this.model.set("reposted", "true");
      return this.model.save([], null, {silent: true,success: _.bind(function() {
        this.$el.data().popup.hide();
        return this.teardown()
      }, this)})
    } else {
      this.post = new window.classes.model.postModel();
      return this.post.fillNewPostData(function() {
        if (b.model instanceof window.classes.model.trackModel) {
          if (!b.post.tracks) {
            b.post.tracks = new window.classes.collection.tracksCollection()
          }
          b.post.tracks.add(b.model)
        } else {
          if (b.model instanceof window.classes.model.PlaylistItem) {
            if (!b.post.tracks) {
              b.post.tracks = new window.classes.collection.tracksCollection()
            }
            b.post.tracks.add(b.model.track)
          } else {
            if (b.model instanceof window.classes.model.LikeTrackModel) {
              if (!b.post.tracks) {
                b.post.tracks = new window.classes.collection.tracksCollection()
              }
              b.post.tracks.add(b.model.track)
            } else {
              b.post.content = b.model
            }
          }
        }
        b.post.save([], null, {success: function() {
          return window.utils.msg.notify(__("Добавлено в черновик. Перейдите в поток для публикации."))
        }});
        return window.utils.msg.notify(__("Обработка. Пожалуйста, подождите..."))
      })
    }
  },fbClick: function(c) {
    var b;
    b = "http://" + window.location.host + this.model.getLink();
    return window.open("http://www.facebook.com/sharer.php?u=" + b, "fb-share", "toolbar=0,status=0,width=" + this.WN_WIDTH + ",height=" + this.WN_HEIGHT)
  },vkClick: function(c) {
    var d, b;
    b = "http://" + window.location.host + this.model.getLink();
    d = this.model.getShareText();
    return window.open("http://vkontakte.ru/share.php?title=" + d + "&url=" + b, "vk-share", "toolbar=0,status=0,width=" + this.WN_WIDTH + ",height=" + this.WN_HEIGHT)
  },twClick: function(c) {
    var d, b;
    b = encodeURIComponent("http://" + window.location.host + this.model.getLink());
    d = c.txt || this.model.getShareText();
    return window.open("http://twitter.com/share?text=" + d + "&url=" + b, "tw-share", "toolbar=0,status=0,width=" + this.WN_WIDTH + ",height=" + this.WN_HEIGHT)
  },mailClick: function() {
    var b, c;
    c = encodeURI("Tracks Flow");
    b = "";
    return parent.location = "mailto:?subject=" + c
  }});
  window.classes.view.socialButtonsView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({tagName: "a",className: "tag no-hover",initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    return this._subModels = []
  },render: function() {
    this.$el.text(this.model.get("name"));
    return this
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.syncManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.tagView = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.events = {"click a": "addToPlaylist","keyup input": "filterPlaylists","click .js-add-new-palylist": "renderAddToNewPlaylistMenu","keyup #js-new-playlist-submit": "addNewPlaylist"};
    e.prototype.initialize = function() {
      this.template = _.template($("#trackrow-actions-to-playlist-template").html());
      this.playlistTemplate = _.template($("#trackrow-actions-playlist-template").html());
      this.addToNewPlaylistMenuTemplate = _.template($("#trackrow-actions-to-new-playlist-template").html());
      return this.collection && this.collection.on("change", this.render, this)
    };
    e.prototype.render = function() {
      this.$el.html(this.template({collection: this.collection.models}));
      return this.renderPlaylists(this.collection.models)
    };
    e.prototype.renderPlaylists = function(k) {
      var f, h, g, l = this;
      this.sortPlaylists(k);
      h = _.map(this.mine, function(m) {
        return l.playlistTemplate({model: m})
      });
      f = _.map(this.friendly, function(m) {
        return l.playlistTemplate({model: m})
      });
      this.$(".js-my-playlists").html(h.join(""));
      this.$(".js-friendly-playlists").html(f.join(""));
      this.jq_checkIfFriendlyHeaderNeeded();
      return (g = this.$el.data().popup) != null ? g.posit() : void 0
    };
    e.prototype.renderAddToNewPlaylistMenu = function() {
      this.$el.html(this.addToNewPlaylistMenuTemplate());
      this.$el.find("input").trigger("focus");
      return this.$el.data().popup.posit()
    };
    e.prototype.sortPlaylists = function(f) {
      var g = this;
      this.friendly = [];
      this.mine = [];
      return f != null ? f.filter(function(h) {
        if (h.get("isShared") && h.get("liked")) {
          g.friendly.push(h)
        }
        if (h.get("liked") === false) {
          return g.mine.push(h)
        }
      }) : void 0
    };
    e.prototype.addNewPlaylist = function(g) {
      var h, f;
      f = $.trim($(g.target).val());
      if ((g.keyCode === 13) && f.length) {
        h = new window.classes.model.playlistModel;
        h.set("name", f);
        h.set("tracks", new window.classes.collection.PlaylistItemsCollection(this.options.trackModel));
        h.save();
        window.utils.msg.html("" + (__("Плейлист")) + ' <span class="bold-gm">' + f + "</span> " + (__("с треком")) + ' <span class="bold-gm">' + (this.options.trackModel.get("trackName")) + "</span> " + (__("создан")));
        return this.$el.data().popup.hide()
      }
    };
    e.prototype.addToPlaylist = function(k) {
      var g, f, m, l, h;
      g = $(k.target).closest("a");
      h = $(".to-playlists-popup-w").scrollTop();
      m = g.attr("href").replace("/playlist/", "");
      l = new window.classes.model.PlaylistItem({track: this.options.trackModel});
      l.url = "" + window.api_url_2 + "/playlistitems?for=" + m;
      l.save("track");
      f = this.collection.where({playlistId: m})[0];
      f.set("hasTrack", true);
      $(".to-playlists-popup-w").scrollTop(h);
      return false
    };
    e.prototype.filterPlaylists = function(h) {
      var f, g, k = this;
      f = $(h.target);
      g = $.trim(f.val());
      if (g) {
        this.filteredCollection = this.collection.filter(function(l) {
          return l.get("name").match(new RegExp(g, "gi"))
        });
        return this.renderPlaylists(this.filteredCollection)
      } else {
        return this.renderPlaylists(this.collection.models)
      }
    };
    e.prototype.jq_checkIfFriendlyHeaderNeeded = function() {
      if (this.friendly.length === 0) {
        return this.$(".js-friendly-playlists-header").hide()
      }
    };
    return e
  })(Backbone.View);
  window.classes.view.TrackRowActionsAddToPlaylists = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "";
    e.prototype.events = {"click .play-button.alone": "playOrPause","click .js-track-menu": "showTrackMenu","mouseenter .heart-icon-new": "showUsersWhoLike","click .heart-icon-new": "toggleLike","click .js-share": "showShare","click .js-add": "showAddMenu"};
    e.prototype.initialize = function(f) {
      this.model && this.model.on("reset", this.render, this);
      this.model && this.model.on("change", this.render, this);
      return this._subModels = []
    };
    e.prototype.showAddMenu = function(f) {
      var g = this;
      if (!window.models.currentUser.id) {
        new window.classes.view.noAuthModal;
        return
      }
      return this.model.showMenu().then(function(h) {
        h.render();
        if (!(g.popupAction != null)) {
          return g.popupAction = new window.tracksflow.h.popup({content: h.$el,target: g.$(".js-add"),mode: "click",type: "show-now",preferredPositions: ["bottom", "left", "right"]})
        }
      })
    };
    e.prototype.showShare = function(g) {
      var h, f;
      f = new window.classes.view.socialButtonsView({model: this.model});
      h = {content: f.render().$el};
      return $(g.target).closest(".js-share").tf_popup(h)
    };
    e.prototype.render = function() {
      this.template = _.template($("#trackInfo-template").html());
      this.$el.html(this.template({model: this.model}));
      this.tags = new window.classes.view.tagListView({collection: this.model.tags});
      this.tags.setElement(this.$(".tags"));
      this.tags.render();
      return this.initPopup()
    };
    e.prototype.teardown = function() {
      var g, k, f, h;
      h = this._subModels;
      for (k = 0, f = h.length; k < f; k++) {
        g = h[k];
        window.models.syncManager.remove([g])
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    e.prototype.showTrackMenu = function(f) {
      return this.model.showMenu({$el: $(f.target)})
    };
    e.prototype.showUsersWhoLike = function(f) {
    };
    e.prototype.initPopup = function() {
    };
    e.prototype.toggleLike = function(f) {
      if (!window.models.currentUser.id) {
        return
      }
      return this.model.toggleLike()
    };
    e.prototype.playOrPause = function(f) {
      f.stopPropagation();
      if (this.model.isPlaying()) {
        window.player.pause();
        return
      }
      if (this.model.getSyncLocalId() === window.player.get("current").getSyncLocalId()) {
        window.player.startPlay(window.player.get("current"), window.player.engine.get("currentTime"), true);
        return
      }
      return window.player.tryPlay(this.model)
    };
    return e
  })(Backbone.View);
  window.classes.view.trackInfoView = c
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({events: {"click .js-heart-icon": "likeTrack","click #clickArea": "playOrPause","click .play-button": "playOrPause","click .cross-icon": "showTrackActions","click .js-share-track": "showShare","click .add-track-btn-m": "addTrack","click .delete-track-icon": "deleteTrack","mouseover .heart-icon-new": "showUsersWhoLike"},POPUP_DELAY: 400,initialize: function(b) {
    var c = this;
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    this.model && this.model.on("change", this.render, this);
    this.model.track && this.model.track.on("change", this.render, this);
    this.model && this.model.on("render", this.render, this);
    this.isHiddenIcons = false;
    window.router.on("all", function() {
      return c.teardown()
    });
    return this._subModels = []
  },className: function() {
    var c, b, d;
    if (this.model.isEditable || ((c = this.model.collection) != null ? c.isEditable : void 0) === true) {
      if (((b = this.model.collection) != null ? b.length : void 0) > 1) {
        return "track-line track-line-type-editable-all-gm"
      } else {
        return "track-line track-line-type-editable-delete-gm"
      }
    } else {
      if (this.model.isEmpty) {
        return "track-line empty"
      } else {
        if (((d = this.model.collection) != null ? d.isSelectable : void 0) === true) {
          return "track-line track-line-type-add-gm"
        } else {
          return "track-line"
        }
      }
    }
  },render: function() {
    this.$(".heart-icon-new").tf_popup_hide();
    this.template = _.template($("#trackRow-template").html());
    this.$el.html(this.template({model: this.model}));
    this.removePopups();
    this.iconWithText = this.$(".icon-with-text");
    this.iconsFork = this.$(".icons-fork");
    return this
  },addTrack: function() {
    if (this.model.collection.target instanceof Backbone.Collection) {
      this.model.collection.target.add(this.model.toJSON())
    }
    if (this.model.collection.target instanceof Backbone.Model) {
      this.model.collection.target.set(this.model.toJSON())
    }
    if (_.isFunction(this.model.collection.target)) {
      return this.model.collection.target(this.model)
    }
  },removePopups: function() {
    var c, b, d;
    if ((c = this.popupAction) != null) {
      c.removeIt()
    }
    if ((b = this.popupShare) != null) {
      b.removeIt()
    }
    if ((d = this.popup) != null) {
      d.removeIt()
    }
    delete this.popupAction;
    delete this.popupShare;
    return delete this.popup
  },showTrackActions: function(b) {
    var c = this;
    if (!window.models.currentUser.id) {
      new window.classes.view.noAuthModal;
      return
    }
    return this.model.showMenu().then(function(d) {
      var e;
      d.render();
      e = false;
      if (!(c.popupAction != null)) {
        return c.popupAction = new window.tracksflow.h.popup({content: d.$el,target: c.$(".cross-icon"),"class": "is-with-shadow",mode: "click",type: "show-now",preferredPositions: ["bottom", "left", "right"],onShow: function() {
          return c.lockIcons()
        },onHide: function() {
          return c.unLockIcons()
        }})
      }
    })
  },showShare: function(c) {
    var b, d = this;
    b = new window.classes.view.socialButtonsView({model: this.model});
    if (!(this.popupShare != null)) {
      return this.popupShare = new window.tracksflow.h.popup({content: b.render().$el,target: this.$(".js-share-track"),"class": "is-with-shadow",mode: "click",type: "show-now",preferredPositions: ["top", "bottom", "right"],onShow: function() {
        return d.lockIcons()
      },onHide: function() {
        return d.unLockIcons()
      }})
    }
  },lockIcons: function() {
    this.isHiddenIcons = this.iconWithText.hasClass("hidden");
    this.isHiddenIcons && this.iconWithText.removeClass("hidden");
    return this.iconsFork.addClass("width-x8-gm-i")
  },unLockIcons: function() {
    this.isHiddenIcons && this.iconWithText.addClass("hidden");
    return this.iconsFork.removeClass("width-x8-gm-i")
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.syncManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    this.remove();
    this.removePopups();
    return this
  },likeTrack: function(b) {
    b.stopPropagation();
    b.preventDefault();
    if (window.models.currentUser.id) {
      return this.model.toggleLike()
    } else {
      return new window.classes.view.noAuthModal
    }
  },playOrPause: function(b) {
    b.preventDefault();
    b.stopPropagation();
    if (this.model.isPlaying()) {
      window.player.pause();
      return
    }
    if (this.model.get("syncLocalId") === window.player.get("current").get("syncLocalId")) {
      window.player.startPlay(window.player.get("current"), window.player.engine.get("currentTime"), true);
      return
    }
    return window.player.tryPlay(this.model)
  },showUsersWhoLike: function() {
    var b, c = this;
    b = {data: {"for": this.model.getArtist().toLowerCase() + "_" + this.model.getName().toLowerCase(),"in": "tracks",pageSize: 5}};
    this.followers = new window.classes.collection.usersCollection();
    this.usersViewWithTitle = new window.classes.view.UserCardsWithTitle({track: this.model,title: __("Этот трек нравится"),type: "show-now",count: this.model.getLikesCount() + " " + window.utils.plural(this.model.getLikesCount(), __("людям"), __("человеку"), __("людям")),collection: this.followers,pageSize: 5});
    this.showPopup(this.usersViewWithTitle.$el);
    return this.usersViewWithTitle.collection.fetch(b).then(function() {
      var d;
      return (d = c.popup) != null ? d.posit() : void 0
    })
  },showPopup: function(b) {
    var c = this;
    if (!(this.popup != null)) {
      return this.popup = new window.tracksflow.h.popup({content: b,target: this.$(".js-heart-icon"),mode: "hover",type: "show-now","class": "is-with-shadow",showDelay: this.POPUP_DELAY,hideDelay: this.POPUP_DELAY,preferredPositions: ["top", "left", "right"],onShow: function() {
        return c.lockIcons()
      },onHide: function() {
        return c.unLockIcons()
      }})
    }
  },hideUsersWhoLike: function(b) {
    this.mouseenter = false;
    return clearTimeout(this.timer)
  },deleteTrack: function() {
    return this.model.removeSelf()
  }});
  window.classes.view.trackRowView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({events: {"click .delete-track-icon": "deleteTrack","click .js-delete-link": "deleteLink","keyup .js-trackName": "onKeyupName","focus .js-trackName": "onFocusName","click .play-button": "playOrPause","blur .js-artistName": "onBlurArtist","blur .js-duration": "onBlurDuration","click .js-add-link": "showConfirm"},POPUP_DELAY: 400,className: "album-edit-track-line-mdl",initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    this.model && this.model.on("change", this.model.checkLink, this.model);
    this._subModels = [];
    this.tracks = new window.classes.collection.tracksCollection([], {target: this.model});
    this.debouncedSearch = _.debounce(_.bind(this.suggestTrack, this), 300);
    return this.debouncedSetTrackName = _.debounce(_.bind(this.onBlurName, this), 1000)
  },onBlurName: function() {
    return this.model.set({trackName: this.$(".js-trackName").val(),durationSec: this.timeToSec(this.$(".js-duration").val()),link: null})
  },onBlurDuration: function() {
    return this.model.set({durationSec: this.timeToSec(this.$(".js-duration").val())})
  },onFocusName: function(b) {
    b.stopPropagation();
    return this.debouncedSearch()
  },showPopup: function(b) {
    if (this.popup) {
      return
    }
    this.popup = new window.tracksflow.h.popup({target: this.$(".js-trackName"),content: b,"class": "container-l is-modal is-white",preferredPositions: ["top"]});
    return $("#content").one("click", _.bind(function() {
      return this.removePopup()
    }, this))
  },timeToSec: function(c) {
    var b, d;
    b = c.split(":");
    d = parseInt(b[0], 10) * 60 + parseInt(b[1], 10);
    return d
  },onBlurArtist: function() {
    return this.model.set({artistName: this.$(".js-artistName").val(),durationSec: this.timeToSec(this.$(".js-duration").val()),link: null})
  },removePopup: function() {
    this.popup.remove();
    return this.popup = null
  },suggestTrack: function() {
    var d, c, b;
    c = this.$(".js-trackName").val();
    this.mouseenter = true;
    this.tracks.isSelectable = true;
    b = new window.classes.view.trackListView({collection: this.tracks});
    d = {data: {"for": c + " " + this.model.getArtist(),"in": "search",pageSize: 10}};
    return this.tracks.fetch(d).then(_.bind(function() {
      if (this.tracks.length === 0) {
        this.removePopup();
        return
      }
      this.showPopup(b.render().el);
      if (this.popup) {
        return this.popup.posit(this.$(".js-trackName"))
      }
    }, this))
  },showConfirm: function(c) {
    var b;
    c.stopPropagation();
    b = new window.classes.view.ModalWithInput({headtext: __("Добавить прямую ссылку"),text: __("Tracks Flow не хранит аудиофайлы. Вы можете загрузить mp3-файл в Интернет и указать прямую ссылку."),button: {ok: __("Добавить"),cancel: __("Отмена")},success: _.bind(function(d) {
      return window.player.checkPlayable(d, {success: _.bind(function() {
        this.model.set("userLink", d);
        this.model.set("link", d);
        this.model.set("source", "user");
        return this.modal.remove()
      }, this),error: function(e) {
        if (e == null) {
          e = null
        }
        if (e) {
          return utils.msg.warn(__(e))
        } else {
          return utils.msg.warn(__("Ссылка не работает"))
        }
      }})
    }, this)});
    return $("#modal-popups").html(b.render().$el)
  },onKeyupName: function() {
    this.debouncedSearch();
    return this.debouncedSetTrackName()
  },render: function() {
    this.template = _.template($("#trackRowEdit-template").html());
    this.$el.html(this.template({model: this.model}));
    return this
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.syncManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  },playOrPause: function(b) {
    if (this.model.isPlaying()) {
      window.player.pause();
      return
    }
    if (this.model.get("syncLocalId") === window.player.get("current").get("syncLocalId")) {
      window.player.startPlay(window.player.get("current"), window.player.engine.get("currentTime"), true);
      return
    }
    return window.player.tryPlay(this.model)
  },deleteTrack: function() {
    return this.model.collection.remove(this.model)
  },deleteLink: function() {
    this.model.unset("userLink");
    this.model.unset("link");
    this.model.unset("source");
    return this.model.checkLink()
  }});
  window.classes.view.TrackRowEdit = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "pileSection track-line",events: {"click .heart-icon": "likeTrack","click #clickArea": "playOrPause","click .play-button": "playOrPause"},initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    return this._subModels = []
  },render: function() {
    this.template = _.template($("#track-template").html());
    this.$el.html(this.template({model: this.model}));
    return this
  },likeTrack: function(b) {
    return this.model.toggleLike()
  },playOrPause: function(c) {
    var b;
    b = $(c.target);
    if (b.hasClass("load") || b.hasClass("check")) {
      return window.player.pause()
    } else {
      return this.model.playOrPause()
    }
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.syncManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.trackView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "rounded-cover userThumb",tagName: "a",initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    return this._subModels = []
  },render: function() {
    this.template = _.template($("#userCard-template").html());
    this.$el.html(this.template({model: this.model}));
    this.$el.attr("href", "/user/" + (this.model.get("login")));
    this.$el.attr("title", this.model.getName());
    return this
  },teardown: function() {
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.userCardView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "pile left-panel album",initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    this._subModels = [];
    this.socialButtons = new window.classes.view.socialButtonsView({model: this.model});
    if (this.socialButtons.model) {
      return this._subModels.push(this.socialButtons.model)
    }
  },render: function() {
    this.template = _.template($("#userInfo-template").html());
    this.$el.html(this.template({model: this.model}));
    this.socialButtons.render();
    this.$(".js_socialButtons").html(this.socialButtons.el);
    return this
  },teardown: function() {
    var b;
    if ((b = this.socialButtons) != null) {
      b.teardown()
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.userInfoView = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.events = function() {
      return _.extend({}, window.classes.view.BaseInfo.prototype.events, {"click .js-play-track": "tryPlay"})
    };
    d.prototype.initialize = function(f) {
      this.model.on("reset", this.render, this);
      this.model.on("change:albumLikeCount change:artistLikeCount change:trackLikeCount change:wallMessagesCount change:totalPlaylistCount", this.render, this);
      return this._subModels = []
    };
    d.prototype.render = function() {
      this.template = _.template($("#profile-user-info-template").html());
      this.$el.html(this.template({model: this.model,section: this.options.section}));
      return this
    };
    d.prototype.tryPlay = function() {
      if (this.model.nowPlaying.track.isPlaying()) {
        window.player.pause();
        return
      }
      if (this.model.nowPlaying.track.get("syncLocalId") === window.player.get("current").get("syncLocalId")) {
        window.player.startPlay(window.player.get("current"));
        return
      }
      this.model.nowPlaying.track.collection = new window.classes.collection.tracksCollection([this.model.nowPlaying.track]);
      return window.player.tryPlay(this.model.nowPlaying.track)
    };
    d.prototype.teardown = function() {
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.view.BaseInfo);
  window.classes.view.ProfileInfo = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "notify-message cf follows",events: {"click .js-follow": "toggleFollow"},initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    return this._subModels = []
  },render: function() {
    this.template = _.template($("#user-row-template").html());
    this.$el.html(this.template({model: this.model}));
    return this
  },toggleFollow: function() {
    if (!window.models.currentUser.id) {
      new window.classes.view.noAuthModal;
      return
    }
    return this.model.toggleFollow()
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.syncManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.UserRow = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.events = {"click .js-like": "toggleLike","click .js-play": "playOrPause"};
    d.prototype.initialize = function() {
      this.model.on("reset", this.render, this);
      this.model.track.on("change", this.render, this);
      return this.template = _.template($("#ticket-like-template").html())
    };
    d.prototype.render = function() {
      this.$el.html(this.template({model: this.model}));
      return this
    };
    d.prototype.playOrPause = function() {
      if (this.model.isPlaying()) {
        window.player.pause();
        return
      }
      if (this.model.get("syncLocalId") === window.player.get("current").get("syncLocalId")) {
        window.player.startPlay(window.player.get("current"), window.player.engine.get("currentTime"), true);
        return
      }
      return window.player.tryPlay(this.model)
    };
    d.prototype.toggleLike = function() {
      return this.model.track.toggleLike()
    };
    return d
  })(Backbone.View);
  window.classes.view.TicketLikeView = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.initialize = function() {
      this.model.on("reset", this.render, this);
      this.model.on("destroy", this.remove, this);
      return this.template = _.template($("#ticket-online-template").html())
    };
    e.prototype.render = function() {
      this.$el.html(this.template({model: this.model}));
      return this
    };
    return e
  })(Backbone.View);
  window.classes.view.TicketOnlineView = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.tagName = "ul";
    e.prototype.className = "clear-margin-all clear-padding-all";
    e.prototype.id = "sectionMenu";
    e.prototype.events = {"click .item": "toggleCheck"};
    e.prototype.initialize = function() {
      return this.template = _.template($("#mix-section-menu-template").html())
    };
    e.prototype.render = function() {
      this.$el.html(this.template({type: this.options.type}));
      return this
    };
    e.prototype.toggleCheck = function(f) {
      this.$(".item").removeClass("check");
      return $(f.target).addClass("check")
    };
    return e
  })(Backbone.View);
  window.classes.view.SwitchMixView = c
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    return d
  })(window.classes.view.trackRowView);
  window.classes.view.PlaylistTrackRowView = a
}).call(this);
(function() {
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "track-line center-text-gm";
    d.prototype.events = {"click .js-action": "runAction",click: "stopPropagation"};
    d.prototype.initialize = function(f) {
      this.o = f;
      return this.action = f && f.action
    };
    d.prototype.render = function() {
      this.template = _.template($("#actionRow-template").html());
      this.$el.html(this.template({model: this.model}));
      this.$el.find(".link-show-more-e").addClass(this.o.type);
      return this
    };
    d.prototype.runAction = function(f) {
      f.stopPropagation();
      f.preventDefault();
      if (this.action) {
        return this.action()
      }
    };
    d.prototype.stopPropagation = function(f) {
      f.stopPropagation();
      return false
    };
    return d
  })(Backbone.View);
  window.classes.view.actionRowView = c
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "comment-large-mdl comment-large-new-mdl-m",events: {"keydown textarea": "tryToSubmitComment","click .add-track-icon": "addTrackToComment","mouseenter .add-track-icon": "makeFocusOut","focusout textarea": "saveMessage"},initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    this._subModels = [];
    return this.initTrackCollection()
  },render: function() {
    this.template = _.template($("#new-comment-large-template").html());
    this.$el.html(this.template({model: this.model}));
    this.$el.find("textarea").autogrow();
    this.commentTrackView.setElement(this.$(".js-track"));
    this.commentTrackView.render();
    this.initAddTrackPopup();
    return this
  },initTrackCollection: function() {
    var b = this;
    this.model.commentTrack = new window.classes.collection.tracksCollection;
    this.model.commentTrack.isSelectable = false;
    this.model.commentTrack.isEditable = true;
    this.commentTrackView = new window.classes.view.trackListView({collection: this.model.commentTrack});
    this.model.commentTrack.on("add", function() {
      b.model.isAddButton = "no";
      b.popup.hide();
      return b.render()
    });
    return this.model.commentTrack.on("remove", function() {
      b.model.isAddButton = "yes";
      return b.render()
    })
  },saveMessage: function(b) {
    return this.model.set("message", $.trim(this.$("textarea").val()))
  },makeFocusOut: function() {
    return this.$("textarea").focusout()
  },initAddTrackPopup: function() {
    if (!(this.tracklist != null)) {
      this.tracklist = new window.classes.view.trackSelectionPopupView({target: this.model.commentTrack})
    }
    if (!(typeof popup !== "undefined" && popup !== null)) {
      return this.popup = new window.tracksflow.h.popup({target: this.$(".add-track-icon"),content: this.tracklist.$el,"class": "is-white",mode: "click",preferredPositions: ["top", "top-left", "top-right"]})
    }
  },addTrackToComment: function(b) {
    var c = this;
    return this.tracklist.fillTracks().then(function() {
      return c.popup.posit()
    })
  },tryToSubmitComment: function(d) {
    var f, c, b;
    c = $.trim(this.$("textarea").val());
    if (!d.altKey && !d.ctrlKey && !d.shiftKey && (d.keyCode === 13) && c.length) {
      f = new window.classes.model.commentModel(window.classes.model.currentCommentModel.toJSON());
      f.user = window.models.currentUser;
      f.url = window.classes.model.currentCommentModel.url;
      f.set("message", c);
      f.set("track", this.model.commentTrack.at(0));
      if (f.get("isEdit")) {
        f.url = window.api_url_2 + "/comments/" + f.id;
        b = this.collection.get(f.id);
        b.set(f.toJSON())
      } else {
        this.collection.add(f)
      }
      f.save();
      this.model.commentTrack.reset();
      return window.classes.model.currentCommentModel.clear()
    }
  }});
  window.classes.view.newCommentLargeView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "",events: {"keydown textarea": "addComment","focus textarea": "checkAuth"},initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    return this._subModels = []
  },replyTo: function(b) {
    this.model.set("message", b);
    return this.renderAndFocus()
  },edit: function(b) {
    b.set("isEdit", true);
    this.model.set(b.toJSON());
    return this.renderAndFocus()
  },render: function() {
    this.template = _.template($("#new-comment-small-template").html());
    this.$el.html(this.template({model: this.model}));
    return this
  },renderAndFocus: function() {
    this.render();
    return this.$("textarea").focusEnd()
  },onBlur: function(b) {
    b.stopPropagation();
    return this.model.unset("message")
  },checkAuth: function(b) {
    if (!window.models.currentUser.id) {
      new window.classes.view.noAuthModal;
      return
    }
    return b.stopPropagation()
  },addComment: function(c) {
    var g, b, d, f = this;
    b = $.trim(this.$(".js-new-comment").val());
    if (!c.altKey && !c.ctrlKey && !c.shiftKey && (c.keyCode === 13) && b.length) {
      this.model.set("message", b);
      if (this.model.get("isEdit")) {
        g = this.collection.get(this.model.id);
        g.set(this.model.toJSON());
        g.user = window.models.currentUser;
        g.url = window.api_url_2 + "/comments/" + this.model.id
      } else {
        g = new window.classes.model.commentModel(this.model.toJSON());
        g.url = this.model.url;
        g.user = window.models.currentUser;
        if (!this.collection.view.showAll) {
          this.collection.view.showAllComments(null, true).then(function() {
            return f.collection.add(g)
          })
        } else {
          this.collection.add(g)
        }
      }
      d = this.model.id ? null : this.collection.params;
      g.save(null, null, null, d);
      this.resetModel();
      return this.render()
    }
  },resetModel: function() {
    var b;
    b = this.model.url;
    this.model = new window.classes.model.commentModel;
    return this.model.url = b
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.syncManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.newCommentSmall = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.key = {enter: 13,esc: 27};
    e.prototype.events = {click: "stopPropagation","click .delete-icon, .js-cancel": "close","click .js-ok": "ok",keyup: "onKeyup"};
    e.prototype.initialize = function(f) {
      this.options = _.extend({button: false}, f);
      return this.template = _.template($("#modal-base-template").html())
    };
    e.prototype.close = function() {
      return this.remove()
    };
    e.prototype.ok = function() {
      this.options.success && this.options.success();
      return this.remove()
    };
    e.prototype.onKeyup = function(f) {
      if (f.keyCode === this.key.esc) {
        this.close()
      }
      if (f.keyCode === this.key.enter) {
        return this.ok()
      }
    };
    e.prototype.stopPropagation = function(f) {
      return f.stopPropagation()
    };
    e.prototype.render = function() {
      this.$el.html(this.template(this.options));
      $(window).one("click", _.bind(function(f) {
        return this.close()
      }, this));
      this.$el.attr("tabindex", 0);
      return this
    };
    return e
  })(Backbone.View);
  window.classes.view.Modal = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.initialize = function() {
      $(window).off("click");
      this.template = _.template($("#modal-with-input-template").html());
      return this.options = _.extend({type: "green"}, this.options)
    };
    e.prototype.ok = function() {
      var f;
      f = this.$(".js-input").val();
      return this.options.success && this.options.success(f)
    };
    e.prototype.stopPropagation = function(f) {
      return f.stopPropagation()
    };
    return e
  })(window.classes.view.Modal);
  window.classes.view.ModalWithInput = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.events = {"click .delete-icon": "closePopup","click .js-log-in": "showLogIn","click .js-create-account": "initCreateAccount"};
    e.prototype.initialize = function() {
      this.template = _.template($("#no-auth-modal-template").html());
      return this.render()
    };
    e.prototype.render = function() {
      this.$el.html(this.template());
      return this.popup = new window.tracksflow.h.popup({content: this.$el,mode: "modal"})
    };
    e.prototype.showLogIn = function() {
      this.closePopup();
      return new window.classes.view.LogInModal
    };
    e.prototype.initCreateAccount = function() {
      this.closePopup();
      return new window.classes.view.CreateAccoutModal
    };
    e.prototype.closePopup = function() {
      this.popup.hide();
      return delete this.popup
    };
    return e
  })(Backbone.View);
  window.classes.view.noAuthModal = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.events = {"click .delete-icon": "closePopup","click .js-log-in": "logIn","keyup .js-password, .js-login": "checkIfLogIn","click .js-create-account": "initCreateAccount","click .js-forgot-password": "initForgotPassword"};
    e.prototype.initialize = function(f) {
      this.options = f;
      this.template = _.template($("#log-in-modal-template").html());
      return this.render()
    };
    e.prototype.render = function() {
      this.$el.html(this.template());
      return this.popup = new window.tracksflow.h.popup({content: this.$el,mode: "modal"})
    };
    e.prototype.logIn = function() {
      var h, f, g, k = this;
      f = $.trim(this.$(".js-login").val());
      g = md5($.trim(this.$(".js-password").val()));
      h = {success: function() {
        var l;
        if ((l = k.options) != null) {
          if (typeof l.success === "function") {
            l.success()
          }
        }
        return k.closePopup()
      },error: function() {
        var l;
        if ((l = k.options) != null) {
          if (typeof l.fail === "function") {
            l.fail()
          }
        }
        return k.showError()
      }};
      return window.models.currentUser.login(f, g, h)
    };
    e.prototype.checkIfLogIn = function(f) {
      f.keyCode === 13 && this.logIn();
      return true
    };
    e.prototype.showError = function() {
      this.$("input").addClass("is-error");
      return this.$(".js-error-text").show()
    };
    e.prototype.closePopup = function() {
      this.popup.hide();
      this.popup.removeIt();
      return delete this.popup
    };
    e.prototype.initForgotPassword = function() {
      this.closePopup();
      return new window.classes.view.ForgotPasswordModal
    };
    e.prototype.initCreateAccount = function() {
      this.closePopup();
      return new window.classes.view.CreateAccoutModal
    };
    return e
  })(Backbone.View);
  window.classes.view.LogInModal = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.events = {"click .js-change": "changePassword","keyup .js-password": "validatePassword","keyup .js-repeat-password": "validate"};
    d.prototype.PASSURL = window.api_url_2 + "/NewPassword";
    d.prototype.initialize = function(f) {
      var g = this;
      this.code = f;
      return $.ajax({url: this.PASSURL,type: "POST",data: {code: this.code.code,deviceType: "website"}}).then(function() {
        g.template = _.template($("#reset-password-modal-template").html());
        return g.render()
      }).fail(function() {
          window.utils.msg.html("" + (__("Код для смены пароля не верный или устарел.")));
          return window.router.navigate("/flow")
        })
    };
    d.prototype.render = function() {
      this.$el.html(this.template());
      return this.popup = new window.tracksflow.h.popup({content: this.$el,mode: "modal",type: "no-click"})
    };
    d.prototype.changePassword = function() {
      var g, f, h = this;
      if (!this.passwordError) {
        f = md5(this.password);
        g = {code: this.code.code,password: f,deviceType: "website"};
        return $.ajax({url: this.PASSURL,type: "POST",data: g}).then(function() {
          window.utils.msg.notify("" + (__("Пароль успешно сменен.")));
          h.closePopup();
          return window.models.currentUser.fetch({success: function(k) {
            window.views.sidebar.render();
            window.player.trigger("change:current");
            window.models.currentUser.createTicker();
            return window.router.navigate("/flow", {trigger: true})
          }})
        }).fail(function() {
            return window.utils.msg.error("" + (__("Произошла ошибка при смене пароля.")))
          })
      }
    };
    d.prototype.validatePassword = function(g) {
      var f;
      if (g.keyCode === 13) {
        this.changePassword();
        return
      }
      this.password = $.trim(this.$(".js-password").val());
      f = this.$(".js-err-password");
      if (!(this.password.length > 3 && /^\w+$/.test(this.password))) {
        this.showError(f);
        return this.passwordError = true
      } else {
        this.hideError(f);
        return this.passwordError = false
      }
    };
    d.prototype.validate = function(g) {
      var f;
      if (g.keyCode === 13) {
        this.changePassword();
        return
      }
      this.password = $.trim(this.$(".js-password").val());
      this.repassword = $.trim(this.$(".js-repeat-password").val());
      f = this.$(".js-err-text");
      if (!(this.password === this.repassword)) {
        return this.showError(f)
      } else {
        return this.hideError(f)
      }
    };
    d.prototype.showError = function(f) {
      return f.show()
    };
    d.prototype.hideError = function(f) {
      return f.hide()
    };
    d.prototype.closePopup = function() {
      this.popup.hide();
      return this.popup.removeIt()
    };
    return d
  })(Backbone.View);
  window.classes.view.ResetPasswordModal = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.events = {"click .delete-icon": "closePopup","click .js-log-in": "showLogIn","click .js-create-account": "send","keyup .js-password": "validatePassword","keyup .js-email": "validateEmail","keyup .js-user-name": "validateName","keyup .js-email, .js-user-name, .js-password": "submit"};
    d.prototype.initialize = function(f) {
      this.options = f;
      this.template = _.template($("#create-account-modal-template").html());
      this.emailError = this.nameError = this.passwordError = true;
      return this.render()
    };
    d.prototype.render = function() {
      this.$el.html(this.template());
      return this.popup = new window.tracksflow.h.popup({content: this.$el,mode: "modal"})
    };
    d.prototype.showLogIn = function() {
      this.closePopup();
      return new window.classes.view.LogInModal
    };
    d.prototype.send = function() {
      return !this.emailError && !this.nameError && !this.passwordError && this.sendToServer()
    };
    d.prototype.submit = function(f) {
      if (f.keyCode === 13) {
        return this.send()
      }
    };
    d.prototype.sendToServer = function() {
      var f, g, h = this;
      g = {devicetype: "website",login: this.userName,email: this.email,password: md5(this.password)};
      f = {success: function() {
        var k;
        if ((k = h.options) != null) {
          if (typeof k.success === "function") {
            k.success()
          }
        }
        h.closePopup();
        return h.renderCurrentPage()
      },error: function(n) {
        var l, k, m;
        if ((m = h.options) != null) {
          if (typeof m.fail === "function") {
            m.fail()
          }
        }
        l = {$input: h.$(".js-email"),$text: h.$(".js-err-email")};
        k = {$input: h.$(".js-user-name"),$text: h.$(".js-err-name")};
        if (!n.emailValid) {
          h.showNotValidbase(l)
        } else {
          h.hideNotValidbase(l)
        }
        if (!n.loginValid) {
          return h.showNotValidbase(k)
        } else {
          return h.hideNotValidbase(k)
        }
      }};
      return window.models.currentUser.register(g, f)
    };
    d.prototype.renderCurrentPage = function() {
      window.router._nextView = window.router._currentView;
      return window.router.startView()
    };
    d.prototype.validateEmail = function() {
      this.email = $.trim(this.$(".js-email").val());
      return this.baseValidation({test: !(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(this.email)),$input: this.$(".js-email"),$text: this.$(".js-err-correct-email"),varName: "emailError"})
    };
    d.prototype.validateName = function() {
      this.userName = $.trim(this.$(".js-user-name").val());
      return this.baseValidation({test: !(/^[a-z0-9]+$/.test(this.userName)),$input: this.$(".js-user-name"),$text: this.$(".js-err-correct-name"),varName: "nameError"})
    };
    d.prototype.validatePassword = function() {
      this.password = $.trim(this.$(".js-password").val());
      return this.baseValidation({test: !(this.password.length > 3 && /^\w+$/.test(this.password)),$input: this.$(".js-password"),$text: this.$(".js-err-password"),varName: "passwordError"})
    };
    d.prototype.baseValidation = function(f) {
      if (f.test) {
        return this.showBaseError(f)
      } else {
        return this.hideBaseError(f)
      }
    };
    d.prototype.showBaseError = function(f) {
      f.$input.addClass("is-error");
      f.$text.show();
      return this[f.varName] = true
    };
    d.prototype.hideBaseError = function(f) {
      f.$input.removeClass("is-error");
      f.$text.hide();
      return this[f.varName] = false
    };
    d.prototype.showNotValidbase = function(f) {
      f.$text.show();
      return f.$input.addClass("is-error")
    };
    d.prototype.hideNotValidbase = function(f) {
      f.$text.hide();
      return f.$input.removeClass("is-error")
    };
    d.prototype.closePopup = function() {
      this.popup.hide();
      this.popup.removeIt();
      return delete this.popup
    };
    return d
  })(Backbone.View);
  window.classes.view.CreateAccoutModal = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.events = {"click .delete-icon": "closePopup","click .js-send-email": "sendEmail","keyup .js-email-input": "trySendEmail"};
    e.prototype.initialize = function() {
      this.template = _.template($("#forgot-password-modal-template").html());
      return this.render()
    };
    e.prototype.render = function() {
      this.$el.html(this.template());
      return this.popup = new window.tracksflow.h.popup({content: this.$el,mode: "modal"})
    };
    e.prototype.showLogIn = function() {
      this.closePopup();
      return new window.classes.view.logInModal
    };
    e.prototype.sendEmail = function() {
      this.email = $.trim(this.$(".js-email-input").val());
      if (this.email.length && !this.isNotAllowSend) {
        return this.sendToServer()
      }
    };
    e.prototype.trySendEmail = function(f) {
      return f.keyCode === 13 && this.sendEmail()
    };
    e.prototype.sendToServer = function() {
      var f = this;
      return $.ajax({url: window.api_url_2 + "/newpassword",type: "GET",data: {email: this.email},success: function(g) {
        f.hideError();
        f.$(".js-email-was-send").show();
        f.$(".js-send-email").addClass("is-inactive");
        return f.isNotAllowSend = true
      },error: function(g) {
        console.error("err");
        console.error(g);
        return f.showError()
      }})
    };
    e.prototype.showError = function() {
      return this.$(".js-error").show()
    };
    e.prototype.hideError = function() {
      return this.$(".js-error").hide()
    };
    e.prototype.closePopup = function() {
      return this.popup.hide()
    };
    return e
  })(Backbone.View);
  window.classes.view.ForgotPasswordModal = c
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "new-post-add-popup-mdl container-l is-modal",MAX_SIZE: 400,events: {"keyup .js-search-input": "queryEdited","mousewheel .js_elements": "stopPropagationWheel"},initialize: function(b) {
    this._subModels = [];
    this.template = _.template($("#contentSelectionPopup-template").html());
    this.type = b && b.type;
    return this.defaultFetchParams = b && b.defaultFetchParams
  },queryEdited: function() {
    var b;
    b = this.$(".js-search-input").val();
    return this.fillData(b)
  },fillData: function(c) {
    var b;
    if (c) {
      if (this.jqxhr) {
        this.jqxhr.abort()
      }
      b = new window.classes.model.searchModel({query: c});
      return this.jqxhr = b.fetch({data: {pageSize: 30,section: this.type + "s"},success: _.bind(function(d) {
        this.collection.reset(b[this.type + "s"].models);
        _.each(this.collection.models, function(e) {
          return e.collection = this.collection
        }, this);
        return this.renderItems()
      }, this)})
    } else {
      return this.collection.fetch({data: this.defaultFetchParams,success: _.bind(function() {
        return this.renderItems()
      }, this)})
    }
  },render: function() {
    this.$el.html(this.template);
    this.renderItems();
    return this
  },renderItems: function() {
    this.$(".js_elements").empty();
    this.$(".js_elements").css("max-height", $(window).height() / 2);
    this.$(".js_elements").css("overflow-y", "auto");
    console.log(this.collection);
    if (this.collection) {
      return this.collection.each(this.renderOne, this)
    }
  },renderOne: function(b) {
    var c;
    c = new window.classes.view.contentRowView({model: b});
    c.render();
    return this.$(".js_elements").append(c.el)
  },stopPropagationWheel: function(c, f) {
    var b;
    b = this.$(".js_elements");
    if (f > 0 && b.scrollTop() === 0) {
      return c.preventDefault()
    } else {
      if (f < 0 && (b.scrollTop() === b.get(0).scrollHeight - b.innerHeight())) {
        return c.preventDefault()
      }
    }
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.eventManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.contentSelectionPopupView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "new-post-add-popup-mdl container-l is-modal",MAX_SIZE: 400,events: {"click .js-menu li": "showSource","keyup .js-search": "searchTracks","mousewheel .js-container-lazy": "stopPropagationWheel"},initialize: function(b) {
    this._subModels = [];
    this.template = _.template($("#trackSelectionPopup-template").html());
    this.type = b && b.type || "likes";
    this.target = b && b.target;
    this.$elementToShowOn = b && b.$elementToShowOn;
    this.pageSize = 20;
    this.tracks = new window.classes.collection.tracksCollection([], {target: this.target});
    return this.tracks.isSelectable = true
  },fillTracks: function() {
    var d, c, b;
    d = new $.Deferred;
    this.search = new window.classes.model.searchModel({query: typeof options !== "undefined" && options !== null ? options.id : void 0});
    switch (this.type) {
      case "history":
        this.tracks.reset(window.resources.storage.get("tracksHistory"));
        this.render();
        if ((c = this.$el.data().popup) != null) {
          c.posit()
        }
        break;
      case "likes":
        this.likeCollection = new window.classes.collection.LikeList();
        this.likeCollection.pageNum = 1;
        this.likeCollection.fetch({data: {pageSize: 20,type: "tracks"},success: _.bind(function(f) {
          var e;
          this.tracks.reset(_.map(f.models, function(g) {
            return g.track
          }));
          this.render();
          d.resolve();
          return (e = this.$el.data().popup) != null ? e.posit() : void 0
        }, this)});
        break;
      case "search":
        this.tracks.reset([]);
        this.render();
        if ((b = this.$el.data().popup) != null) {
          b.posit({current: true})
        }
    }
    return d.promise()
  },searchTracks: function() {
    switch (this.type) {
      case "history":
      case "likes":
        this.tracks.setFilter(this.$(".js-search").val());
        return this.renderTracks();
      case "search":
        return this.tracks.fetch({data: {"for": this.$(".js-search").val(),"in": "search",pageNum: 0,pageSize: 30},success: _.bind(function(c) {
          var b;
          this.renderTracks();
          return (b = this.$el.data().popup) != null ? b.posit() : void 0
        }, this)})
    }
  },showSource: function(b) {
    this.type = this.$(b.target).data("type");
    this.$(".js-search").val("");
    this.$("li").removeClass("is-check");
    this.$("li[data-type=" + this.type + "]").addClass("is-check");
    return this.fillTracks()
  },renderTracks: function() {
    this.$(".js_elements").empty();
    return this.tracks && this.tracks.each(this.renderOne, this)
  },render: function() {
    this.$el.html(this.template({model: this.model}));
    this.$("li[data-type=" + this.type + "]").addClass("is-check");
    this.$(".js_elements").empty();
    this.renderTracks();
    this.lazy = new window.classes.controller.lazyLoadController(this.$(".js-container-lazy"), this.$(".js_elements"), this.likeCollection, 30, false);
    this.lazy.bindScroll();
    return this
  },renderOne: function(c) {
    var b;
    if (c.get("hiddenByFilter") !== true) {
      b = new window.classes.view.trackRowView({model: c});
      b.render();
      this.$el.find(".js_elements").append(b.el);
      return this._subModels.push(c)
    }
  },stopPropagationWheel: function(c, f) {
    var b;
    b = this.$(".js-container-lazy");
    if (f > 0 && b.scrollTop() === 0) {
      return c.preventDefault()
    } else {
      if (f < 0 && (b.scrollTop() === b.get(0).scrollHeight - b.innerHeight())) {
        return c.preventDefault()
      }
    }
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.eventManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.trackSelectionPopupView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "flow-post-section-l new-post-mdl cf",events: {"click .js-publish": "publishPost","click .js-delete-content": "deleteContent","click .js-add-video": "addVideo","click .js-add-track": "addTrack","click .js-add-artist": "addArtist","click .js-add-album": "addAlbum","click .js-add-playlist": "addPlaylist","blur  .js-message": "saveMessage"},initialize: function(b) {
    this.contentWidth = 512;
    this.initModel();
    return this
  },initModel: function() {
    this.model = new window.classes.model.postModel({autoSave: true});
    this.newPostTracks = new window.classes.view.trackListView({collection: this.model.tracks});
    this.model.on("change", this.render, this);
    this.model.on("saving", _.bind(function() {
      return this.$(".js-publish").toggleClass("is-inactive", this.model.canPublish() === this.$("js-publish").hasClass("is-inactive"))
    }, this));
    return this.model.fillNewPostData()
  },deinitModel: function() {
    this.model.off("change");
    return this.model.off("saving")
  },deleteContent: function(b) {
    return this.model.deleteContent(_.bind(function() {
      return this.render()
    }, this))
  },addTrack: function(c) {
    var b;
    b = new window.classes.view.trackSelectionPopupView({target: _.bind(this.trackAdded, this)});
    b.fillTracks();
    if (!(this.popup != null)) {
      return this.popup = new window.tracksflow.h.popup({target: this.$(".js-add-track"),content: b.$el,"class": "is-white",mode: "click",type: "show-now",preferredPositions: ["bottom", "left", "right"]})
    }
  },addPlaylist: function(b) {
    var c;
    c = new window.classes.collection.playlistsCollection();
    return this.addContentItem("playlist", {"in": "users"}, this.$(".js-add-playlist"), c)
  },addAlbum: function(b) {
    var c;
    c = new window.classes.collection.releasesCollection();
    return this.addContentItem("album", {"in": "likes"}, this.$(".js-add-album"), c)
  },addArtist: function(b) {
    var c;
    c = new window.classes.collection.artistsCollection();
    return this.addContentItem("artist", {"in": "likes"}, this.$(".js-add-artist"), c)
  },addVideo: function(c) {
    var b;
    b = new window.classes.view.addVideoView({target: _.bind(this.itemAdded, this)});
    b.render();
    if (this.popup) {
      this.popup.removeIt()
    }
    this.popup = new window.tracksflow.h.popup({target: this.$(".js-add-video"),content: b.$el,"class": "is-white",preferredPositions: ["bottom", "left", "right"]});
    return this.popup.listenToClick()
  },addContentItem: function(d, c, e, f) {
    var b;
    b = new window.classes.view.contentSelectionPopupView();
    b.type = d;
    b.defaultFetchParams = c;
    f.isSelectable = true;
    f.target = _.bind(this.itemAdded, this);
    b.collection = f;
    b.render();
    b.fillData();
    if (this.popup) {
      this.popup.removeIt()
    }
    this.popup = new window.tracksflow.h.popup({target: e,content: b.$el,"class": "is-white",preferredPositions: ["bottom", "left", "right"]});
    return this.popup.listenToClick()
  },itemAdded: function(b) {
    this.model.content = b;
    this.model.save();
    this.popup.removeIt();
    return this.removePopup()
  },trackAdded: function(b) {
    this.model.tracks.add(b.toJSON());
    this.model.save();
    return this.removePopup()
  },publishPost: function(b) {
    if (this.model.canPublish()) {
      this.model.set({isHidden: false}, {silent: true});
      this.deinitModel();
      return this.model.save([], null, {success: _.bind(function() {
        this.collection.fetch();
        return this.initModel()
      }, this)})
    }
  },saveMessage: function() {
    this.model.set({message: this.$textarea.val()}, {silent: true});
    return this.model.save()
  },render: function() {
    var b = this;
    this.template = _.template($("#addPost-template").html());
    this.$el.html(this.template({model: this.model}));
    this.$(".js-publish").toggleClass("is-inactive", this.model.canPublish() === this.$("js-publish").hasClass("is-inactive"));
    if (this.newPostTracks.collection.length) {
      this.newPostTracks.setElement(this.$(".js-new-tracks").addClass(this.newPostTracks.className));
      this.newPostTracks.render()
    }
    if (this.model.content && this.model.content instanceof window.classes.model.embedVideoModel) {
      this.addVideoCover()
    } else {
      if (this.model.content) {
        this.addContentCover("superlarge", this.model.content);
        if (this.model.content instanceof window.classes.model.artistModel) {
          this.$(".js-artist-name-cover").show()
        }
      } else {
        if (this.model.has("images")) {
          this.addContentCover("large", this.model)
        } else {
          this.showAddContentButtons()
        }
      }
    }
    _.defer(function() {
      return b.initImageLoader()
    });
    this.$textarea = this.$(".js-message");
    this.$textarea.autogrow();
    this.forceRecalcStyles();
    return this
  },forceRecalcStyles: function() {
    var b;
    b = $(".track-line").first().find(".js-heart-icon");
    b.trigger("mouseenter");
    return b.trigger("mouseleave")
  },initImageLoader: function() {
    var b;
    if (this.uploader) {
      this.uploader.destroy()
    }
    this.uploader = new plupload.Uploader({runtimes: "html5,flash",file_data_name: "image",browse_button: "js-add-image-button",drop_element: "js-add-image-button",max_file_size: "2048kb",url: window.api_url_2 + "/files?for=" + this.model.id + "&in=flow",flash_swf_url: "/js/lib/plupload/plupload.flash.swf",filters: [{title: "Image files",extensions: "jpeg,jpg,gif,png"}]});
    this.uploader.init();
    b = this;
    this.uploader.bind("FilesAdded", function(c) {
      window.utils.msg.notify(__("Изоображение загружается..."));
      return b.uploader.start()
    });
    this.uploader.bind("Error", function(c, d) {
      return window.utils.msg.warn(__("Не удалось загрузить изображение"))
    });
    return this.uploader.bind("FileUploaded", function(d, f, e) {
      var c, g;
      if (true) {
        c = JSON.parse(e.response);
        if ((g = b.model) != null) {
          g.set("images", c)
        }
        return window.utils.msg.notify(__("Изображение загружено"))
      } else {
        window.utils.msg.warn(__("Не удалось загрузить изображение"));
        return console.log("Error", e.status, e.response)
      }
    })
  },showAddContentButtons: function() {
    return this.$(".js-add-content-buttons").show()
  },addVideoCover: function() {
    var c, g, h, f, k, b, e, d;
    h = this.$(".js-content-place");
    k = this.model.content.get("thumbnailWidth");
    f = this.model.content.get("thumbnailHeight");
    e = this.model.content.get("width");
    b = this.model.content.get("height");
    d = b * this.contentWidth / e;
    h.css("width", this.contentWidth);
    h.css("height", d);
    h.css("background", "transparent url('" + this.model.content.get("thumbnailUrl") + "') no-repeat center center");
    g = this.contentWidth;
    c = d;
    if (e / b > k / f) {
      g = this.contentWidth;
      c = f * this.contentWidth / k
    }
    if (e / b < k / f) {
      g = k * d / f;
      c = d
    }
    return h.css("background-size", g + "px " + c + "px")
  },addContentCover: function(d, c) {
    var b;
    b = c.getImage(d) || c.getImage("large") || c.getImage("medium");
    if (this.model.getContentType() === "artist") {
      return this.$(".js-content-place").css({"background-image": "url(" + b + ")","min-height": 48 * window.tracksflow.h.gSize})
    } else {
      return this.$(".js-content-place").append($('<img src="' + b + '"/>'))
    }
  },removePopup: function() {
    var b;
    if ((b = this.popup) != null) {
      b.removeIt()
    }
    return delete this.popup
  },teardown: function() {
    if (this.uploader) {
      this.uploader.destroy()
    }
    this.removePopup();
    this.off();
    this.undelegateEvents();
    this.remove();
    return this
  }});
  window.classes.view.addPostView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({events: {"click .js-add-item": "addItem","click .delete-track-icon": "deleteItem"},POPUP_DELAY: 400,initialize: function(b) {
    this.model && this.model.on("reset", this.render, this);
    this.model && this.model.on("change", this.render, this);
    return this._subModels = []
  },className: function() {
    var b;
    if (((b = this.model.collection) != null ? b.isSelectable : void 0) === true) {
      return "add-line-mdl track-like-line-l"
    } else {
      return "add-line-mdl track-like-line-l"
    }
  },render: function() {
    this.template = _.template($("#contentRow-template").html());
    this.$el.html(this.template({model: this.model}));
    return this
  },addItem: function() {
    if (this.model.collection.target instanceof Backbone.Collection) {
      this.model.collection.target.add(this.model.toJSON())
    }
    if (this.model.collection.target instanceof Backbone.Model) {
      this.model.collection.target.set(this.model.toJSON())
    }
    if (_.isFunction(this.model.collection.target)) {
      return this.model.collection.target(this.model)
    }
  },deleteItem: function() {
    return this.model.collection.remove(this.model)
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.syncManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.contentRowView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({ENTER_CODE: 13,className: "new-post-add-popup-mdl container-l is-modal",events: {"keyup .js-video-link": "onLinkAdded","click .js-ok": "onLinkAddedClick"},initialize: function(b) {
    this._subModels = [];
    this.template = _.template($("#addVideo-template").html());
    return this.target = b && b.target
  },onLinkAdded: function(b) {
    if (b.keyCode === this.ENTER_CODE) {
      return this.validateAndSend($.trim(this.$(".js-video-link").val()))
    }
  },onLinkAddedClick: function() {
    return this.validateAndSend($.trim(this.$(".js-video-link").val()))
  },validateAndSend: function(c) {
    var b;
    if (c.length) {
      b = new window.classes.model.embedVideoModel();
      b.set("link", c);
      return this.target(b)
    } else {
      return window.utils.msg.warn(__("Пожалуйста, введите адрес"))
    }
  },render: function() {
    this.$el.html(this.template);
    return this
  },teardown: function() {
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.addVideoView = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.key = {enter: 13,esc: 27};
    d.prototype.className = "new-post-add-popup-mdl container-l is-modal";
    d.prototype.events = {"click .js-ok": "ok","keyup .js-input": "onKeyup"};
    d.prototype.onKeyup = function(f) {
      if (f.keyCode === this.key.esc) {
        this.close()
      }
      if (f.keyCode === this.key.enter) {
        return this.ok()
      }
    };
    d.prototype.initialize = function(f) {
      this._subModels = [];
      this.template = _.template($("#popup-input-template").html());
      return this.target = f && f.target
    };
    d.prototype.ok = function() {
      var f;
      f = this.$(".js-input").val();
      this.options.success && this.options.success(f);
      return this.remove()
    };
    d.prototype.close = function() {
      return this.$el.data().popup.hide()
    };
    d.prototype.render = function() {
      this.$el.html(this.template({btnText: __("Создать"),placeholderText: __("Название плейлиста")}));
      return this
    };
    d.prototype.teardown = function() {
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(Backbone.View);
  window.classes.view.PopupInput = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.events = {"click .js-play": "OnClickPlay","click .js-share": "OnClickShare","click .js-plus": "OnClickPlus"};
    e.prototype.className = function() {
      var f;
      f = "flat-card-t flat-card-type-large-gm is-in-post";
      switch (this.model.contentType) {
        case "album":
          f = f + " flat-card-type-album-gm";
          break;
        case "artist":
          f = f + " flat-card-type-artist-gm"
      }
      return f
    };
    e.prototype.render = function() {
      this.template = _.template($("#postCard-template").html());
      return this.$el.html(this.template({model: this.model}))
    };
    return e
  })(window.classes.view.CommonCard);
  window.classes.view.postCard = c
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({events: {"keyup textarea": "refreshCount","paste textarea": "refreshCount"},initialize: function() {
    return this.template = _.template($("#textarea-with-counter-template").html())
  },render: function(b) {
    if (b) {
      this.options = b
    }
    this.$el.html(this.template({text: this.options.text,addClass: this.options.addClass || ""}));
    return this.refreshCount()
  },refreshCount: function(c) {
    var b, d = this;
    b = this.$("textarea");
    return setTimeout(function() {
      var e;
      e = d.calcCount();
      if (e < 0) {
        if (!d.options.countChar) {
          b.val(b.val().slice(0, d.options.maxCount));
          e = 0
        } else {
          b.val(b.val().slice(0, b.val().lastIndexOf(",")))
        }
      }
      return b.parent().attr("data-after", e).css({outline: "0"})
    }, 30)
  },calcCount: function() {
    var c, b;
    if (this.options.countChar != null) {
      b = this.$("textarea").val().split(",");
      b = _.map(b, function(d) {
        if ($.trim(d) !== "") {
          return $.trim(d)
        }
      });
      b = _.without(b, void 0);
      b = _.uniq(b);
      this.$("textarea").data({tags: b});
      c = b.length
    } else {
      c = this.$("textarea").val().length
    }
    return this.options.maxCount - c
  },teardown: function() {
    this.off();
    return this.undelegateEvents()
  }});
  window.classes.view.TextareaWithCounterView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "image-loader-t",events: {"click .js-image-loader-delete-image": "deleteImage"},initialize: function(b) {
    if (b) {
      this.initOptions = b
    }
    return this.template = _.template($("#image-loader-template").html())
  },render: function() {
    var b = this;
    this.$el.html(this.template({img: this.model.getImage("small") || ""}));
    setTimeout(function() {
      return b.prepareUploader()
    }, 1);
    return this
  },prepareUploader: function() {
    var b;
    this.uploader = new plupload.Uploader({runtimes: "html5,flash",file_data_name: "image",browse_button: this.initOptions.targetElement || "js-user-ava-upload",drop_element: this.initOptions.targetElement || "js-user-ava-upload",max_file_size: "2048kb",url: this.initOptions.apiPath,flash_swf_url: "/js/lib/plupload/plupload.flash.swf",filters: [{title: "Image files",extensions: "jpeg,jpg,gif,png"}]});
    this.uploader.init();
    b = this;
    this.uploader.bind("FilesAdded", function(c) {
      return b.uploader.start()
    });
    this.uploader.bind("Error", function(c, d) {
      window.utils.msg.warn(__("Не удалось загрузить аватар"));
      return console.error("Error", d.code, d.message)
    });
    return this.uploader.bind("FileUploaded", function(d, f, e) {
      var c, g;
      if (true) {
        c = JSON.parse(e.response);
        if ((g = b.model) != null) {
          g.set("images", c)
        }
        return window.utils.msg.notify(__("Изображение загружено"))
      } else {
        window.utils.msg.warn(__("Не удалось загрузить изображение"));
        return console.error("Error", e.status, e.response)
      }
    })
  },deleteImage: function() {
    var b;
    return (b = this.model) != null ? b.unset("images") : void 0
  },teardown: function() {
    return this.uploader.destroy()
  }});
  window.classes.view.ImageLoaderView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({arrange: function(d, c) {
    var b;
    b = this.collection.at(d - 1);
    this.collection.remove(b);
    this.collection.add(b, {at: c});
    return this.collection.trigger("arrange", b, c)
  },bindSortable: function() {
    var c, d, b;
    b = this;
    c = {};
    d = {sortableTable: this.$(".js_elements"),sortHolder: ".sort-track-icon"};
    return d.sortableTable.sortable({axis: "y",delay: 200,cursor: "move",handle: d.sortHolder,start: function(e, f) {
      c = $(f.item);
      c.addClass("sort");
      c.css("left", c.parent().position().left);
      if ($.browser.webkit) {
        return b.wscrolltop = $(window).scrollTop()
      }
    },sort: function(g, f) {
      if ($.browser.webkit) {
        return f.helper.css({top: f.position.top + b.wscrolltop + "px"})
      }
    },stop: function(g, f) {
      return $(f.item).removeClass("sort")
    },update: function(f, g) {
      var e;
      e = $(g.item).find("#num").text() || $(g.item).find(".num-play-button-b .text-be").text();
      return b.arrange(e, $(g.item).prevAll().length)
    }})
  },initActionRow: function(b) {
    if (b && b.actionRowView) {
      this.actionRowView = b.actionRowView;
      if (this.actionRowView.model) {
        return this.actionRowView.model.collection = this.collection
      }
    }
  },renderActionRow: function(b) {
    if (this.actionRowView) {
      this.actionRowView.render();
      return b.append(this.actionRowView.el)
    }
  }});
  window.classes.view.baseTrackListView = a
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.showAll = true;
    d.prototype.initialize = function() {
      this.collection && this.collection.on("reset", this.render, this);
      this.collection && this.collection.on("change", this.render, this);
      this.collection && this.collection.on("add", this.renderOne, this);
      this._subViews = [];
      this._subModels = [];
      return this
    };
    d.prototype.render = function(g) {
      var h, f;
      if (!this.collection) {
        return this
      }
      this.$el.empty();
      if (this.showAll) {
        this.collection.each(this.renderOne, this)
      } else {
        h = this.collection.models.slice(0, 5);
        f = this;
        _.each(h, function(k) {
          return f.renderOne(k)
        })
      }
      this.$("img").fadeInAll();
      return this
    };
    return d
  })(Backbone.View);
  window.classes.view.CardListBase = b
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({initialize: function(b) {
    this.collection && this.collection.on("reset", this.render, this);
    this.collection && this.collection.on("change", this.render, this);
    this.collection && this.collection.on("remove", this.render, this);
    this.collection && this.collection.on("add", this.render, this);
    this._subModels = [];
    return this.template = _.template($("#userWithLink-template").html())
  },render: function() {
    var b = this;
    return this.collection.each(function(c) {
      return b.$el.append(b.renderOne(c))
    })
  },renderOne: function(b) {
    return this.template({model: b})
  },teardown: function() {
  }});
  window.classes.view.usersWithLink = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "";
    d.prototype.renderOne = function(g) {
      var f;
      if (g.artist) {
        g = g.artist
      }
      f = new window.classes.view.artistCardView({model: g});
      this._subViews.push(f);
      this._subModels.push(g);
      return this.$el.append(f.render().el)
    };
    d.prototype.teardown = function() {
      var g, k, f, h;
      h = this._subViews;
      for (k = 0, f = h.length; k < f; k++) {
        g = h[k];
        g.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.view.CardListBase);
  window.classes.view.artistCardsView = c
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "",events: {"click .js-show-all": "showAllComments"},initialize: function(b) {
    this.collection && this.collection.on("reset", this.render, this);
    this.collection && this.collection.on("change", this.render, this);
    this.collection && this.collection.on("remove", this.render, this);
    this.collection && this.collection.on("add", this.render, this);
    this._subViews = [];
    this._subModels = [];
    this.collection.commentFormModel = new window.classes.model.commentModel;
    this.collection.commentFormModel.url = b.url;
    this.collection.commentFormView = new window.classes.view.newCommentSmall({model: this.collection.commentFormModel});
    this.collection.view = this;
    return this.collection.commentFormView.collection = this.collection
  },render: function() {
    var b;
    this.template = _.template($("#comments-template").html());
    this.$el.html(this.template({collection: this.collection,showAll: this.showAll}));
    if (this.showAll) {
      this.collection.each(this.renderOne, this)
    } else {
      b = this.collection.models.slice(0, 3);
      _.each(b, _.bind(this.renderOne, this))
    }
    this.collection.commentFormView.setElement(this.$(".js-comment-form"));
    this.collection.commentFormView.render();
    return this.collection.commentFormView.$("textarea").autogrow()
  },renderOne: function(b) {
    var c;
    c = new window.classes.view.commentView({model: b});
    c.render();
    this.$(".js-commets-list").append(c.$el);
    return this._subViews.push(c)
  },showAllComments: function(d, b) {
    var c, f = this;
    if (d != null) {
      d.stopPropagation()
    }
    c = new $.Deferred;
    this.showAll = true;
    if (b) {
      this.collection.fetch().then(function() {
        return c.resolve()
      })
    } else {
      this.render();
      c.resolve()
    }
    return c.promise()
  },teardown: function() {
    var c, e, b, d;
    d = this._subViews;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      c.teardown()
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.commentsView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "",initialize: function(b) {
    this.collection && this.collection.on("reset", this.render, this);
    this.collection && this.collection.on("change", this.render, this);
    this.collection && this.collection.on("remove", this.render, this);
    this.collection && this.collection.on("add", this.render, this);
    this._subViews = [];
    this.template = _.template($("#comments-large-template").html());
    if (window.models.currentUser.id) {
      window.classes.model.currentCommentModel = new window.classes.model.commentModel;
      window.classes.view.currentCommentview = new window.classes.view.newCommentLargeView({model: window.classes.model.currentCommentModel,collection: this.collection});
      window.classes.model.currentCommentModel.url = "" + window.api_url_2 + "/comments?" + b.url;
      return this.newComment = window.classes.view.currentCommentview
    }
  },render: function() {
    var c, b, d = this;
    this.$el.html(this.template({collection: this.collection}));
    this.collection.each(function(e) {
      return d.renderOne(e)
    });
    if ((c = this.newComment) != null) {
      c.setElement(this.$(".js-new-comment"))
    }
    if ((b = this.newComment) != null) {
      b.render()
    }
    return this
  },renderOne: function(c) {
    var b;
    b = new window.classes.view.commentLargeView({model: c});
    b.render();
    return this.$(".js-comments").append(b.$el)
  },teardown: function() {
    var c, e, b, d;
    d = this._subViews;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      c.teardown()
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.commentsLargeView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "",initialize: function() {
    this.collection && this.collection.on("reset", this.render, this);
    this.collection && this.collection.on("change", this.render, this);
    this._subViews = [];
    return this._subModels = []
  },render: function() {
    this.template = _.template($("#playlists-template").html());
    this.$el.html(this.template());
    this.$(".js_elements").empty();
    if (this.collection) {
      this.collection.each(this.renderOne, this)
    }
    this.$("img").fadeInAll();
    return this
  },renderOne: function(c) {
    var d, b;
    b = this;
    d = new window.classes.view.playlistCardView({model: c});
    this._subViews.push(d);
    d.render();
    this._subModels.push(c);
    return this.$el.append(d.el)
  },teardown: function() {
    var c, e, b, d;
    d = this._subViews;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      c.teardown()
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.playlistsView = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "";
    e.prototype.renderOne = function(h) {
      var g, f;
      f = this;
      g = new window.classes.view.playlistCardView({model: h});
      this._subViews.push(g);
      this._subModels.push(h);
      g.render();
      return this.$el.append(g.el)
    };
    e.prototype.teardown = function() {
      var g, k, f, h;
      h = this._subViews;
      for (k = 0, f = h.length; k < f; k++) {
        g = h[k];
        g.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return e
  })(window.classes.view.CardListBase);
  window.classes.view.PlaylistCardList = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "";
    e.prototype.initialize = function() {
      this.collection && this.collection.on("reset", this.render, this);
      this.collection && this.collection.on("change", this.render, this);
      this._subViews = [];
      return this._subModels = []
    };
    e.prototype.renderOne = function(g) {
      var f;
      if (g.album) {
        g = g.album
      }
      f = new window.classes.view.albumCardView({model: g});
      this._subViews.push(f);
      this._subModels.push(g);
      return this.$el.append(f.render().el)
    };
    e.prototype.teardown = function() {
      var g, k, f, h;
      h = this._subViews;
      for (k = 0, f = h.length; k < f; k++) {
        g = h[k];
        g.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return e
  })(window.classes.view.CardListBase);
  window.classes.view.releaseCardsView = c
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "tags",events: {"keyup .js-edit-tags": "onKeyUpTags"},initialize: function() {
    this.collection && this.collection.on("reset", this.render, this);
    this.collection && this.collection.on("change", this.render, this);
    this._subViews = [];
    return this._subModels = []
  },onKeyUpTags: function() {
    var c, b;
    c = this.$(".js-edit-tags").val().split(", ");
    b = _.map(c, function(d) {
      return {name: d,id: d}
    });
    return this.collection.reset(b, {silent: true})
  },render: function() {
    if (!this.collection) {
      return this
    }
    this.template = _.template($("#tagList-template").html());
    return this.$el.html(this.template({tags: this.collection}))
  },renderOne: function(d) {
    var c, b;
    c = this;
    b = new window.classes.view.tagView();
    this._subViews.push(b);
    b.model = d;
    b.render();
    this._subModels.push(d);
    return this.$el.append(b.el)
  },teardown: function() {
    var c, e, b, d;
    d = this._subViews;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      c.teardown()
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.tagListView = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "pile";
    e.prototype.initialize = function(f) {
      this.collection && this.collection.on("reset", this.render, this);
      this.collection && this.collection.on("add", this.onAdd, this);
      this.collection && this.collection.on("remove", this.render, this);
      this.tracksLimit = f && f.tracksLimit;
      this._subViews = [];
      this._subModels = [];
      return this.initActionRow(f)
    };
    e.prototype.render = function() {
      var g, f, h;
      this.template = _.template($("#trackList-template").html());
      this.$el.html(this.template({headerText: ((g = this.options) != null ? g.headerText : void 0) || "",headerClass: ((f = this.options) != null ? f.headerClass : void 0) || "",closeButtonClass: ((h = this.options) != null ? h.closeButtonClass : void 0) || ""}));
      this.$(".js_elements").empty();
      if (this.collection) {
        this.collection.each(this.renderOne, this)
      }
      if (this.collection && this.collection.isEditable === true && this.collection.length > 1) {
        this.bindSortable()
      }
      this.renderActionRow(this.$(".js_elements"));
      console.log("render");
      return this
    };
    e.prototype.renderOne = function(g) {
      var f;
      if (this.tracksLimit && g.getNum() > this.tracksLimit) {
        return
      }
      if (g.get("hiddenByFilter") !== true) {
        f = new window.classes.view.trackRowView({model: g});
        f.render();
        this._subViews.push(f);
        this._subModels.push(g);
        return this.$(".js_elements").append(f.el)
      }
    };
    e.prototype.appendAfter = function(g) {
      var f;
      f = new window.classes.view.trackRowView({model: g});
      f.render();
      this._subViews.push(f);
      this._subModels.push(g);
      return this.$(".track-line:not('.center-text-gm')").last().after(f.el)
    };
    e.prototype.onAdd = function(f) {
      if (this.actionRowView) {
        return this.appendAfter(f)
      } else {
        return this.renderOne(f)
      }
    };
    e.prototype.renderNext = function(g) {
      var f;
      f = 0;
      this.collection.each(function(h) {
        if ((f < g) && (h.get("hiddenByFilter") === true)) {
          f++;
          return h.set("hiddenByFilter", false)
        }
      });
      return this.collection.trigger("reset")
    };
    e.prototype.teardown = function() {
      var g, k, f, h;
      h = this._subViews;
      for (k = 0, f = h.length; k < f; k++) {
        g = h[k];
        g.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return e
  })(window.classes.view.baseTrackListView);
  window.classes.view.trackListView = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "pile";
    d.prototype.events = {"click .js-add": "addTrack"};
    d.prototype.initialize = function(f) {
      this.collection && this.collection.on("reset", this.render, this);
      this.collection && this.collection.on("add", this.onAdd, this);
      this.collection && this.collection.on("remove", this.render, this);
      this._subViews = [];
      this._subModels = [];
      this.i = 0;
      return this.task = window.setInterval(_.bind(this.chekOneItemLink, this), 900)
    };
    d.prototype.chekOneItemLink = function() {
      var f;
      f = this.collection.at(this.i);
      this.i++;
      if (!f) {
        window.clearInterval(this.task);
        return
      }
      if (!f.get("link")) {
        return f.checkLink()
      }
    };
    d.prototype.render = function() {
      this.template = _.template($("#trackListEdit-template").html());
      this.$el.html(this.template({headerText: "2. " + __("Список треков"),error: this.collection.error}));
      this.$(".js_elements").empty();
      if (this.collection) {
        this.collection.each(this.renderOne, this)
      }
      if (this.collection && this.collection.isEditable === true && this.collection.length > 1) {
        this.bindSortable()
      }
      return this
    };
    d.prototype.addTrack = function() {
      var f;
      f = new window.classes.model.trackModel({artistName: this.options.album.get("artistName")});
      return this.collection.add(f)
    };
    d.prototype.renderOne = function(g) {
      var f;
      if (g.get("hiddenByFilter") !== true) {
        f = new window.classes.view.TrackRowEdit({model: g});
        f.render();
        this._subViews.push(f);
        this._subModels.push(g);
        return this.$(".js_elements").append(f.el)
      }
    };
    d.prototype.onAdd = function(f) {
      if (this.addTrackRow) {
        return this.render()
      } else {
        return this.renderOne(f)
      }
    };
    d.prototype.teardown = function() {
      var g, k, f, h;
      h = this._subViews;
      for (k = 0, f = h.length; k < f; k++) {
        g = h[k];
        g.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.view.baseTrackListView);
  window.classes.view.trackListEditView = c
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "",initialize: function() {
    this.collection && this.collection.on("reset", this.render, this);
    this.collection && this.collection.on("change", this.render, this);
    this._subViews = [];
    return this._subModels = []
  },render: function(b) {
    var c;
    if (!this.collection) {
      return this
    }
    this.$el.html("");
    if (b) {
      c = this.collection.models.slice(0, b);
      _.each(c, this.renderOne, this)
    } else {
      this.collection.each(this.renderOne, this)
    }
    return this
  },renderOne: function(d) {
    var c, b;
    c = this;
    b = new window.classes.view.userCardView();
    this._subViews.push(b);
    b.model = d;
    b.render();
    this._subModels.push(d);
    return this.$el.append(b.el)
  },teardown: function() {
    var c, e, b, d;
    d = this._subViews;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      c.teardown()
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.userCardsView = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.events = {"click .js-show-all": "showModalFollowers"};
    d.prototype.initialize = function() {
      return d.__super__.initialize.apply(this, arguments)
    };
    d.prototype.render = function(f) {
      this.template = _.template($("#userCardsWithTitle-template").html());
      this.$el.html(this.template({title: this.options.title,count: this.options.count}));
      this.$(".js_elements").empty();
      if (!this.collection) {
        return this
      }
      this.collection.each(this.renderOne, this);
      return this
    };
    d.prototype.renderOne = function(g) {
      var f;
      f = new window.classes.view.userCardView();
      f.model = g;
      f.render();
      this._subModels.push(g);
      this._subViews.push(f);
      return this.$(".js_elements").append(f.el)
    };
    d.prototype.showModalFollowers = function() {
      var f = this;
      this.users = new window.classes.collection.usersCollection();
      this.usersView = new window.classes.view.UserList({collection: this.users});
      this.usersView.preventBodyScroll();
      return this.options.track.getUsers(this.users).done(function() {
        var g;
        g = new window.classes.view.Modal({headtext: f.options.title + " " + f.options.count});
        $("#modal-popups").html(g.render().$el);
        return g.$(".js-container").html(f.usersView.render().el)
      })
    };
    return d
  })(window.classes.view.userCardsView);
  window.classes.view.UserCardsWithTitle = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "user-list",stopPropagationWheel: function(c, f) {
    var b;
    b = this.$el;
    if (f > 0 && b.scrollTop() === 0) {
      return c.preventDefault()
    } else {
      if (f < 0 && (b.scrollTop() === b.get(0).scrollHeight - b.innerHeight())) {
        return c.preventDefault()
      }
    }
  },preventBodyScroll: function() {
    return this.$el.on("mousewheel", _.bind(this.stopPropagationWheel, this))
  },initialize: function() {
    this.collection && this.collection.on("reset", this.render, this);
    this._subViews = [];
    return this._subModels = []
  },render: function(b) {
    this.$el.empty();
    if (this.collection) {
      this.collection.each(this.renderOne, this)
    }
    return this
  },renderOne: function(c) {
    var b;
    b = new window.classes.view.UserRow({model: c});
    this._subViews.push(b);
    this._subModels.push(c);
    return this.$el.append(b.render().el)
  },teardown: function() {
    var c, e, b, d;
    d = this._subViews;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      c.teardown()
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.UserList = a
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "flat-canvas-wrapper";
    d.prototype.render = function(f) {
      var g;
      this.$el.empty();
      this.$el.html('<div class="list"></div>');
      this.headerTemplate = _.template($("#simple-header-template").html());
      switch (this.options.section) {
        case "followers":
          g = this.collection.length + " " + __("подписчиков");
          break;
        case "followings":
          g = this.collection.length + " " + __("подписан")
      }
      this.$el.prepend(this.headerTemplate({text: g}));
      if (this.collection) {
        this.collection.each(this.renderOne, this)
      }
      return this
    };
    d.prototype.renderOne = function(g) {
      var f;
      f = new window.classes.view.UserRow({model: g});
      this._subViews.push(f);
      this._subModels.push(g);
      return this.$(".list").append(f.render().el)
    };
    return d
  })(window.classes.view.UserList);
  window.classes.view.UserListWithCounter = b
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.id = "menu";
    d.prototype.tagName = "ul";
    d.prototype.initialize = function() {
      this.template = _.template($("#popup-menu-template").html());
      return this.$el.addClass(this.options.addClass)
    };
    d.prototype.render = function() {
      var f, g = this;
      return this.$el.html((f = this.collection) != null ? f.map(function(h) {
        h = h.split(":");
        return g.template({menumItemName: h[0],menumItemId: h[1]})
      }).join("") : void 0)
    };
    return d
  })(Backbone.View);
  window.classes.view.PopupMenu = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({initialize: function() {
    this.oneTemplate = _.template($("#main-page-album-template").html());
    return this.collection.on("reset", this.render, this)
  },render: function() {
    var b = this;
    return this.collection.each(function(c) {
      return b.$el.append(b.oneTemplate({model: c}))
    })
  },teardown: function() {
    var c, e, b, d;
    d = this._subViews;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      c.teardown()
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.mainPageAlbums = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "";
    d.prototype.initialize = function(f) {
      this.collection && this.collection.on("reset", this.render, this);
      this.collection && this.collection.on("change", this.render, this);
      this.collection && this.collection.on("remove", this.render, this);
      this.collection && this.collection.on("add", this.render, this);
      this.tracksLimit = f && f.tracksLimit;
      this._subViews = [];
      this._subModels = [];
      return this.initActionRow(f)
    };
    d.prototype.render = function(f) {
      this.template = _.template($("#trackList-template").html());
      this.$el.html(this.template({headerText: (f != null ? f.header : void 0) || "",headerClass: (f != null ? f.headerClass : void 0) || ""}));
      this.$(".js_elements").empty();
      if (this.collection) {
        this.collection.each(this.renderOne, this)
      }
      this.bindSortable();
      this.renderActionRow(this.$(".js_elements"));
      return this
    };
    d.prototype.renderOne = function(h) {
      var g, f;
      if (this.tracksLimit && h.getNum() > this.tracksLimit) {
        return
      }
      g = this;
      f = new window.classes.view.PlaylistTrackRowView({model: h});
      f.render();
      this._subViews.push(f);
      this._subModels.push(h);
      return this.$(".js_elements").append(f.el)
    };
    d.prototype.teardown = function() {
      var g, k, f, h;
      h = this._subViews;
      for (k = 0, f = h.length; k < f; k++) {
        g = h[k];
        g.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.view.baseTrackListView);
  window.classes.view.PlaylistTrackListView = c
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "mix-list",initialize: function() {
    this._subViews = [];
    return this._subModels = []
  },render: function(b) {
    if (typeof this !== "undefined" && this !== null) {
      this.collection.each(this.renderOne, this)
    }
    this.$("img").fadeInAll();
    return this
  },renderOne: function(d) {
    var b, c;
    c = this;
    b = new window.classes.view.playlistCardView({model: d});
    this._subViews.push(b);
    d.on("sync", function(e, f) {
      c.trigger("sync", c, "");
      if (!f) {
        return c.collection.fetch()
      }
    });
    b.render();
    this._subModels.push(d);
    return this.$el.append(b.el)
  },teardown: function() {
    var c, e, b, d;
    d = this._subViews;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      c.teardown()
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.MixListView = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "posts-collection-l";
    d.prototype.initialize = function(f) {
      this.collection.on("reset", this.render, this);
      this.collection.on("add", this.renderOne, this);
      this.collection.on("remove", this.render, this);
      return this
    };
    d.prototype.render = function() {
      this.$el.empty();
      if (this.collection) {
        this.collection.each(this.renderOne, this)
      }
      return this
    };
    d.prototype.renderOne = function(g) {
      var h, f;
      f = this;
      h = new window.classes.view.postInfoView({model: g});
      h.render();
      return this.$el.append(h.el)
    };
    d.prototype.teardown = function() {
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(Backbone.View);
  window.classes.view.postListView = a
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "like-list";
    d.prototype.initialize = function(f) {
      d.__super__.initialize.call(this, f);
      return this.template = _.template($("#trackList-with-date-template").html())
    };
    d.prototype.render = function() {
      this.$el.html(this.template({title: this.options.title}));
      this.$(".js_elements").empty();
      if (this.collection) {
        this.collection.each(this.renderOne, this)
      }
      return this
    };
    d.prototype.renderOne = function(g) {
      var f;
      f = new window.classes.view.trackRowView({model: g});
      this._subViews.push(f);
      this._subModels.push(g);
      return this.$(".js_trackList").append(f.render().el)
    };
    d.prototype.remove = function() {
      _.each(this._subViews, function(f) {
        return f.remove()
      });
      return d.__super__.remove.apply(this, arguments)
    };
    return d
  })(window.classes.view.trackListView);
  window.classes.view.LikeTrackList = b
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "flat-canvas-wrapper";
    d.prototype.initialize = function() {
      this.collection && this.collection.on("reset", this.render, this);
      this.collection && this.collection.on("add", this.renderOne, this);
      this.lastLikeTrackList = {};
      return this._subViews = []
    };
    d.prototype.groupByDate = function(f) {
      var g;
      g = f.groupBy(function(h) {
        return moment(h.get("likedDate")).format("MMMM YYYY")
      });
      return g
    };
    d.prototype.render = function() {
      return this.collection.each(this.renderOne, this)
    };
    d.prototype.renderOne = function(h) {
      var n, m, g, l, k, f;
      g = moment(h.get("likedDate")).format("MMMM YYYY");
      n = _.isEmpty(this.lastLikeTrackList);
      l = (k = this.lastLikeTrackList.options) != null ? k.title : void 0;
      m = ((f = this.lastLikeTrackList.options) != null ? f.title : void 0) === g;
      if (n || !m) {
        return this.createGroup(h, g)
      } else {
        return this.addLikeInLastGroup(h)
      }
    };
    d.prototype.createGroup = function(f, h) {
      var g;
      g = new window.classes.view.LikeTrackList({collection: new window.classes.collection.LikeList([]),title: h});
      g.collection.add(f);
      this.lastLikeTrackList = g;
      this.$el.append(g.render().$el);
      return this._subViews.push(g)
    };
    d.prototype.addLikeInLastGroup = function(f) {
      return this.lastLikeTrackList.collection.add(f)
    };
    d.prototype.remove = function() {
      _.each(this._subViews, function(f) {
        return f.remove()
      });
      return d.__super__.remove.call(this)
    };
    return d
  })(Backbone.View);
  window.classes.view.likeTrackListsWithDate = a
}).call(this);
(function() {
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.initialize = function() {
      this.template = _.template($("#profile-sidebar-albums-template").html());
      return this.templateOne = _.template($('<a href="#" class="h6 bold c-mainGrey c-greenDark-ifcheck-txt"><%= text %></a>').html())
    };
    e.prototype.render = function() {
      this.$el.html(this.template({albums: this.collection}));
      return this
    };
    e.prototype.renderOne = function(f) {
      var g;
      g = this.templateOne({text: f.getArtist()});
      return this.$(".js_list").append(g)
    };
    return e
  })(Backbone.View);
  window.classes.view.SidebarAlbums = c
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    return d
  })(window.classes.view.PlaylistCardList);
  window.classes.view.ContainerPlaylists = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "playlists-profile";
    e.prototype.initialize = function() {
      this.collection.on("reset", this.render, this);
      this.containerPlaylist = new window.classes.view.ContainerPlaylists({collection: this.collection});
      return this
    };
    e.prototype.render = function() {
      this.$el.append(this.containerPlaylist.render().$el);
      return this
    };
    e.prototype.teardown = function() {
      this.off();
      this.undelegateEvents();
      return this
    };
    return e
  })(Backbone.View);
  window.classes.view.PlaylistsProfile = c
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({initialize: function(b) {
    var c = this;
    this.MAXHEIGHT = 32 * window.tracksflow.h.gSize;
    this.collection.on("reset", this.render, this);
    this.collection.on("change", this.render, this);
    this.collection.on("add", this.renderOne, this);
    this.collection.on("add", this.setTickerHeight, this);
    this.collection.on("remove", this.removeOne, this);
    this.collection.on("remove", this.setTickerHeight, this);
    this._subModels = [];
    this._subViews = [];
    this.tickerLikes = $(".ticker-likes .tickets-wrapper");
    return this.collection.fetch().then(function() {
      return c.render()
    })
  },render: function() {
    this.renderTickets();
    this.jsp = this.$(".scrollable").jScrollPane({autoReinitialise: true,showArrows: false,contentWidth: 184,verticalDragMinHeight: 7}).data("jsp");
    this.setTickerHeight();
    return this
  },renderTickets: function() {
    if (_.isEmpty(this.collection)) {
      return
    }
    this.$(".jspPane").empty();
    this.collection.each(this.renderOne, this);
    return this
  },setTickerHeight: function() {
    var b;
    b = this.collection.length * 5 * window.tracksflow.h.gSize + 5 * window.tracksflow.h.gSize;
    b > this.MAXHEIGHT && (b = this.MAXHEIGHT);
    this.collection.length === 0 && (b = 0);
    this.$el.css({height: b});
    this.$el.css({bottom: b + 4});
    this.tickerLikes.css({"padding-bottom": b + 4});
    return this
  },renderOne: function(c) {
    var b;
    b = new window.classes.view.TicketOnlineView({model: c});
    this._subViews.push(b);
    return this.$(".jspPane").prepend(b.render().$el)
  },teardown: function() {
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.TickerOnline = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({events: {"click .js-play-ticker": "play"},initialize: function(b) {
    this.collection.on("reset", this.render, this);
    this.collection.on("add", this.addTicketLike, this);
    this._subModels = [];
    this._subViews = [];
    this.headerTemplate = _.template($("#tickets-like-header-template").html());
    this.headers = {0: __("Любимые треки"),1: __("Вчера"),2: "2 " + (__("дня назад")),3: "3 " + (__("дня назад")),4: "4 " + (__("дня назад")),5: "5 " + (__("дней назад")),6: "6 " + (__("дней назад")),7: __("Неделю назад"),13: "2 " + (__("недели назад")),20: "3 " + (__("недели назад")),27: __("Месяц назад"),60: "2 " + (__("месяца назад"))};
    return this.collection.fetch({data: $.param({type: "friends",pageSize: 50})})
  },render: function() {
    this.jsp = this.$(".scrollable").jScrollPane({autoReinitialise: true,showArrows: false,contentWidth: 184,verticalDragMinHeight: 7}).data("jsp");
    this.renderTickets();
    return this
  },play: function() {
    if (window.player.get("originalCollection") === this.collection) {
      return
    }
    return window.player.tryPlay(this.collection.at(0))
  },renderTickets: function() {
    var b = this;
    if (_.isEmpty(this.collection)) {
      return
    }
    this.$(".jspPane").empty();
    this.sortTicketsByDate();
    _.each(this.sortedTickets, function(c, d) {
      b.$(".jspPane").append(b.renderHeader(d));
      return _.each(c, b.renderOne, b)
    });
    return this
  },dateFromString: function(c) {
    var b;
    b = $.map(c.split(/[^0-9]/), function(d) {
      return parseInt(d, 10)
    });
    return new Date(b[0], b[1] - 1 || 0, b[2] || 1, b[3] || 0, b[4] || 0, b[5] || 0, b[6] || 0)
  },sortTicketsByDate: function() {
    var b = this;
    this.sortedTickets = [];
    return this.collection.each(function(c) {
      var d;
      d = Math.floor((new Date().valueOf() - new Date(b.dateFromString(c.get("likedDate"))).valueOf()) / (60 * 60 * 24 * 1000));
      d = b.translateI(d);
      if (!(b.sortedTickets[d] != null)) {
        b.sortedTickets[d] = []
      }
      return b.sortedTickets[d].push(c)
    })
  },createTicketView: function(c) {
    var b;
    c.track.set({parentId: "FriendRadio"});
    b = new window.classes.view.TicketLikeView({model: c});
    this._subViews.push(b);
    return b
  },renderOne: function(c) {
    var b;
    b = this.createTicketView(c);
    return this.$(".jspPane").append(b.render().$el)
  },renderHeader: function(b) {
    return this.headerTemplate({header: __(this.headers[b])})
  },translateI: function(b) {
    b > 7 && b < 13 && (b = 13);
    b > 13 && b < 20 && (b = 20);
    b > 20 && b < 27 && (b = 27);
    b > 27 && b < 32 && (b = 27);
    b >= 32 && b < 60 && (b = 60);
    return b
  },addTicketLike: function(c) {
    var b;
    b = this.createTicketView(c);
    return this.$(".jspPane").find(".ticket-header-b").first().after(b.render().$el.hide().slideDown(200))
  },teardown: function() {
    var c, e, b, d;
    d = this._subModels;
    for (e = 0, b = d.length; e < b; e++) {
      c = d[e];
      window.models.syncManager.remove([c])
    }
    this.off();
    this.undelegateEvents();
    return this
  }});
  window.classes.view.TickerLikesView = a
}).call(this);
(function() {
  var a;
  a = Backbone.View.extend({className: "ticker",CHECK_WIDTH: 900,events: {"click .sidebar-toggle-button": "onClickToggle",mousewheel: "stopPropagationWheel"},initialize: function() {
    return this.isOpen = window.models.state.get("tickerIsOpen") || false
  },stopPropagationWheel: function(b) {
    b.stopPropagation();
    return b.preventDefault()
  },bindWindowResize: function() {
    var b;
    b = _.debounce(this.checkState, 200);
    return $(window).resize(_.bind(b, this))
  },render: function() {
    this.template = _.template($("#ticker-template").html());
    this.$el.html(this.template());
    $(document.body).append(this.$el);
    this.redrawTicker();
    this.tickerLikes = new window.classes.view.TickerLikesView({el: this.$(".ticker-likes"),collection: new window.classes.collection.LikeList});
    this.tickerOnline = new window.classes.view.TickerOnline({el: this.$(".ticker-online-friends"),collection: new window.classes.collection.NowPlayingList});
    return this
  },checkState: function(b) {
    if (b.originalEvent === void 0) {
      return
    }
    if ($(window).width() < this.CHECK_WIDTH) {
      return this.toggleTicker(false)
    } else {
      return this.toggleTicker(true)
    }
  },onClickToggle: function() {
    return this.toggleTicker()
  },toggleTicker: function(b) {
    if (_.isUndefined(b)) {
      this.isOpen = !this.isOpen
    } else {
      this.isOpen = b
    }
    window.models.state.saveTicker(this.isOpen);
    return this.redrawTicker()
  },redrawTicker: function() {
    var b;
    b = this.$(".sidebar-toggle-button").removeClass("close open");
    if (!this.isOpen) {
      b.addClass("open")
    }
    if (this.isOpen) {
      b.addClass("close")
    }
    $("body").toggleClass("hide-ticker", !this.isOpen);
    window.models.state.trigger("redrawTicker");
    return $(window).trigger("resize")
  }});
  window.classes.view.tickerView = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.title = window.APP_NAME;
    d.prototype.teardown = function() {
      return this
    };
    return d
  })(Backbone.View);
  window.classes.page.PageBase = c
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "";
    d.prototype.type = "Trends";
    d.prototype.initialize = function(f) {
      this.template = _.template($("#trends-page-template").html());
      window.models.state.on("redrawTicker", this.reloadItems, this);
      this.collection = new window.classes.collection.playlistsCollection();
      return this
    };
    d.prototype.start = function() {
      this.jqxhr = this.collection.fetch({data: $.param({type: "top"}),success: _.bind(function() {
        this.mixView = new window.classes.view.MixListView({collection: this.collection});
        return this.render()
      }, this)});
      return this
    };
    d.prototype.render = function() {
      if (!(this.mixView.$el.data().masonry != null)) {
        this.$el.html(this.template());
        this.$(".js-place-mix").html(this.mixView.render().$el);
        this.mixView.$el.masonry({itemSelector: ".flat-card-t",columnWidth: 168,isAnimated: true,isFitWidth: true})
      }
      return this
    };
    d.prototype.reloadItems = function() {
      return this.$(".mix-list").masonry("reload")
    };
    d.prototype.teardown = function() {
      var l, f, o, n, m, k, h, g;
      if ((l = this.leftPanel) != null) {
        l.teardown()
      }
      if ((f = this.comments) != null) {
        f.teardown()
      }
      if ((o = this.topTracks) != null) {
        o.teardown()
      }
      if ((n = this.similarArtists) != null) {
        n.teardown()
      }
      if ((m = this.albumCards) != null) {
        m.teardown()
      }
      if ((k = this.singleCards) != null) {
        k.teardown()
      }
      if ((h = this.compilationCards) != null) {
        h.teardown()
      }
      if ((g = this.jqxhr) != null) {
        g.abort()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.page.PageBase);
  window.classes.page.TrendsPage = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "";
    e.prototype.type = "Album";
    e.prototype.initialize = function(f) {
      this._subModels = [];
      this.album = new window.classes.model.releaseModel({id: f.id});
      this.model = this.album;
      this._subModels.push(this.album);
      return this
    };
    e.prototype.start = function() {
      return this.jqxhr = this.album.fetch({success: _.bind(function(f) {
        this.leftPanel = new window.classes.view.albumInfoView({model: this.album});
        this._subModels.push(this.leftPanel);
        this.album.tracks.nowPlayingTarget = this.album.getLink();
        this.tracks = new window.classes.view.trackListView({collection: this.album.tracks});
        if (this.tracks.model) {
          this._subModels.push(this.tracks.model)
        }
        this.followers = new window.classes.view.userCardsView({collection: this.album.followers});
        this.comments = new window.classes.view.commentsLargeView({collection: this.album.comments,url: "for=" + f.id + "&in=albums"});
        if (this.comments.model) {
          this._subModels.push(this.comments.model)
        }
        return this.render()
      }, this)})
    };
    e.prototype.render = function() {
      this.template = _.template($("#album-template").html());
      this.$el.html(this.template({model: this.model}));
      this.leftPanel.render();
      this.$(".js_leftPanel").html(this.leftPanel.el);
      this.followers.setElement(this.$(".js_followers"));
      this.followers.render();
      window.helpers.tf_showMoreContainer({masonryContainer: this.$(".js_followers"),masonrySelector: ".rounded-cover",showMoreButton: this.$(".js-followers-show-more")});
      this.tracks.render({headerClass: "hidden_i"});
      this.$(".js_tracks").html(this.tracks.el);
      this.comments.setElement(this.$(".js_comments"));
      this.comments.render();
      return this
    };
    e.prototype.teardown = function() {
      var g, f, k, h;
      if ((g = this.jqxhr) != null) {
        g.abort()
      }
      if ((f = this.leftPanel) != null) {
        f.teardown()
      }
      if ((k = this.tracks) != null) {
        k.teardown()
      }
      if ((h = this.comments) != null) {
        h.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    e.prototype.showMore = function(g) {
      var f;
      f = $(g.target).data("view");
      if (f != null) {
        f.showAll = true
      }
      if (f != null) {
        f.render()
      }
      return $(g.target).hide()
    };
    return e
  })(window.classes.page.PageBase);
  window.classes.page.albumPage = c
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "";
    d.prototype.type = "AlbumEdit";
    d.prototype.events = {"click .js-save": "trySave","click .js-cancel": "cancel","click .js-destroy": "destroy"};
    d.prototype.initialize = function(f) {
      d.__super__.initialize.call(this, f);
      return this.options = _.extend({btnOkCaption: __("Опубликовать")}, this.options, f)
    };
    d.prototype.start = function() {
      this.infoEditView = new window.classes.view.AlbumInfoEdit({model: this.model});
      this.model.tracks.isEditable = true;
      this.tracksView = new window.classes.view.trackListEditView({collection: this.model.tracks,album: this.model});
      return this.render()
    };
    d.prototype.render = function() {
      this.template = _.template($("#album-edit-page-template").html());
      this.$el.html(this.template({model: this.model,btnOkCaption: this.options.btnOkCaption}));
      this.$(".js_info").html(this.infoEditView.render().el);
      this.$(".js_tracks").html(this.tracksView.render().el);
      return this
    };
    d.prototype.trySave = function(k) {
      var f, g, h;
      k.stopPropagation();
      if (!this.model.tracks.length) {
        this.model.validationError = {attr: "tracks",msg: __("Пустой список треков")};
        this.model.trigger("invalid");
        return
      }
      if (this.$(".year-input-mdlm").val() < 10) {
        this.model.validationError = {attr: "year",msg: __("Год указывать обязательно")};
        this.model.trigger("invalid");
        return
      } else {
        f = this.$(".day-input-mdlm").val();
        h = $(".js-month-release").find(":selected").val();
        if (f === "" || h < 0) {
          this.model.set("year", this.$(".year-input-mdlm").val());
          this.model.set("releaseDate", null)
        } else {
          g = this.$(".year-input-mdlm").val() + " " + (h * 1 + 1) + " " + f;
          this.model.set("releaseDate", moment(g, "YYYY MM DD"))
        }
      }
      if (this.model.isNew()) {
        return this._save()
      } else {
        this.confirm = new window.classes.view.ModalWithInput({headtext: __("Комментарий к изменениям"),text: __("Опишите коротко и четко изменения, которые вы внесли, а также причину этих изменений. Это нужно, чтобы другие пользователи легко могли понять суть изменений"),button: {ok: __("Сохранить"),cancel: __("Отмена")},success: _.bind(function(l) {
          this._save(l);
          return this.confirm.remove()
        }, this)});
        return $("#modal-popups").html(this.confirm.render().el)
      }
    };
    d.prototype._save = function(f) {
      if (f == null) {
        f = null
      }
      utils.msg.notify(__("Пожалуйста подождите, альбом сохраняется..."));
      $("#content").html(_.template($("#loader-template").html())());
      if (f) {
        this.model.set({message: f}, {silent: true})
      }
      return this.model.save(["tracks"], {}, {success: _.bind(function() {
        return window.router.navigate(this.model.getLink(), {trigger: true})
      }, this),error: function() {
        return utils.msg.error(__("Не удалось сохранить альбом"))
      }})
    };
    d.prototype.destroy = function(f) {
      f.stopPropagation();
      this.confirm = new window.classes.view.ModalWithInput({headtext: __("Комментарий к удалению"),text: __("Опишите причину удаления альбома"),type: "red",button: {ok: __("Удалить"),cancel: __("Отмена")},success: _.bind(function(g) {
        this.confirm.remove();
        return this._destroy(g)
      }, this)});
      return $("#modal-popups").html(this.confirm.render().el)
    };
    d.prototype._destroy = function(f) {
      this.model.set({archived: true,message: f}, {silent: true});
      this.model.save({success: function(g) {
        return msg.warn(__("Альбом успешно удален"))
      },error: function() {
        console.log("error remove album");
        return msg.error(__("Не удалось удалить альбом"))
      }});
      return window.router.navigate(this.model.getArtistLink(), {trigger: true})
    };
    d.prototype.cancel = function() {
      return window.history.back()
    };
    d.prototype.teardown = function() {
      var g, f;
      if ((g = this.infoEditView) != null) {
        g.teardown()
      }
      if ((f = this.tracksView) != null) {
        f.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    d.prototype.showMore = function(g) {
      var f;
      f = $(g.target).data("view");
      if (f != null) {
        f.showAll = true
      }
      if (f != null) {
        f.render()
      }
      return $(g.target).hide()
    };
    return d
  })(window.classes.page.PageBase);
  window.classes.page.AlbumEditPage = b
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "";
    d.prototype.type = "Artist";
    d.prototype.events = function() {
      return {"click .js_action_row": "showMoreTracks"}
    };
    d.prototype.initialize = function(f) {
      this.model && this.model.on("reset", this.render, this);
      this.model && this.model.on("change", this.render, this);
      this.artist = new window.classes.model.artistModel({id: f.id});
      this.model = this.artist;
      this._subModels = [];
      this._subModels.push(this.artist);
      return this
    };
    d.prototype.start = function() {
      return this.jqxhr = this.artist.fetch({success: _.bind(function(h) {
        var g, f, k = this;
        this.leftPanel = new window.classes.view.artistInfoView({model: this.artist});
        this._subModels.push(this.leftPanel);
        this.comments = new window.classes.view.commentsLargeView({collection: this.artist.comments,url: "for=" + h.id + "&in=artists"});
        if (this.comments.model) {
          this._subModels.push(this.comments.model)
        }
        this.followers = new window.classes.view.userCardsView({collection: this.artist.followers});
        this.artist.tracks.nowPlayingTarget = this.artist.getLink();
        g = {};
        g.text = __("Показать ещё");
        f = new window.classes.view.actionRowView({model: g,type: "no-arrow",action: function() {
          return k.topTracks.collection.loadNextPage()
        }});
        this.topTracks = new window.classes.view.trackListView({collection: this.artist.tracks,actionRowView: f});
        this.similarArtists = new window.classes.view.artistCardsView({collection: this.artist.similar});
        if (this.similarArtists.model) {
          this._subModels.push(this.similarArtists.model)
        }
        this.albumCards = new window.classes.view.releaseCardsView({collection: this.artist.albums});
        if (this.albumCards.model) {
          this._subModels.push(this.albumCards.model)
        }
        this.singleCards = new window.classes.view.releaseCardsView({collection: this.artist.singles});
        if (this.singleCards.model) {
          this._subModels.push(this.singleCards.model)
        }
        this.compilationCards = new window.classes.view.releaseCardsView({collection: this.artist.compilations});
        if (this.compilationCards.model) {
          this._subModels.push(this.compilationCards.model)
        }
        return this.render()
      }, this)})
    };
    d.prototype.showMoreTracks = function() {
      return this.topTracks.collection.loadNextPage()
    };
    d.prototype.render = function() {
      var g, f, k, h;
      this.template = _.template($("#artist-template").html());
      this.$el.html(this.template({model: this.model}));
      this.leftPanel.render();
      this.$(".js_leftPanel").html(this.leftPanel.el);
      this.comments.setElement(this.$(".js_comments"));
      this.comments.render();
      this.followers.setElement(this.$(".js_followers"));
      this.followers.render();
      window.helpers.tf_showMoreContainer({masonryContainer: this.$(".js_followers"),masonrySelector: ".rounded-cover",showMoreButton: this.$(".js-followers-show-more")});
      this.topTracks.render({header: __("Популярные треки")});
      this.$(".js_topTracks").html(this.topTracks.el);
      if ((g = this.albumCards.collection) != null ? g.length : void 0) {
        this.albumCards.render({headerText: __("Альбомы")});
        this.$(".js_albumCards").html(this.albumCards.el).prev().removeClass("hidden_i")
      }
      if ((f = this.singleCards.collection) != null ? f.length : void 0) {
        this.singleCards.render({headerText: __("Синглы")});
        this.$(".js_singleCards").html(this.singleCards.el).prev().removeClass("hidden_i")
      }
      if ((k = this.compilationCards.collection) != null ? k.length : void 0) {
        this.compilationCards.render({headerText: __("Компиляции")});
        this.$(".js_compilationCards").html(this.compilationCards.el).prev().removeClass("hidden_i")
      }
      if ((h = this.similarArtists.collection) != null ? h.length : void 0) {
        this.similarArtists.render({headerText: __("Похожие артисты")});
        this.$(".js_similarArtists").html(this.similarArtists.el).prev().removeClass("hidden_i")
      }
      return this
    };
    d.prototype.teardown = function() {
      var p, o, n, m, l, k, h, g, f;
      if ((p = this.jqxhr) != null) {
        p.abort()
      }
      if ((o = this.leftPanel) != null) {
        o.teardown()
      }
      if ((n = this.comments) != null) {
        n.teardown()
      }
      if ((m = this.topTracks) != null) {
        m.teardown()
      }
      if ((l = this.similarArtists) != null) {
        l.teardown()
      }
      if ((k = this.albumCards) != null) {
        k.teardown()
      }
      if ((h = this.singleCards) != null) {
        h.teardown()
      }
      if ((g = this.compilationCards) != null) {
        g.teardown()
      }
      if ((f = this.followers) != null) {
        f.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.page.PageBase);
  window.classes.page.artistPage = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "";
    d.prototype.type = "FlowPost";
    d.prototype.pageSize = 5;
    d.prototype.events = {"click .js-up-button": "scrollTop"};
    d.prototype.initialize = function(f) {
      var g;
      this.type = ((g = this.options) != null ? g.type : void 0) || "";
      this.posts = new window.classes.collection.flowCollection([], {data: {type: this.getAPIType()}});
      this.postsView = new window.classes.view.postListView({collection: this.posts});
      this.addPost = new window.classes.view.addPostView({collection: this.posts});
      this.$w = $(window);
      return this
    };
    d.prototype.getAPIType = function() {
      var f;
      switch (this.type) {
        case "":
          f = "withFriends";
          break;
        case "popular":
          f = "bestposts";
          break;
        case "news":
          f = "new"
      }
      return f
    };
    d.prototype.showFlow = function(h) {
      var g, f;
      h.preventDefault();
      h.stopPropagation();
      g = "/flow";
      f = $(h.target).data("type");
      if (f !== "") {
        g = g + "/" + f
      }
      if (f !== this.type) {
        return window.router.navigate(g, {trigger: true})
      }
    };
    d.prototype.start = function() {
      this.render();
      this.lazy = new window.classes.controller.lazyLoadController($(window), this.$el, this.posts, this.pageSize);
      this.ruby = this.$(".rubricator-pl");
      this.postsWrapper = this.$(".post-list-pl");
      return this.upButton = this.$(".js-up-button")
    };
    d.prototype.render = function() {
      this.template = _.template($("#flow-template").html());
      this.$el.html(this.template({type: this.type}));
      this.addPost.setElement(this.$(".js_addPost"));
      window.models.currentUser.id && this.addPost.render();
      this.postsView.$el = this.$(".js_postsList");
      this.listenToResize();
      this.listenToScroll();
      return this
    };
    d.prototype.scrollTop = function() {
      return $("body, html").animate({scrollTop: 0})
    };
    d.prototype.positRuby = function(f) {
      if (f === "de") {
        this.ruby.attr("style", "");
        return
      }
      this.ruby.css({right: this.$w.outerWidth() - (this.postsWrapper.offset().left + this.postsWrapper.outerWidth() + window.tracksflow.h.gSize * 2 + this.ruby.outerWidth()),top: 4 * window.tracksflow.h.gSize,display: "block",position: "fixed"});
      return $(window).trigger("resize")
    };
    d.prototype.checkUpButtonAndRuby = function() {
      if (this.$w.scrollTop() > this.$w.outerHeight()) {
        this.upButton.show()
      } else {
        this.upButton.hide()
      }
      if (this.$w.scrollTop() > this.postsWrapper.offset().top) {
        return this.positRuby()
      } else {
        return this.positRuby("de")
      }
    };
    d.prototype.listenToResize = function() {
      var f = this;
      return this.$w.smartresize(function() {
        return f.checkUpButtonAndRuby()
      })
    };
    d.prototype.listenToScroll = function() {
      var f = this;
      return this.$w.scroll(function() {
        return f.checkUpButtonAndRuby()
      })
    };
    d.prototype.teardown = function() {
      var g, f, h;
      if ((g = this.lazy) != null) {
        g.teardown()
      }
      if ((f = this.addPost) != null) {
        f.teardown()
      }
      if ((h = this.postsView) != null) {
        h.teardown()
      }
      this.addPost.teardown();
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.page.PageBase);
  window.classes.page.flowPage = c
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "";
    d.prototype.type = "Playlist";
    d.prototype.initialize = function(f) {
      this.playlist = new window.classes.model.playlistModel({playlistId: f.id});
      this._subModels = [];
      this._subModels.push(this.playlist);
      return this
    };
    d.prototype.start = function() {
      try {
        return this.jqxhr = this.playlist.fetch({success: _.bind(function(l) {
          var k, h, g;
          this.title = this.playlist.getName() + " - " + window.APP_NAME;
          window.models.syncManager.trigger("document:title:change", {title: this.title});
          this.playlistInfo = new window.classes.view.playlistInfoView({model: this.playlist});
          this.playlist.tracks.isEditable = this.playlist.isEditable();
          this.playlist.tracks.isAddable = this.playlist.isAddable();
          if (this.playlist.isAddable() && this.playlist.id !== "vk" && this.playlist.id !== "lastfm") {
            k = {};
            k.text = __("Добавить") + " " + __("трек");
            h = new window.classes.view.actionRowView({model: k,type: "no-arrow",action: _.bind(function() {
              g.fillTracks();
              if (!(this.popup != null)) {
                return this.popup = new window.tracksflow.h.popup({target: this.$(".js-action"),content: g.$el,"class": "is-white",mode: "click",type: "show-now",preferredPositions: ["left", "bottom", "right"]})
              }
            }, this)})
          }
          this.tracks = new window.classes.view.trackListView({collection: this.playlist.tracks,actionRowView: h});
          this.followers = new window.classes.view.userCardsView({collection: this.playlist.followers});
          if (this.followers.model) {
            this._subModels.push(this.followers.model)
          }
          if (!(this.playlist.id === "lastfm" || this.playlist.id === "vk")) {
            this.comments = new window.classes.view.commentsLargeView({collection: this.playlist.comments,url: "for=" + l.id + "&in=playlists"})
          }
          if (this.playlist.id === "vk") {
            this.lazy = new window.classes.controller.lazyLoadController($(window), $(document), this.playlist.tracks, 200, false);
            this.lazy.bindScroll()
          }
          this.render();
          if (this.playlist.isAddable()) {
            return g = new window.classes.view.trackSelectionPopupView({target: _.bind(function(o) {
              var m, n;
              m = new window.classes.model.PlaylistItem({track: o.toJSON()});
              m.url = "" + window.api_url_2 + "/playlistitems?for=" + this.playlist.id;
              this.playlist.tracks.add(m);
              m.save(["track", "tags"]);
              return (n = this.popup) != null ? n.hide() : void 0
            }, this)})
          }
        }, this)})
      } catch (f) {
      }
    };
    d.prototype.render = function() {
      var f, g;
      this.template = _.template($("#playlist-template").html());
      this.$el.html(this.template({model: this.model,followers: this.followers}));
      this.playlistInfo.render();
      this.$(".js_playlistInfo").html(this.playlistInfo.el);
      this.tracks.render();
      this.$(".js_tracks").html(this.tracks.el);
      this.followers.setElement(".js-followers");
      this.followers.render();
      window.helpers.tf_showMoreContainer({masonryContainer: this.$(".js-followers"),masonrySelector: ".rounded-cover",showMoreButton: this.$(".js-followers-show-more")});
      this.tracks.collection.on("arrange", function(h, l) {
        var k;
        k = l + 1;
        h.set("position", k);
        return h.save()
      }, this);
      if (!(this.playlist.id === "lastfm" || this.playlist.id === "vk")) {
        this.comments.setElement(this.$(".js_comments"));
        this.comments.render();
        g = new window.classes.model.commentModel();
        g.user = models.currentUser;
        f = new window.classes.view.commentFormView({collection: this.playlist.comments,model: g,el: this.$(".js_comments_form")});
        f.render()
      }
      return this
    };
    d.prototype.teardown = function() {
      var g, f, k, h;
      if ((g = this.jqxhr) != null) {
        g.abort()
      }
      if ((f = this.playlistInfo) != null) {
        f.teardown()
      }
      if ((k = this.tracks) != null) {
        k.teardown()
      }
      if ((h = this.comments) != null) {
        h.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.page.PageBase);
  window.classes.page.playlistPage = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.initialize = function(f) {
      this.post = new window.classes.model.postModel();
      this.post.id = f.id;
      this.postInfo = new window.classes.view.postInfoView({model: this.post});
      this.post.on("reset", this.render, this);
      this.post.on("change", this.render, this);
      this._subModels = [];
      this._subModels.push(this.post);
      return this
    };
    d.prototype.start = function() {
      return this.post.fetch()
    };
    d.prototype.render = function() {
      this.postInfo.render();
      this.$el.html(this.postInfo.$el);
      return this.postInfo.$el.wrap('<div class="single-post-page" />')
    };
    d.prototype.teardown = function() {
      var f;
      if ((f = this.postInfo) != null) {
        f.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.page.PageBase);
  window.classes.page.postPage = a
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "";
    d.prototype.type = "UserTracks";
    d.prototype.events = {"click .js-create-playlist": "showPlaylistAddForm"};
    d.prototype.initialize = function(f) {
      var g;
      this.user = new window.classes.model.userModel({userId: f.id});
      this.model = this.user;
      switch (f.section) {
        case "flow":
          this.newPostFLow = new window.classes.view.addPostView;
          this.collection = new window.classes.collection.flowCollection([], {data: {"for": this.options.id,pageSize: 10}});
          this.contentView = new window.classes.view.postListView({collection: this.collection});
          break;
        case "followers":
        case "followings":
          this.collection = new window.classes.collection.usersCollection([], {data: {"for": this.options.id,"in": "users",type: this.options.section}});
          this.contentView = new window.classes.view.UserListWithCounter({section: this.options.section,collection: this.collection});
          break;
        case "playlists":
          if (!this.model.isMe()) {
            g = {"for": this.user.id,"in": "users"}
          } else {
            g = {"in": "users"}
          }
          this.collection = new window.classes.collection.playlistsCollection([], {data: g});
          this.contentView = new window.classes.view.PlaylistsProfile({collection: this.collection,className: "margin-left-de-x2-gm"});
          break;
        case "artists":
          this.collection = new window.classes.collection.LikeList([], {model: window.classes.model.LikeArtist,data: {"for": this.options.id,type: this.options.section}});
          this.contentView = new window.classes.view.artistCardsView({collection: this.collection,className: "margin-left-de-x2-gm"});
          break;
        case "albums":
          this.collection = new window.classes.collection.LikeList([], {model: window.classes.model.LikeAlbum,data: {"for": this.options.id,type: this.options.section}});
          this.contentView = new window.classes.view.releaseCardsView({collection: this.collection,className: "margin-left-de-x2-gm"});
          break;
        case "tracks":
          this.collection = new window.classes.collection.LikeList([], {data: {"for": this.options.id,type: this.options.section,pageSize: 100}});
          this.contentView = new window.classes.view.likeTrackListsWithDate({collection: this.collection})
      }
      this._subModels = [];
      this._subModels.push(this.user);
      return this
    };
    d.prototype.start = function() {
      var f;
      if (this.options.section !== "tracks") {
        this.jqxhr = this.collection.fetch()
      }
      if (this.user.isMe()) {
        this.user = window.models.currentUser
      } else {
        this.jqxhrUser = this.user.fetch()
      }
      if (this.options.section === "tracks" || this.options.section === "flow") {
        this.lazy = new window.classes.controller.lazyLoadController($(window), $(document), this.collection)
      }
      f = [];
      if (this.jqxhrUser) {
        f.push(this.jqxhrUser)
      }
      if (this.jqxhr) {
        f.push(this.jqxhr)
      }
      if (this.lazy) {
        f.push(this.lazy.jqxhr)
      }
      if (this.jqxhrUser) {
        this.jqxhrUser.done(_.bind(function() {
          return this.collection.commonLength = this.user.get("trackLikeCount")
        }, this))
      } else {
        this.collection.commonLength = this.user.get("trackLikeCount")
      }
      return $.when.apply(null, f).done(_.bind(function() {
        return this.render()
      }, this))
    };
    d.prototype.render = function() {
      this.template = _.template($("#profile-page-template").html());
      this.$el.html(this.template({model: this.model,section: this.options.section}));
      this.userInfo = new window.classes.view.ProfileInfo({model: this.user,section: this.options.section});
      this.$(".js_profile-info ").html(this.userInfo.render().$el);
      this.$(".js_content").html(this.contentView.$el);
      if (this.newPostFLow) {
        this.$(".js_new_placeholder").replaceWith(this.newPostFLow.$el)
      }
      return this.$(".js_new_placeholder").replaceWith(_.template($("#button-with-icon-template").html())())
    };
    d.prototype.showPlaylistAddForm = function() {
      var f;
      f = new window.classes.view.PopupInput({success: _.bind(function(g) {
        return this.addPlaylist(g)
      }, this)});
      f.render();
      if (this.popup) {
        this.popup.removeIt()
      }
      this.popup = new window.tracksflow.h.popup({target: this.$(".js-create-playlist"),content: f.$el,"class": "is-white",preferredPositions: ["bottom", "left", "right"]});
      return this.popup.listenToClick()
    };
    d.prototype.addPlaylist = function(f) {
      var h, g;
      g = $.trim(f);
      if (g.length) {
        h = new window.classes.model.playlistModel;
        h.set("name", g);
        h.save().done(_.bind(function() {
          return window.router.navigate(h.getLink(), {trigger: true})
        }, this));
        $("#content").html(_.template($("#loader-template").html())());
        window.utils.msg.html("" + (__("Плейлист")) + ' <span class="bold-gm">' + g + "</span> " + (__("создан")));
        return this.popup.hide()
      }
    };
    d.prototype.teardown = function() {
      var p, o, n, m, l, k, h, g, f;
      if ((p = this.jqxhr) != null) {
        p.abort()
      }
      if ((o = this.jqxhrUser) != null) {
        o.abort()
      }
      if (this.lazy) {
        if ((n = this.lazy.jqxhr) != null) {
          n.abort()
        }
      }
      if ((m = this.userInfo) != null) {
        m.teardown()
      }
      if ((l = this.newPostFLow) != null) {
        l.teardown()
      }
      if ((k = this.contentView) != null) {
        k.remove()
      }
      if ((h = this.lazy) != null) {
        h.teardown()
      }
      this.off();
      this.undelegateEvents();
      if ((g = this.contentView) != null) {
        g.remove()
      }
      return (f = this.userInfo) != null ? f.remove() : void 0
    };
    return d
  })(window.classes.page.PageBase);
  window.classes.page.ProfilePage = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.className = "";
    d.prototype.type = "Search";
    d.prototype.pageSize = 30;
    d.prototype.initialize = function(f) {
      this.model && this.model.on("reset", this.render, this);
      this.search = new window.classes.model.searchModel({query: f.id});
      this.model = this.search;
      this._subModels = [];
      this._subModels.push(this.search);
      this.sidebarSearch = $(".sidebar-search");
      this.checkSearchInput();
      return this
    };
    d.prototype.start = function() {
      var f;
      if (!this.options.section) {
        f = {section: "all",page: 0,pageSize: 10}
      } else {
        f = {section: this.options.section,page: 0,pageSize: 30}
      }
      return this.jqxhr = this.search.fetch({success: _.bind(function(g) {
        this.userList = new window.classes.view.usersWithLink({collection: this.search.users});
        this.albumList = new window.classes.view.releaseCardsView({collection: this.search.albums});
        this.artistList = new window.classes.view.artistCardsView({collection: this.search.artists});
        this.search.tracks.nowPlayingTarget = "/search/" + this.id;
        this.trackList = new window.classes.view.trackListView({collection: this.search.tracks});
        this.playlistList = new window.classes.view.playlistsView({collection: this.search.playlists});
        this.tagList = new window.classes.view.tagListView({collection: this.search.tags});
        return this.render()
      }, this),data: $.param(f)})
    };
    d.prototype.render = function() {
      this.scrollCollection = (function() {
        switch (this.options.section) {
          case "tracks":
            return this.search.tracks;
          case "albums":
            return this.search.albums;
          case "artists":
            return this.search.artists;
          case "playlists":
            return this.search.playlists;
          default:
            return null
        }
      }).call(this);
      if (this.scrollCollection) {
        this.lazy = new window.classes.controller.lazyLoadController($(window), this.$el, this.scrollCollection, this.pageSize)
      }
      if (!this.options.section) {
        this.template = _.template($("#search-page-template").html())
      } else {
        this.template = _.template($("#search-page-" + this.options.section + "-template").html())
      }
      this.$el.html(this.template({model: this.model}));
      this.tagList.setElement(this.$(".js_tagList"));
      this.tagList.render();
      this.userList.render();
      this.$(".js_userList").html(this.userList.el);
      this.albumList.render();
      this.$(".js_albumList").html(this.albumList.el);
      this.artistList.render();
      this.$(".js_artistList").html(this.artistList.el);
      this.trackList.render();
      this.$(".js_trackList").html(this.trackList.el);
      this.playlistList.setElement(this.$(".js_playlistList"));
      this.playlistList.render();
      return this
    };
    d.prototype.checkSearchInput = function() {
      return this.sidebarSearch.addClass("is-check")
    };
    d.prototype.uncheckSearchInput = function() {
      return this.sidebarSearch.removeClass("is-check")
    };
    d.prototype.teardown = function() {
      var k, f, n, m, l, h, g;
      if (!Backbone.history.fragment.match(new RegExp("search", "g"))) {
        this.uncheckSearchInput()
      }
      if ((k = this.jqxhr) != null) {
        k.abort()
      }
      if ((f = this.lazy) != null) {
        f.teardown()
      }
      if ((n = this.userList) != null) {
        n.teardown()
      }
      if ((m = this.albumList) != null) {
        m.teardown()
      }
      if ((l = this.artistList) != null) {
        l.teardown()
      }
      if ((h = this.trackList) != null) {
        h.teardown()
      }
      if ((g = this.playlistList) != null) {
        g.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.page.PageBase);
  window.classes.page.searchPage = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "";
    e.prototype.type = "Tags";
    e.prototype.pageSize = 30;
    e.prototype.initialize = function(f) {
      this.tag = new window.classes.model.tagModel({name: f.id});
      this.model = this.tag;
      this._subModels = [];
      this._subModels.push(this.tag);
      return this
    };
    e.prototype.start = function() {
      var f;
      if (!this.options.section) {
        f = {section: "all",page: 0,pageSize: 10}
      } else {
        f = {section: this.options.section,page: 0,pageSize: 30}
      }
      return this.tag.fetch({success: _.bind(function(g) {
        this.trackList = new window.classes.view.trackListView({collection: this.tag.tracks});
        this.artistList = new window.classes.view.artistCardsView({collection: this.tag.artists});
        this.albumList = new window.classes.view.releaseCardsView({collection: this.tag.albums});
        this.plalistList = new window.classes.view.playlistsView({collection: this.tag.playlists});
        this.tagList = new window.classes.view.tagListView({collection: this.tag.similar});
        return this.render()
      }, this),data: $.param(f)})
    };
    e.prototype.render = function() {
      this.scrollCollection = (function() {
        switch (this.options.section) {
          case "tracks":
            return this.tag.tracks;
          case "albums":
            return this.tag.albums;
          case "artists":
            return this.tag.artists;
          case "playlists":
            return this.tag.playlists;
          default:
            return null
        }
      }).call(this);
      if (this.scrollCollection) {
        this.lazy = new window.classes.controller.lazyLoadController($(window), this.$el, this.scrollCollection, this.pageSize)
      }
      if (!this.options.section) {
        this.template = _.template($("#tag-page-template").html())
      } else {
        this.template = _.template($("#tag-page-" + this.options.section + "-template").html())
      }
      this.$el.html(this.template({model: this.model}));
      if (this.tag.similar) {
        this.tagList.setElement(this.$(".js_tagList"));
        this.tagList.render()
      }
      if (!_.isEmpty(this.trackList.collection)) {
        this.trackList.setElement(this.$(".js_trackList"));
        this.trackList.render()
      }
      if (!_.isEmpty(this.artistList.collection)) {
        this.artistList.setElement(this.$(".js_artistList"));
        this.artistList.render()
      }
      if (!_.isEmpty(this.albumList.collection)) {
        this.albumList.setElement(this.$(".js_albumList"));
        this.albumList.render({headerText: __("Альбомы"),iconType: "album-icon"})
      }
      if (!_.isEmpty(this.plalistList.collection)) {
        this.plalistList.render();
        this.$(".js_playlistList").html(this.plalistList.el)
      }
      return this
    };
    e.prototype.teardown = function() {
      this.off();
      this.undelegateEvents();
      return this
    };
    return e
  })(window.classes.page.PageBase);
  window.classes.page.tagPage = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "";
    e.prototype.type = "Track";
    e.prototype.events = {"click .js-lyrics-show-more": "lyricsShowMore","click .js-similar-show-more": "similarShowMore"};
    e.prototype.initialize = function(f) {
      this.model && this.model.on("reset", this.render, this);
      this.model && this.model.on("change", this.render, this);
      this.track = new window.classes.model.trackFullModel({id: f.id});
      this.track.collection = new window.classes.collection.tracksCollection([this.track]);
      this._subModels = [];
      this._subModels.push(this.track);
      return this
    };
    e.prototype.start = function() {
      return this.jqxhr = this.track.fetch({success: _.bind(function(f) {
        this.trackInfo = new window.classes.view.trackInfoView({model: this.track});
        this._subModels.push(this.trackInfo);
        this.followers = new window.classes.view.userCardsView({collection: this.track.followers});
        if (this.followers.model) {
          this._subModels.push(this.followers.model)
        }
        this.similar = new window.classes.view.trackListView({collection: this.track.similar});
        this.playlists = new window.classes.view.playlistsView({collection: this.track.playlists});
        if (this.playlists.model) {
          this._subModels.push(this.playlists.model)
        }
        return this.render()
      }, this)})
    };
    e.prototype.render = function() {
      this.template = _.template($("#track-template").html());
      this.$el.html(this.template({followers: this.followers,playlists: this.playlists,similar: this.similar.collection || "empty"}));
      this.trackInfo.setElement(this.$(".js_trackInfo"));
      this.trackInfo.render();
      this.similar.setElement(this.$(".js_similar"));
      this.similar.render();
      this.followers.setElement(this.$(".js_followers"));
      this.followers.render();
      window.helpers.tf_showMoreContainer({masonryContainer: this.$(".js_followers"),masonrySelector: ".rounded-cover",showMoreButton: this.$(".js-followers-show-more")});
      this.playlists.setElement(this.$(".js_playlists"));
      this.playlists.render();
      window.helpers.tf_showMoreContainer({masonryContainer: this.$(".js_playlists"),masonrySelector: ".flat-card-t",showMoreButton: this.$(".js-playlist-show-more")});
      $.ajax({url: window.api_url_2 + "/search/youtube",context: this,data: {name: this.track.getArtist(),title: this.track.getName()},success: function(f) {
        return this.renderVideo(f != null ? f[0].id : void 0)
      }});
      this.track.getLyrics(function(f) {
        if (f) {
          this.$(".js_lyrics").html($.trim(f));
          this.$(".js-lyrics-w").show();
          return this.$(".js-lyrics-header").show()
        }
      });
      return this
    };
    e.prototype.renderVideo = function(g) {
      var f;
      if (g) {
        f = _.template($("#youtube-template").html(), {id: g});
        this.$(".js_youtube").html(f);
        return this.$(".js-video-header").show()
      }
    };
    e.prototype.listenToMasonry = function(g, f) {
      var h = this;
      return g.on("masonry:complete", function() {
        var k;
        k = g.data().masonry;
        if (k.cols < k.$bricks.length) {
          return f.show()
        } else {
          return f.hide()
        }
      })
    };
    e.prototype.similarShowMore = function() {
      return this.similar.renderNext(10)
    };
    e.prototype.lyricsShowMore = function(f) {
      this.$(".js-lyrics-show-more").toggleClass("hidden-gm-i");
      this.$(".js_lyrics").toggleClass("clear-max-height-gm-i");
      return false
    };
    e.prototype.teardown = function() {
      var g, f, l, k, h;
      if ((g = this.jqxhr) != null) {
        g.abort()
      }
      if ((f = this.trackInfo) != null) {
        f.teardown()
      }
      if ((l = this.followers) != null) {
        l.teardown()
      }
      if ((k = this.similar) != null) {
        k.teardown()
      }
      if ((h = this.playlists) != null) {
        h.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return e
  })(window.classes.page.PageBase);
  window.classes.page.trackPage = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.events = {"click .js-save-profile": "saveProfile","click .js-save-account": "saveAccount","click .js-save-localization": "saveLocalization","change .js-localization-select": "changeLocalization","click .js-connect-facebook": "toggleFacebook","click .js-connect-twitter": "toggleTwitter","click .js-connect-vk": "toggleVk","click .js-connect-lastfm": "toggleLastfm","click .js-lastfm-playlist": "togglePlaylistLastfm","click .js-lastfm-scrobble": "toggleScrobbleLastfm","click .js-noty-save": "saveNoties"};
    e.prototype.profileTextareaMaxCount = 160;
    e.prototype.languages = {ru: "Русский",en: "Английский"};
    e.prototype.initialize = function() {
      this.model = window.models.currentUser;
      this.model.lang = this.model.get("lang");
      this.model.on("change:images", this.render, this);
      return this.model.on("change:accounts", this.render, this)
    };
    e.prototype.start = function() {
      return this.render()
    };
    e.prototype.render = function() {
      var f;
      this.template = _.template($("#settings-page-template").html());
      this.$el.html(this.template({model: this.model}));
      f = new window.classes.view.TextareaWithCounterView;
      f.setElement(this.$(".js-textarea-with-count-place"));
      f.render({text: this.model.get("bio"),maxCount: this.profileTextareaMaxCount,addClass: "textarea-type-c-comments-bg-gm about-m"});
      this.imageLoader = new window.classes.view.ImageLoaderView({apiPath: window.api_url_2 + "/files?in=users",model: this.model});
      this.imageLoader.setElement(this.$(".js-profile-avatar-place"));
      this.imageLoader.render();
      return this
    };
    e.prototype.teardown = function() {
      if (this.imageLoader) {
        this.imageLoader.teardown()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    e.prototype.saveProfile = function(g) {
      var f;
      f = false;
      if (this.$("input[type=radio]:checked").val() === "male") {
        f = true
      }
      this.model.set("name", $.trim(this.$(".js-profile-name").val()));
      this.model.set("bio", $.trim(this.$(".js-profile-about-textarea").val()));
      this.model.set("location", $.trim(this.$(".js-profile-location").val()));
      this.model.set("webSite", $.trim(this.$(".js-profile-website").val()));
      this.model.set("gender", f);
      return this.model.save().done(function() {
        return window.utils.msg.notify(__("Профиль успешно сохранен"))
      }).error(function() {
          return window.utils.msg.notify(__("Не удалось сохранить профиль"))
        })
    };
    e.prototype.saveAccount = function() {
      var f;
      this.model.set("login", $.trim(this.$(".js-account-user-name").val()));
      this.model.set("email", $.trim(this.$(".js-account-email").val()));
      f = $.trim(this.$(".js-account-new-password").val());
      if (f.length) {
        this.model.set("password", md5(f))
      }
      return this.model.save().done(function() {
        return window.utils.msg.notify(__("Профиль успешно сохранен"))
      }).error(function() {
          return window.utils.msg.error(__("Не удалось сохранить профиль"))
        })
    };
    e.prototype.changeLocalization = function(g) {
      var f;
      f = $(g.target);
      this.model.set("lang", f.find(":selected").val());
      return this.$(".select-input-labels-wd").attr("data-label", this.languages[this.model.get("lang")])
    };
    e.prototype.saveLocalization = function() {
      var f;
      f = $(".js-localization-select").find(":selected").val();
      $.cookie("lang", f, {path: "/",domain: "tracksflow.com"});
      return this.model.save().always(function() {
        return window.location.reload(true)
      })
    };
    e.prototype.toggleFacebook = function() {
      return this.toggleAccount("facebook")
    };
    e.prototype.toggleTwitter = function() {
      return this.toggleAccount("twitter")
    };
    e.prototype.toggleVk = function() {
      return this.toggleAccount("vkontakte")
    };
    e.prototype.toggleLastfm = function() {
      return this.toggleAccount("lastfm")
    };
    e.prototype.toggleAccount = function(g) {
      var h, f;
      h = this.model.getAccount(g);
      if (_.isEmpty(h)) {
        this.connectAccount(g)
      } else {
        f = _.reject(this.model.get("accounts"), function(k) {
          return k.type === h.type
        });
        this.model.set("accounts", f)
      }
      return this.model.save()
    };
    e.prototype.connectAccount = function(f) {
      switch (f) {
        case "lastfm":
          return this.connectLastFm();
        case "vkontakte":
          return this.connectVk()
      }
    };
    e.prototype.connectLastFm = function() {
      return window.location.href = "http://www.lastfm.ru/api/auth?api_key=" + window.resources.LastFM.API_KEY + "&cb=" + encodeURIComponent(window.location.href + "?type=lastfm")
    };
    e.prototype.connectVk = function() {
      return window.utils.connectVk()
    };
    e.prototype.togglePlaylistLastfm = function() {
      this.model.getAccount("lastfm")["generatePlaylist"] = this.$(".js-lastfm-playlist").prop("checked");
      return this.model.save()
    };
    e.prototype.toggleScrobbleLastfm = function() {
      this.model.getAccount("lastfm")["scrobble"] = this.$(".js-lastfm-scrobble").prop("checked");
      return this.model.save()
    };
    e.prototype.saveNoties = function() {
      this.model.set("notifySubscribers", !!this.$(".js-noty-notifySubscribers").attr("checked"));
      this.model.set("notifyPlaylistSubscribers", !!this.$(".js-noty-notifyPlaylistSubscribers").attr("checked"));
      this.model.set("notifyWallMessageLike", !!this.$(".js-noty-notifyWallMessageLike").attr("checked"));
      this.model.set("notifyWallMessageComment", !!this.$(".js-noty-notifyWallMessageComment").attr("checked"));
      this.model.set("notifyPlaylistComment", !!this.$(".js-noty-notifyPlaylistComment").attr("checked"));
      this.model.set("notifyAlbumComment", !!this.$(".js-noty-notifyAlbumComment").attr("checked"));
      this.model.set("notifyArtistComment", !!this.$(".js-noty-notifyArtistComment").attr("checked"));
      this.model.set("notifyPlaylistNewTracks", !!this.$(".js-noty-notifyPlaylistNewTracks").attr("checked"));
      return this.model.save().done(function() {
        return window.utils.msg.notify(__("Настройки успешно сохранены"))
      }).error(function() {
          return window.utils.msg.notify(__("Не удалось сохранить настройки нотификации"))
        })
    };
    return e
  })(window.classes.page.PageBase);
  window.classes.page.SettingsPage = c
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.type = "MainPage";
    d.prototype.ENTER_CODE = 13;
    d.prototype.events = {"keyup .js-search": "onKeySearch"};
    d.prototype.initialize = function() {
      this.model = new window.classes.model.mainPageModel();
      this.topArtists = new window.classes.view.artistCardsView({collection: this.model.artists});
      this.topAlbums = new window.classes.view.releaseCardsView({collection: this.model.albums});
      this.topPlaylists = new window.classes.view.playlistsView({collection: this.model.playlists});
      this.topTracks = new window.classes.view.trackListView({collection: this.model.tracks});
      return this.topPost = new window.classes.view.postInfoView({model: this.model.post})
    };
    d.prototype.start = function() {
      return this.jqxhr = this.model.fetch({success: _.bind(function(f) {
        return this.render()
      }, this)})
    };
    d.prototype.render = function() {
      var f;
      this.template = _.template($("#main-page-template").html());
      this.$el.html(this.template({model: this.model}));
      f = $(".main-page-slider ul").bxSlider({mode: "horizontal",pager: false,nextSelector: "#next-btn-m",prevSelector: "#prev-btn-m",nextText: "",prevText: ""});
      this.topArtists.setElement(this.$(".js-top-artists").addClass(this.topArtists.className));
      this.topArtists.render();
      this.topAlbums.setElement(this.$(".js-top-albums").addClass(this.topAlbums.className));
      this.topAlbums.render();
      this.topPlaylists.setElement(this.$(".js-top-playlists").addClass(this.topPlaylists.className));
      this.topPlaylists.render();
      this.topTracks.setElement(this.$(".js-top-tracks").addClass(this.topTracks.className));
      this.topTracks.render();
      this.topPost.setElement(this.$(".js-top-post").addClass(this.topPost.className));
      this.topPost.render();
      this._listenToMasonry();
      this.$(".js-banners").masonry({itemSelector: ".main-page-banner-t",isAnimated: true,isFitWidth: true});
      this.$(".js-weekly-best-cards-container").masonry({itemSelector: ".flat-card-t",isAnimated: true,isFitWidth: true});
      this._resizeToMasonryWidth();
      return this
    };
    d.prototype._listenToMasonry = function() {
      var f = this;
      return this.$(".js-weekly-best-cards-container").resize(function() {
        return f._resizeToMasonryWidth()
      })
    };
    d.prototype._resizeToMasonryWidth = function() {
      var h, f, g;
      h = this.$(".js-weekly-best-cards-container");
      f = this.$(".js-top-tracks-and-post-w");
      g = h.width() - parseInt(h.find(".flat-card-t").first().css("margin-left"), 10);
      return f.width(g)
    };
    d.prototype.onKeySearch = function(g) {
      var f;
      if (g.keyCode === this.ENTER_CODE) {
        f = this.$(".js-search").val();
        return window.router.navigate("search/" + window.utils.linkBeautify(f), {trigger: true})
      }
    };
    d.prototype.teardown = function() {
      var f;
      if ((f = this.jqxhr) != null) {
        f.abort()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.page.PageBase);
  window.classes.page.mainPage = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "";
    e.prototype.pageSize = 30;
    e.prototype.initialize = function(f) {
      this.model = new window.classes.model.selectionModel({selectionId: f.id});
      return this
    };
    e.prototype.start = function() {
      return this.jqxhr = this.model.fetch({success: _.bind(function(f) {
        this.trackList = new window.classes.view.trackListView({collection: this.model.tracks});
        this.artistList = new window.classes.view.artistCardsView({collection: this.model.artists});
        this.albumList = new window.classes.view.releaseCardsView({collection: this.model.albums});
        this.playlistList = new window.classes.view.playlistsView({collection: this.model.playlists});
        return this.render()
      }, this)})
    };
    e.prototype.render = function() {
      this.template = _.template($("#selection-template").html());
      this.$el.html(this.template({model: this.model}));
      if (!_.isEmpty(this.trackList.collection)) {
        this.trackList.setElement(this.$(".js_trackList"));
        this.trackList.render()
      }
      if (!_.isEmpty(this.artistList.collection)) {
        this.artistList.setElement(this.$(".js_artistList"));
        this.artistList.render()
      }
      if (!_.isEmpty(this.albumList.collection)) {
        this.albumList.setElement(this.$(".js_albumList"));
        this.albumList.render({headerText: __("Альбомы"),iconType: "album-icon"})
      }
      if (!_.isEmpty(this.playlistList.collection)) {
        this.playlistList.render();
        this.$(".js_playlistList").html(this.playlistList.el)
      }
      return this
    };
    e.prototype.teardown = function() {
      var f;
      if ((f = this.jqxhr) != null) {
        f.abort()
      }
      this.off();
      this.undelegateEvents();
      return this
    };
    return e
  })(window.classes.page.PageBase);
  window.classes.page.selectionPage = c
}).call(this);
(function() {
  var b, a = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  b = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.events = {"click .js-create-account": "createAccount","click .js-log-in": "logIn","click .js-try": "tryWithNoAccount","click .js-try": "tryWithNoAccount","click .js-ru": "setRussian","click .js-en": "setEnglish",scroll: "scroll"};
    d.prototype.initialize = function() {
      this.model = new window.classes.model.mainPageModel();
      this.template = _.template($("#main-once-page-template").html());
      this.resScript = $("#resourcesScript");
      return this.setPageVisited()
    };
    d.prototype.setPageVisited = function() {
      if (window.models.currentUser.id) {
        window.models.currentUser.set("mainVisited", true);
        return window.models.currentUser.save()
      }
    };
    d.prototype.start = function() {
      var f = this;
      this.render();
      $(document.body).css({"overflow-y": "hidden"});
      return this.model.fetch().then(function() {
        return f.renderLogo()
      })
    };
    d.prototype.render = function() {
      this.$el.html(this.template());
      $(document.body).prepend(this.$el);
      this.renderLogo();
      this.$containers = $(".main-demo-page-l .section-ll");
      this.$w = $(window);
      this.allowScroll = true;
      this.lastScrollTop = 0;
      this.$bh = this.$(".main-demo-page-l");
      return this.pageI = 0
    };
    d.prototype.renderLogo = function() {
      var h, f, k, g;
      h = this.model.albums.toJSON();
      g = h.slice(0, 6);
      f = h.slice(6, 11);
      k = h.slice(11, 18);
      this.renderLogoPart(g, ".js-six-albums");
      this.renderLogoPart(f, ".js-five-albums");
      this.renderLogoPart(k, ".js-seven-albums");
      return this.fadeImages()
    };
    d.prototype.renderLogoPart = function(h, f) {
      var g;
      g = new window.classes.view.mainPageAlbums({collection: new window.classes.collection.releasesCollection(h)});
      g.render();
      return this.$(f).html(g.$el.html())
    };
    d.prototype.fadeImages = function() {
      return $(".logo-mdl img").each(function() {
        return $(this).on("load", function() {
          return $(this).fadeIn(800)
        })
      })
    };
    d.prototype.setRussian = function() {
      return window.resources.LANG !== "ru" && this.changeLanguage("ru")
    };
    d.prototype.setEnglish = function() {
      return window.resources.LANG !== "en" && this.changeLanguage("en")
    };
    d.prototype.changeLanguage = function(f) {
      window.resources.LANG = f;
      $("#lang-dic").remove();
      this.resScript.after('<script id="lang-dic" type="text/javascript" src="/i18n/js/all-' + window.resources.LANG + ".js?v=" + window.tfVersion + '"><\/script>');
      return this.render()
    };
    d.prototype.createAccount = function() {
      var f = this;
      return new window.classes.view.CreateAccoutModal({success: function() {
        return f.tryWithNoAccount()
      }})
    };
    d.prototype.logIn = function() {
      var f = this;
      return new window.classes.view.LogInModal({success: function() {
        return f.tryWithNoAccount()
      }})
    };
    d.prototype.tryWithNoAccount = function() {
      if (window.models.currentUser.id) {
        window.router.navigate("/flow", {trigger: true})
      } else {
        window.router.navigate("/home", {trigger: true})
      }
      return this.$el.fadeOut(800, function() {
        return $(document.body).css({"overflow-y": "auto"})
      })
    };
    d.prototype.scroll = function() {
      if (!this.allowScroll) {
        return false
      }
      this.$bh.stop();
      if (this.$bh.scrollTop() < this.$w.outerHeight() * 4 || this.$bh.scrollTop() > this.$w.outerHeight() * 4 + this.$containers.eq(4).outerHeight() - this.$w.outerWidth() / 8) {
        if (this.$bh.scrollTop() > this.lastScrollTop) {
          return this.findNearest(false, true)
        } else {
          return this.findNearest(true, false)
        }
      }
    };
    d.prototype.listenToScroll = function() {
      return this.$bh.scroll($.debounce(100, _.bind(this.scroll, this)))
    };
    d.prototype.findNearest = function(h, o, m) {
      var k, f, p, g, l, n;
      if (h == null) {
        h = false
      }
      if (o == null) {
        o = false
      }
      if (m == null) {
        m = 1.3
      }
      h = h ? this.$w.outerHeight() / m : 0;
      o = o ? this.$w.outerHeight() / m : 0;
      g = this.findPrev();
      k = this.findNext();
      n = (g != null ? g.offset().top : void 0) || 0;
      p = (k != null ? k.offset().top : void 0) || 0;
      l = Math.abs(n) - h;
      f = Math.abs(p) - o;
      if (l < f) {
        return this.scrollTo(n)
      } else {
        return this.scrollTo(p)
      }
    };
    d.prototype.findPrev = function() {
      var f, h, g;
      for (f = h = g = this.$containers.length - 1; g <= 0 ? h <= 0 : h >= 0; f = g <= 0 ? ++h : --h) {
        if (this.$containers.eq(f).offset().top < 0) {
          return this.$containers.eq(f)
        }
      }
    };
    d.prototype.findNext = function() {
      var f, h, g;
      for (f = h = 0, g = this.$containers.length; 0 <= g ? h < g : h > g; f = 0 <= g ? ++h : --h) {
        if (this.$containers.eq(f).offset().top > 0) {
          return this.$containers.eq(f)
        }
      }
    };
    d.prototype.scrollTo = function(f) {
      var g = this;
      this.allowScroll = false;
      return this.$bh.stop().animate({scrollTop: this.$bh.scrollTop() + f}, 600, function() {
        return setTimeout(function() {
          g.allowScroll = true;
          return g.lastScrollTop = g.$bh.scrollTop()
        }, 200)
      })
    };
    d.prototype.teardown = function() {
      this.off();
      this.undelegateEvents();
      return this
    };
    return d
  })(window.classes.page.PageBase);
  window.classes.page.mainOncePage = b
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.className = "";
    e.prototype.initialize = function(f) {
      this.template = _.template($("#terms-template").html());
      return this
    };
    e.prototype.start = function() {
      this.render();
      return this
    };
    e.prototype.render = function() {
      this.$el.html(this.template());
      console.log(this.$el[0]);
      return this
    };
    e.prototype.teardown = function() {
      return this
    };
    return e
  })(window.classes.page.PageBase);
  window.classes.page.termsPage = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.render = function(f) {
      if (f == null) {
        f = 500
      }
      this.template = _.template($("#error-page-template").html());
      return this.$el.html(this.template({code: f}))
    };
    return e
  })(window.classes.page.PageBase);
  window.classes.page.ErrorPage = c
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.processCollection = function(f) {
      return _.clone(f)
    };
    return d
  })(Backbone.Model);
  window.classes.model.TrackListMapper = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.processCollection = function(f) {
      var g;
      g = _.map(f.models, function(h) {
        return h.track
      });
      return new window.classes.collection.tracksCollection(g)
    };
    return d
  })(Backbone.Model);
  window.classes.model.TickerMapper = c
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.processCollection = function(f) {
      var g;
      g = _.map(f.models, function(h) {
        return h.tracks.models
      });
      g = _.flatten(g);
      return new window.classes.collection.tracksCollection(g)
    };
    d.prototype.processModel = function(h, g) {
      var f;
      f = h.tracks.toJSON();
      if (g) {
        f = _.shuffle(f)
      }
      return f
    };
    return d
  })(Backbone.Model);
  window.classes.model.FlowMapper = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.processCollection = function(f) {
      var g;
      g = _.map(f.models, function(h) {
        return h.track
      });
      return new window.classes.collection.tracksCollection(g)
    };
    return e
  })(Backbone.Model);
  window.classes.model.PlaylistMapper = c
}).call(this);
(function() {
  var a, c, b;
  b = window.resources.__;
  c = (function() {
    var d;
    d = void 0;
    if (localStorage !== undefined) {
      d = {type: "localStorage",get: function(e) {
        if (localStorage.getItem(e)) {
          return JSON.parse(localStorage.getItem(e))
        } else {
          return ""
        }
      },set: function(e, f) {
        return localStorage.setItem(e, JSON.stringify(f))
      }}
    } else {
      d = {type: "cookie",get: function(e) {
        if ($.cookie(e)) {
          return JSON.parse($.cookie(e))
        } else {
          return ""
        }
      },set: function(e, f) {
        return $.cookie(e, JSON.stringify(f))
      }}
    }
    return d
  })();
  a = Backbone.Model.extend({defaults: {player: {volume: 0.7},closedTrackPos: 0,closedTime: 0,closedTabId: 0,tabId: (function() {
    var e;
    e = new Date;
    return e.getTime()
  })(),flow: {}},initialize: function() {
    this.load();
    this.on("change", this.save, this);
    $(window).on("beforeunload", _.bind(this.save, this, true));
    return this.updatePlayingTab()
  },updatePlayingTab: function() {
    var d, e;
    d = this.get("playingTabId");
    e = c.get("playingTabId");
    if (e && e !== d) {
      this.set("playingTabId", e)
    }
    return setTimeout(_.bind(this.updatePlayingTab, this), 1000)
  },load: function() {
    _.each(this.defaults, function(d, e) {
      return this.set(e, c.get(e) || d)
    }, this);
    return this.loadTicker()
  },save: function(e) {
    var f, g;
    f = this.changedAttributes();
    this.savePlayerState(e);
    this.savePlayingTab(f);
    if (e === true) {
      g = new Date;
      c.set("closedTime", g.getTime());
      if (window.player && window.player.engine && window.player.engine.plugin && window.player.engine.plugin.currentTime) {
        c.set("closedTrackPos", window.player.getTime())
      }
      return c.set("closedTabId", this.get("tabId"))
    }
  },savePlayingTab: function(d) {
    if (d.playingTabId) {
      return c.set("playingTabId", d.playingTabId)
    }
  },loadTicker: function() {
    return this.set("tickerIsOpen", c.get("tickerIsOpen"))
  },saveTicker: function(d) {
    this.set("tickerIsOpen", d);
    return c.set("tickerIsOpen", d)
  },savePlayerState: function(l) {
    var n, m, k, h, g, f, e, d;
    if (l == null) {
      l = false
    }
    if (_.isEmpty(window.player)) {
      return
    }
    if (window.player.get("originalCollection") instanceof window.classes.collection.LikeList) {
      n = "classes.collection.LikeList"
    } else {
      if (window.player.get("originalCollection") instanceof window.classes.collection.flowCollection) {
        n = "classes.collection.flowCollection"
      } else {
        if (window.player.get("originalCollection") instanceof window.classes.collection.PlaylistItemsCollection) {
          n = "classes.collection.PlaylistItemsCollection"
        } else {
          n = "classes.collection.tracksCollection"
        }
      }
    }
    if (l) {
      window.player.get("current").unset("link", {silent: true});
      window.player.get("current").unset("source", {silent: true})
    }
    m = {classOriginalCollection: n,nowPlayingTarget: (k = window.player.get("nowPlayingTarget")) != null ? k : null,originalCollection: (h = window.player.get("originalCollection")) != null ? h : null,collection: (g = window.player.get("collection")) != null ? g : null,unshuffled: (f = window.player.get("unshuffled")) != null ? f : null,currentIndex: (e = window.player.get("currentIndex")) != null ? e : null,current: (d = window.player.get("current")) != null ? d : null,state: window.player.get("current").get("state"),volume: window.player.get("volume"),repeat: window.player.get("repeat"),shuffle: window.player.get("shuffle"),currentTime: window.player.get("current").get("currentTime")};
    return c.set("player", m)
  }});
  window.models.state = new a()
}).call(this);
(function() {
  var a, b = {}.hasOwnProperty, c = function(g, e) {
    for (var d in e) {
      if (b.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  a = (function(e) {
    c(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.initialize = function() {
      return this.model.on("change", this.render, this)
    };
    d.prototype.render = function() {
      this.template = _.template($("#playerTrack-template").html());
      this.$el.html(this.template({model: this.model}));
      return this
    };
    return d
  })(Backbone.View);
  window.classes.view.PlayerTrack = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.events = {"click .player-controls .js-play": "playPause","click .player-controls .js-rewind": "prevTrack","click .player-controls .js-forward": "nextTrack","click .player-controls .js-like": "onClickLike","click .progressbar .seekbar": "onClickSeek","mouseup .volume .seekbar": "onUpVolumeSeek","mousedown .volume .seekbar": "onDownVolumeSeek","mousemove .volume .seekbar": "onMoveVolumeSeek","mouseleave .volume .seekbar": "onLeaveVolumeSeek","click .js-sound-btn": "onClickVolume","click .js-shuffle-btn": "onClickShuffle","click .js-repeat-btn": "onClickRepeat"};
    e.prototype.initialize = function() {
      this.playerTrackView = new window.classes.view.PlayerTrack({model: this.model.get("current")});
      window.player.on("change:current", this.renderPlayerTrack, this);
      window.player.on("trackFound", this.renderPlayerTrack, this);
      window.player.on("timeProgress", this.updateProgressSeek, this);
      window.player.on("loadProgress", this.updateLoadingSeek, this);
      window.player.get("current").on("change", this.renderPlayerTrack, this);
      window.player.get("current").on("change:state", this.onChangeStateTrack, this);
      window.player.on("change:volume", this.updateVolume, this);
      window.player.on("change:shuffle", this.updateShuffle, this);
      window.player.on("change:repeat", this.updateRepeat, this);
      this.seekHandler = this.$(".progressbar-handle");
      this.seekbar = this.$(".progressbar .seekbar");
      this.seekContainer = this.$(".progressbar .seek-container");
      this.seekprogress = this.$(".progressbar .progress");
      this.seekloaded = this.$(".progressbar .preload");
      this.volSeekbar = this.$(".volume .seekbar");
      return this.bindDraggable()
    };
    e.prototype.renderPlayerTrack = function() {
      this.$el.toggleClass("empty", !this.model.get("current").has("trackName"));
      this.$(".js-player-track").html(this.playerTrackView.render().$el);
      return this.updateTrackInfo()
    };
    e.prototype.bindDraggable = function() {
      var f;
      this.dragging = false;
      f = this;
      return this.seekHandler.draggable({containment: [24, 0, 158, 0],axis: "x",cursorAt: {left: 11},start: function() {
        return f.dragging = true
      },drag: function(l, m) {
        var h, g, k;
        g = f.seekContainer.outerWidth();
        h = m.position.left / g;
        k = h * 100;
        f.seekprogress.css({width: k + "%"});
        f.$(".js-current-time").text(window.player.getTimeElapsed(h));
        return f._updateTextPos()
      },stop: function(k, l) {
        var h, g;
        g = f.seekContainer.outerWidth();
        h = l.position.left / g;
        window.player.setTime(h);
        f.dragging = false;
        return this
      }})
    };
    e.prototype.onClickLike = function() {
      if (!window.models.currentUser.id) {
        new window.classes.view.noAuthModal;
        return
      }
      return this.model.get("current").toggleLike()
    };
    e.prototype.playPause = function() {
      var f;
      f = window.player.get("current");
      if (f.isPlaying()) {
        return window.player.pause()
      } else {
        return window.player.startPlay(f, window.player.engine.get("currentTime"), true)
      }
    };
    e.prototype.prevTrack = function() {
      return window.player.prev()
    };
    e.prototype.nextTrack = function() {
      return window.player.next()
    };
    e.prototype.onClickSeek = function(g) {
      var f;
      f = (g.offsetX - this.seekHandler.outerWidth() / 2) / this.seekContainer.outerWidth();
      return window.player.setTime(f)
    };
    e.prototype.changeVolumeByEvent = function(h) {
      var g, f;
      f = h.offsetX ? h.offsetX : h.originalEvent.layerX;
      g = f / this.volSeekbar.outerWidth();
      if (g >= 1) {
        return
      }
      if (g <= 0) {
        return
      }
      return window.player.setVolume(g)
    };
    e.prototype.onUpVolumeSeek = function(f) {
      this.changeVolumeByEvent(f);
      return this.dragged = false
    };
    e.prototype.onDownVolumeSeek = function(f) {
      this.dragged = true;
      this.onMoveVolumeSeek(f);
      return $(window).one("mouseup", _.bind(this.onUpVolumeSeek, this))
    };
    e.prototype.onLeaveVolumeSeek = function(f) {
      return this.onMoveVolumeSeek(f)
    };
    e.prototype.onMoveVolumeSeek = function(f) {
      if (this.dragged) {
        return this.changeVolumeByEvent(f)
      }
    };
    e.prototype.onClickVolume = function() {
      var f;
      f = window.player.get("volume");
      if (f !== 0) {
        this.prevVolume = f;
        return window.player.setVolume(0)
      } else {
        return window.player.setVolume(this.prevVolume || 1)
      }
    };
    e.prototype.onClickShuffle = function() {
      return window.player.toggleShuffle()
    };
    e.prototype.onClickRepeat = function() {
      return window.player.toggleRepeat()
    };
    e.prototype._updateTextPos = function() {
      var h, q, o, n, l, k, m, f, p, g;
      l = this.$(".progressbar .text").width() / 2;
      n = this.seekHandler.width() / 2;
      f = this.seekbar.offset().left;
      m = this.seekHandler.offset().left;
      g = f + this.seekbar.width();
      h = l - n;
      o = m + n + l;
      q = m + n - l;
      if (q <= f) {
        k = m - f;
        return this.$(".progressbar .text").css({left: -k,right: "auto"})
      } else {
        if (o >= g) {
          p = (m + this.seekHandler.width()) - (f + this.seekbar.width());
          return this.$(".progressbar .text").css({left: "auto",right: p})
        } else {
          return this.$(".progressbar .text").css({left: -h,right: "auto"})
        }
      }
    };
    e.prototype._upSeek = function(f) {
      this.seekHandler.css("left", f + "%");
      return this.seekprogress.width(f + "%")
    };
    e.prototype.updateProgressSeek = function() {
      var h, f, g;
      if (this.dragging) {
        return
      }
      f = window.player.getSeek();
      g = f * 100;
      this._upSeek(g);
      h = window.player.getTimeElapsed();
      this.$(".js-current-time").text(h);
      return this._updateTextPos()
    };
    e.prototype.updateLoadingSeek = function() {
      var f, g;
      f = window.player.getBuffer();
      g = f * 100;
      return this.seekloaded.width(g + "%")
    };
    e.prototype.updateVolume = function() {
      var f, g;
      f = window.player.get("volume");
      this.$(".js-sound-btn").toggleClass("sound-loud-icon", f > 0.6);
      this.$(".js-sound-btn").toggleClass("sound-middle-icon", f > 0 && f <= 0.6);
      this.$(".js-sound-btn").toggleClass("sound-mute-icon", f === 0);
      g = f * 100;
      return this.volSeekbar.find(".progress").width(g + "%")
    };
    e.prototype.updateShuffle = function() {
      return this.$(".js-shuffle-btn").toggleClass("is-check", window.player.get("shuffle" === true))
    };
    e.prototype.onChangeStateTrack = function() {
      var f;
      f = window.player.get("current");
      this.$(".js-play").removeClass("play-icon pause-icon");
      switch (window.player.get("current").get("state")) {
        case window.player.trackStates.PLAYING:
        case window.player.trackStates.SEARCHING:
          return this.$(".js-play").addClass("pause-icon");
        case window.player.trackStates.PAUSED:
          return this.$(".js-play").addClass("play-icon")
      }
    };
    e.prototype.updateRepeat = function() {
      this.$(".js-repeat-btn").toggleClass("is-check", window.player.get("repeat") === window.player.repeatStates.REPEAT || window.player.get("repeat") === window.player.repeatStates.ONLY_ONE);
      return this.$(".js-repeat-btn").toggleClass("repeat-one-icon", window.player.get("repeat") === window.player.repeatStates.ONLY_ONE)
    };
    e.prototype.updateTrackInfo = function() {
      this.$(".js-like").toggleClass("is-check", this.model.get("current").isLiked());
      return this.$(".js-duration").text(this.model.get("current").getTime())
    };
    return e
  })(Backbone.View);
  window.classes.view.Player = c
}).call(this);
(function() {
  $.prototype.tf_popup = function(a) {
    if (a == null) {
      a = {}
    }
    window.positionCore = {state: {tryPositionCount: 0},defaults: {position: "best",preferredPositions: null,delay: 800,offset: 10,showingTime: 200,showDelay: 400,style: "",reset: false,elClass: "",onShow: function() {
    },beforeShow: function() {
    },beforeHide: function() {
    },onHide: function() {
    },fadeInEffectDistance: 15,positionPriority: ["top", "bottom", "left", "right", "top_left", "top_right", "bottom_left", "bottom_right"],$window: $(window)},template: _.template($("#popup-template").html()),init: function(b) {
      positionCore.settings = $.extend({}, positionCore.defaults, b || {});
      if (positionCore.settings.preferredPositions) {
        _.each(positionCore.settings.preferredPositions, function(d, c) {
          return positionCore.settings.positionPriority[c] = d
        })
      }
      if ((b.$element.data().allowPopOnHover !== false) || (positionCore.settings.reset === true)) {
        positionCore.renderPopup(b);
        positionCore.showPopup(positionCore.settings);
        positionCore.settings.$element.addClass(positionCore.settings.elClass)
      }
      return b.$element
    },isPopupVisible: function() {
      return window.helpers.$popup
    },renderPopup: function() {
      var c, b;
      c = $(".popup-mdl.is-widget").remove();
      $(document.body).append(positionCore.template({options: {classes: positionCore.settings.classes}}));
      positionCore.settings.beforeHide();
      if ((b = window.helpers.$lastShownElement) != null) {
        b.data().allowPopOnHover = true
      }
      window.helpers.$popup = $(".popup-mdl.is-widget");
      return window.helpers.$popup.append(positionCore.settings.content)
    },showPopup: function(c) {
      var b, f, d, e;
      b = c.$element;
      if ((e = window.helpers.$lastShownElement) != null) {
        e.removeClass(positionCore.settings.elClass)
      }
      window.helpers.$popupOnElement = b;
      if (!(b.data().allowPopOnHover != null)) {
        b.data().allowPopOnHover = true
      }
      b.data().allowPopOnHover = false;
      positionCore.state.tryPositionCount = 0;
      f = b.parent();
      d = b.css("position");
      if (d === "static" || d === "relative") {
        d = "absolute"
      }
      window.helpers.$popup.css({position: d || "absolute"});
      positionCore.makePosition({$elem: b,position: this.settings.position,positionType: d,$parent: f});
      b.on("mouseenter", positionCore._stopPopupHideDelay);
      b.on("mouseleave", positionCore._startPopupHideDelay);
      window.helpers.$popup.on("mouseenter", positionCore._stopPopupHideDelay);
      return window.helpers.$popup.on("mouseleave", positionCore._startPopupHideDelay)
    },_stopPopupHideDelay: function(b) {
      return clearTimeout(window.helpers.popupHideTimer)
    },_startPopupHideDelay: function() {
      clearTimeout(window.helpers.popupHideTimer);
      return window.helpers.popupHideTimer = setTimeout(function() {
        return positionCore._hidePopup()
      }, positionCore.settings.delay)
    },_hidePopup: function() {
      var b;
      positionCore.settings.$element.removeClass(positionCore.settings.elClass);
      positionCore.settings.beforeHide();
      if ((b = window.helpers.$popupOnElement) != null) {
        b.data().allowPopOnHover = true
      }
      return window.helpers.$popup.stop(true, false).fadeOut(200, positionCore.settings.hoverOnHide, function() {
        return positionCore.settings.onHide()
      })
    },getNormalize: function(f, e) {
      var c, d, b;
      b = 0;
      c = 0;
      d = "";
      d = window.helpers.$popup.attr("class", "popup-mdl is-widget");
      b = window.helpers.$popup.outerWidth() - ((window.helpers.$popup.outerWidth() - window.helpers.$popup.width()) / 4);
      c = window.helpers.$popup.outerHeight() - ((window.helpers.$popup.outerHeight() - window.helpers.$popup.height()) / 4);
      return {normH: c,normW: b,normTipPop: d}
    },makePosition: function(e) {
      var b, d, c, f;
      f = window.helpers.$popup;
      if (e.positionType === "fixed") {
        b = e.$elem.offset().top - $(window).scrollTop()
      } else {
        b = e.$elem.offset().top
      }
      if (e.position !== "best") {
        positionCore._stopPopupHideDelay();
        window.helpers.$lastShownElement = e.$elem
      }
      switch (e.position) {
        case "left":
          c = positionCore.getNormalize(e.$elem, e.type);
          positionCore.settings.beforeShow();
          c.normTipPop.addClass("is-middle is-right " + positionCore.settings.style).css({top: b + (e.$elem.outerHeight() / 2) - (c.normH / 2) - 1,left: e.$elem.offset().left - positionCore.settings.offset - c.normW - positionCore.settings.fadeInEffectDistance}).stop(true, false).css({display: "inline-block",opacity: "0"}).animate({left: "+=" + positionCore.settings.fadeInEffectDistance,opacity: "1"}, positionCore.settings.showingTime, positionCore.settings.onShow);
          break;
        case "right":
          c = positionCore.getNormalize(e.$elem, e.type);
          positionCore.settings.beforeShow();
          c.normTipPop.addClass("is-middle is-left " + positionCore.settings.style).css({top: b + (e.$elem.outerHeight() / 2) - (c.normH / 2) - 1,left: e.$elem.offset().left + e.$elem.outerWidth() + positionCore.settings.offset + positionCore.settings.fadeInEffectDistance}).stop(true, false).css({display: "inline-block",opacity: "0"}).animate({left: "-=" + positionCore.settings.fadeInEffectDistance,opacity: "1"}, positionCore.settings.showingTime, positionCore.settings.onShow);
          break;
        case "top":
          c = positionCore.getNormalize(e.$elem, e.type);
          positionCore.settings.beforeShow();
          c.normTipPop.addClass("" + positionCore.settings.style).css({top: b - c.normH - positionCore.settings.offset - positionCore.settings.fadeInEffectDistance,left: e.$elem.offset().left + (e.$elem.outerWidth() / 2) - (c.normW / 2) - 2}).stop(true, false).css({display: "inline-block",opacity: "0"}).animate({top: "+=" + positionCore.settings.fadeInEffectDistance,opacity: "1"}, positionCore.settings.showingTime, positionCore.settings.onShow);
          break;
        case "top_left":
          c = positionCore.getNormalize(e.$elem, e.type);
          positionCore.settings.beforeShow();
          c.normTipPop.addClass("is-right " + positionCore.settings.style).css({top: b - c.normH - positionCore.settings.offset - positionCore.settings.fadeInEffectDistance,left: e.$elem.offset().left - f.outerWidth() + 32}).stop(true, false).css({display: "inline-block",opacity: "0"}).animate({top: "+=" + positionCore.settings.fadeInEffectDistance,opacity: "1"}, positionCore.settings.showingTime, positionCore.settings.onShow);
          break;
        case "top_right":
          c = positionCore.getNormalize(e.$elem, e.type);
          positionCore.settings.beforeShow();
          c.normTipPop.addClass("is-left " + positionCore.settings.style).css({top: b - c.normH - positionCore.settings.offset - positionCore.settings.fadeInEffectDistance,left: e.$elem.offset().left + e.$elem.outerWidth() - 32}).stop(true, false).css({display: "inline-block",opacity: "0"}).animate({top: "+=" + positionCore.settings.fadeInEffectDistance,opacity: "1"}, positionCore.settings.showingTime, positionCore.settings.onShow);
          break;
        case "bottom":
          c = positionCore.getNormalize(e.$elem, e.type);
          positionCore.settings.beforeShow();
          c.normTipPop.addClass("is-top " + positionCore.settings.style).css({top: b + e.$elem.outerHeight() + positionCore.settings.offset + positionCore.settings.fadeInEffectDistance,left: e.$elem.offset().left + (e.$elem.outerWidth() / 2) - (c.normW / 2) - 2}).stop(true, false).css({display: "inline-block",opacity: "0"}).animate({top: "-=" + positionCore.settings.fadeInEffectDistance,opacity: "1"}, positionCore.settings.showingTime, positionCore.settings.onShow);
          break;
        case "bottom_left":
          c = positionCore.getNormalize(e.$elem, e.type);
          positionCore.settings.beforeShow();
          c.normTipPop.addClass("is-top is-right " + positionCore.settings.style).css({top: b + e.$elem.outerHeight() + positionCore.settings.offset + positionCore.settings.fadeInEffectDistance,left: e.$elem.offset().left - f.outerWidth() + 20}).stop(true, false).css({display: "inline-block",opacity: "0"}).animate({top: "-=" + positionCore.settings.fadeInEffectDistance,opacity: "1"}, positionCore.settings.showingTime, positionCore.settings.onShow);
          break;
        case "bottom_right":
          c = positionCore.getNormalize(e.$elem, e.type);
          positionCore.settings.beforeShow();
          c.normTipPop.addClass("is-top is-left " + positionCore.settings.style).css({top: b + e.$elem.outerHeight() + positionCore.settings.offset + positionCore.settings.fadeInEffectDistance,left: e.$elem.offset().left + e.$elem.outerWidth() - 32}).stop(true, false).css({display: "inline-block",opacity: "0"}).animate({top: "-=" + positionCore.settings.fadeInEffectDistance,opacity: "1"}, positionCore.settings.showingTime, positionCore.settings.onShow);
          break;
        case "best":
          d = positionCore.state.tryPositionCount++;
          if (d < positionCore.settings.positionPriority.length) {
            positionCore.makePosition({$elem: e.$elem,position: positionCore.tryPosition[positionCore.settings.positionPriority[d]](e.$elem, e.type),positionType: e.positionType})
          } else {
            positionCore.makePosition({$elem: e.$elem,position: positionCore.settings.positionPriority[0],positionType: e.positionType})
          }
      }
      return e.$elem
    },tryPosition: {left: function(c, d) {
      var e, b;
      b = positionCore.getNormalize(c, d);
      e = positionCore.getGSidesY(c);
      if ((c.offset().left - b.normW - positionCore.settings.offset > positionCore.settings.$window.scrollLeft()) && (e.g_top > positionCore.settings.$window.scrollTop()) && (e.g_bottom < positionCore.settings.$window.scrollTop() + positionCore.settings.$window.outerHeight())) {
        return "left"
      } else {
        return "best"
      }
    },right: function(c, d) {
      var e, b;
      b = positionCore.getNormalize(c, d);
      e = positionCore.getGSidesY(c);
      if ((c.offset().left + c.outerWidth() + positionCore.settings.offset + b.normW < positionCore.settings.$window.scrollLeft() + positionCore.settings.$window.outerWidth()) && (e.g_top > positionCore.settings.$window.scrollTop()) && (e.g_bottom < positionCore.settings.$window.scrollTop() + positionCore.settings.$window.outerHeight())) {
        return "right"
      } else {
        return "best"
      }
    },top: function(e, c) {
      var d, b;
      b = positionCore.getNormalize(e, c);
      d = positionCore.getGSidesX(e);
      if ((e.offset().top - b.normH - positionCore.settings.offset - 4 > positionCore.settings.$window.scrollTop()) && (d.g_left > positionCore.settings.$window.scrollLeft()) && (d.g_right < positionCore.settings.$window.scrollLeft() + positionCore.settings.$window.outerWidth())) {
        return "top"
      } else {
        return "best"
      }
    },top_left: function(c, d) {
      var e, b;
      b = positionCore.getNormalize(c, d);
      e = positionCore.getGSidesX(c);
      if ((c.offset().top - b.normH - positionCore.settings.offset - 4 > positionCore.settings.$window.scrollTop()) && (c.offset().left - window.helpers.$popup.outerWidth() > positionCore.settings.$window.scrollLeft())) {
        return "top_left"
      } else {
        return "best"
      }
    },top_right: function(c, d) {
      var e, b;
      b = positionCore.getNormalize(c, d);
      e = positionCore.getGSidesX(c);
      if ((c.offset().top - b.normH - positionCore.settings.offset - 4 > positionCore.settings.$window.scrollTop()) && (c.offset().left + c.outerWidth() + window.helpers.$popup.outerWidth() > positionCore.settings.$window.scrollLeft())) {
        return "top_right"
      } else {
        return "best"
      }
    },bottom: function(e, c) {
      var d, b;
      b = positionCore.getNormalize(e, c);
      d = positionCore.getGSidesX(e);
      if (e.offset().top + e.outerHeight() + b.normH - 4 + positionCore.settings.offset < positionCore.settings.$window.scrollTop() + positionCore.settings.$window.outerHeight() && (d.g_left > positionCore.settings.$window.scrollLeft()) && (d.g_right < positionCore.settings.$window.scrollLeft() + positionCore.settings.$window.outerWidth())) {
        return "bottom"
      } else {
        return "best"
      }
    },bottom_left: function(b, c) {
      if ((b.offset().top + b.outerHeight() + positionCore.settings.offset + window.helpers.$popup.outerHeight()) < (positionCore.settings.$window.scrollTop() + positionCore.settings.$window.outerHeight()) && (b.offset().left - window.helpers.$popup.outerWidth() > positionCore.settings.$window.scrollLeft())) {
        return "bottom_left"
      } else {
        return "best"
      }
    },bottom_right: function(b, c) {
      if ((b.offset().top + b.outerHeight() + positionCore.settings.offset + window.helpers.$popup.outerHeight()) < (positionCore.settings.$window.scrollTop() + positionCore.settings.$window.outerHeight()) && (b.offset().left + b.outerWidth() + window.helpers.$popup.outerWidth() - 32 < positionCore.settings.$window.scrollLeft() + positionCore.settings.$window.outerWidth())) {
        return "bottom_right"
      } else {
        return "best"
      }
    }},getGSidesX: function(d) {
      var c, b;
      b = window.helpers.$popup.outerWidth() > d.outerWidth() ? d.offset().left + d.outerWidth() + (Math.abs(d.outerWidth() - window.helpers.$popup.outerWidth()) / 2) : d.offset().left + d.outerWidth();
      c = window.helpers.$popup.outerWidth() > d.outerWidth() ? d.offset().left - (Math.abs(d.outerWidth() - window.helpers.$popup.outerWidth()) / 2) : d.offset().left;
      return {g_right: b,g_left: c}
    },getGSidesY: function(d) {
      var c, b;
      b = (d.offset().top + d.outerHeight() / 2) - (window.helpers.$popup.outerHeight() / 2);
      c = (d.offset().top + d.outerHeight() / 2) + (window.helpers.$popup.outerHeight() / 2);
      return {g_top: b,g_bottom: c}
    }};
    a.$element = $(this);
    return positionCore.init(a)
  };
  $.prototype.tf_popup_move = function(a) {
    if (a == null) {
      a = {}
    }
    if (!window.positionCore) {
      return
    }
    if (positionCore.isPopupVisible()) {
      a.$element = $(this);
      positionCore.settings = $.extend({}, positionCore.defaults, a || {});
      return positionCore.showPopup(positionCore.settings)
    }
  };
  $.prototype.tf_popup_hide = function() {
    if (!window.positionCore) {
      return
    }
    return positionCore._hidePopup()
  }
}).call(this);
(function() {
  window.helpers.tf_showMoreContainer = function(b) {
    var a;
    a = {initialize: function(c) {
      var d = this;
      this.options = c;
      this.listenToMasonry(c.masonryContainer, c.showMoreButton);
      c.masonryContainer.masonry({itemSelector: c.masonrySelector,isAnimated: true,isFitWidth: true});
      return c.showMoreButton.on("click", function(f) {
        c.showMoreButton.toggleClass("is-opened");
        c.masonryContainer.toggleClass("clear-max-height-gm-i");
        f.preventDefault();
        return false
      })
    },listenToMasonry: function(d, c) {
      var e = this;
      return d.on("masonry:complete", function() {
        var f;
        f = d.data().masonry;
        if (f.cols < f.$bricks.length) {
          return c.show()
        } else {
          return c.hide()
        }
      })
    }};
    return a.initialize(b)
  }
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.SCROBBLE_TIME = 240;
    d.prototype.initialize = function(f) {
      return d.__super__.initialize.call(this, f)
    };
    d.prototype.getCurrentTime = function() {
      return window.player.getTimeElapsed()
    };
    return d
  })(window.classes.model.trackModel);
  window.classes.model.PlayerTrack = c
}).call(this);
(function() {
  var a, b;
  b = window.resources.__;
  a = Backbone.Model.extend({init: false,initialize: function(d) {
    var c;
    c = this;
    return this.el = $("#audioplayer").mediaelementplayer({startVolume: window.models.state.get("player").volume,features: [],mode: /chromium/.test(navigator.userAgent.toLowerCase()) ? "shim" : "auto",pluginPath: "/js/lib/mediaelement/",isVideo: false,keyActions: [],success: function(e, f) {
      c.plugin = e;
      c.bindEvents(c.plugin);
      c.plugin.load();
      c.plugin.pause();
      return c.trigger("success")
    },error: function(f) {
      return console.error("player init error: ", f)
    }})
  },bindEvents: function(c) {
    c.addEventListener("timeupdate", _.bind(this.timeUpdate, this));
    c.addEventListener("ended", _.bind(this.endPlay, this));
    c.addEventListener("error", _.bind(this.error, this));
    c.addEventListener("loadedmetadata", _.bind(this.loadedMetaData, this));
    c.addEventListener("progress", _.bind(this.progress, this));
    return c.addEventListener("canplay", _.bind(this.canPlay, this))
  },timeUpdate: function() {
    return this.set({currentTime: this.plugin.currentTime})
  },progress: function(d) {
    var c;
    if (!this.plugin.buffered.length) {
      return
    }
    c = this.plugin.buffered.end(0);
    return this.set({bufferTime: c})
  },setTime: function(c) {
    var d;
    d = (c > 1 ? c : this.get("duration") * c);
    return this.plugin && this.plugin.setCurrentTime && this.plugin.setCurrentTime(d)
  },getTime: function() {
    return this.plugin && this.plugin.currentTime && this.plugin.currentTime.toFixed(3)
  },endPlay: function() {
    return this.trigger("endPlay")
  },error: function() {
    var c;
    c = this;
    return _.throttle(function() {
      return c.trigger("error")
    }, 500)()
  },loadedMetaData: function(c) {
    return this.set("duration", this.plugin.duration)
  },canPlay: function() {
    return this.trigger("canPlay")
  },setSrc: function(c) {
    this.plugin.pause();
    this.plugin.setSrc(c);
    this.set("src", c);
    return this.plugin.load()
  },play: function() {
    return this.plugin.play()
  },pause: function() {
    return this.plugin && this.plugin.pause && this.plugin.pause()
  },resume: function() {
    return this.plugin.play()
  },stop: function() {
    if (!this.init) {
      return
    }
    if (this.plugin.pluginType === "native") {
      this.plugin.removeAttribute("src");
      this.plugin.load()
    } else {
      this.plugin.pause();
      this.plugin.setSrc("")
    }
    return this.set({duration: 0,currentTime: 0})
  },setVolume: function(c) {
    return this.plugin.setVolume(c)
  }});
  $(function() {
    return window.models.audioEngine = new a()
  })
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.SCROBBLE_TIME = 240;
    e.prototype.trackStates = {PAUSED: 0,PLAYING: 1,SEARCHING: 2};
    e.prototype.repeatStates = {NO_REPEAT: 0,REPEAT: 1,ONLY_ONE: 2};
    e.prototype.defaults = {state: 0,shuffle: false,repeat: 0,current: null,currentTime: 0,currentIndex: -1,originalCollection: null,collection: null};
    e.prototype.initialize = function() {
      var f;
      this.set("current", new window.classes.model.PlayerTrack());
      this.engine = this.get("engine");
      this.engine.on("change:currentTime", (function() {
        return this.trigger("timeProgress")
      }), this);
      this.engine.on("change:bufferTime", (function() {
        return this.trigger("loadProgress")
      }), this);
      this.engine.on("endPlay", this.next, this);
      this.on("change:shuffle", this.onChangeShuffle, this);
      _.delay(_.bind(this.restoreState, this), 1500);
      this.get("current").on("change", function() {
        window.models.state.save();
        if (this.get("state") === this.trackStates.PLAYING) {
          return window.models.state.set("playingTabId", window.models.state.get("tabId"))
        }
      }, this);
      return (f = window.models.state) != null ? f.on("change:playingTabId", this.checkPlayingTab, this) : void 0
    };
    e.prototype.checkPlayingTab = function() {
      var f;
      f = window.models.state.get("playingTabId");
      if (f && f !== window.models.state.get("tabId")) {
        return this.pause()
      }
    };
    e.prototype.restoreState = function() {
      var h, l, m, o, n, k, f, g;
      if (!window.models.state) {
        return
      }
      g = window.models.state.get("player");
      l = window.models.state.get("closedTime");
      h = moment(l);
      k = moment();
      o = k.diff(h, "minutes");
      if (o >= 7) {
        return
      }
      this.get("current").set(g.current);
      this.get("current").set("state", g.state);
      n = g.classOriginalCollection.split(".");
      f = window[n[0]][n[1]][n[2]];
      if (!g.collection) {
        return
      }
      window.player.set("originalCollection", new f(g.originalCollection));
      window.player.set("collection", new window.classes.collection.tracksCollection(g.collection));
      window.player.set("currentIndex", g.currentIndex);
      window.player.set("nowPlayingTarget", g.nowPlayingTarget);
      if (g.unshuffled) {
        window.player.set("collection", new window.classes.collection.tracksCollection(g.unshuffled));
        window.player.set("unshuffled", new window.classes.collection.tracksCollection(g.unshuffled))
      } else {
        window.player.set("unshuffled", new window.classes.collection.tracksCollection(g.collection))
      }
      if (window.models.state.get("closedTrackPos") !== this.get("currentTime")) {
        m = window.models.state.get("closedTrackPos")
      }
      this.set("shuffle", g.shuffle);
      this.set("repeat", g.repeat);
      window.player.setVolume(g.volume);
      if (!window.player.get("volume") || !g.volume) {
        window.player.setVolume(0.7)
      }
      return window.player.getLink(this.get("current"), {success: _.bind(function() {
        return this.startPlay(this.get("current"), m)
      }, this)})
    };
    e.prototype.tryPlay = function(h, g) {
      var k, f;
      if (g == null) {
        g = 0
      }
      this.tryStopPrevTrack();
      this.fillDataFor(h);
      f = this.getCurrentTrack();
      f.set("state", window.player.trackStates.SEARCHING);
      window.models.syncManager.trigger(f.getSyncLocalId(), {state: window.player.trackStates.SEARCHING,debug: "tryPlay"});
      k = this.get("current").clear();
      k.set(f.toJSON());
      if (this.get("shuffle")) {
        this.setShuffleCollection(0)
      }
      return this.getLink(f, {success: _.bind(function(l) {
        if (!l.getUrl()) {
          this.onErrorSearchTrack("Not found Link");
          return
        }
        this.get("current").set(l.toJSON());
        this.get("current").set({state: window.player.trackStates.PLAYING});
        this.get("current").set({link: l.getUrl()});
        return this.startPlay(this.get("current"), g)
      }, this),error: _.bind(function(l) {
        console.log(l, "error catch");
        return this.onErrorSearchTrack(l)
      }, this)})
    };
    e.prototype.tryPlayTrack = function(f) {
      f.set("state", window.player.trackStates.SEARCHING);
      window.models.syncManager.trigger(f.getSyncLocalId(), {state: window.player.trackStates.SEARCHING});
      return this.getLink(f, {success: _.bind(function(g) {
        if (!g.getUrl()) {
          this.onErrorSearchTrack("Not found Link");
          return
        }
        this.get("current").set(g.toJSON());
        this.get("current").set("state", window.player.trackStates.PLAYING);
        return this.startPlay(this.get("current"))
      }, this),error: _.bind(function(g) {
        return this.onErrorSearchTrack(g)
      }, this)})
    };
    e.prototype.tryPlayByIndex = function(g) {
      var f;
      f = this.get("collection").at(g);
      return this.tryPlayTrack(f)
    };
    e.prototype.tryStopPrevTrack = function() {
      if (!this.get("collection")) {
        return
      }
      return this.get("collection").each(function(f) {
        if (f.get("state") === this.trackStates.SEARCHING || f.get("state") === this.trackStates.PLAYING) {
          return window.models.syncManager.trigger(f.getSyncLocalId(), {state: this.trackStates.PAUSED})
        }
      }, this)
    };
    e.prototype.getCurrentTrack = function() {
      if (this.get("currentIndex") < 0) {
        return
      }
      if (!this.get("collection")) {
        return
      }
      this.checkLazyLoad();
      return this.get("collection").at(this.get("currentIndex"))
    };
    e.prototype.hasCurrentTrack = function() {
      if (this.get("currentIndex") < 0) {
        return false
      }
      if (!this.get("collection")) {
        return false
      }
      return true
    };
    e.prototype.checkLazyLoad = function() {
      var k, g, f, h;
      k = this.get("collection").length - 1;
      if (this.get("currentIndex") === k && ((g = this.get("originalCollection")) != null ? (f = g.options) != null ? (h = f.data) != null ? h["for"] : void 0 : void 0 : void 0)) {
        return this.get("originalCollection").loadNextPage()
      }
    };
    e.prototype.fillDataFor = function(h) {
      var m, g, l, f, k;
      if ((k = h.collection) != null ? k.flow : void 0) {
        this.setCollection(h.collection.flow);
        m = this.get("collection").find(function(n) {
          return h.getSyncLocalId() === n.getSyncLocalId()
        });
        this.set("currentIndex", this.get("collection").indexOf(m));
        return
      }
      if (h.collection) {
        this.setCollection(h.collection);
        l = h.collection.indexOf(h);
        f = this.get("originalCollection").at(l);
        g = this.get("collection").getIndexByLocalId(f.getSyncLocalId());
        this.set("currentIndex", g)
      }
      return this.set("nowPlayingTarget", h.collection.nowPlayingTarget)
    };
    e.prototype.startPlay = function(f, g, h) {
      if (g == null) {
        g = 0
      }
      if (h == null) {
        h = false
      }
      this.engine.setSrc(f.getUrl());
      return this.engine.on("canPlay", function() {
        if (f.getState() === window.player.trackStates.PLAYING) {
          f.sendNowPlaying()
        }
        try {
          if (g) {
            this.setTime(g)
          }
        } catch (k) {
          console.log(k)
        }
        if (h) {
          f.set("state", window.player.trackStates.PLAYING)
        }
        window.models.syncManager.trigger(f.getSyncLocalId(), {state: f.get("state")});
        if (f.getState() === window.player.trackStates.PLAYING) {
          this.engine.play()
        }
        return this.engine.off("canPlay")
      }, this)
    };
    e.prototype.pause = function() {
      var f;
      this.get("current").set("state", this.trackStates.PAUSED);
      window.models.syncManager.trigger(this.get("current").getSyncLocalId(), {state: this.get("current").get("state")});
      window.models.syncManager.trigger("document:title:change", {title: window.router._currentView.title,force: true});
      f = new window.classes.model.NowPlaying({id: 1});
      f.destroy();
      return this.engine.pause()
    };
    e.prototype.prev = function() {
      var g, f;
      switch (window.player.get("repeat")) {
        case this.repeatStates.NO_REPEAT:
          if (this.get("currentIndex") <= 0) {
            return
          }
          f = this.get("currentIndex") - 1;
          break;
        case this.repeatStates.REPEAT:
          g = this.get("collection").length - 1;
          f = this.get("currentIndex") <= 0 ? g : this.get("currentIndex") - 1;
          break;
        case this.repeatStates.ONLY_ONE:
          f = this.get("currentIndex")
      }
      this.tryStopPrevTrack();
      this.set("currentIndex", f);
      this.get("current").set(this.getCurrentTrack().toJSON());
      return this.tryPlayTrack(this.getCurrentTrack())
    };
    e.prototype.next = function() {
      var g, f;
      g = this.get("collection").length - 1;
      switch (window.player.get("repeat")) {
        case this.repeatStates.NO_REPEAT:
          if (g <= this.get("currentIndex")) {
            this.tryStopPrevTrack();
            this.pause();
            return
          }
          f = this.get("currentIndex") + 1;
          break;
        case this.repeatStates.REPEAT:
          f = g <= this.get("currentIndex") ? 0 : this.get("currentIndex") + 1;
          break;
        case this.repeatStates.ONLY_ONE:
          f = this.get("currentIndex")
      }
      this.tryStopPrevTrack();
      this.set("currentIndex", f);
      this.get("current").set(this.getCurrentTrack().toJSON());
      return this.tryPlayTrack(this.getCurrentTrack())
    };
    e.prototype.getNextTrack = function() {
      return this.get("collection").at(this.get("currentIndex") + 1)
    };
    e.prototype.getPrevTrack = function() {
      return this.get("collection").at(this.get("currentIndex") - 1)
    };
    e.prototype.getCurrentIndex = function() {
    };
    e.prototype.onErrorSearchTrack = function(g) {
      var f;
      window.player.pause();
      if (window.models.currentUser.id) {
        f = window.models.currentUser.getAccount("vkontakte");
        console.log(f);
        if (_.isEmpty(f)) {
          window.utils.msg.html(__("Трек не найден.") + " " + __("Попробуйте") + " <a class='connect-vk-btn' href='#'>" + __("подключить") + "</a> " + __("аккаунт Вконтакте"));
          $(".connect-vk-btn").one("click", function() {
            return window.utils.connectVk()
          })
        } else {
          console.log("Трек не найден!)");
          window.utils.msg.warn(__("Трек не найден."))
        }
      } else {
        window.utils.msg.html(__("Трек не найден.") + " " + __("Попробуйте авторизоваться и подключить аккаунт Вконтакте"))
      }
      return this.next()
    };
    e.prototype.getLink = function(f, g) {
      var k, h, l;
      l = h = k = undefined;
      if (f.getUrl()) {
        g.success(f) || null;
        return
      }
      return this.loadFromVK(f, _.bind(function(m, n) {
        if (!m && !_.isEmpty(n)) {
          if (_.isArray(n)) {
            this.vkTracks = n;
            this.vkTracks.index = 0;
            l = n[0].source;
            h = n[0].url;
            k = n[0].durationSec;
            f.set("source", l);
            f.set("link", h);
            if (k) {
              f.set("durationSec", k)
            }
            return g.success(f)
          } else {
            l = n.source;
            h = n.url;
            k = n.durationSec;
            f.set("source", l);
            f.set("link", h);
            if (k) {
              f.set("durationSec", k)
            }
            return g.success(f)
          }
        } else {
          delete this.vkTracks;
          return this.loadFromNode(f, function(p, o) {
            if (!p && f) {
              f.set("sourceLink", o.sourceLink);
              l = o.source;
              h = o.url;
              k = o.durationSec;
              f.set("source", l);
              f.set("link", h);
              if (k) {
                f.set("durationSec", k)
              }
              g.success(f)
            } else {
              f.set("source", "notFound");
              return g.error && g.error(p)
            }
          })
        }
      }, this))
    };
    e.prototype.loadFromNode = function(h, l) {
      var g, f, k;
      f = function(n, o, m) {
        $.ajax({url: window.api_url_2 + "/search/source/" + n + "/" + o,type: "get",dataType: "json"}).success(function(p) {
          return m(null, p)
        }).fail(function(p) {
            return m(null, __("Не найден"))
          })
      };
      g = $.trim(h.get("artistName"));
      k = $.trim(h.get("trackName"));
      return invoke(function(n, m) {
        return f(g, k, m)
      }).and(function(o, m) {
          var n;
          n = k.match(/^(.+)\s*?\([^)]*?\)\s*?/);
          if (!n) {
            return m(null, "")
          } else {
            return f(g, n[1], m)
          }
        }).rescue(function(m) {
          return l(m)
        }).end(null, function(n, m) {
          if (!n[0] && !n[1]) {
            l(__("Не найден"))
          }
          h = (n[0] && n[0].url ? n[0] : n[1]);
          if (!h.url) {
            return l(__("Не найден"))
          } else {
            return l(null, {url: h.url,durationSec: h.durationSec,source: h.source,sourceLink: h.sourceLink})
          }
        })
    };
    e.prototype.loadFromVK = function(f, k) {
      var g, h;
      g = f.get("durationSec");
      h = function(l, n, o) {
        var p, m;
        p = encodeURIComponent(l) + " " + encodeURIComponent(n);
        m = _.find(window.models.currentUser.get("accounts"), function(q) {
          return q.type === "vkontakte"
        });
        if (m) {
          return $.ajax({url: "https://api.vk.com/method/audio.search?access_token=" + m.token + "&q=" + p,dataType: "jsonp",success: function(s) {
            var q;
            if (s.error) {
              console.error("Error Get Link.", s.error);
              k(s.error);
              return
            }
            if (s.response.length <= 1) {
              return o(null, null)
            } else {
              q = _.filter(s.response, function(r) {
                return (r.title && r.title.toLowerCase() === n.toLowerCase()) && (r.artist && r.artist.toLowerCase() === l.toLowerCase())
              });
              if (g) {
                q = _.sortBy(q, function(r) {
                  return Math.abs(r.duration - g)
                })
              }
              if (q && q.length) {
                return o(null, q)
              } else {
                return o(null, {first: s.response[1]})
              }
            }
          }})
        } else {
          return k("VK not connected")
        }
      };
      return invoke(function(m, l) {
        return h(f.get("artistName"), f.get("trackName"), l)
      }).and(function(m, l) {
          var n;
          n = f.get("trackName").match(/^(.+)\s*?\([^)]*?\)\s*?/);
          if (!n) {
            return l(null, "")
          } else {
            return h(f.get("artistName"), n[1], l)
          }
        }).rescue(function(l) {
          return k(l)
        }).end(null, function(n, l) {
          var m;
          m = n[0] || n[1];
          if (m) {
            if (m.first) {
              m = {url: m.first.url,durationSec: m.first.duration,source: "vkontakte",vkLyricsId: m.first.lyrics_id}
            } else {
              m = _.map(m, function(o) {
                return {url: o.url,durationSec: o.duration,source: "vkontakte",vkLyricsId: o.lyrics_id}
              })
            }
            return k(null, m)
          } else {
            return k("Not found")
          }
        })
    };
    e.prototype.setCollection = function(f) {
      this.set("originalCollection", f);
      f.on("add", function(g) {
        return this.fillCollection(this.get("originalCollection"))
      }, this);
      this.setMapper();
      return this.fillCollection(this.get("originalCollection"))
    };
    e.prototype.fillCollection = function(g) {
      var f;
      f = this.mapper.processCollection(this.get("originalCollection"));
      this.set("collection", f);
      return this.set("unshuffled", _.clone(f))
    };
    e.prototype.setMapper = function() {
      if (this.get("originalCollection") instanceof window.classes.collection.LikeList) {
        return this.mapper = new window.classes.model.TickerMapper
      } else {
        if (this.get("originalCollection") instanceof window.classes.collection.flowCollection) {
          return this.mapper = new window.classes.model.FlowMapper
        } else {
          if (this.get("originalCollection") instanceof window.classes.collection.PlaylistItemsCollection) {
            return this.mapper = new window.classes.model.PlaylistMapper
          } else {
            return this.mapper = new window.classes.model.TrackListMapper
          }
        }
      }
    };
    e.prototype.getSeek = function() {
      return Math.floor(this.engine.get("currentTime")) / Math.floor(this.engine.get("duration")).toFixed(2)
    };
    e.prototype.getBuffer = function() {
      return Math.floor(this.engine.get("bufferTime")) / Math.floor(this.engine.get("duration")).toFixed(2)
    };
    e.prototype.setTime = function(f) {
      return _.debounce(this.engine.setTime(f), 8000)
    };
    e.prototype.getTime = function() {
      return this.engine.getTime()
    };
    e.prototype.setVolume = function(f) {
      this.engine.setVolume(f);
      return this.set("volume", f)
    };
    e.prototype.getTimeElapsed = function(f) {
      var g;
      g = (f === undefined ? this.engine.get("currentTime").toFixed(0) : (this.engine.get("duration") * f).toFixed(0));
      return this.addBaseZero(Math.floor(g / 60)) + ":" + this.addBaseZero(g % 60)
    };
    e.prototype.addBaseZero = function(f) {
      f = f + "";
      if (f.length === 1) {
        return f = "0" + f
      }
      return f
    };
    e.prototype.toggleShuffle = function() {
      return this.set("shuffle", !this.get("shuffle"))
    };
    e.prototype.onChangeShuffle = function() {
      if (this.get("shuffle") === true) {
        return this.setShuffleCollection()
      } else {
        return this.setUnshuffleCollection()
      }
    };
    e.prototype.setShuffleCollection = function(f) {
      var g;
      if (f == null) {
        f = null
      }
      this.tmp = this.get("collection");
      this.get("collection").reset(this.tmp.shuffle());
      g = this.get("collection").findTrackByLocalId(this.get("current").getSyncLocalId());
      this.get("collection").move(g, 0);
      this.set("currentIndex", 0);
      if (f) {
        this.tryPlayByIndex(f);
        return this.set("currentIndex", f)
      }
    };
    e.prototype.setUnshuffleCollection = function() {
      var g, f;
      g = this.get("unshuffled").find(function(h) {
        return this.get("current").getSyncLocalId() === h.getSyncLocalId()
      }, this);
      f = this.get("unshuffled").indexOf(g);
      this.set("currentIndex", f);
      return this.set("collection", this.get("unshuffled"))
    };
    e.prototype.toggleRepeat = function() {
      var f;
      f = this.get("repeat");
      if (f < 2) {
        return this.set("repeat", ++f)
      } else {
        return this.set("repeat", 0)
      }
    };
    e.prototype.checkPlayable = function(k, f) {
      var l, h, g;
      h = window.utils.getHost(k);
      l = ["vkontakte.ru", "userapi.com", "vk.com", "vk.me"];
      g = _.some(l, function(m) {
        return m === h
      });
      if (g) {
        f.error("К сожалению ссылки на VK фильтруются по IP адресу. Укажите другой источник.");
        return
      }
      this.engine.setSrc(k);
      this.engine.on("canPlay", _.bind(function() {
        this.engine.off("canPlay");
        return f.success()
      }, this));
      return this.engine.on("error", _.bind(function(m) {
        this.engine.off("canPlay");
        return f.error()
      }, this))
    };
    return e
  })(Backbone.Model);
  $(function() {
    return window.player = new c({engine: window.models.audioEngine})
  })
}).call(this);
(function() {
  var b, d, a = {}.hasOwnProperty, c = function(h, f) {
    for (var e in f) {
      if (a.call(f, e)) {
        h[e] = f[e]
      }
    }
    function g() {
      this.constructor = h
    }
    g.prototype = f.prototype;
    h.prototype = new g();
    h.__super__ = f.prototype;
    return h
  };
  d = window.resources.__;
  b = (function(f) {
    c(e, f);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.AUTH_URL = window.api_url_2 + "/auth";
    e.prototype.SALT_URL = API_PREFIX + "/salt";
    e.prototype.CHECK_URL = API_PREFIX + "/checkuser";
    e.prototype.SOCIAL_URL = API_PREFIX + "/socialaccount";
    e.prototype.INVITE_URL = API_PREFIX + "/sendInvite";
    e.prototype.DEV_TYPE = "website";
    e.prototype.idAttribute = "userId";
    e.prototype.url = function() {
      return window.api_url_2 + "/users/me"
    };
    e.prototype.initialize = function() {
      var g;
      g = this;
      this.socialNetworks = {};
      return this.on("change:authorized", function() {
        return window.resources.IS_AUTH = g.get("authorized")
      })
    };
    e.prototype.parse = function(g) {
      g.authorized = true;
      return g
    };
    e.prototype.login = function(g, k, h) {
      var l, m = this;
      l = {devicetype: this.DEV_TYPE,login: g,email: g,password: k};
      return $.ajax({url: window.api_url_2 + "/auth",type: "POST",data: l,success: function(n) {
        m.set(n);
        window.views.sidebar.render();
        window.player.trigger("change:current");
        m.createTicker();
        return h != null ? typeof h.success === "function" ? h.success() : void 0 : void 0
      },error: function(n) {
        return h != null ? typeof h.error === "function" ? h.error() : void 0 : void 0
      }})
    };
    e.prototype.register = function(h, g) {
      var k = this;
      return $.ajax({url: window.api_url_2 + "/users",type: "POST",data: h,success: function(l) {
        k.set(l);
        window.views.sidebar.render();
        window.player.trigger("change:current");
        k.createTicker();
        if (Backbone.history.fragment !== "flow") {
          window.router.navigate("/flow", {trigger: true})
        }
        return g != null ? typeof g.success === "function" ? g.success() : void 0 : void 0
      },error: function(l) {
        return g != null ? typeof g.error === "function" ? g.error(JSON.parse(l.responseText)) : void 0 : void 0
      }})
    };
    e.prototype.logout = function(g) {
      return $.ajax({url: this.AUTH_URL,type: "DELETE",success: function() {
        $.cookie("SessionId", "");
        window.models.currentUser = new e();
        window.views.sidebar.render();
        window.player.trigger("change:current");
        window.views.tickerView.remove();
        return $("#content").addClass("margin-right-x0-gm-i")
      }})
    };
    e.prototype.createTicker = function() {
      window.views.tickerView = new window.classes.view.tickerView;
      window.views.tickerView.render();
      return $("#content").removeClass("margin-right-x0-gm-i")
    };
    e.prototype.socialLogin = function(g, h) {
      var k;
      k = this.socialNetworks[g];
      k.network = g;
      k.devicetype = this.DEV_TYPE;
      return $.ajax({url: this.AUTH_URL,type: "POST",data: k,success: _.bind(this.setAuth, this),error: h.error})
    };
    e.prototype.clearModel = function() {
      this.clear();
      this.id = null;
      return this.socialNetworks = {}
    };
    e.prototype.checkUser = function(k, h, g) {
      return $.getJSON(this.CHECK_URL, {email: k,login: h}, function(l) {
        return g && g(l)
      })
    };
    e.prototype.setAuth = function(k) {
      var h, g;
      this.set(k);
      this.loaded = true;
      this.set({authorized: true});
      this.trigger("auth");
      g = [];
      for (h in this.socialNetworks) {
        g.push(this._addSocialNetwork(h))
      }
      return g
    };
    e.prototype.addSocialNetwork = function(k, h) {
      var g;
      h = _.defaults(h || {}, {success: function() {
      },error: function() {
      }});
      g = _.bind(function() {
        if (window.models.currentUser.get("authorized")) {
          return this._addSocialNetwork(k, h)
        }
      }, this);
      if (k === "facebook") {
        return this.fbApi(g)
      } else {
        if (k === "vkontakte") {
          return this.vkApi(g)
        }
      }
    };
    e.prototype._addSocialNetwork = function(l, k) {
      var g, h;
      h = this;
      g = function(m) {
        return $.ajax(_.extend({type: "POST",url: h.SOCIAL_URL,data: _.extend(h.socialNetworks[l], {network: l,friendId: m})}, k))
      };
      switch (l) {
        case "facebook":
          return window.FB && window.FB.api("/me/friends", function(m) {
            var n;
            n = [];
            if (m.data) {
              _.each(m.data, function(o) {
                return n.push(o.id)
              })
            }
            window.views.inviteFriendsForm.networks[l] = {network: l,friendId: n};
            return g(n)
          });
        case "vkontakte":
          return VK && VK.api("friends.get", {}, function(n) {
            var m;
            m = [];
            if (!n.error) {
              m = n.response
            }
            window.views.inviteFriendsForm.networks[l] = {network: l,friendId: m};
            return g(m)
          });
        default:
          return g([])
      }
    };
    e.prototype.fbApi = function(g) {
      var k, h;
      h = this;
      k = function(l) {
        var m, n;
        n = l.authResponse.userID;
        m = l.authResponse.accessToken;
        h.socialNetworks.facebook = {socialId: n,token: m};
        return g && g(l)
      };
      return window.FB && window.FB.getLoginStatus(function(l) {
        if (l.status === "connected") {
          return k(l)
        } else {
          return window.FB.login((function(m) {
            if (m.status === "connected") {
              return k(m)
            }
          }), {scope: "email,user_likes,user_about_me,user_photos, publish_actions, publish_stream"})
        }
      })
    };
    e.prototype.getFBData = function(g) {
      return window.FB && window.FB.api("/me", function(h) {
        return g && g(h)
      })
    };
    e.prototype.importInfo = function(l) {
      var k, h, g;
      h = this;
      k = function(m) {
        return $.ajax({type: "POST",url: API_PREFIX + "/userImage",data: {imageUrl: m},success: function(n) {
          h.set("image", n);
          return h.trigger("avatarUpdated", h)
        },error: function() {
          window.utils.msg.error(d("Не удалось импортировать аватар"));
          return console.log("error", arguments_)
        }})
      };
      g = function(m) {
        m = m || this;
        if (!h.get("authorized")) {
          h.on("auth", g, m);
          return
        }
        h.off("auth", g);
        _.each(m, function(o, n) {
          if (o === null || o === "" || h.get(n)) {
            return delete m[n]
          }
        });
        if (m.imageUrl && !h.get("image")) {
          k(m.imageUrl)
        }
        delete m.imageUrl;
        if (_.isEmpty(m)) {
          return
        }
        return h.saveProfile(m, {success: function() {
          return h.trigger("infoImported", h)
        },error: function() {
          return window.utils.msg.error(d("Не удалось импортировать информацию"))
        }})
      };
      if (l === "vkontakte") {
        window.VK.Api.call("users.get", {uids: h.socialNetworks.vkontakte.socialId,fields: "first_name, last_name, nickname, sex, photo_big"}, function(n) {
          var o, m;
          if (!n || !n.response || !n.response.length) {
            return
          }
          m = n.response[0];
          o = {name: m.first_name + " " + m.last_name,imageUrl: m.photo_big,gender: (m.sex === 2 ? true : (m.sex === 1 ? false : ""))};
          return g(o)
        });
        return this.createVKPlaylist()
      } else {
        if (l === "facebook") {
          return this.getFBData(function(m) {
            var n;
            n = {name: m.name,gender: (m.gender === "male" ? true : (m.gender === "female" ? false : "")),webSite: m.website || "",location: m.location && m.location.name || "",bio: m.bio || "",imageUrl: "https://graph.facebook.com/" + m.id + "/picture?type=large"};
            return g(n)
          })
        } else {
          if (l === "lastfm") {
            return this.createLastFMPlaylist()
          }
        }
      }
    };
    e.prototype.vkApi = function(g) {
      var h;
      h = this;
      return window.VK && window.VK.Auth.login(function(k) {
        var m, l;
        if (!k.session) {
          return
        }
        l = k.session.mid;
        m = k.session.sig;
        h.socialNetworks.vkontakte = {socialId: l,sig: m};
        return g && g(k)
      }, 8 + 2 + 8192)
    };
    e.prototype.createVKPlaylist = function(g) {
      var h;
      h = this;
      if (!window.models.currentUser.get("authorized")) {
        return
      }
      return window.VK.api("users.get", {uids: this.socialNetworks.vkontakte.socialId,fields: "first_name, last_name"}, function(m) {
        var l, k;
        if (!m || !m.response || !m.response.length) {
          return
        }
        k = m.response[0];
        l = k.first_name + " " + k.last_name;
        return window.VK.api("audio.get", {uid: h.socialNetworks.vkontakte.socialId,count: 200}, function(n) {
          var o;
          o = _.map(n.response, function(p) {
            return {trackName: p.title,artistName: p.artist,duration: p.duration}
          });
          if (!o.length) {
            return
          }
          return h.postTracksToServer(o, d("ВКонтакте – ") + l, "vkontakte", g)
        })
      })
    };
    e.prototype.getHoursFromSignup = function() {
      var g;
      return g = Math.round(parseInt(this.get("ordersCount"), 10) * 3 / 60)
    };
    e.prototype.postTracksToServer = function(h, l, k, g) {
      return $.ajax({type: "POST",dataType: "json",url: API_PREFIX + "/BulkPlayList/",data: "name=" + encodeURIComponent(l) + "&type=" + k + "&tracks=" + encodeURIComponent(JSON.stringify(h)),processData: false,success: function(m) {
        return g && g()
      },error: function() {
        return console.log("error", arguments_)
      }})
    };
    e.prototype.getAccount = function(g) {
      var h;
      h = _.find(this.get("accounts"), function(k) {
        return k.type === g
      });
      return h
    };
    e.prototype.connectVk = function(l, k, g) {
      var h;
      h = this;
      return $.ajax({type: "POST",url: window.api_url_2 + "/socials/vk/" + l + "?redirect_uri=" + k,success: function(m) {
        h.set(m);
        return g()
      },error: function() {
        return window.utils.msg.error(d("Не удалось подключить") + d("Вконтакте"))
      }})
    };
    e.prototype.connectLastFM = function(k, g) {
      var h;
      h = this;
      return $.ajax({type: "POST",url: window.api_url_2 + "/socials/lastfm/" + k,success: function(l) {
        h.set(l);
        return g()
      },error: function() {
        window.utils.msg.error(d("Не удалось подключить Lastfm"));
        return g()
      }})
    };
    e.prototype.createLastFMPlaylist = function(g) {
      var h;
      this.initLastFm();
      if (!window.models.currentUser.get("authorized")) {
        return
      }
      h = this;
      return this.lastfm.user.getTopTracks({limit: 200,user: window.models.currentUser.socialNetworks.lastfm.socialId}, {success: function(k) {
        var l;
        l = _.map(k.toptracks.track, function(m) {
          return {trackName: m.name,artistName: m.artist.name,duration: m.duration}
        });
        if (!l.length) {
          return
        }
        return h.postTracksToServer(l, "Last.fm – " + h.socialNetworks.lastfm.socialId, "lastfm", g)
      }})
    };
    e.prototype.getSocialAccount = function(k, h) {
      var l, g;
      g = this;
      l = {network: k};
      h = _.defaults(h || {}, {success: function() {
      },error: function() {
      }});
      return $.getJSON(this.SOCIAL_URL + (k ? "" : "s"), l, function(m) {
        if (m.length === 0) {
          m = []
        } else {
          if (m.length === undefined) {
            m = [m]
          }
        }
        return _.each(m, function(n) {
          switch (n.type) {
            case "facebook":
              return window.FB.getLoginStatus(function(o) {
                if (o.status === "connected") {
                  g.socialNetworks[n.type] = n;
                  return h.success(g.socialNetworks)
                } else {
                  return g.deleteSocial(n.type)
                }
              });
            case "vkontakte":
              return window.VK.Auth.getLoginStatus(function(o) {
                if (o.session) {
                  g.socialNetworks[n.type] = n;
                  return h.success(g.socialNetworks)
                } else {
                  return g.deleteSocial(n.type)
                }
              });
            case "twitter":
              return $.ajax({url: NODE_API_PREFIX + "/twitter/check-token/",type: "POST",dataType: "JSON",data: {token: n.token},success: function(o) {
                g.socialNetworks[n.type] = n;
                return h.success(g.socialNetworks)
              },error: function() {
                return g.deleteSocial(n.type)
              }});
            case "lastfm":
              g.socialNetworks[n.type] = n;
              return h.success(g.socialNetworks);
            default:
              g.socialNetworks[n.type] = n;
              return h.success(g.socialNetworks)
          }
        })
      })
    };
    e.prototype.deleteSocial = function(k, h) {
      var l, g;
      l = this.socialNetworks[k];
      g = this;
      if (!l) {
        return
      }
      h = _.defaults(h || {}, {success: function() {
      },error: function() {
      }});
      return $.ajax({type: "DELETE",url: this.SOCIAL_URL + "?network=" + k,success: function(m) {
        delete g.socialNetworks[k];
        return h.success(m)
      },error: function() {
        return h.error()
      }})
    };
    e.prototype.saveProfile = function(h, m) {
      var g, l, n, k;
      m = _.defaults(m || {}, {success: function() {
      },error: function() {
      }});
      if (_.isObject(h) && !h.length) {
        g = [];
        _.each(h, function(p, o) {
          return g.push({name: o,value: p})
        });
        h = g
      }
      n = _.find(h, function(o) {
        return o.name === "password"
      });
      l = _.find(h, function(o) {
        return o.name === "newPassword"
      });
      if (n && n.value) {
        n.value = md5(n.value)
      }
      if (l && l.value) {
        l.value = md5(l.value)
      }
      k = this;
      return $.ajax({type: "PUT",url: this.urlRoot,data: h,success: function() {
        var o;
        o = {};
        _.each(h, function(p) {
          return o[p.name] = p.value
        });
        k.set(o);
        return m.success(k)
      },error: function(o) {
        return m.error(JSON.parse((o && o.responseText) || {}))
      }})
    };
    e.prototype.checkSocial = function(k, g) {
      var h;
      h = this;
      if (!this.socialNetworks[k]) {
        if (h[k + "Checked"]) {
          g && g(null)
        }
      } else {
        return g && g(this.socialNetworks[k])
      }
    };
    e.prototype.sendInvite = function(h, g) {
      g = _.defaults(g || {}, {success: function() {
      },error: function() {
      }});
      if (this.get("invitesCount") <= 0) {
        g.error()
      }
      return $.ajax({type: "GET",url: this.INVITE_URL + "?email=" + h,success: _.bind(function(k) {
        this.set("invitesCount", this.get("invitesCount") - 1);
        return g.success(k)
      }, this),error: g.error})
    };
    e.prototype.saveNotificationSettings = function(g) {
      this.set("notificationSettings", g);
      return $.ajax({type: "PUT",data: g,url: this.urlRoot})
    };
    e.prototype.changeLanguage = function(g) {
      if (g === $.cookie("lang")) {
        return $.ajax({type: "PUT",url: this.urlRoot,data: {lang: g},success: function(h) {
          $.ajax({type: "get",url: API_PREFIX + "/user/LegoMushroom",success: function() {
          }});
          window.location.reload();
          return $.cookie("lang", g, {path: "/"})
        }})
      }
    };
    e.prototype.getVKToken = function() {
      return document.location.href = "http://oauth.vk.com/authorize?client_id=2944447&redirect_uri=tracksflow.com&response_type=code"
    };
    return e
  })(window.classes.model.userModel);
  window.models.currentUser = new b();
  window.models.currentUser.fetch({async: false})
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(d) {
    b(e, d);
    function e() {
      return e.__super__.constructor.apply(this, arguments)
    }
    e.prototype.events = {"click .js-show-drop-menu": "toggleDropMenu"};
    e.prototype.initialize = function() {
      this.model.on("change", this.render, this);
      return this.model.on("reset", this.render, this)
    };
    e.prototype.toggleDropMenu = function() {
      this.$(".popup").toggleClass("show");
      if (this.$(".popup").hasClass("show")) {
        return this.$(".popup").slideDown(100, function() {
          return $(window).one("click", function() {
            return this.$(".popup").slideUp(100)
          })
        })
      }
    };
    e.prototype.render = function() {
      this.template = _.template($("#sidebar-user-template").html());
      this.$el.html(this.template({model: this.model}));
      return this
    };
    return e
  })(Backbone.View);
  window.classes.view.CurrentUser = c
}).call(this);
(function() {
  var a;
  a = (function() {
    function b() {
      this.socket = io.connect();
      this.socket.on("askUserId", _.bind(function(c) {
        return this.sendUserId(c)
      }, this))
    }
    b.prototype.sendUserId = function(c) {
      return this.socket.emit("connect", {userId: window.models.currentUser.id,socketId: c.socketId})
    };
    b.prototype.listen = function() {
      if (!window.models.currentUser.id) {
        return
      }
      this.socket.on("ticker/likes", function(c) {
        var d;
        d = new window.classes.model.LikeTrackModel(c, {parse: true});
        d.track.set("state", window.player.trackStates.PAUSED);
        return window.views.tickerView.tickerLikes.collection.unshift(d)
      });
      this.socket.on("ticker/online", function(d) {
        var c;
        c = new window.classes.model.NowPlaying(d, {parse: true});
        return window.views.tickerView.tickerOnline.collection.pushOnline(c)
      });
      return this.socket.on("ticker/online/remove", function(c) {
        return window.views.tickerView.tickerOnline.collection.removeByUserId(c)
      })
    };
    return b
  })();
  window.classes.SocketListener = a
}).call(this);
(function() {
  var a;
  a = (function() {
    b.prototype.ScrollOffset = 310;
    function b(d, f, g, c, e) {
      if (f == null) {
        f = $(document)
      }
      if (c == null) {
        c = null
      }
      if (e == null) {
        e = true
      }
      this.container = d;
      this.content = f;
      this.collection = g;
      this.collection.pageSize = c || g.options.data.pageSize;
      if (e) {
        this.bindScroll();
        this.jqxhr = this.collection.loadNextPage(_.bind(this.pageLoaded, this))
      }
    }
    b.prototype.bindScroll = function() {
      return this.container.scroll(_.bind(function() {
        if (this.container.scrollTop() >= this.content.height() - this.container.height() - this.ScrollOffset) {
          return this.jqxhr = this.collection.loadNextPage(_.bind(this.pageLoaded, this))
        }
      }, this))
    };
    b.prototype.pageLoaded = function() {
    };
    b.prototype.unbind = function() {
      return this.container.unbind("scroll")
    };
    b.prototype.teardown = function() {
      var c;
      this.unbind();
      return (c = this.jqxhr) != null ? c.abort() : void 0
    };
    return b
  })();
  window.classes.controller.lazyLoadController = a
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.navigate = function(g, f) {
      if (_.isFunction(this.preRoute)) {
        this.preRoute()
      }
      d.__super__.navigate.call(this, g, f);
      if (_.isFunction(this.postRoute)) {
        return this.postRoute()
      }
    };
    return d
  })(Backbone.Router);
  window.classes.ExtRouter = c
}).call(this);
(function() {
  var c, a = {}.hasOwnProperty, b = function(g, e) {
    for (var d in e) {
      if (a.call(e, d)) {
        g[d] = e[d]
      }
    }
    function f() {
      this.constructor = g
    }
    f.prototype = e.prototype;
    g.prototype = new f();
    g.__super__ = e.prototype;
    return g
  };
  c = (function(e) {
    b(d, e);
    function d() {
      return d.__super__.constructor.apply(this, arguments)
    }
    d.prototype.routes = {"user/:login": "profileHandler","user/:login/:section": "profileHandler",settings: "settingsHandler","artist/:artistName": "artistHandler","artist/:artistId/album/:albumId": "albumHandler","artist/:artistId/track/:trackId": "trackHandler","artist/:artistName/add": "addAlbumHandler","artist/:artistName/album/:albumName/edit": "editAlbumHandler","playlist/:playlistKey": "playlistHandler","flow(/:typeName)": "flowHandler","post/:postId": "postHandler",trends: "trendsHandler",music: "trendsHandler","new": "mainOnceHandler","": "emptyHandler",home: "mainPageHandler","search/:query": "searchHandler","search/:query/tracks": "searchTracksHandler","search/:query/playlists": "searchPlaylistHandler","search/:query/albums": "searchAlbumsHandler","search/:query/artists": "searchArtistsHandler","search/:query/mixes": "searchMixesHandler","search/:query/users": "searchUsersHandler","tag/:name": "tagHandler","tag/:name/tracks": "tagTracksHandler","tag/:name/playlists": "tagPlaylistHandler","tag/:name/albums": "tagAlbumsHandler","tag/:name/artists": "tagArtistsHandler",selectionAdmin: "selectionAdminHandler","selection/:selectionId": "selectionHandler",logout: "logoutHandler","reset-pass": "resetHandler",terms: "termsHandler"};
    d.prototype.preRoute = function(f) {
      if (f == null) {
        f = false
      }
      $("#content").html(_.template($("#loader-template").html())());
      if (f) {
        return this.trackGA()
      }
    };
    d.prototype.postRoute = function() {
      return this.trackGA()
    };
    d.prototype.trackGA = function() {
      var f;
      if (!window.googleTracker) {
        return
      }
      f = window.models.currentUser.id ? true : false;
      window.googleTracker._trackPageview(location.pathname);
      return window.googleTracker._setCustomVar(1, "Member Type", f, 1)
    };
    d.prototype._checkSocialTokenUrl = function() {
      var g, f;
      g = window.utils.getURLParameters();
      if ((g != null ? g.type : void 0) === "lastfm") {
        window.models.currentUser.connectLastFM(g.token, function() {
          return _.defer(function() {
            window.router.navigate("/settings/", {trigger: true});
            window.router.navigate("/settings", {trigger: true});
            return window.utils.msg.notify(__("Last.fm") + " " + __("подключен"))
          }, 1000)
        })
      }
      if ((g != null ? g.type : void 0) === "vk") {
        f = encodeURIComponent(window.location.host + window.location.pathname + "?type=vk");
        return window.models.currentUser.connectVk(g.code, f, function() {
          return _.defer(function() {
            window.router.navigate("/settings/", {trigger: true});
            window.router.navigate("/settings", {trigger: true});
            return window.utils.msg.notify(__("Вконтакте") + " " + __("подключен"))
          }, 1000)
        })
      }
    };
    d.prototype.mainOnceHandler = function() {
      this._nextView = new window.classes.page.mainOncePage;
      return this.startView()
    };
    d.prototype.termsHandler = function() {
      this._nextView = new window.classes.page.termsPage({el: $("#content")});
      return this.startView()
    };
    d.prototype.mainPageHandler = function() {
      this._nextView = new window.classes.page.mainPage({el: $("#content")});
      return this.startView()
    };
    d.prototype.emptyHandler = function() {
      if (window.models.currentUser.id && window.models.currentUser.get("mainVisited")) {
        return this.navigate("/flow", {trigger: true})
      }
    };
    d.prototype.profileHandler = function(f, g) {
      if (g == null) {
        g = "flow"
      }
      this._nextView = new window.classes.page.ProfilePage({el: $("#content"),id: f,section: g});
      return this.startView()
    };
    d.prototype.settingsHandler = function() {
      var f;
      if (!window.models.currentUser.id) {
        history.back()
      }
      f = __("Настройки") + " - " + window.APP_NAME;
      this._checkSocialTokenUrl();
      this._nextView = new window.classes.page.SettingsPage({el: $("#content")});
      return this.startView(f)
    };
    d.prototype.resetHandler = function() {
      var f;
      f = window.location.href.split("?")[1].split("=")[1];
      return new window.classes.view.ResetPasswordModal({code: f})
    };
    d.prototype.tagHandler = function(f) {
      this._nextView = new window.classes.page.tagPage({el: $("#content"),id: decodeURIComponent(f)});
      return this.startView()
    };
    d.prototype.tagTracksHandler = function(f) {
      this._nextView = new window.classes.page.tagPage({section: "tracks",el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.tagPlaylistHandler = function(f) {
      this._nextView = new window.classes.page.tagPage({section: "playlists",el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.tagAlbumsHandler = function(f) {
      this._nextView = new window.classes.page.tagPage({section: "albums",el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.tagArtistsHandler = function(f) {
      this._nextView = new window.classes.page.tagPage({section: "artists",el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.searchHandler = function(f) {
      this._nextView = new window.classes.page.searchPage({el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.searchTracksHandler = function(f) {
      this._nextView = new window.classes.page.searchPage({section: "tracks",el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.searchMixesHandler = function(f) {
      this._nextView = new window.classes.page.searchPage({section: "mixes",el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.searchPlaylistHandler = function(f) {
      this._nextView = new window.classes.page.searchPage({section: "playlists",el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.searchAlbumsHandler = function(f) {
      this._nextView = new window.classes.page.searchPage({section: "albums",el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.searchArtistsHandler = function(f) {
      this._nextView = new window.classes.page.searchPage({section: "artists",el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.searchUsersHandler = function(f) {
      this._nextView = new window.classes.page.searchPage({section: "users",el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.trendsHandler = function() {
      var f;
      f = Backbone.history.fragment;
      this._nextView = new window.classes.page.TrendsPage({el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.artistHandler = function(f) {
      var g;
      f = decodeURIComponent(f);
      g = f + " - " + window.APP_NAME;
      this._nextView = new window.classes.page.artistPage({el: $("#content"),id: helpers.getId(f)});
      return this.startView(g)
    };
    d.prototype.albumHandler = function(h, g) {
      var k, f, l;
      f = decodeURIComponent(h);
      k = decodeURIComponent(g);
      l = k + " - " + f + " - " + window.APP_NAME;
      this._nextView = new window.classes.page.albumPage({el: $("#content"),id: helpers.getId(decodeURIComponent(h), decodeURIComponent(g))});
      return this.startView(l)
    };
    d.prototype.addAlbumHandler = function(f) {
      var h, g;
      if (!window.models.currentUser.id) {
        history.back()
      }
      g = new window.classes.model.releaseModel();
      g.tracks = new window.classes.collection.tracksCollection();
      h = decodeURIComponent(f);
      g.set("artistName", h);
      g.url = window.api_url_2 + "/albums";
      this._nextView = new window.classes.page.AlbumEditPage({el: $("#content"),model: g});
      return this.startView()
    };
    d.prototype.editAlbumHandler = function(f, g) {
      var h;
      if (!window.models.currentUser.id) {
        history.back()
      }
      h = helpers.getId(decodeURIComponent(f), decodeURIComponent(g));
      g = new window.classes.model.releaseModel({id: h});
      return g.fetch({success: _.bind(function(k) {
        this._nextView = new window.classes.page.AlbumEditPage({el: $("#content"),model: g,btnOkCaption: __("Сохранить")});
        return this.startView()
      }, this)})
    };
    d.prototype.trackHandler = function(h, k) {
      var f, l, g;
      f = decodeURIComponent(h);
      g = decodeURIComponent(k);
      l = g + " - " + f + " - " + window.APP_NAME;
      this._nextView = new window.classes.page.trackPage({el: $("#content"),id: helpers.getId(decodeURIComponent(h), decodeURIComponent(k))});
      return this.startView(l)
    };
    d.prototype.playlistHandler = function(f) {
      this._nextView = new window.classes.page.playlistPage({el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.flowHandler = function(f) {
      var g;
      g = __("Поток") + " - " + window.APP_NAME;
      this._nextView = new window.classes.page.flowPage({el: $("#content"),type: f});
      return this.startView(g)
    };
    d.prototype.postHandler = function(f) {
      this._nextView = new window.classes.page.postPage({el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.selectionAdminHandler = function() {
      this._nextView = new window.classes.page.selectionAdminPage({el: $("#content")});
      return this.startView()
    };
    d.prototype.selectionHandler = function(f) {
      this._nextView = new window.classes.page.selectionPage({el: $("#content"),id: f});
      return this.startView()
    };
    d.prototype.logoutHandler = function() {
      return window.models.currentUser.logout()
    };
    d.prototype.initSidebar = function() {
      window.views.sidebar = new window.classes.view.Sidebar;
      return window.views.sidebar.render()
    };
    d.prototype.initTicker = function() {
      window.views.tickerView = new window.classes.view.tickerView;
      return window.views.tickerView.render()
    };
    d.prototype.initErrorPage = function() {
      return this._errorView = new window.classes.page.ErrorPage({el: $("#content")})
    };
    d.prototype.initialize = function() {
      window.models.syncManager.on("document:title:change", this.onChangeTitle, this);
      this.preRoute(true);
      this.initSidebar();
      this.initErrorPage();
      window.models.currentUser.id && this.initTicker();
      Backbone.history.start({pushState: true});
      this.checkIfMainOnce();
      return this.checkIfUnauthFlow()
    };
    d.prototype.onChangeTitle = function(g) {
      var f;
      g = _.extend({force: false}, g);
      if (g.force) {
        return $(document).attr("title", g.title)
      } else {
        f = $(document).attr("title");
        if (!_.isEmpty(f.match(/▶/i))) {
          return
        }
        return $(document).attr("title", g.title)
      }
    };
    d.prototype.checkIfMainOnce = function() {
      var f;
      f = window.location.href.split("/");
      if (f[f.length - 1] === "") {
        if (!window.models.currentUser.get("mainVisited")) {
          return this.navigate("/new", {trigger: true})
        }
      }
    };
    d.prototype.checkIfUnauthFlow = function() {
      var f;
      f = window.location.href.split("/");
      if (f.length === 4 && f[3] === "flow") {
        if (!window.models.currentUser.id) {
          return this.navigate("/flow/popular", {trigger: true})
        }
      }
    };
    d.prototype.startView = function(h) {
      var g, f, k;
      if (h == null) {
        h = window.APP_NAME
      }
      $("html, body").scrollTop(0);
      if ((g = this._currentView) != null) {
        g.teardown()
      }
      this._currentView = this._nextView;
      if ((f = this._currentView) != null) {
        f.title = h
      }
      window.models.syncManager.trigger("document:title:change", {title: h});
      return (k = this._nextView) != null ? k.start() : void 0
    };
    return d
  })(window.classes.ExtRouter);
  $(function() {
    return window.router = new c
  })
}).call(this);
